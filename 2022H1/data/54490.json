{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "Ie5be7f545f1930ddb2c01b829d8de2e312e936dc",
    "number": 54490,
    "subject": "crow_getroutes_test: revive the test",
    "owner": {
        "name": "Nan Zhou",
        "email": "nanzhoumails@gmail.com",
        "username": "FighterNan"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/54490",
    "commitMessage": "crow_getroutes_test: revive the test\n\nThe test today exists but it isn't enabled. This commit revives the\ntest, and fixed obsolete interfaces.\n\nNote that the current codes don't return the \"/\" route correctly. This\ncommit doesn't fix it but left a TODO.\n\nTested: unit test passed\n\nSigned-off-by: Nan Zhou <nanzhoumails@gmail.com>\nChange-Id: Ie5be7f545f1930ddb2c01b829d8de2e312e936dc\n",
    "createdOn": 1654894186,
    "lastUpdated": 1655825322,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1654894186,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1654894218,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1654894218,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1654894219,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1654894232,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1654894232,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1654894232,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/44820/ : ABORTED"
        },
        {
            "timestamp": 1654894786,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/44821/ : SUCCESS"
        },
        {
            "timestamp": 1654895307,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1654896676,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1655049979,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1655052598,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1655071361,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1655148503,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1655148546,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1655148546,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1655148552,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1655148645,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1655148675,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1655148675,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1655148676,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/44911/ : ABORTED"
        },
        {
            "timestamp": 1655148972,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1655149275,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/44919/ : SUCCESS"
        },
        {
            "timestamp": 1655159715,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1655159756,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1655159756,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1655160055,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1655160272,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/44938/ : SUCCESS"
        },
        {
            "timestamp": 1655166630,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5: Code-Review+2"
        },
        {
            "timestamp": 1655166640,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5: Code-Review+1"
        },
        {
            "timestamp": 1655825318,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5: Code-Review+2"
        },
        {
            "timestamp": 1655825322,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as 5ad7720717807d6cd25b334c11ad117b46c9ee0d"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "7733253387bf71a04d8c5e947700d8e51b91b77d",
            "parents": [
                "7267c21d36a0dfce37f4821e9cd0994156ae3ba7"
            ],
            "ref": "refs/changes/90/54490/1",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1654894186,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -24
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 49,
            "sizeDeletions": 24
        },
        {
            "number": 2,
            "revision": "ab4152db0a0b4bf223eb2643481614ce61583a45",
            "parents": [
                "7267c21d36a0dfce37f4821e9cd0994156ae3ba7"
            ],
            "ref": "refs/changes/90/54490/2",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1654894219,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Overall looks good.  Only one question."
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "line": 39,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Why did this route change?"
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "line": 39,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Yes, \"/\" will be not be reported by getRoutes. I guess you will have more insights why."
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "line": 39,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I don't understand your response.  it seems reasonable to test registering the \"/\" route, so I'm not sure why we changed this.  That's what I'm trying to understand, I'm not saying it's not valid."
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "line": 39,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "> \"/\" will be not be reported by getRoutes\n\nWhen you do `BMCWEB_ROUTE(app, \"/\")`, `app.getRoutes()` won't report this \"/\" route. I didn't dig into why the behavior is like this when working on this commit."
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "line": 39,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "In that case, don't just quietly change the test to do something else, as it's surprising to users, and somewhat defeats the purpose of enabling the unit test if there is behavior that's incorrect.  Comment out the one assertion with a note that the behavior looks incorrect, and someone should look into it.\n\nFWIW, this means that these tests probably should've been left on (I don't recall why they were disabled, but they seem to have found an issue.)"
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "line": 39,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Please take a look at what I have now. I explicitly added a test case and commented it out."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": -24
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 47,
            "sizeDeletions": 24
        },
        {
            "number": 3,
            "revision": "7b9fc1c1984118bd0b3dc31075ef0d7e62ed1755",
            "parents": [
                "7267c21d36a0dfce37f4821e9cd0994156ae3ba7"
            ],
            "ref": "refs/changes/90/54490/3",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1655148503,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 40,
                    "deletions": -24
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 60,
            "sizeDeletions": 24
        },
        {
            "number": 4,
            "revision": "2c9d50c59a66dc3fc1ce6761dd263ba49df303c7",
            "parents": [
                "7267c21d36a0dfce37f4821e9cd0994156ae3ba7"
            ],
            "ref": "refs/changes/90/54490/4",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1655148645,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "line": 63,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "What I meant was just do:\n\n// TODO(nan) Determine why the root route doesn't get reported in getRoutes()                                    \n//testing::Pointee(std::string(\"/\")),\n                                     testing::Pointee(std::string(\"/foo\")),\n                                     testing::Pointee(std::string(\"/bar\")),\n                                     testing::Pointee(std::string(\"/baz\")),\n                                     testing::Pointee(std::string(\"/boo\")),\n                                     testing::Pointee(std::string(\"/moo\"))));\n                                     \n                                     \nand leave the rest of the test alone.  When we find the bug, we'll just comment in that line again."
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "line": 63,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Done. Split into https://gerrit.openbmc.org/c/openbmc/bmcweb/+/54538  and https://gerrit.openbmc.org/c/openbmc/bmcweb/+/54490"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 40,
                    "deletions": -24
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 60,
            "sizeDeletions": 24
        },
        {
            "number": 5,
            "revision": "018ff2131c2022fc8a3968b01ae47e89e4f47c09",
            "parents": [
                "a85afbe1960b015865db775c3e0a53df2a769f44"
            ],
            "ref": "refs/changes/90/54490/5",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1655159715,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -9
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 33,
            "sizeDeletions": 9
        },
        {
            "number": 6,
            "revision": "5ad7720717807d6cd25b334c11ad117b46c9ee0d",
            "parents": [
                "76686dcc74002493e22d72e24db9d3326b3a63ed"
            ],
            "ref": "refs/changes/90/54490/6",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1655825322,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/crow_getroutes_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -9
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 33,
            "sizeDeletions": 9
        }
    ]
}