{
    "project": "openbmc/openpower-occ-control",
    "branch": "master",
    "id": "Ibf272270156edae565231ca429f15e8fca2f15bc",
    "number": 52574,
    "subject": "Prevent termination on OCC open/read/write errors",
    "owner": {
        "name": "Chris Cain",
        "email": "cjcain@us.ibm.com",
        "username": "cjcain"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openpower-occ-control/+/52574",
    "commitMessage": "Prevent termination on OCC open/read/write errors\n\nInstead of creating an elog and terminating, the code will now retry on\na Open/Read/Write failure and if it continues to fail, it will return a\nCommFailure to the caller. Then the caller of can determine how to\nhandle (reset PM complex or ignore).\nNormally all communication errors with the OCC should trigger an OCC\nreset.\n\nChange-Id: Ibf272270156edae565231ca429f15e8fca2f15bc\nSigned-off-by: Chris Cain <cjcain@us.ibm.com>\n",
    "createdOn": 1648852961,
    "lastUpdated": 1656338442,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1648852961,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1648852990,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1648852990,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1648853022,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/40365/ : FAILURE"
        },
        {
            "timestamp": 1648853779,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1648853789,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1648853789,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1648853923,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/40367/ : SUCCESS"
        },
        {
            "timestamp": 1649098080,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1649098100,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649098100,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1649098235,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/40467/ : SUCCESS"
        },
        {
            "timestamp": 1649165771,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1649168369,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1649175885,
            "reviewer": {
                "name": "Sheldon Bailey",
                "email": "baileysh@us.ibm.com",
                "username": "baileysh"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1649344004,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1649345067,
            "reviewer": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1649434773,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Change has been successfully rebased and submitted as c567dc8d7853d545c2ef1c7bfea028c157bce6b2"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "c2a29cc7be66ea7c12b954715177ff26df9d8da1",
            "parents": [
                "e2d0a43cc1af0104d6a0cca10ef8eb91328e15bf"
            ],
            "ref": "refs/changes/74/52574/1",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1648852961,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "occ_command.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "powermode.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -2
                },
                {
                    "file": "occ_command.cpp",
                    "type": "MODIFIED",
                    "insertions": 28,
                    "deletions": -28
                },
                {
                    "file": "occ_status.cpp",
                    "type": "MODIFIED",
                    "insertions": 26,
                    "deletions": -3
                },
                {
                    "file": "occ_pass_through.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 88,
            "sizeDeletions": 38
        },
        {
            "number": 2,
            "revision": "b7623abd5078dec8f08630dfe70b9e78aba4c71d",
            "parents": [
                "e2d0a43cc1af0104d6a0cca10ef8eb91328e15bf"
            ],
            "ref": "refs/changes/74/52574/2",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1648853779,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "occ_command.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "powermode.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -2
                },
                {
                    "file": "occ_command.cpp",
                    "type": "MODIFIED",
                    "insertions": 28,
                    "deletions": -28
                },
                {
                    "file": "occ_status.cpp",
                    "type": "MODIFIED",
                    "insertions": 26,
                    "deletions": -3
                },
                {
                    "file": "occ_pass_through.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 88,
            "sizeDeletions": 38
        },
        {
            "number": 3,
            "revision": "2e3f49089881160e6df27e358aff1a39e2138421",
            "parents": [
                "373af75721778bd6fac65d5cf54a982506d64bfe"
            ],
            "ref": "refs/changes/74/52574/3",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1649098080,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "occ_status.cpp",
                    "line": 217,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "is that OK if it still continues on to the sendIpsData after deviceError runs?"
                },
                {
                    "file": "occ_status.cpp",
                    "line": 217,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "Good point.  Looking at getIpsData(), we do check masterActive first, which gets cleared on the deviceError() call, so should be ok."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "occ_command.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -4
                },
                {
                    "file": "powermode.cpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -19
                },
                {
                    "file": "occ_command.cpp",
                    "type": "MODIFIED",
                    "insertions": 29,
                    "deletions": -29
                },
                {
                    "file": "occ_status.cpp",
                    "type": "MODIFIED",
                    "insertions": 24,
                    "deletions": -9
                },
                {
                    "file": "occ_pass_through.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 88,
            "sizeDeletions": 69
        },
        {
            "number": 4,
            "revision": "c567dc8d7853d545c2ef1c7bfea028c157bce6b2",
            "parents": [
                "7e374fb4378f88e194f4a47c4bb4adfaa605fa89"
            ],
            "ref": "refs/changes/74/52574/4",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1649434773,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "occ_command.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -4
                },
                {
                    "file": "powermode.cpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -19
                },
                {
                    "file": "occ_command.cpp",
                    "type": "MODIFIED",
                    "insertions": 29,
                    "deletions": -29
                },
                {
                    "file": "occ_status.cpp",
                    "type": "MODIFIED",
                    "insertions": 24,
                    "deletions": -9
                },
                {
                    "file": "occ_pass_through.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 88,
            "sizeDeletions": 69
        }
    ]
}