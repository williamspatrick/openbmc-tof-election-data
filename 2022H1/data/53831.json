{
    "project": "openbmc/openpower-pnor-code-mgmt",
    "branch": "master",
    "id": "I473bdef12dd14913c385ccd43693ad7176567313",
    "number": 53831,
    "subject": "Preserved Partition Change",
    "owner": {
        "name": "Zami Seck",
        "email": "zimzam17@gmail.com",
        "username": "zamiseck"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openpower-pnor-code-mgmt/+/53831",
    "commitMessage": "Preserved Partition Change\n\nThis commit fixes the problem of corrupted or changed preserved\npartitions. If one of the partitions becomes corrupted, or it\nthe size of the partition needs to be changes, these changes will\nallow for the copying of the old partition, forcing the new one\nto take its place.\n\nTested:\nWhen a PRESERVED partition is altered (corrupted or contents\ndeleted) ensured that the contents was not copied into the\nprsv directory and the working partition appeared upon\nreboot.\n\nSigned-off-by: Zami Seck <zimzam17@gmail.com>\nChange-Id: I473bdef12dd14913c385ccd43693ad7176567313\n",
    "createdOn": 1653002407,
    "lastUpdated": 1653511999,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1653002407,
            "reviewer": {
                "name": "Zami Seck",
                "email": "zimzam17@gmail.com",
                "username": "zamiseck"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1653002422,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1653002422,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1653002450,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/43550/ : FAILURE"
        },
        {
            "timestamp": 1653003991,
            "reviewer": {
                "name": "Zami Seck",
                "email": "zimzam17@gmail.com",
                "username": "zamiseck"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1653004022,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1653004022,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1653004046,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/43552/ : FAILURE"
        },
        {
            "timestamp": 1653405895,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 2: Code-Review-1\n\n(4 comments)"
        },
        {
            "timestamp": 1653424457,
            "reviewer": {
                "name": "Zami Seck",
                "email": "zimzam17@gmail.com",
                "username": "zamiseck"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1653424535,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1653424535,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1653424675,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/43746/ : SUCCESS"
        },
        {
            "timestamp": 1653424794,
            "reviewer": {
                "name": "Zami Seck",
                "email": "zimzam17@gmail.com",
                "username": "zamiseck"
            },
            "message": "Patch Set 3:\n\n(4 comments)"
        },
        {
            "timestamp": 1653511958,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1653511999,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Change has been successfully merged"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "631d099a7b18d45566cd46bc45dc381fd78ae941",
            "parents": [
                "6b56bd4bc1feadc0b3f273be759ad2616db7809d"
            ],
            "ref": "refs/changes/31/53831/1",
            "uploader": {
                "name": "Zami Seck",
                "email": "zimzam17@gmail.com",
                "username": "zamiseck"
            },
            "createdOn": 1653002407,
            "author": {
                "name": "Zami Seck",
                "email": "zimzam17@gmail.com",
                "username": "zamiseck"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "mmc/obmc-flash-bios",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 36,
            "sizeDeletions": 2
        },
        {
            "number": 2,
            "revision": "26cfa40490c03ffb3013f3f3499f5823d0f4a9f9",
            "parents": [
                "6b56bd4bc1feadc0b3f273be759ad2616db7809d"
            ],
            "ref": "refs/changes/31/53831/2",
            "uploader": {
                "name": "Zami Seck",
                "email": "zimzam17@gmail.com",
                "username": "zamiseck"
            },
            "createdOn": 1653003991,
            "author": {
                "name": "Zami Seck",
                "email": "zimzam17@gmail.com",
                "username": "zamiseck"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "mmc/obmc-flash-bios",
                    "line": 65,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "The prsv variable points to a symlink, so the size is 12 always. Probably need to move \"prsv=\"$(readlink \"${running_dir}/${prsv}\")\"\" to be called before getting the sizes."
                },
                {
                    "file": "mmc/obmc-flash-bios",
                    "line": 65,
                    "reviewer": {
                        "name": "Zami Seck",
                        "email": "zimzam17@gmail.com",
                        "username": "zamiseck"
                    },
                    "message": "Done"
                },
                {
                    "file": "mmc/obmc-flash-bios",
                    "line": 69,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "We can remove this echo since we'll be creating a PEL and there would be a journal msg \"Created PEL xxx\""
                },
                {
                    "file": "mmc/obmc-flash-bios",
                    "line": 69,
                    "reviewer": {
                        "name": "Zami Seck",
                        "email": "zimzam17@gmail.com",
                        "username": "zamiseck"
                    },
                    "message": "Done"
                },
                {
                    "file": "mmc/obmc-flash-bios",
                    "line": 74,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "I'm not sure this is a WriteFailure since we didn't fail to write. Let's go ahead and create a new string to put here, like \"xyz.openbmc_project.Software.Version.Error.HostFile\", that we can use as a generic error for host file errors, then add it to the phosphor-logging registry with example Description and Message \"\"A host file error occurred\" and Notes \"A host file had invalid contents and has been reset to default.\""
                },
                {
                    "file": "mmc/obmc-flash-bios",
                    "line": 74,
                    "reviewer": {
                        "name": "Zami Seck",
                        "email": "zimzam17@gmail.com",
                        "username": "zamiseck"
                    },
                    "message": "Done"
                },
                {
                    "file": "mmc/obmc-flash-bios",
                    "line": 75,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "These are the metadata entries, and a CALLOUT_ERRNO etnry with an empty string value is not applicable to this error. Let's add the file name and sizes instead, example:\n3 \"FILE_NAME\" \"$prsv\" \"CURRENT_FILE_SIZE\" \"$runsize\" \"EXPECTED_FILE_SIZE\" \"$rosize\""
                },
                {
                    "file": "mmc/obmc-flash-bios",
                    "line": 75,
                    "reviewer": {
                        "name": "Zami Seck",
                        "email": "zimzam17@gmail.com",
                        "username": "zamiseck"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "mmc/obmc-flash-bios",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 36,
            "sizeDeletions": 2
        },
        {
            "number": 3,
            "revision": "1e01078ee7d37aa01db48687433704e73c34b68c",
            "parents": [
                "f9a72a7aaa12029308e96b09d2a2128834efb990"
            ],
            "ref": "refs/changes/31/53831/3",
            "uploader": {
                "name": "Zami Seck",
                "email": "zimzam17@gmail.com",
                "username": "zamiseck"
            },
            "createdOn": 1653424457,
            "author": {
                "name": "Zami Seck",
                "email": "zimzam17@gmail.com",
                "username": "zamiseck"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "mmc/obmc-flash-bios",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 42,
            "sizeDeletions": 1
        }
    ]
}