{
    "project": "openbmc/phosphor-state-manager",
    "branch": "master",
    "id": "I459dd8c35ceddec986336fee635fdf691257f758",
    "number": 51129,
    "subject": "crit-service: create error on failed service",
    "owner": {
        "name": "Andrew Geissler",
        "email": "andrew@geissonator.com",
        "username": "geissonator"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/phosphor-state-manager/+/51129",
    "commitMessage": "crit-service: create error on failed service\n\nThis enhances the existing code to support logging an error when a\nmonitored service fails. The same systemd event is triggered for a\ntarget failure and a service failure so no new logic is needed in\nthat area.\n\nTested:\n- Repeatedly killed the host-state service until its unit went into the\n  failed state. Verified this was detected and the expected log was\n  created.\n\nSigned-off-by: Andrew Geissler <geissonator@yahoo.com>\nChange-Id: I459dd8c35ceddec986336fee635fdf691257f758\n",
    "createdOn": 1644535530,
    "lastUpdated": 1645817051,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1644535530,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1644535542,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1644535542,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1644535547,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1644535586,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/37079/ : FAILURE"
        },
        {
            "timestamp": 1645131133,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1645131152,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1645131152,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1645131282,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/37582/ : SUCCESS"
        },
        {
            "timestamp": 1645223654,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 3: New patch set was added with same tree, parent, and commit message as Patch Set 2."
        },
        {
            "timestamp": 1645223665,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1"
        },
        {
            "timestamp": 1645223666,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1645223667,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1645223689,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Patch Set 3:\n\nThis change is ready for review."
        },
        {
            "timestamp": 1645225265,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/37667/ : SUCCESS"
        },
        {
            "timestamp": 1645567730,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1645567767,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1645583446,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 4: Patch Set 3 was rebased."
        },
        {
            "timestamp": 1645583469,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1645583469,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1645583664,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/37830/ : SUCCESS"
        },
        {
            "timestamp": 1645736530,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 4: Code-Review+1"
        },
        {
            "timestamp": 1645816755,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Patch Set 4: Code-Review+2"
        },
        {
            "timestamp": 1645817051,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Change has been successfully rebased and submitted as f3870c6210ac5e134109c14291ca94511ab4a513"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "3971f0fdc258f28dc8354c874110ea13ee79d29e",
            "parents": [
                "ae4e41572781c03f14757f4a0e2e8a42a60dd205"
            ],
            "ref": "refs/changes/29/51129/1",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "createdOn": 1644535530,
            "author": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "systemd_target_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "systemd_target_signal.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -7
                },
                {
                    "file": "systemd_target_signal.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 52,
            "sizeDeletions": 11
        },
        {
            "number": 2,
            "revision": "a312a3d9eac6db269df04ce3f5b26c4dac5b60b3",
            "parents": [
                "ae4e41572781c03f14757f4a0e2e8a42a60dd205"
            ],
            "ref": "refs/changes/29/51129/2",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "createdOn": 1645131133,
            "author": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "systemd_target_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "systemd_target_signal.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -7
                },
                {
                    "file": "systemd_target_signal.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": -3
                },
                {
                    "file": "test/systemd_signal.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 63,
            "sizeDeletions": 18
        },
        {
            "number": 3,
            "revision": "3ba3d55e16e9b2f4f4c33508f55eb29fc7246777",
            "parents": [
                "3d53988641981753de3b4ca0f31aab454fec4555"
            ],
            "ref": "refs/changes/29/51129/3",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "createdOn": 1645223654,
            "author": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "kind": "NO_CHANGE",
            "comments": [
                {
                    "file": "systemd_target_signal.cpp",
                    "line": 97,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "So this doesn't include the service/target name with the issue in the error?  It would probably be useful."
                },
                {
                    "file": "systemd_target_signal.cpp",
                    "line": 97,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "heh, nevermind, just saw the next commit."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "systemd_target_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "systemd_target_signal.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -7
                },
                {
                    "file": "systemd_target_signal.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": -3
                },
                {
                    "file": "test/systemd_signal.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 63,
            "sizeDeletions": 18
        },
        {
            "number": 4,
            "revision": "90baf3de91a388cbeeb0780c9d9007c7a297591d",
            "parents": [
                "0d595dfacbf10e987dce69120078fede4ca6ee5c"
            ],
            "ref": "refs/changes/29/51129/4",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "createdOn": 1645583446,
            "author": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "systemd_target_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "systemd_target_signal.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -7
                },
                {
                    "file": "systemd_target_signal.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": -3
                },
                {
                    "file": "test/systemd_signal.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 63,
            "sizeDeletions": 18
        },
        {
            "number": 5,
            "revision": "f3870c6210ac5e134109c14291ca94511ab4a513",
            "parents": [
                "9e3afdf0964dd5b6ca43f2bceb3154a416573ebd"
            ],
            "ref": "refs/changes/29/51129/5",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "createdOn": 1645817051,
            "author": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "systemd_target_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "systemd_target_signal.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -7
                },
                {
                    "file": "systemd_target_signal.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": -3
                },
                {
                    "file": "test/systemd_signal.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 63,
            "sizeDeletions": 18
        }
    ]
}