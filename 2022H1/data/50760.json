{
    "project": "openbmc/phosphor-power",
    "branch": "master",
    "id": "I0ed7657320f4944d64ee434c1d02ce25d5cdc43b",
    "number": 50760,
    "subject": "pseq: Add UCD90320 specific error handling",
    "owner": {
        "name": "Jim Wright",
        "email": "jlwright@us.ibm.com",
        "username": "wrightjl1"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/phosphor-power/+/50760",
    "commitMessage": "pseq: Add UCD90320 specific error handling\n\nAdd device specific handling for voltage and power good failures to\nUCD90320 device subclass.\n\nSigned-off-by: Jim Wright <jlwright@us.ibm.com>\nChange-Id: I0ed7657320f4944d64ee434c1d02ce25d5cdc43b\n",
    "createdOn": 1643385081,
    "lastUpdated": 1643747044,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1643385081,
            "reviewer": {
                "name": "Jim Wright",
                "email": "jlwright@us.ibm.com",
                "username": "wrightjl1"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1643385093,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1643385093,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1643385657,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/36253/ : SUCCESS"
        },
        {
            "timestamp": 1643388184,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1643409266,
            "reviewer": {
                "name": "Jim Wright",
                "email": "jlwright@us.ibm.com",
                "username": "wrightjl1"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1643409285,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1643409285,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1643409883,
            "reviewer": {
                "name": "Jim Wright",
                "email": "jlwright@us.ibm.com",
                "username": "wrightjl1"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1643409920,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/36281/ : SUCCESS"
        },
        {
            "timestamp": 1643656666,
            "reviewer": {
                "name": "Derek Howard",
                "email": "derekh@us.ibm.com",
                "username": "derekhoward55"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1643664053,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1643669705,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1643729748,
            "reviewer": {
                "name": "Jim Wright",
                "email": "jlwright@us.ibm.com",
                "username": "wrightjl1"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1643737082,
            "reviewer": {
                "name": "Brandon J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1643742185,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1643744767,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Patch Set 2: Code-Review+2\n\n(1 comment)"
        },
        {
            "timestamp": 1643744815,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Change has been successfully rebased and submitted as 71a14131f1f9b41e75873c69e8f7d8d9a6d8490f"
        },
        {
            "timestamp": 1643747044,
            "reviewer": {
                "name": "Jim Wright",
                "email": "jlwright@us.ibm.com",
                "username": "wrightjl1"
            },
            "message": "Patch Set 3:\n\n(3 comments)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "164cc1c2cf1803bc529bc65b5aeb3775e86587fa",
            "parents": [
                "930458c23ce545620614e31cdd32d9ee545230f3"
            ],
            "ref": "refs/changes/60/50760/1",
            "uploader": {
                "name": "Jim Wright",
                "email": "jlwright@us.ibm.com",
                "username": "wrightjl1"
            },
            "createdOn": 1643385081,
            "author": {
                "name": "Jim Wright",
                "email": "jlwright@us.ibm.com",
                "username": "wrightjl1"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "line": 414,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Consider putting some sort of assert here that lines.size() == pins.size(), assuming pins has already been created. On line 76 you're de-referencing an index that depends on this condition being true. If somehow the condition was ever false, it would be much easier to fix when an assert fails, vs an array index segfault or silent memory corruption."
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "line": 414,
                    "reviewer": {
                        "name": "Jim Wright",
                        "email": "jlwright@us.ibm.com",
                        "username": "wrightjl1"
                    },
                    "message": "Good point. I think the parallel vectors is a weakness of my approach, but decided that letting libgpiod batch process the GPIOs was worth my discomfort. I added a guard to line 76 above to address your concern. My thinking being that it will be better to issue some sort of pgood error even if the vectors get funky, than have the application fail."
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "line": 414,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 155,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-sequencer/src/power_sequencer_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 29,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 198,
            "sizeDeletions": 1
        },
        {
            "number": 2,
            "revision": "2016cfc70c10e1a122dc2c7bd2a5b4bbc22d57e0",
            "parents": [
                "930458c23ce545620614e31cdd32d9ee545230f3"
            ],
            "ref": "refs/changes/60/50760/2",
            "uploader": {
                "name": "Jim Wright",
                "email": "jlwright@us.ibm.com",
                "username": "wrightjl1"
            },
            "createdOn": 1643409266,
            "author": {
                "name": "Jim Wright",
                "email": "jlwright@us.ibm.com",
                "username": "wrightjl1"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "line": 94,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "would it be useful to put all the pins that are off, or the whole pins vector, into the AdditionalData for the sake of FFDC?"
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "line": 94,
                    "reviewer": {
                        "name": "Jim Wright",
                        "email": "jlwright@us.ibm.com",
                        "username": "wrightjl1"
                    },
                    "message": "That would be useful, look for it in a future commit."
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "line": 94,
                    "reviewer": {
                        "name": "Jim Wright",
                        "email": "jlwright@us.ibm.com",
                        "username": "wrightjl1"
                    },
                    "message": "Ack"
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "line": 116,
                    "reviewer": {
                        "name": "Brandon J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "Not so sure it matters a whole lot, right now, but isn't the number of pages a function of the UCD90320, not just the VOUT faults? This could be some kind of class variable, but this is the only place you are using it right now, so ..."
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "line": 116,
                    "reviewer": {
                        "name": "Jim Wright",
                        "email": "jlwright@us.ibm.com",
                        "username": "wrightjl1"
                    },
                    "message": "Good point.  If I expand the usage of pages, I'll expand the scope of this constant."
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.hpp",
                    "line": 91,
                    "reviewer": {
                        "name": "Shawn McCarney",
                        "email": "shawnmm@us.ibm.com",
                        "username": "smccarney"
                    },
                    "message": "Is there a reason you are including the return type in the @return lines for the new methods?  Seems like you could skip it and not have to keep it in sync with the code.\n\nNot a problem, just asking."
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.hpp",
                    "line": 91,
                    "reviewer": {
                        "name": "Jim Wright",
                        "email": "jlwright@us.ibm.com",
                        "username": "wrightjl1"
                    },
                    "message": "Oh, no good reason, bad copy and paste probably. Will cleanup for next commit."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 155,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-sequencer/src/power_sequencer_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 29,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 198,
            "sizeDeletions": 1
        },
        {
            "number": 3,
            "revision": "71a14131f1f9b41e75873c69e8f7d8d9a6d8490f",
            "parents": [
                "f8d8c464247d7bc6607b70c5953495b4ee4095f0"
            ],
            "ref": "refs/changes/60/50760/3",
            "uploader": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "createdOn": 1643744815,
            "author": {
                "name": "Jim Wright",
                "email": "jlwright@us.ibm.com",
                "username": "wrightjl1"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 155,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-sequencer/src/power_sequencer_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "phosphor-power-sequencer/src/ucd90320_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 29,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 198,
            "sizeDeletions": 1
        }
    ]
}