{
    "project": "openbmc/sdbusplus",
    "branch": "master",
    "id": "Ib1d77708d74e6063bcaa08fc76fb98667ee7a2cb",
    "number": 49117,
    "subject": "async: add co-routine context and match",
    "owner": {
        "name": "Patrick Williams",
        "email": "patrick@stwcx.xyz",
        "username": "williamspatrick"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/sdbusplus/+/49117",
    "commitMessage": "async: add co-routine context and match\n\nStart work on async bindings using C++20 coroutines (and libunifex).\nThis creates a class to hold the execution context, similar to the boost\n`io_service`, and a class that can be used to `co_await` for match\nevents.  This implementation is experimental and currently does not\nproperly handle cancellation, exceptions, or a run policy.\n\nSigned-off-by: Patrick Williams <patrick@stwcx.xyz>\nChange-Id: Ib1d77708d74e6063bcaa08fc76fb98667ee7a2cb\n",
    "createdOn": 1638133538,
    "lastUpdated": 1642762875,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1638133538,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1638133553,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1638133588,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/30839/ : FAILURE"
        },
        {
            "timestamp": 1638545574,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Uploaded patch set 2: Patch Set 1 was rebased."
        },
        {
            "timestamp": 1638545587,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1638545622,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/31186/ : FAILURE"
        },
        {
            "timestamp": 1638982886,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Uploaded patch set 3: Patch Set 2 was rebased."
        },
        {
            "timestamp": 1638982899,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1638982939,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/31571/ : FAILURE"
        },
        {
            "timestamp": 1639572542,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Uploaded patch set 4: Patch Set 3 was rebased."
        },
        {
            "timestamp": 1639572562,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1639572860,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/32096/ : FAILURE"
        },
        {
            "timestamp": 1639582279,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1639582293,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1639583067,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/32103/ : SUCCESS"
        },
        {
            "timestamp": 1641979652,
            "reviewer": {
                "name": "Krzysztof Grobelny",
                "email": "krzysztof.grobelny@intel.com",
                "username": "krzysztof-i"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1642009317,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1642762875,
            "reviewer": {
                "name": "Krzysztof Grobelny",
                "email": "krzysztof.grobelny@intel.com",
                "username": "krzysztof-i"
            },
            "message": "Patch Set 5: Code-Review+1\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "b085dd927e81f74d0f147ecc3c3e487f4d6cbe6b",
            "parents": [
                "e47e6d7a64751a71ce92f25b0f48eceb5f5ebd93"
            ],
            "ref": "refs/changes/17/49117/1",
            "uploader": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "createdOn": 1638133538,
            "author": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/context.hpp",
                    "type": "ADDED",
                    "insertions": 129,
                    "deletions": 0
                },
                {
                    "file": "example/meson.build",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/async/context.cpp",
                    "type": "ADDED",
                    "insertions": 177,
                    "deletions": 0
                },
                {
                    "file": "src/async/match.cpp",
                    "type": "ADDED",
                    "insertions": 74,
                    "deletions": 0
                },
                {
                    "file": "example/coroutine-example.cpp",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/execution.hpp",
                    "type": "ADDED",
                    "insertions": 62,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/match.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 632,
            "sizeDeletions": 1
        },
        {
            "number": 2,
            "revision": "e115cb51a28d29f2eb2d0e3ada85de5608d16e5f",
            "parents": [
                "0f21c6722c3862ac3a257e05b45c1613aadd257a"
            ],
            "ref": "refs/changes/17/49117/2",
            "uploader": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "createdOn": 1638545574,
            "author": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/context.hpp",
                    "type": "ADDED",
                    "insertions": 129,
                    "deletions": 0
                },
                {
                    "file": "example/meson.build",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/async/context.cpp",
                    "type": "ADDED",
                    "insertions": 177,
                    "deletions": 0
                },
                {
                    "file": "src/async/match.cpp",
                    "type": "ADDED",
                    "insertions": 74,
                    "deletions": 0
                },
                {
                    "file": "example/coroutine-example.cpp",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/execution.hpp",
                    "type": "ADDED",
                    "insertions": 62,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/match.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 632,
            "sizeDeletions": 1
        },
        {
            "number": 3,
            "revision": "0fbbb127d3b7b075832cb7a046a72a67ec2ca660",
            "parents": [
                "6616bf4b399759aeac857d8c21c3152fb44b238c"
            ],
            "ref": "refs/changes/17/49117/3",
            "uploader": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "createdOn": 1638982886,
            "author": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/context.hpp",
                    "type": "ADDED",
                    "insertions": 129,
                    "deletions": 0
                },
                {
                    "file": "example/meson.build",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/async/context.cpp",
                    "type": "ADDED",
                    "insertions": 177,
                    "deletions": 0
                },
                {
                    "file": "src/async/match.cpp",
                    "type": "ADDED",
                    "insertions": 74,
                    "deletions": 0
                },
                {
                    "file": "example/coroutine-example.cpp",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/execution.hpp",
                    "type": "ADDED",
                    "insertions": 62,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/match.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 632,
            "sizeDeletions": 1
        },
        {
            "number": 4,
            "revision": "b7d1b6644b1fe28bca5ca9751488ff1e179668fc",
            "parents": [
                "a5b12c0540cb2ca4190ca22a6e0f3f3cb6b089ac"
            ],
            "ref": "refs/changes/17/49117/4",
            "uploader": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "createdOn": 1639572542,
            "author": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/context.hpp",
                    "type": "ADDED",
                    "insertions": 129,
                    "deletions": 0
                },
                {
                    "file": "example/meson.build",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/async/context.cpp",
                    "type": "ADDED",
                    "insertions": 177,
                    "deletions": 0
                },
                {
                    "file": "src/async/match.cpp",
                    "type": "ADDED",
                    "insertions": 74,
                    "deletions": 0
                },
                {
                    "file": "example/coroutine-example.cpp",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/execution.hpp",
                    "type": "ADDED",
                    "insertions": 62,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/match.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 632,
            "sizeDeletions": 1
        },
        {
            "number": 5,
            "revision": "a31eabe220ec2431f4abbe10d828190d08094f7d",
            "parents": [
                "a5b12c0540cb2ca4190ca22a6e0f3f3cb6b089ac"
            ],
            "ref": "refs/changes/17/49117/5",
            "uploader": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "createdOn": 1639582279,
            "author": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "example/coroutine-example.cpp",
                    "line": 0,
                    "reviewer": {
                        "name": "Krzysztof Grobelny",
                        "email": "krzysztof.grobelny@intel.com",
                        "username": "krzysztof-i"
                    },
                    "message": "Can it be used together with boost::asio::io_context?\n\nIf it is possible it would be nice to have additional example where there is dbus service like https://github.com/openbmc/sdbusplus/blob/master/example/asio-example.cpp or other. Then match is created for single property, property is changed and match produces some output."
                },
                {
                    "file": "example/coroutine-example.cpp",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "> Can it be used together with boost::asio::io_context?\n\nNot yet.  Hopefully as I implement this feature a little more we can figure out how to integrate it with the asio::io_context so there is a relatively smooth transition between coroutines and the current callback implementation.\n\n> If it is possible it would be nice to have additional example where there is dbus service...\n\nI'll look if that is relevant to the code in the current state.  There is quite a bit more work to do here anyhow."
                },
                {
                    "file": "example/coroutine-example.cpp",
                    "line": 0,
                    "reviewer": {
                        "name": "Krzysztof Grobelny",
                        "email": "krzysztof.grobelny@intel.com",
                        "username": "krzysztof-i"
                    },
                    "message": "Okay. I'm wondering if this should go to different namespace to indicate that this feature is still work in progress. Like experimental, people will be more careful if they decide to use it."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/context.hpp",
                    "type": "ADDED",
                    "insertions": 129,
                    "deletions": 0
                },
                {
                    "file": "example/meson.build",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/async/context.cpp",
                    "type": "ADDED",
                    "insertions": 177,
                    "deletions": 0
                },
                {
                    "file": "src/async/match.cpp",
                    "type": "ADDED",
                    "insertions": 74,
                    "deletions": 0
                },
                {
                    "file": "example/coroutine-example.cpp",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/execution.hpp",
                    "type": "ADDED",
                    "insertions": 62,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/async/match.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 632,
            "sizeDeletions": 1
        }
    ]
}