{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I61e6c76ca6dd6f129c5d382dcc46a4292a4e1bb7",
    "number": 53822,
    "subject": "memory: refactor JSON assembling codes",
    "owner": {
        "name": "Nan Zhou",
        "email": "nanzhoumails@gmail.com",
        "username": "FighterNan"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/53822",
    "commitMessage": "memory: refactor JSON assembling codes\n\nThis commit does nothing but a refactoring around the translation codes\nthat translate data from dbus objects to JSON.\n\nExisting codes assumes that the |AsyncResponse| is always at a specific\nDIMM. This doesn't work if we are doing a efficient level=1 expand, as\nintroduced initially in\nhttps://gerrit.openbmc-project.xyz/c/openbmc/bmcweb/+/52418, where the\n|AsyncResponse| now points to the MemoryCollection.\n\nIn order to reuse codes in future changes, this commits refactors many\nfunctions to take a JSON pointer, so any attributes added to a specific\nDIMM go to the JSON pointer, rather than always to the root.\n\n1. Tested on my mock environment,\n```\nURI: /redfish/v1/Systems/system/Memory/dimm0\n{\n    \"@odata.id\": \"/redfish/v1/Systems/system/Memory/dimm0\",\n    \"@odata.type\": \"#Memory.v1_11_0.Memory\",\n    \"AllowedSpeedsMHz\": [],\n    \"BaseModuleType\": \"RDIMM\",\n    \"BusWidthBits\": 0,\n    \"CapacityMiB\": 1024,\n    \"DataWidthBits\": 0,\n    \"ErrorCorrection\": \"NoECC\",\n    \"FirmwareRevision\": \"0\",\n    \"Id\": \"dimm0\",\n    \"Name\": \"DIMM Slot\",\n    \"OperatingSpeedMhz\": 0,\n    \"RankCount\": 0,\n    \"Regions\": [\n        {\n            \"MemoryClassification\": \"Volatile\",\n            \"OffsetMiB\": 0,\n            \"PassphraseEnabled\": false,\n            \"RegionId\": \"\",\n            \"SizeMiB\": 1024\n        }\n    ],\n    \"Status\": {\n        \"Health\": \"OK\",\n        \"HealthRollup\": \"OK\",\n        \"State\": \"Enabled\"\n    }\n}\n```\n2. No new Redfish Validator failures on MemoryCollection on real\nhardware:\n/redfish/v1/Systems/system/Memory\u2002(response time:0:00:00.116538)\nMemoryCollection Pass\n/redfish/v1/Systems/system/Memory/dimm0\u2002(response time:\n0:00:00.201940)\u2002Memory Pass\n\nSigned-off-by: Nan Zhou <nanzhoumails@gmail.com>\nChange-Id: I61e6c76ca6dd6f129c5d382dcc46a4292a4e1bb7\n",
    "createdOn": 1652988224,
    "lastUpdated": 1655253400,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1652988224,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1652988241,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1652988241,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1652988941,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/43535/ : SUCCESS"
        },
        {
            "timestamp": 1653343626,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1653343657,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1653343657,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1653343679,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/43658/ : FAILURE"
        },
        {
            "timestamp": 1653343773,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1653343807,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1653343807,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1653344489,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/43662/ : SUCCESS"
        },
        {
            "timestamp": 1653349139,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1653516858,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1653517221,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1653522855,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1653523124,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1653523148,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1653523174,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 4: Patch Set 3 was rebased"
        },
        {
            "timestamp": 1653523228,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1653523228,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1653523919,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/43861/ : SUCCESS"
        },
        {
            "timestamp": 1653524022,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1653524445,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1653525334,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1653584634,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1653584687,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1653584687,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1653584809,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 5:\n\n(3 comments)"
        },
        {
            "timestamp": 1653584953,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1653585172,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1653585247,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1653585247,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1653585247,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/43932/ : ABORTED"
        },
        {
            "timestamp": 1653585429,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1653585952,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/43935/ : SUCCESS"
        },
        {
            "timestamp": 1653589430,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 7: Commit message was updated."
        },
        {
            "timestamp": 1653589493,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 8."
        },
        {
            "timestamp": 1653589557,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1653589558,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: -Ok-To-Test"
        },
        {
            "timestamp": 1653590239,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/43942/ : SUCCESS"
        },
        {
            "timestamp": 1654116394,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 9: Commit message was updated."
        },
        {
            "timestamp": 1654116521,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 10."
        },
        {
            "timestamp": 1654116575,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1654116575,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: -Ok-To-Test"
        },
        {
            "timestamp": 1654116596,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 10:\n\n(1 comment)"
        },
        {
            "timestamp": 1654117278,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/44212/ : SUCCESS"
        },
        {
            "timestamp": 1654117699,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 10:\n\n(2 comments)"
        },
        {
            "timestamp": 1654121458,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 10:\n\n(1 comment)"
        },
        {
            "timestamp": 1654122663,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 11."
        },
        {
            "timestamp": 1654122680,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1654122680,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: -Ok-To-Test"
        },
        {
            "timestamp": 1654122986,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1654123075,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1654123361,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/44243/ : SUCCESS"
        },
        {
            "timestamp": 1654124053,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1654128748,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 12."
        },
        {
            "timestamp": 1654128761,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 11:\n\n(2 comments)"
        },
        {
            "timestamp": 1654128796,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1654128796,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: -Ok-To-Test"
        },
        {
            "timestamp": 1654129482,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/44248/ : SUCCESS"
        },
        {
            "timestamp": 1654621207,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1655251559,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1655253397,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 12: Code-Review+2\n\n(1 comment)"
        },
        {
            "timestamp": 1655253400,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as d7f04fd9ef456a6e6871adba6f3c5803f1ee88c6"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "9ed2ab14b85c4c68361b783c7eae145d71e4521c",
            "parents": [
                "eee0f26bcba38c5926677fd7f1c99f47e3deb829"
            ],
            "ref": "refs/changes/22/53822/1",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1652988224,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 52,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 68,
                    "deletions": -70
                }
            ],
            "sizeInsertions": 120,
            "sizeDeletions": 70
        },
        {
            "number": 2,
            "revision": "bbd2d2c5cb6c11840e7cf3dd39032f4cea5ef080",
            "parents": [
                "3bde2112c2f2387b43edccfd52b4b86d11ebcee1"
            ],
            "ref": "refs/changes/22/53822/2",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1653343626,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 68,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 69,
                    "deletions": -70
                }
            ],
            "sizeInsertions": 137,
            "sizeDeletions": 70
        },
        {
            "number": 3,
            "revision": "1b918b58554d290de872869e3c57fce6298c6482",
            "parents": [
                "3bde2112c2f2387b43edccfd52b4b86d11ebcee1"
            ],
            "ref": "refs/changes/22/53822/3",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1653343773,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "This is also a trivial change. PTAL"
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 143,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "In general, we shouldn't be passing BOTH an async response, and a reference to a json object.  In looking at this function, it doesn't look like it takes ownership of the response, so that part should be passed by crow::Response&  The json object also has lifetime issues as you've written it."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 143,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Done. Now we always get the JSON from the shared AsyncResponse."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 879,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I suspect you didn't mean to delete this, and looking at it, makes this code no longer match the schema.  I would've expected your testing with the redfish service validator that you stated in your commit message to catch this;  Can you please triage why your testing didn't catch this, and get a bug filed with the service validator github for whatever the issue is?"
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 879,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/53824/9\n\nYeah, it gets added here. Maybe I messed up the testing with these nested changes. Let me fix it and run the validator again against this commit only."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 879,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Done. Fixed and reran the validator."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 168,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Now that the json object is modified from within dimmPropToHex, it invalidates the reference to the json object, which means that this code can now have lifetime issues.  Please rework to avoid the lifetime issues."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 168,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Hmm, is adding a comment saying \"Callers should guarantee the reference outlives the function call\" enough?\n\nThese two functions don't create async calls. They just manipulates a JSON and codes run synchronously. So it's unlikely to have lifecycle issues like the HealthPopulate object which runs asynchronously."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 168,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "But I can use a JSON pointer instead."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 168,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Wait, specifically to this dimmPropToHex issue, why does the reference gets invalidated?"
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 168,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "because the json object itself is modified as part of the messages::internalError calls.\n\n> Hmm, is adding a comment saying \"Callers should guarantee the reference outlives the function call\" enough?\n\nNo, as written, I'm pretty sure this code will seg fault if it hits an InternalError call, then tries to parse a value after that.\n\n\n> But I can use a JSON pointer instead.\nThat would be one approach, although a little bit overkill in this case.  MIght be better to make dimmPropToHex just return the value and load it directly without a reference at all?"
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 168,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Oh, I see what you meant. You are worrying about that line149 invalidates the reference."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 168,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 68,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 67,
                    "deletions": -67
                }
            ],
            "sizeInsertions": 135,
            "sizeDeletions": 67
        },
        {
            "number": 4,
            "revision": "251e504d90bcb3e1f58f39d5b618827c5087539d",
            "parents": [
                "dfababfc65fb9f07050070910be0cc015df4fd2c"
            ],
            "ref": "refs/changes/22/53822/4",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1653523174,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 68,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 67,
                    "deletions": -67
                }
            ],
            "sizeInsertions": 135,
            "sizeDeletions": 67
        },
        {
            "number": 5,
            "revision": "153d28ddfa4c5bcf1c3b0168fbbf3a0cb8db575a",
            "parents": [
                "dfababfc65fb9f07050070910be0cc015df4fd2c"
            ],
            "ref": "refs/changes/22/53822/5",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1653584634,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 730,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Okay, here we have problems, too.\n\nMy hardware doesn't have Partition data, but let me fix it and use my mock data to test."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 730,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Ack.\n\nActually in this function, all internal error follows with a return, so we are good. But I still changed it to use jsonPtr."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 70,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 83,
                    "deletions": -60
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 60
        },
        {
            "number": 6,
            "revision": "6facc11fa3b4b8c7312459daaf2ac1e74c90d695",
            "parents": [
                "dfababfc65fb9f07050070910be0cc015df4fd2c"
            ],
            "ref": "refs/changes/22/53822/6",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1653585172,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 70,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 87,
                    "deletions": -65
                }
            ],
            "sizeInsertions": 157,
            "sizeDeletions": 65
        },
        {
            "number": 7,
            "revision": "41ca4e5ef8a1541fb94bb6dae30ec75b92146b33",
            "parents": [
                "dfababfc65fb9f07050070910be0cc015df4fd2c"
            ],
            "ref": "refs/changes/22/53822/7",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1653589430,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 63,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 87,
                    "deletions": -65
                }
            ],
            "sizeInsertions": 150,
            "sizeDeletions": 65
        },
        {
            "number": 8,
            "revision": "09180460ffe23a555203a17c49665841ca04210d",
            "parents": [
                "dfababfc65fb9f07050070910be0cc015df4fd2c"
            ],
            "ref": "refs/changes/22/53822/8",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1653589493,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 63,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 87,
                    "deletions": -65
                }
            ],
            "sizeInsertions": 150,
            "sizeDeletions": 65
        },
        {
            "number": 9,
            "revision": "845c762b4cc6f9b23f2b881dcec92f39c79c39e6",
            "parents": [
                "dfababfc65fb9f07050070910be0cc015df4fd2c"
            ],
            "ref": "refs/changes/22/53822/9",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1654116394,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 63,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 87,
                    "deletions": -65
                }
            ],
            "sizeInsertions": 150,
            "sizeDeletions": 65
        },
        {
            "number": 10,
            "revision": "eff54a7c8d3dfa0902728a1485c8fab4552094f5",
            "parents": [
                "72c3ae33bd127f8cd5887000a45adf13a56c7582"
            ],
            "ref": "refs/changes/22/53822/10",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1654116521,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "PTAL. This is also a \"trivial\" change."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 808,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "In your current code setup relying on json_pointer, this isn't needed anymore, correct?"
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 808,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Ack."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 812,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please put this on its own line.  It's non trivial to construct.  Also, as you've used it here, it's undefined behavior, because you're taking a reference to a 2nd level rvalue (ie \"/Regions\"_json_pointer) that will be destroyed.  In many cases, this code will work for a while, or appear to, but fail later.\n\nAlso, when line 808 gets deleted, I suspect the -1 needs to be removed."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 812,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "I can move it to a separate line.\n\nBut for my knowledge: if assembleDimmPartitionData is async and the function returns, yes, I understand we will have a problem. But given that assembleDimmPartitionData returns before the temporary pointer gets destroyed, we are good here, right?"
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 812,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Your code before was functionally correct, it was just difficult to read, and was doing a method call, an object construction, an operator/ object construction, a map lookup, a size() check, and a decrement all on one line."
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 812,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 63,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 86,
                    "deletions": -65
                }
            ],
            "sizeInsertions": 149,
            "sizeDeletions": 65
        },
        {
            "number": 11,
            "revision": "2681d27390193b51e3cc0b5b509f7873e1b8cbd9",
            "parents": [
                "72c3ae33bd127f8cd5887000a45adf13a56c7582"
            ],
            "ref": "refs/changes/22/53822/11",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1654122663,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 810,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Looking at this logic a little more, should we just be passing in \n\n\"/Regions\"_json_pointer, then let assembleDimmPartitionData call emplace_back on its own, negating the need for an index entirely?"
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "line": 810,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Yes, it is doable and can be used in efficient handler. Done."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 63,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 84,
                    "deletions": -65
                }
            ],
            "sizeInsertions": 147,
            "sizeDeletions": 65
        },
        {
            "number": 12,
            "revision": "b169e950a1e6256038da305c19645c8c1e5b2388",
            "parents": [
                "72c3ae33bd127f8cd5887000a45adf13a56c7582"
            ],
            "ref": "refs/changes/22/53822/12",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1654128748,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Any more comments?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "bump. Once this is in. I can update https://gerrit.openbmc.org/c/openbmc/bmcweb/+/53824/9"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Was kinda hoping the intel folks would help to review this, but I guess we can merge it."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 63,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 80,
                    "deletions": -60
                }
            ],
            "sizeInsertions": 143,
            "sizeDeletions": 60
        },
        {
            "number": 13,
            "revision": "d7f04fd9ef456a6e6871adba6f3c5803f1ee88c6",
            "parents": [
                "3ba0007367777144f474fdf99439ae8c03633486"
            ],
            "ref": "refs/changes/22/53822/13",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1655253400,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 63,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 80,
                    "deletions": -60
                }
            ],
            "sizeInsertions": 143,
            "sizeDeletions": 60
        }
    ]
}