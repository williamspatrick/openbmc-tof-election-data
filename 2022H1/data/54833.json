{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I03b387bd5f218a86c9d1765415a46e3c2ad83ff9",
    "number": 54833,
    "subject": "dbus_singleton: use stack variable and extern",
    "owner": {
        "name": "Nan Zhou",
        "email": "nanzhoumails@gmail.com",
        "username": "FighterNan"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/54833",
    "commitMessage": "dbus_singleton: use stack variable and extern\n\nCurrently, the |systemBus| connection is a static variable declared in\nheaders. This has a problem that every translation unit will keep its\nown copy. It's not a problem today because there's only one translation\nunit \"webserver_main.cpp.o\". This issue was brounght up in\nhttps://gerrit.openbmc.org/c/openbmc/bmcweb/+/54758\n\nActually, the |systemBus| doesn't need to be a singleton. It can just be\na stack variable, which is normally more efficient than heap variables.\n\nTo keep minimum changes treeside, this commits keeps the existing\n|systemBus| variable as an external variable. It is defined in its own\ntranslation unit. It is initialized in the main translation unit.\n\nReference:\n1. Extern\nhttps://stackoverflow.com/questions/1433204/how-do-i-use-extern-to-share-variables-between-source-files\n\nTested:\n1. Romulus QEMU robot Redfish test passed;\n2. Start and restart service on real hardware, no issues;\n3. No new validator failures\n4. Code compies\n\nSigned-off-by: Nan Zhou <nanzhoumails@gmail.com>\nChange-Id: I03b387bd5f218a86c9d1765415a46e3c2ad83ff9\n",
    "createdOn": 1655959424,
    "lastUpdated": 1657266700,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1655959424,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1655959481,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1655959481,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1655959557,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1655959582,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 3: Patch Set 2 was rebased"
        },
        {
            "timestamp": 1655959626,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1655959626,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1655959626,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/45689/ : ABORTED"
        },
        {
            "timestamp": 1655959938,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/45690/ : FAILURE"
        },
        {
            "timestamp": 1655961812,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1655961886,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1655961886,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1655962404,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/45691/ : SUCCESS"
        },
        {
            "timestamp": 1656012901,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1656013969,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1656015155,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1656017532,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 5: Commit message was updated."
        },
        {
            "timestamp": 1656017659,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 5:\n\n(2 comments)"
        },
        {
            "timestamp": 1656024174,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1656024195,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1656024195,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1656024303,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1656024736,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/45765/ : SUCCESS"
        },
        {
            "timestamp": 1656025289,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1656025806,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 6:\n\n(4 comments)"
        },
        {
            "timestamp": 1656026673,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1656027054,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 7: Published edit on patch set 6."
        },
        {
            "timestamp": 1656027065,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1656027065,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: -Ok-To-Test"
        },
        {
            "timestamp": 1656027499,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1656027612,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/45769/ : SUCCESS"
        },
        {
            "timestamp": 1656027794,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1656034179,
            "reviewer": {
                "name": "John Broadbent",
                "email": "jebr@google.com",
                "username": "jebr224"
            },
            "message": "Patch Set 7:\n\n(3 comments)"
        },
        {
            "timestamp": 1656035002,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1656084534,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 7:\n\n(3 comments)"
        },
        {
            "timestamp": 1656084671,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1656087026,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 8."
        },
        {
            "timestamp": 1656087048,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1656087048,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: -Ok-To-Test"
        },
        {
            "timestamp": 1656087370,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 8:\n\n(6 comments)"
        },
        {
            "timestamp": 1656087567,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/45814/ : SUCCESS"
        },
        {
            "timestamp": 1656093945,
            "reviewer": {
                "name": "John Broadbent",
                "email": "jebr@google.com",
                "username": "jebr224"
            },
            "message": "Patch Set 8: Code-Review+1\n\n(3 comments)"
        },
        {
            "timestamp": 1656094519,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1656097245,
            "reviewer": {
                "name": "John Broadbent",
                "email": "jebr@google.com",
                "username": "jebr224"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1656109536,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1656353987,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 8:\n\n(2 comments)"
        },
        {
            "timestamp": 1656356090,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 8:\n\n(2 comments)"
        },
        {
            "timestamp": 1656356211,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1656358172,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 8:\n\n(2 comments)"
        },
        {
            "timestamp": 1656358199,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 9: Published edit on patch set 8."
        },
        {
            "timestamp": 1656358221,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 10: Published edit on patch set 9."
        },
        {
            "timestamp": 1656358233,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1656358233,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: -Ok-To-Test"
        },
        {
            "timestamp": 1656358755,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/45953/ : SUCCESS"
        },
        {
            "timestamp": 1656384982,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 10:\n\n(2 comments)"
        },
        {
            "timestamp": 1656449505,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 11."
        },
        {
            "timestamp": 1656449538,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1656449538,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: -Ok-To-Test"
        },
        {
            "timestamp": 1656449628,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 11:\n\n(2 comments)"
        },
        {
            "timestamp": 1656450058,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/46071/ : SUCCESS"
        },
        {
            "timestamp": 1657154135,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1657159822,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1657218595,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Uploaded patch set 12."
        },
        {
            "timestamp": 1657218621,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1657218621,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: -Ok-To-Test"
        },
        {
            "timestamp": 1657218646,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1657218672,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 13: Published edit on patch set 12."
        },
        {
            "timestamp": 1657218705,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 13: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1657218705,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 13: -Ok-To-Test"
        },
        {
            "timestamp": 1657218706,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/46600/ : ABORTED"
        },
        {
            "timestamp": 1657219227,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 13: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/46601/ : SUCCESS"
        },
        {
            "timestamp": 1657220127,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 13: Code-Review+2\n\n(1 comment)"
        },
        {
            "timestamp": 1657220131,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as 6384e3239a6567db6e9b0df73f77193768c5a86d"
        },
        {
            "timestamp": 1657266700,
            "reviewer": {
                "name": "Krzysztof Grobelny",
                "email": "krzysztof.grobelny@intel.com",
                "username": "krzysztof-i"
            },
            "message": "Patch Set 14: Code-Review+1"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "2f775caf65dc625c3ad8b2b04aeba22e4c5a7813",
            "parents": [
                "011b9ed0dca75efb4264e8166370de42a6c67ba7"
            ],
            "ref": "refs/changes/33/54833/1",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1655959424,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/certificate_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -13
                },
                {
                    "file": "redfish-core/lib/processor.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -14
                },
                {
                    "file": "redfish-core/lib/hypervisor_system.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -14
                },
                {
                    "file": "include/google/google_service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/account_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 137,
                    "deletions": -137
                },
                {
                    "file": "redfish-core/lib/pcie.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "redfish-core/lib/bios.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -6
                },
                {
                    "file": "redfish-core/lib/pcie_slots.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/roles.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish_aggregator.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/include/utils/sw_utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -5
                },
                {
                    "file": "redfish-core/lib/redfish_util.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/metric_report.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_utility.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -23
                },
                {
                    "file": "redfish-core/lib/ethernet.hpp",
                    "type": "MODIFIED",
                    "insertions": 28,
                    "deletions": -26
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 95,
                    "deletions": -81
                },
                {
                    "file": "include/nbd_proxy.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "redfish-core/lib/network_protocol.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -14
                },
                {
                    "file": "redfish-core/lib/task.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -5
                },
                {
                    "file": "redfish-core/lib/storage.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -15
                },
                {
                    "file": "redfish-core/lib/health.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/telemetry_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/power.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/trigger.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/cable.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": -1
                },
                {
                    "file": "include/openbmc_dbus_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 55,
                    "deletions": -49
                },
                {
                    "file": "include/hostname_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -15
                },
                {
                    "file": "http/http_client.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/sensors.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -22
                },
                {
                    "file": "http/routing.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/managers.hpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": -44
                },
                {
                    "file": "include/async_resolve.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "include/image_upload.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/metric_report_definition.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/update_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -18
                },
                {
                    "file": "redfish-core/include/utils/collection.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/led.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 674,
            "sizeDeletions": 576
        },
        {
            "number": 2,
            "revision": "a2f35d1a5d9d286b57c67b469df3ebbe1dd06ee0",
            "parents": [
                "011b9ed0dca75efb4264e8166370de42a6c67ba7"
            ],
            "ref": "refs/changes/33/54833/2",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1655959557,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/certificate_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -13
                },
                {
                    "file": "redfish-core/lib/processor.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -14
                },
                {
                    "file": "redfish-core/lib/hypervisor_system.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -14
                },
                {
                    "file": "include/google/google_service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/account_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 137,
                    "deletions": -137
                },
                {
                    "file": "redfish-core/lib/pcie.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "redfish-core/lib/bios.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -6
                },
                {
                    "file": "redfish-core/lib/pcie_slots.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/roles.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish_aggregator.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/include/utils/sw_utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -5
                },
                {
                    "file": "redfish-core/lib/redfish_util.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/metric_report.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_utility.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -23
                },
                {
                    "file": "redfish-core/lib/ethernet.hpp",
                    "type": "MODIFIED",
                    "insertions": 28,
                    "deletions": -26
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 95,
                    "deletions": -81
                },
                {
                    "file": "include/nbd_proxy.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "redfish-core/lib/network_protocol.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -14
                },
                {
                    "file": "redfish-core/lib/task.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -5
                },
                {
                    "file": "redfish-core/lib/storage.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -15
                },
                {
                    "file": "redfish-core/lib/health.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/telemetry_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/power.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/trigger.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/cable.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -1
                },
                {
                    "file": "include/openbmc_dbus_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 55,
                    "deletions": -49
                },
                {
                    "file": "include/hostname_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -15
                },
                {
                    "file": "http/http_client.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/sensors.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -22
                },
                {
                    "file": "http/routing.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/managers.hpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": -44
                },
                {
                    "file": "include/async_resolve.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "include/image_upload.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/metric_report_definition.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/update_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -18
                },
                {
                    "file": "redfish-core/include/utils/collection.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/led.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 672,
            "sizeDeletions": 576
        },
        {
            "number": 3,
            "revision": "2f3a1749174f68a7642afc0d55406ab7acb0e5db",
            "parents": [
                "f1eac5775ed6593fe7148118304bdecec08af1ef"
            ],
            "ref": "refs/changes/33/54833/3",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1655959582,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/certificate_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -13
                },
                {
                    "file": "redfish-core/lib/processor.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -14
                },
                {
                    "file": "redfish-core/lib/hypervisor_system.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -14
                },
                {
                    "file": "include/google/google_service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/account_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 137,
                    "deletions": -137
                },
                {
                    "file": "redfish-core/lib/pcie.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "redfish-core/lib/bios.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -6
                },
                {
                    "file": "redfish-core/lib/pcie_slots.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/roles.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish_aggregator.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/include/utils/sw_utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -5
                },
                {
                    "file": "redfish-core/lib/redfish_util.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/metric_report.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_utility.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -23
                },
                {
                    "file": "redfish-core/lib/ethernet.hpp",
                    "type": "MODIFIED",
                    "insertions": 28,
                    "deletions": -26
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 95,
                    "deletions": -81
                },
                {
                    "file": "include/nbd_proxy.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "redfish-core/lib/network_protocol.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -14
                },
                {
                    "file": "redfish-core/lib/task.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -5
                },
                {
                    "file": "redfish-core/lib/storage.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -15
                },
                {
                    "file": "redfish-core/lib/health.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/telemetry_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/power.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/trigger.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/cable.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -1
                },
                {
                    "file": "include/openbmc_dbus_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 55,
                    "deletions": -49
                },
                {
                    "file": "include/hostname_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -15
                },
                {
                    "file": "http/http_client.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/sensors.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -22
                },
                {
                    "file": "http/routing.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/managers.hpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": -44
                },
                {
                    "file": "include/async_resolve.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "include/image_upload.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/metric_report_definition.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/update_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -18
                },
                {
                    "file": "redfish-core/include/utils/collection.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/led.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 672,
            "sizeDeletions": 576
        },
        {
            "number": 4,
            "revision": "f138e05fb98a7d9d291ddda4699ebbba431048c4",
            "parents": [
                "f1eac5775ed6593fe7148118304bdecec08af1ef"
            ],
            "ref": "refs/changes/33/54833/4",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1655961812,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "Definitely need more in the commit msg. Why does bmcweb need this change?\n\nAlso a Tested:\n\nMaybe mark as WIP until then?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Yes, I didn't add reviewers yet since I was doing some testing. And yes, will add more explanation."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Done"
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "line": 8,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "The old one was intentionally a pointer so that it could possibly be virtualized at some point with unit tests.  Before we go and make the change to the whole tree (in a way that's going to break everyone patches) can we just keep the type the same for the moment, just move it into its own compile unit to solve the immediate problem, then once we've determined that we have a unit testing design that doesn't require it to be a pointer, we can make all the edits to the tree?\n\nI'm trying to avoid:\n1. Holding up this patch for a long time\n2. Breaking all the existing patches in review\n3. Having to change to a global non-pointer singleton, then back to a pointer when we have unit tests.\n\nI don't have a great line of sight on what we're going to do when, but I think we can make this change incrementally."
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "line": 8,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "> can we just keep the type the same for the moment, just move it into its own compile unit to solve the immediate problem,\n\nHow? Are you talking about extern?"
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "line": 8,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Please take a look at what I have now."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/certificate_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -13
                },
                {
                    "file": "redfish-core/lib/processor.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -14
                },
                {
                    "file": "redfish-core/lib/hypervisor_system.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -14
                },
                {
                    "file": "include/google/google_service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/account_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 137,
                    "deletions": -137
                },
                {
                    "file": "redfish-core/lib/pcie.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "redfish-core/lib/bios.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -6
                },
                {
                    "file": "redfish-core/lib/pcie_slots.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/roles.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 31,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish_aggregator.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/include/utils/sw_utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -5
                },
                {
                    "file": "redfish-core/lib/redfish_util.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/metric_report.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_utility.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -23
                },
                {
                    "file": "redfish-core/lib/ethernet.hpp",
                    "type": "MODIFIED",
                    "insertions": 28,
                    "deletions": -26
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 95,
                    "deletions": -81
                },
                {
                    "file": "include/nbd_proxy.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "redfish-core/lib/network_protocol.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -14
                },
                {
                    "file": "redfish-core/lib/task.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -5
                },
                {
                    "file": "redfish-core/lib/storage.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -15
                },
                {
                    "file": "redfish-core/lib/health.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/telemetry_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/power.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/trigger.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/cable.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -1
                },
                {
                    "file": "include/openbmc_dbus_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 55,
                    "deletions": -49
                },
                {
                    "file": "include/hostname_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -15
                },
                {
                    "file": "http/http_client.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/sensors.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -22
                },
                {
                    "file": "http/routing.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/managers.hpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": -44
                },
                {
                    "file": "include/async_resolve.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "include/image_upload.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/metric_report_definition.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/update_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -18
                },
                {
                    "file": "redfish-core/include/utils/collection.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/led.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 675,
            "sizeDeletions": 576
        },
        {
            "number": 5,
            "revision": "81f7ccc5e930c511da1d0bd7a4767ccd35a80799",
            "parents": [
                "f1eac5775ed6593fe7148118304bdecec08af1ef"
            ],
            "ref": "refs/changes/33/54833/5",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1656017532,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/certificate_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -13
                },
                {
                    "file": "redfish-core/lib/processor.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -14
                },
                {
                    "file": "redfish-core/lib/hypervisor_system.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -14
                },
                {
                    "file": "include/google/google_service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/account_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 137,
                    "deletions": -137
                },
                {
                    "file": "redfish-core/lib/pcie.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "redfish-core/lib/bios.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/memory.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -6
                },
                {
                    "file": "redfish-core/lib/pcie_slots.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/roles.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 31,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish_aggregator.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/include/utils/sw_utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -5
                },
                {
                    "file": "redfish-core/lib/redfish_util.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/metric_report.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_utility.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -23
                },
                {
                    "file": "redfish-core/lib/ethernet.hpp",
                    "type": "MODIFIED",
                    "insertions": 28,
                    "deletions": -26
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 95,
                    "deletions": -81
                },
                {
                    "file": "include/nbd_proxy.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "redfish-core/lib/network_protocol.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -14
                },
                {
                    "file": "redfish-core/lib/task.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -5
                },
                {
                    "file": "redfish-core/lib/storage.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -15
                },
                {
                    "file": "redfish-core/lib/health.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/telemetry_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/power.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/trigger.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/cable.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -1
                },
                {
                    "file": "include/openbmc_dbus_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 55,
                    "deletions": -49
                },
                {
                    "file": "include/hostname_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -15
                },
                {
                    "file": "http/http_client.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/sensors.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -22
                },
                {
                    "file": "http/routing.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/managers.hpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": -44
                },
                {
                    "file": "include/async_resolve.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "include/image_upload.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/metric_report_definition.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/lib/update_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -18
                },
                {
                    "file": "redfish-core/include/utils/collection.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/led.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 701,
            "sizeDeletions": 576
        },
        {
            "number": 6,
            "revision": "f7ea8ca3d621e65292a35ffa0335a9cb2d39c2de",
            "parents": [
                "f1eac5775ed6593fe7148118304bdecec08af1ef"
            ],
            "ref": "refs/changes/33/54833/6",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1656024174,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Ready for review"
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "line": 17,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Can we remove the typical usage please?  The codebase should show the typical usage, and maintaining code blocks like this for things that aren't in the public API is error prone (implementations tend to change without the examples being updated)."
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "line": 17,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "> aren't in the public API\n\npublic API of BMCWeb? or this class?\n\nAnyway, removed the comments."
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "line": 17,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "let me rephrase:  This isn't in a external-client-facing library ABI, so the \"typical usage\" is found by looking at the bmcweb code that currently uses it.\n\nIf this were in an a library ABI, yes, a typical usage would be totally reasonable."
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "line": 17,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 21,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This isn't true.  io continues to be referenced after this is called, and the lifetimes need to match."
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 21,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Could you elaborate, what will be referenced? The io_context inside sdbusplus::asio::connection?\n\nAnd the concern is that |io_context| gets destroyed. but we still reference it inside |systemBus|?"
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 21,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Correct.  making the statement that \"io won't be referenced anymore\" isn't correct, io will be referenced quite often through sdbusplus::asio::connection."
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 21,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "This is done."
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 23,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "possible nullptr dereference.  Please review the cpp core guidelines and the existing code for how we handle pointers.  In this case, I suspect io should've been a reference."
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 23,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Why nullptr dereference is possible? \n\nWe should always call initialize first. Then line 23 won't be execute anymore.\n\nAnd initialize takes a reference."
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 23,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> Why nullptr dereference is possible? \n\nsystembus(nullptr) would seg fault this code.\n\n> \n> We should always call initialize first.\n> Then line 23 won't be execute anymore.\n> \n> And initialize takes a reference.\n\nIn general, that's not how secure coding guidelines work.  Code needs to be secure against users calling the API incorrectly.  Yes, in this case, it's not that likely someone would, but we follow the rules because nullptr dereferences are difficult to track down."
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 23,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "It's not a concern now."
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 153,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "removing this causes lifetime issues.  systemBus holds a reference to the io_context, which is declared in the above scope."
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 153,
                    "reviewer": {
                        "name": "John Broadbent",
                        "email": "jebr@google.com",
                        "username": "jebr224"
                    },
                    "message": "question for Ed.\nI assumed our current scope (main) holds a reference to io_context. It is shared, and not moved.\nI suspect you are correct, somehow."
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 153,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 153,
                    "reviewer": {
                        "name": "John Broadbent",
                        "email": "jebr@google.com",
                        "username": "jebr224"
                    },
                    "message": "I read about this last night, Ed was right, main lose it's ownership after last use. So in patch set 6 Ed was correct, we need this keep io_context owned.\n\nHowever, patch set 8 make DBusConnection a shared owner of the io_context. So we should not require this step. I am going to keep this comment as resolved."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": -1
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 93,
            "sizeDeletions": 3
        },
        {
            "number": 7,
            "revision": "601af42061bee5a69ad6576d62fabb37cba9dc28",
            "parents": [
                "f1eac5775ed6593fe7148118304bdecec08af1ef"
            ],
            "ref": "refs/changes/33/54833/7",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1656027054,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "John Broadbent",
                        "email": "jebr@google.com",
                        "username": "jebr224"
                    },
                    "message": "Thank you for looking into this. It will be great to have this cleaned up.\n\nI will abandon my simplistic approach in: https://gerrit.openbmc.org/c/openbmc/bmcweb/+/54834"
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 12,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I suspect for the moment we don't need the DBus singleton class at all to solve the immediate problem, right?  Yes, our use of a raw pointer here isn't the best, but over time we should work with the sdbusplus maintainers to figure out what the intended pattern here is.\n\nIdeally systembus would just be an RAII object on stack declared after the io_context.... in fact, I wonder if that's what we should just do?"
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 12,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Yes, that's exactly my idea. Please take a look at what I have now.\n\nRaw extern pointer was kept to avoid massive treeside change."
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 12,
                    "reviewer": {
                        "name": "John Broadbent",
                        "email": "jebr@google.com",
                        "username": "jebr224"
                    },
                    "message": "If you want RAII, stdplus has a managed object, and using that might be preferable to adding something to sdbusplus.\n\n\nhttps://github.com/openbmc/stdplus/blob/73a20c4a7bc4bdb4b47465e2c4d5d51a696d996b/src/stdplus/handle/managed.hpp#L11\n\nHowever, that is not a priority (for me). This change is improvement as currently written"
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 12,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "What I have is RAII already IIUC."
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 23,
                    "reviewer": {
                        "name": "John Broadbent",
                        "email": "jebr@google.com",
                        "username": "jebr224"
                    },
                    "message": "I am not sure I understand. It looks as if on line 27 you will call this function with a nullptr. That will create issues on line 23 when you build a connection.\n\nI suspect you want to create the bus (asio::connection) one time, in initialize.\nAnd every subsequent DBusSingleton::systemBus() call,  return  weak_pointer to it (or a reference because it is static)."
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 23,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Please see\n\nhttps://stackoverflow.com/questions/21395459/how-to-pass-argument-in-a-singleton\nhttps://stackoverflow.com/questions/449436/singleton-instance-declared-as-static-variable-of-getinstance-method-is-it-thre/449823#449823\n\nline 27 will only be called after line 12. And then, in following calls of line 27, line 23 won't be executed at all. That's the main idea of using static local variable. More information in https://laristra.github.io/flecsi/src/developer-guide/patterns/meyers_singleton.html.\n\nIf we hit nullptr issue here, my test will fail immediately"
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 23,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Not applied anymore."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -1
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 89,
            "sizeDeletions": 3
        },
        {
            "number": 8,
            "revision": "f132540f2f9a1e899c34d7b7101c0b84da135b96",
            "parents": [
                "f1eac5775ed6593fe7148118304bdecec08af1ef"
            ],
            "ref": "refs/changes/33/54833/8",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1656087026,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "John Broadbent",
                        "email": "jebr@google.com",
                        "username": "jebr224"
                    },
                    "message": "Looks good to me"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "bump"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Generally no need to bump so soon after last comments were given.  This was reviewed Friday;  Generally it takes time for reviewers to get back to things (as I'm sure you know from reviewing other peoples patches).  A rule of thumb is to give a business-week before expecting followup, or if you have specific questions, follow up on discord."
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "line": 0,
                    "reviewer": {
                        "name": "John Broadbent",
                        "email": "jebr@google.com",
                        "username": "jebr224"
                    },
                    "message": "nit:\nthis is not a singleeton, but the file name is still \"dbus_singleton.h"
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "line": 0,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Changing it needs to change many other headers. I don't know if that's something we want to do right now."
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "line": 0,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 153,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I'd still like to reset the systemBus variable to nullptr when we go out of scope.  This makes it less likely there's a security issue on destruction (although unlikely anyway) and makes it a lot more obvious what happened when things fail on shutdown.\n\n\nshould just be crow::connections::systemBus = nullptr;"
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 153,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "when io->run returns, all async code have already returned, right? There will no more reference to |systemBus| other than what DBusConnection owns.\n\nI added this `crow::connections::systemBus = nullptr;`."
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 153,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> when io->run returns, all async code have already returned, right?\n> There will no more reference to |systemBus| other than what DBusConnection owns.\n\n\nsdbusplus::match objects that are global still have some references that don't RAII properly.  It needs fixed at some point, but dereferncing 0 is a lot better than dereferencing what was once a valid pointer.\n\n\n> \n> I added this `crow::connections::systemBus = nullptr;`.\n\nThank you."
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 153,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 71,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "If this is now declared on stack, we don't need the DBusConnection class at all, the ownership is handled by the stack.  Just do\n\nsdbusplus::asio::connection dbusConnection;\ncrow::connections::systemBus = &dbusConnection;\n\n\nand the whole dbus_singleton.hpp file goes away, right?\n\nAs written, I'm a little worried that this forces the io_context to live longer than main(), which might be an issue."
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 71,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "No, dbus_singleton.hpp is a header that declares this global |systemBus| which can't go away.\n\nWhy will io_context live longer than main()? when main returns, |DBusConnection| destructs, firstly |systemBus| goes away, then |io| goes away."
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 71,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "< Why will io_context live longer than main()? \n\nBecause it's a shared pointer, and now there are global-scope things that take ownership of it.  Arguably, io_context should've never been a shared_ptr, but it helped at the time for some reasons I don't remember.\n\nIf we don't need to take a copy of the shared_ptr, because we can now gaurantee it based on both objects being on stack, shouldn't we just rely on that?"
                },
                {
                    "file": "src/webserver_main.cpp",
                    "line": 71,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Done. I agree that DBusConnection can use the |io| directly without require a shared copy. |io| will be destructed after DBusConnection"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -1
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 82,
            "sizeDeletions": 4
        },
        {
            "number": 9,
            "revision": "f783773b78762594d018239b30ec5ee27b1e2ade",
            "parents": [
                "f1eac5775ed6593fe7148118304bdecec08af1ef"
            ],
            "ref": "refs/changes/33/54833/9",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1656358199,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -1
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 84,
            "sizeDeletions": 4
        },
        {
            "number": 10,
            "revision": "4843eeb055b88f97550162cbe2cdf61d1d8b387b",
            "parents": [
                "f1eac5775ed6593fe7148118304bdecec08af1ef"
            ],
            "ref": "refs/changes/33/54833/10",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1656358221,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -1
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 84,
            "sizeDeletions": 4
        },
        {
            "number": 11,
            "revision": "b09f0ad6ef7606de526f249777b804f56b721c14",
            "parents": [
                "a02b586271bd419684f9e50e81675ed037ac8565"
            ],
            "ref": "refs/changes/33/54833/11",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1656449505,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Good to go?"
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 18,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I think you missed my point in the other thread.  Now that everything is on stack, we don't need this class at all.  As you can see, it doesn't really do much in its current form except hold a reference to systemBus, which is already guaranteed to have the appropriate lifetime (and holding a reference doesn't really help with that either)"
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "line": 18,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "I got what you meant this time. Done. PTAL"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": -1
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 76,
            "sizeDeletions": 4
        },
        {
            "number": 12,
            "revision": "06e0cbb7f8885f20c3a57594f9a5c97a6ee79814",
            "parents": [
                "a02b586271bd419684f9e50e81675ed037ac8565"
            ],
            "ref": "refs/changes/33/54833/12",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1657218595,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -1
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 58,
            "sizeDeletions": 4
        },
        {
            "number": 13,
            "revision": "736734fb241cd34a551869ff6be8d1c5e2c758af",
            "parents": [
                "a02b586271bd419684f9e50e81675ed037ac8565"
            ],
            "ref": "refs/changes/33/54833/13",
            "uploader": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "createdOn": 1657218672,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "LGTM, not seeing a lot of discussion here, so merging.\n\nAs always, happy to discuss."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -1
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 56,
            "sizeDeletions": 4
        },
        {
            "number": 14,
            "revision": "6384e3239a6567db6e9b0df73f77193768c5a86d",
            "parents": [
                "16a5535f15af187b56d4c927aa9dec3ef8f66af4"
            ],
            "ref": "refs/changes/33/54833/14",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1657220131,
            "author": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                },
                {
                    "file": "include/dbus_singleton.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -1
                },
                {
                    "file": "src/dbus_singleton.cpp",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 56,
            "sizeDeletions": 4
        }
    ]
}