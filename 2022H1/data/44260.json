{
    "project": "openbmc/phosphor-host-ipmid",
    "branch": "master",
    "id": "I6d4c68dd7139990161b1bd56552e62b748bdb835",
    "number": 44260,
    "subject": "ipmi_pass: Check the existence and size of ipmi_pass",
    "owner": {
        "name": "Medad",
        "email": "medadyoung@gmail.com",
        "username": "medadyoung"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/phosphor-host-ipmid/+/44260",
    "commitMessage": "ipmi_pass: Check the existence and size of ipmi_pass\n\nwe should create new ipmi_pass under below two confitions:\n1. ipmi_pass doesn't exist\n2. ipmi_pass exists, but file size doesn't match the info in the header\n\nSigned-off-by: Medad CChien <ctcchien@nuvoton.com>\nChange-Id: I6d4c68dd7139990161b1bd56552e62b748bdb835\n",
    "createdOn": 1624247691,
    "lastUpdated": 1642482729,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1624247691,
            "reviewer": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1624247706,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624247759,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/20169/ : FAILURE"
        },
        {
            "timestamp": 1624267921,
            "reviewer": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1624267942,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624267985,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/20212/ : FAILURE"
        },
        {
            "timestamp": 1624275167,
            "reviewer": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1624275185,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624275220,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/20235/ : FAILURE"
        },
        {
            "timestamp": 1624276514,
            "reviewer": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1624276528,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624276590,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/20242/ : FAILURE"
        },
        {
            "timestamp": 1624276986,
            "reviewer": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1624276998,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624277151,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/20243/ : SUCCESS"
        },
        {
            "timestamp": 1624317066,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 5:\n\n(1 comment)\n\nPlease explain why this is need. It seems like the default username with the default password is going to get created by default. I might be missing something, but, isn't this a security concern?"
        },
        {
            "timestamp": 1624324929,
            "reviewer": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "message": "Patch Set 5:\n\n> Patch Set 5:\n> \n> (1 comment)\n> \n> Please explain why this is need. It seems like the default username with the default password is going to get created by default. I might be missing something, but, isn't this a security concern?\n\nipmid will crash, because the header size in ipmi_pass are different between aarch64 and arm32, so I add this code to check the info in the header for aarch64.\nmaybe I should hardcode the encrypted user/password for aarch64, but not the plaintext?"
        },
        {
            "timestamp": 1624332371,
            "reviewer": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "message": "Patch Set 5:\n\n> Patch Set 5:\n> \n> (1 comment)\n> \n> Please explain why this is need. It seems like the default username with the default password is going to get created by default. I might be missing something, but, isn't this a security concern?\n\nbut even if I encrypted the default user/password and hardcode, I still need to store corresponding plaintext key_file, for I need to use it to decrypt the user/password, then write back to ipmi_pass"
        },
        {
            "timestamp": 1624411488,
            "reviewer": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "message": "Uploaded patch set 6: Commit message was updated."
        },
        {
            "timestamp": 1624660468,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 6:\n\n> Patch Set 5:\n> \n> > Patch Set 5:\n> > \n> > (1 comment)\n> > \n> > Please explain why this is need. It seems like the default username with the default password is going to get created by default. I might be missing something, but, isn't this a security concern?\n> \n> ipmid will crash, because the header size in ipmi_pass are different between aarch64 and arm32, so I add this code to check the info in the header for aarch64.\n> maybe I should hardcode the encrypted user/password for aarch64, but not the plaintext?\n\nSorry, I still don't understand. Where was this incompatible ipmi_pass (I assume in arm32 format) created in the first place? It seems the issue is portable code. ipmi_pass created by aarch64 code should be able to be parsed by aarch64 code. Erase the old one and create a new one is not the solution."
        },
        {
            "timestamp": 1625211448,
            "reviewer": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "message": "Patch Set 6:\n\n> Patch Set 6:\n> \n> > Patch Set 5:\n> > \n> > > Patch Set 5:\n> > > \n> > > (1 comment)\n> > > \n> > > Please explain why this is need. It seems like the default username with the default password is going to get created by default. I might be missing something, but, isn't this a security concern?\n> > \n> > ipmid will crash, because the header size in ipmi_pass are different between aarch64 and arm32, so I add this code to check the info in the header for aarch64.\n> > maybe I should hardcode the encrypted user/password for aarch64, but not the plaintext?\n> \n> Sorry, I still don't understand. Where was this incompatible ipmi_pass (I assume in arm32 format) created in the first place? It seems the issue is portable code. ipmi_pass created by aarch64 code should be able to be parsed by aarch64 code. Erase the old one and create a new one is not the solution.\n\nThe original ipmi_pass is in pam-ipmi. ipmid will parse ipmi_pass with a structure which has members declared with size_t, and size_t for aaech64 is 8-bytes long, but 4-bytes long for arm32. maybe I should try to parse ipmi_pass with the same size of structure as arm32 when parse fail with the original structure for aarm64, and then write the data back to ipmi_pass?"
        },
        {
            "timestamp": 1625865870,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 6:\n\n> Patch Set 6:\n> \n> > Patch Set 6:\n> > \n> > > Patch Set 5:\n> > > \n> > > > Patch Set 5:\n> > > > \n> > > > (1 comment)\n> > > > \n> > > > Please explain why this is need. It seems like the default username with the default password is going to get created by default. I might be missing something, but, isn't this a security concern?\n> > > \n> > > ipmid will crash, because the header size in ipmi_pass are different between aarch64 and arm32, so I add this code to check the info in the header for aarch64.\n> > > maybe I should hardcode the encrypted user/password for aarch64, but not the plaintext?\n> > \n> > Sorry, I still don't understand. Where was this incompatible ipmi_pass (I assume in arm32 format) created in the first place? It seems the issue is portable code. ipmi_pass created by aarch64 code should be able to be parsed by aarch64 code. Erase the old one and create a new one is not the solution.\n> \n> The original ipmi_pass is in pam-ipmi. ipmid will parse ipmi_pass with a structure which has members declared with size_t, and size_t for aaech64 is 8-bytes long, but 4-bytes long for arm32. maybe I should try to parse ipmi_pass with the same size of structure as arm32 when parse fail with the original structure for aarm64, and then write the data back to ipmi_pass?\nI think either 1) create a ipmi_pass for aarch64 and install the correct version through recipe file or 2) update the structure to be compatible between arch64 and arm32"
        },
        {
            "timestamp": 1642482729,
            "reviewer": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "message": "Set Work In Progress"
        }
    ],
    "wip": true,
    "patchSets": [
        {
            "number": 1,
            "revision": "2c05cdcfd78d9af6afe35fafab152f8c89377833",
            "parents": [
                "7fd91fa260a4c56448b46ae2735a0dd84e78225e"
            ],
            "ref": "refs/changes/60/44260/1",
            "uploader": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "createdOn": 1624247691,
            "author": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.cpp",
                    "type": "MODIFIED",
                    "insertions": 217,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 241,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "db026339373ceb529a920c162c1b5c5b56ab40bb",
            "parents": [
                "7fd91fa260a4c56448b46ae2735a0dd84e78225e"
            ],
            "ref": "refs/changes/60/44260/2",
            "uploader": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "createdOn": 1624267921,
            "author": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.cpp",
                    "type": "MODIFIED",
                    "insertions": 217,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 241,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "96514b38dc116592025fecbb6d8aad4abec1c5dc",
            "parents": [
                "7fd91fa260a4c56448b46ae2735a0dd84e78225e"
            ],
            "ref": "refs/changes/60/44260/3",
            "uploader": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "createdOn": 1624275167,
            "author": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.cpp",
                    "type": "MODIFIED",
                    "insertions": 216,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 240,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "4b46b20f3e69b8c8cdf7d7b07dc69a2353e1cfd7",
            "parents": [
                "7fd91fa260a4c56448b46ae2735a0dd84e78225e"
            ],
            "ref": "refs/changes/60/44260/4",
            "uploader": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "createdOn": 1624276514,
            "author": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.cpp",
                    "type": "MODIFIED",
                    "insertions": 216,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 240,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "6ed2b4156e1f39d58e382c612abb951ab61ffb9a",
            "parents": [
                "7fd91fa260a4c56448b46ae2735a0dd84e78225e"
            ],
            "ref": "refs/changes/60/44260/5",
            "uploader": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "createdOn": 1624276986,
            "author": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "match"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.cpp",
                    "type": "MODIFIED",
                    "insertions": 213,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 237,
            "sizeDeletions": 0
        },
        {
            "number": 6,
            "revision": "4a3305ff51529c1ea12ba1fcb1aa6cdd4e018139",
            "parents": [
                "7fd91fa260a4c56448b46ae2735a0dd84e78225e"
            ],
            "ref": "refs/changes/60/44260/6",
            "uploader": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "createdOn": 1624411488,
            "author": {
                "name": "Medad",
                "email": "medadyoung@gmail.com",
                "username": "medadyoung"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.cpp",
                    "type": "MODIFIED",
                    "insertions": 213,
                    "deletions": 0
                },
                {
                    "file": "user_channel/passwd_mgr.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 237,
            "sizeDeletions": 0
        }
    ]
}