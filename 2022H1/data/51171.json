{
    "project": "openbmc/sdbusplus",
    "branch": "master",
    "topic": "audit-log",
    "id": "I0470fc50b0fd50830ee188d7fcbf26bdd2c02767",
    "number": 51171,
    "subject": "tools: Add elog gen script to support the dbus specified events",
    "owner": {
        "name": "George Liu",
        "email": "liuxiwei@inspur.com",
        "username": "lxwinspur"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/sdbusplus/+/51171",
    "commitMessage": "tools: Add elog gen script to support the dbus specified events\n\nThis work is in prep for running this python script against the\nevents defined in the phosphor-dbus-interfaces repo\n\nEvent is similar to error, indicating that this is not an error,\nbut an event message(maybe redfish, audit, sel, etc.)\n\nNeeds to define *.events.yaml in the phosphor-dbus-interfaces repo,\nand generate corresponding event.hpp & event.cpp through sdbus++\n\nSigned-off-by: George Liu <liuxiwei@inspur.com>\nChange-Id: I0470fc50b0fd50830ee188d7fcbf26bdd2c02767\n",
    "createdOn": 1644818772,
    "lastUpdated": 1646364825,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1644818772,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1644818786,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1644818786,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1644819290,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Topic set to audit-log"
        },
        {
            "timestamp": 1644819293,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/37169/ : FAILURE"
        },
        {
            "timestamp": 1644820115,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1645064538,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1645064546,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1645064546,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1645065741,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1645066272,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/37434/ : SUCCESS"
        },
        {
            "timestamp": 1645092432,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1645096562,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1645096574,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1645096574,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1645096592,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1645098292,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/37477/ : SUCCESS"
        },
        {
            "timestamp": 1645594659,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1646335130,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3: Code-Review-1\n\n(7 comments)"
        },
        {
            "timestamp": 1646364825,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 3:\n\n(7 comments)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "1968a4ca3e9ca6d6c0f404fa8a1e0d070789d7d9",
            "parents": [
                "7662fa6932c90c134ecc815be688957fa45e1c84"
            ],
            "ref": "refs/changes/71/51171/1",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "createdOn": 1644818772,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/main.py",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                },
                {
                    "file": "tools/sdbusplus/templates/event.md.mako",
                    "type": "ADDED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/namedelement.py",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/templates/event.cpp.mako",
                    "type": "ADDED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/__init__.py",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/event.py",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/templates/event.hpp.mako",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbus++-gen-meson",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -3
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbus++-gendir",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 181,
            "sizeDeletions": 5
        },
        {
            "number": 2,
            "revision": "274b183488ca717864f4fa8746fc54a062f1b627",
            "parents": [
                "7662fa6932c90c134ecc815be688957fa45e1c84"
            ],
            "ref": "refs/changes/71/51171/2",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "createdOn": 1645064538,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "typo"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Done"
                },
                {
                    "file": "tools/sdbus++-gendir",
                    "line": 172,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "Do you need to add `waitall` here?"
                },
                {
                    "file": "tools/sdbus++-gendir",
                    "line": 172,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "> Do you need to add `waitall` here?\n\nyes, added."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/main.py",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -1
                },
                {
                    "file": "tools/sdbusplus/templates/event.md.mako",
                    "type": "ADDED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/namedelement.py",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/templates/event.cpp.mako",
                    "type": "ADDED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/__init__.py",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/event.py",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/templates/event.hpp.mako",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbus++-gen-meson",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -3
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbus++-gendir",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 188,
            "sizeDeletions": 5
        },
        {
            "number": 3,
            "revision": "5accd470013b3d72788a1cb4d2226d8891d70044",
            "parents": [
                "7662fa6932c90c134ecc815be688957fa45e1c84"
            ],
            "ref": "refs/changes/71/51171/3",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "createdOn": 1645096562,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Do you have any kind of design / design updates to go along with this proposal?  There are aspects that I'm kind of guessing at in the review."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "> Do you have any kind of design / design updates to go along with this proposal?  There are aspects that I'm kind of guessing at in the review.\n\nI will update this design doc\nhttps://gerrit.openbmc-project.xyz/c/openbmc/docs/+/46023"
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "line": 8,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "namespace name should be singular."
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "line": 8,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack\nWill update it."
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "There is quite a bit of overlap with this and the existing errors.  I would lean towards reusing the generated_exception class as much as we can.  Is there any harm in having this inherit from that?"
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "line": 11,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "> There is quite a bit of overlap with this and the existing errors.  I would lean towards reusing the generated_exception class as much as we can.  \n\nDo you mean to extend event in exception.hpp?\n\n> Is there any harm in having this inherit from that?\n\nSince error inherits std::exception, my understanding is that event does not represent an error, and they just have the same `name` and `description`, which I tend to separate."
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "line": 17,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "What is a \"consumer\"?  Why is it singular?  I would have expect it to be more likely a set.\n\nHow do we define and document valid consumers, whatever they are?"
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "line": 17,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "> What is a \"consumer\"?  Why is it singular?  I would have expect it to be more likely a set.\n> \n> How do we define and document valid consumers, whatever they are?\n\nMy understanding is that the consumer should be:\n\nAudit: consumer=audit\nRedfish: consumer=redfish\nSEL: consumer=sel\n..."
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "line": 20,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Please add \n\nusing event_t = event::event\n\nso that developers can do simply 'sdbusplus::event_t'.\n\n(If we even go this route.  I'm slightly concerned about these events not really being a dbus concept and so not really belonging in this library and also leading to confusion with actual sd_bus/sd_event...)"
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "line": 20,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack\nWill update it."
                },
                {
                    "file": "tools/sdbusplus/templates/event.hpp.mako",
                    "line": 1,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "These template files are almost identical between event.?pp.mako and error.?pp.mako.  I'd really like it if we can combine the handling for them and maybe have a minor change based on if it is an error.yaml or event.yaml (passed in as a parameter of some sort)."
                },
                {
                    "file": "tools/sdbusplus/templates/event.hpp.mako",
                    "line": 1,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "> These template files are almost identical between event.?pp.mako and error.?pp.mako.  I'd really like it if we can combine the handling for them and maybe have a minor change based on if it is an error.yaml or event.yaml (passed in as a parameter of some sort).\n\nSorry, I think we should evaluate whether events really need to rely on exceptions and whether there will be extensions later\nNow, I still tend to separate event from error"
                },
                {
                    "file": "tools/sdbusplus/templates/event.md.mako",
                    "line": 1,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "This doesn't appear to be hooked in anywhere."
                },
                {
                    "file": "tools/sdbusplus/templates/event.md.mako",
                    "line": 1,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "> This doesn't appear to be hooked in anywhere.\n\nTBH, Here I copied from error.md.mako\nWill remove it."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/main.py",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -1
                },
                {
                    "file": "tools/sdbusplus/templates/event.md.mako",
                    "type": "ADDED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/namedelement.py",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/templates/event.cpp.mako",
                    "type": "ADDED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/__init__.py",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/event.py",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbusplus/templates/event.hpp.mako",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbus++-gen-meson",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -3
                },
                {
                    "file": "include/sdbusplus/event.hpp",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "tools/sdbus++-gendir",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 189,
            "sizeDeletions": 5
        }
    ]
}