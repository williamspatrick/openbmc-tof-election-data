{
    "project": "openbmc/phosphor-fan-presence",
    "branch": "master",
    "topic": "ibm3559",
    "id": "Iacdd2d2b388e79988e2536d52497f0e697e1d444",
    "number": 53307,
    "subject": "monitor: Capture BMC dumps on fan/ambient shutdowns",
    "owner": {
        "name": "Mike Capps",
        "email": "mikepcapps@gmail.com",
        "username": "mikecgithub"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/phosphor-fan-presence/+/53307",
    "commitMessage": "monitor: Capture BMC dumps on fan/ambient shutdowns\n\nWhen fan-monitor or sensor-monitor generates an EPOW, this change\ncreates a BMC dump after the system is powered off and all error logs\nare created.\n\nChange-Id: Iacdd2d2b388e79988e2536d52497f0e697e1d444\nSigned-off-by: Mike Capps <mikepcapps@gmail.com>\n",
    "createdOn": 1651092535,
    "lastUpdated": 1651246187,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1651092535,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1651092545,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1651092545,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1651092648,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/42110/ : SUCCESS"
        },
        {
            "timestamp": 1651092838,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1651093459,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1651093473,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1651093473,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1651093578,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/42113/ : SUCCESS"
        },
        {
            "timestamp": 1651116743,
            "reviewer": {
                "name": "Brandon J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1651155802,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1651179654,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1651179665,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1651179665,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1651180023,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/42236/ : SUCCESS"
        },
        {
            "timestamp": 1651180537,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1651180550,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1651180550,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1651180653,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/42238/ : SUCCESS"
        },
        {
            "timestamp": 1651184107,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 4:\n\n(3 comments)"
        },
        {
            "timestamp": 1651241302,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1651241316,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1651241316,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1651241406,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1651241421,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/42340/ : SUCCESS"
        },
        {
            "timestamp": 1651241431,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 5: Code-Review+2"
        },
        {
            "timestamp": 1651241689,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Change has been successfully merged"
        },
        {
            "timestamp": 1651246187,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "670b1c35ebc69b898db2d40a6a9e2222772fb278",
            "parents": [
                "be15edeef8ca9c0c6b99e4b53f51db251b568307"
            ],
            "ref": "refs/changes/07/53307/1",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1651092535,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "monitor/system.cpp",
                    "line": 500,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "This is an oversight, I am fixing it now."
                },
                {
                    "file": "monitor/system.cpp",
                    "line": 500,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "monitor/system.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "monitor/power_off_action.hpp",
                    "type": "MODIFIED",
                    "insertions": 27,
                    "deletions": -1
                },
                {
                    "file": "monitor/power_interface.cpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/shutdown_alarm_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/shutdown_alarm_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 82,
            "sizeDeletions": 1
        },
        {
            "number": 2,
            "revision": "4c58edd8a2a8bcd04bcb8c93009675e90bb309e0",
            "parents": [
                "be15edeef8ca9c0c6b99e4b53f51db251b568307"
            ],
            "ref": "refs/changes/07/53307/2",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1651093459,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "monitor/power_interface.cpp",
                    "line": 40,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "I think you can just use the same util::SdBusPlus::callMethod() function as above for all of the instances?  It's templated to take the method args as function parameters"
                },
                {
                    "file": "monitor/power_interface.cpp",
                    "line": 40,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "monitor/system.cpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": 0
                },
                {
                    "file": "monitor/power_off_action.hpp",
                    "type": "MODIFIED",
                    "insertions": 27,
                    "deletions": -1
                },
                {
                    "file": "monitor/system.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                },
                {
                    "file": "monitor/power_interface.cpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/shutdown_alarm_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/shutdown_alarm_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 106,
            "sizeDeletions": 1
        },
        {
            "number": 3,
            "revision": "948883739c9a375e199988805f078728ea4dde94",
            "parents": [
                "be15edeef8ca9c0c6b99e4b53f51db251b568307"
            ],
            "ref": "refs/changes/07/53307/3",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1651179654,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "monitor/system.cpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": 0
                },
                {
                    "file": "monitor/power_off_action.hpp",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": -1
                },
                {
                    "file": "monitor/system.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                },
                {
                    "file": "monitor/power_interface.cpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/shutdown_alarm_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/shutdown_alarm_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 81,
            "sizeDeletions": 1
        },
        {
            "number": 4,
            "revision": "cfdd9afe03a4f8aeb5dbc157571246059d978bc4",
            "parents": [
                "be15edeef8ca9c0c6b99e4b53f51db251b568307"
            ],
            "ref": "refs/changes/07/53307/4",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1651180537,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "monitor/power_interface.cpp",
                    "line": 40,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "I might feel a little safer putting a try/catch around these so it can't affect fan monitor. In theory this shouldn't fail though... what do you think?"
                },
                {
                    "file": "monitor/power_interface.cpp",
                    "line": 40,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "It's something that can only be a benefit and no cost, so I'll add it."
                },
                {
                    "file": "monitor/power_interface.cpp",
                    "line": 40,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "monitor/system.cpp",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "monitor/power_off_action.hpp",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": -1
                },
                {
                    "file": "monitor/system.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                },
                {
                    "file": "monitor/power_interface.cpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/shutdown_alarm_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/shutdown_alarm_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 72,
            "sizeDeletions": 1
        },
        {
            "number": 5,
            "revision": "683a96c658a2ccc500652ccd0657f1d0f192e016",
            "parents": [
                "be15edeef8ca9c0c6b99e4b53f51db251b568307"
            ],
            "ref": "refs/changes/07/53307/5",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1651241302,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "monitor/system.cpp",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "monitor/power_off_action.hpp",
                    "type": "MODIFIED",
                    "insertions": 24,
                    "deletions": -1
                },
                {
                    "file": "monitor/system.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                },
                {
                    "file": "monitor/power_interface.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/shutdown_alarm_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/shutdown_alarm_monitor.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 93,
            "sizeDeletions": 1
        }
    ]
}