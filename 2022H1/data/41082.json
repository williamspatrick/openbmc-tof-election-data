{
    "project": "openbmc/openbmc",
    "branch": "master",
    "id": "I3c01fd17579bf78c56c9c434534870a4d48ad299",
    "number": 41082,
    "subject": "WIP: Implement recipes for redfish-service-validator",
    "owner": {
        "name": "Ed Tanous",
        "email": "ed@tanous.net",
        "username": "edtanous"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openbmc/+/41082",
    "commitMessage": "WIP: Implement recipes for redfish-service-validator\n\nBeing able to run redfish service validator in qemu seems worthwhile\n\nRedfish-service-validator was never meant to be installable, so this\nrecipe can't use the normal yocto machinery for doing pip compatible\ninstalls.  For the moment it does a blind copy of the files into lib.\nConsidering this is only for testing, and unlikely to make it into a\n\"real\" release, this seems reasonable.\n\nAs part of that, this commit also adds recipes to install the schema\nfiles from the redfish schema pack.  This involves some license\ngoofyness, as the schema files are under a permissive copyright, so a\ncustom-license type was added for that.  I copied what was done in\nthe upstream OE meta-intel for similar licenses for microcode.\n\nThis commit also adds a modified config file, for use on the BMC,\npointing to the install location of the schema packs.  This makes it\ntrivial for a user to run a schema test using the command\nopenbmc-redfish-test from a console.  I intent on adding more to this\ntest script as I get time.  DMTF recommends running 4 different\nvalidators, so getting those running in emulation seems useful.\n\nSigned-off-by: Ed Tanous <edtanous@google.com>\nChange-Id: I3c01fd17579bf78c56c9c434534870a4d48ad299\nSigned-off-by: Willy Tu <wltu@google.com>\n",
    "createdOn": 1614912891,
    "lastUpdated": 1645422555,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1614912891,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1614912919,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1614912929,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/2269/"
        },
        {
            "timestamp": 1614914048,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/2269/ : SUCCESS"
        },
        {
            "timestamp": 1614916131,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 1:\n\nBuild Failed \n\nIBM Hardware CI : witherspoon hardware test failed"
        },
        {
            "timestamp": 1615506371,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1615506398,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1615506405,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/2418/"
        },
        {
            "timestamp": 1615507112,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/2418/ : SUCCESS"
        },
        {
            "timestamp": 1615510249,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 2:\n\nBuild Failed \n\nIBM Hardware CI : witherspoon hardware test failed"
        },
        {
            "timestamp": 1644018835,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 2:\n\n(6 comments)"
        },
        {
            "timestamp": 1644031562,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(4 comments)"
        },
        {
            "timestamp": 1644144785,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1644144817,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1644144817,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1644144823,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/9099/"
        },
        {
            "timestamp": 1644145362,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1644145370,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 3:\n\n(6 comments)"
        },
        {
            "timestamp": 1644145400,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1644145400,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1644145402,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/9099/ : ABORTED"
        },
        {
            "timestamp": 1644145408,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/9100/"
        },
        {
            "timestamp": 1644146234,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/9100/ : SUCCESS"
        },
        {
            "timestamp": 1644147611,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 4:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1644433292,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1644612735,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1644612833,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(2 comments)"
        },
        {
            "timestamp": 1644613166,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1645223687,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 4:\n\n(8 comments)"
        },
        {
            "timestamp": 1645224815,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(8 comments)"
        },
        {
            "timestamp": 1645225286,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1645228030,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1645228158,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1645422555,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "fb85456cd0ae8c60f27950fcb6cd255dab9c0224",
            "parents": [
                "6e358f603f635c593d41d770ca1d8914c826edd8"
            ],
            "ref": "refs/changes/82/41082/1",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1614912891,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2020.4.bb",
                    "type": "ADDED",
                    "insertions": 24,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc-redfish-test",
                    "type": "ADDED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc_config.ini",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "type": "ADDED",
                    "insertions": 44,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 119,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "45680d507a06afcd643e9cc0970b808c38d7646e",
            "parents": [
                "6e358f603f635c593d41d770ca1d8914c826edd8"
            ],
            "ref": "refs/changes/82/41082/2",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1615506371,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2020.4.bb",
                    "line": 1,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Sync to 2021.4\n\n```\nLICENSE = \"DMTF-COPYRIGHT\"\nLICENSE = \"DMTF-COPYRIGHT\"\nLIC_FILES_CHKSUM = \"file://DSP8010_${PV}.pdf;md5=629fa6b338287a1a901b6a615934ac24\"\n\n\n\nSRC_URI = \"https://www.dmtf.org/sites/default/files/standards/documents/DSP8010_${PV}.zip\"\n\nSRC_URI[md5sum] = \"2572edeb96268ff6cdd41cbe1354c255\"\nSRC_URI[sha1sum] = \"9c2cf10cc433e5e8beae074a204fd3083e23a46f\"\nSRC_URI[sha256sum] = \"88534f1ec24943fea67ec7b329ebfee8d513de4fd48dfd1d743ce218e76090fe\"\nSRC_URI[sha384sum] = \"036495338a96109b20dfd7401cc6d37566501bb3fddaf76570f2834fc64a2104dff5c7b936b27f2b4c344f1436e806a5\"\nSRC_URI[sha512sum] = \"af26cb16f35be570965e01bdfc14ca650a43ac200dddb86dd771ddbf132e2625915c415fa0a4856d05330db65189e75abc58f5c4a230a0613a65c26fad811046\"\n\ninherit allarch\n\nS = \"${WORKDIR}\"\n\nFILES:${PN} += \"${libdir}/redfish-schema-pack.zip\"\n\ndo_install () {\n    install -d ${D}${libdir}\n    cp -R --no-dereference --preserve=mode,links -v ${S}/csdl ${D}${libdir}/redfish-schema-pack/\n    cp -R --no-dereference --preserve=mode,links -v ${S}/openapi ${D}${libdir}/redfish-schema-pack/\n}\n\n```\n\nDoes it have to be csdl and openapi? What about `json-schema`?"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2020.4.bb",
                    "line": 1,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I forgot json schema existed, we could probably add that to, although it's not super useful, bmcweb doesn't use it, and all the tools rely on CSDL.  This commit predates 2021.4, and yes, it should be updated."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2020.4.bb",
                    "line": 1,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Done. I have cleaned updated in the change. I didn't include json_schema since we don't really use it."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc_config.ini",
                    "line": 1,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "This will need to be updated to something like\n\n```\n[Tool]\nVersion = 2\nCopyright = Redfish DMTF (c) 2021\nverbose = \n\n[Host]\nip = http://localhost:8000\nusername = root\npassword = 0penBmc\ndescription = Test Config, place your own description of target system here\nforceauth = True\nauthtype = Basic\ntoken = \n\n[Validator]\npayload = \nlogdir = /var/log/redfish-service-validator\noemcheck = True\ndebugging = False\nschema_directory = /usr/lib/redfish-schema-pack\n\n\n```"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc_config.ini",
                    "line": 1,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> http://\n\nhttp is specific to your system you're on.  Upstream runs ssl by default, and so far as I know, on every upstream system.\n\n\nFor the rest of it, can you actually call out the diffs?  You've omitted a bunch of the file, which makes it not immediately applyable to this patch, so it's tough to see what you changed.  Some things you changed need responded to directly, for example, you used Basic auth, which is an anti pattern for running the validator, and shouldn't be done here, but there's nowhere to comment that when you leave bulk comments at the top."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc_config.ini",
                    "line": 1,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "I have cleaned it up a bit to match what we had in here before. The existing options should all match.\n\nIt only provided the number of options in https://github.com/DMTF/Redfish-Service-Validator/blob/bb087bf3aa3caaca7366cd1062a1bcb95025579c/common/config.py#L11-L15\n\nSeems like a lot of the old ones are gone."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc_config.ini",
                    "line": 1,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Cool"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 13,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Just adding some notes on things to do to sync up to `47dbbb304e9af6d576f28548e62bf9a07ec53a1e` (Mostly so I don't loose it).\n\nI didn't want to override this for now.\n\n\nThe build and validator run now, but failing somewhere else. Will need to see why that is the case.\n\n```\nTarget URI: http://localhost:80\nauthtype: Basic\nconfig: /etc/redfish-service-validator/openbmc_config.ini\ndebugging: False\nforceauth: True\nip: http://localhost:80\nlogdir: /var/log/redfish-service-validator\noemcheck: True\npassword: ******\nschema_directory: /usr/lib/redfish-schema-pack\nuricheck: False\nusername: root\nverbose: 1\nStart time: 01/01/70 - 00:04:19\n\nSetting up service...\nException caught while creating Service\nTraceback (most recent call last):\n  File \"/usr/lib/redfish-service-validator/RedfishServiceValidator.py\", line 124, in main\n    currentService = traverse.rfService(vars(args))\n  File \"/usr/lib/redfish-service-validator/common/traverse.py\", line 45, in __init__\n    self.catalog = catalog.SchemaCatalog(self.config['metadatafilepath'])\n  File \"/usr/lib/redfish-service-validator/common/catalog.py\", line 104, in __init__\n    schema = SchemaDoc(f.read(), self, my_name)\n  File \"/usr/lib/redfish-service-validator/common/catalog.py\", line 181, in __init__\n    reftags = edmxTag.find_all(\"edmx:Reference\", recursive=False)\nAttributeError: 'NoneType' object has no attribute 'find_all'\nService could not be started: AttributeError(\"'NoneType' object has no attribute 'find_all'\")\n\n```"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 13,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "If you have things to update this that you've already done locally (like updating the schema pack), feel free to push changes to this review.  I won't be offended."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 13,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Updated and tested. Seems to work for now.\n\nAlso seems like we now have *.ymal files in the folder that I removed to about the error above."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 17,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Need to add redfish-library_3.1.1.bb\n\n```\nSUMMARY = \"DMTF Redfish Library\"\nHOMEPAGE = \"https://github.com/DMTF/python-redfish-library\"\nLICENSE = \"BSD\"\nLIC_FILES_CHKSUM = \"file://LICENSE.md;md5=cee7a7694b5bf14bc9d3e0fbe78a64af\"\n\nSRC_URI[md5sum] = \"9b470d56a07d521b6a439f8651d84535\"\nSRC_URI[sha256] = \"eef72d11b6d6a79073eea8f2832881e14464cb964b8d87313410c064d8bcadd0\"\n\nPYPI_PACKAGE = \"redfish\"\n\ninherit pypi\ninherit setuptools3\n\nBBCLASSEXTEND = \"native nativesdk\"\n\n```"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 17,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Done"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 23,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "```\nRDEPENDS:${PN} = \"\\\n    python3-lxml \\\n    python3-beautifulsoup4 \\\n    python3-requests-toolbelt \\\n    redfish-schema-pack \\\n    redfish-library \\  \n\"\n```"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 23,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Done"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 43,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Do the following instead.\n\n```\ndo_install () {\n    install -d ${D}${libdir}/${PN}\n    install -m 0755 ${S}/RedfishServiceValidator.py ${D}/${libdir}/${PN}\n    install -m 0755 ${S}/RedfishServiceValidatorGui.py ${D}/${libdir}/${PN}\n    install -m 0755 ${S}/schema_pack.py ${D}/${libdir}/${PN}\n    install -m 0755 ${S}/tohtml.py ${D}/${libdir}/${PN}\n    install -m 0755 ${S}/validateRedfish.py ${D}/${libdir}/${PN}\n    install -m 0755 ${S}/validateResource.py ${D}/${libdir}/${PN}\n\n    install -d ${D}${libdir}/${PN}/common\n    install -m 0755 ${S}/common/catalog.py ${D}/${libdir}/${PN}/common\n    install -m 0755 ${S}/common/config.py ${D}/${libdir}/${PN}/common\n    install -m 0755 ${S}/common/helper.py ${D}/${libdir}/${PN}/common\n    install -m 0755 ${S}/common/metadata.py ${D}/${libdir}/${PN}/common\n    install -m 0755 ${S}/common/RedfishLogo.py ${D}/${libdir}/${PN}/common\n    install -m 0755 ${S}/common/schema.py ${D}/${libdir}/${PN}/common\n    install -m 0755 ${S}/common/traverse.py ${D}/${libdir}/${PN}/common\n\n    install -d ${D}${sysconfdir}/${PN}\n    install -m 0755 ${WORKDIR}/openbmc_config.ini ${D}${sysconfdir}/${PN}/\n\n    install -d ${D}${bindir}\n    install -m 0755 ${WORKDIR}/openbmc-redfish-test ${D}${bindir}/openbmc-redfish-test\n}\n```"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 43,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "yeah, looks like they moved some files around.  I really dislike that this calls out every file.  I wonder if we'd be better off with wildcards."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 43,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "I guess we can go wildcards if they don't put random python files, but maybe this is fine for now."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 43,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Alternatively we could just copy the whole folder into somewhere in lib and symlink the required things into /usr/bin\n\nIn a perfect world, we'd fix their package to make it pip installable."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 43,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "> In a perfect world, we'd fix their package to make it pip installable.\n\nYes.  If the upstream is garbage and doesn't properly package, we should try to contribute that upstream.  I've done the same thing for other packages, like libunifex."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 43,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Yep.  I started there, spent a couple hours on it and couldn't make it work.  I need to get back at some point.  I have a couple github bugs out against various weird packaging things that they do that are sub-optimal."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 31,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2020.4.bb",
                    "type": "ADDED",
                    "insertions": 23,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc-redfish-test",
                    "type": "ADDED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/custom-licenses/DMTF-COPYRIGHT",
                    "type": "ADDED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/conf/layer.conf",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc_config.ini",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "type": "ADDED",
                    "insertions": 44,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 138,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "438cf1b3effccb7e478830c68c1d8a2fdeae90f6",
            "parents": [
                "a5170c3e3495fd9ee54aca683bf96ea2f20c33e6"
            ],
            "ref": "refs/changes/82/41082/3",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1644144785,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2021.4.bb",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc-redfish-test",
                    "type": "ADDED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/custom-licenses/DMTF-COPYRIGHT",
                    "type": "ADDED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/conf/layer.conf",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc_config.ini",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "type": "ADDED",
                    "insertions": 49,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-library_3.1.1.bb",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 144,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "8acd78bd277ce050d619a59f2284015003685c6d",
            "parents": [
                "a5170c3e3495fd9ee54aca683bf96ea2f20c33e6"
            ],
            "ref": "refs/changes/82/41082/4",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1644145362,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-library_3.1.1.bb",
                    "line": 6,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Can we drop the md5sum one?  Doesn't seem to provide much benefit."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-library_3.1.1.bb",
                    "line": 6,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "ACK.  \"devtool add\" generates all of these, but I've never really understood why."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-library_3.1.1.bb",
                    "line": 7,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Is this suppose to be 'sha256sum'?"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-library_3.1.1.bb",
                    "line": 7,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "devtool add did this one as well.  I see a couple openembedded recipies that use sha256, so maybe the lookup is fuzzier than we think?  With that said, yeah, I can change this to be more consistent.\n\nACK."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2021.4.bb",
                    "line": 10,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Yikes.  Can we pick one?"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2021.4.bb",
                    "line": 10,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "ACK.  devtool add again."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2021.4.bb",
                    "line": 12,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Does this need native or is native implied by allarch?"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2021.4.bb",
                    "line": 12,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "My understanding was that allarch was a more strict form than native, ie \"the binaries produced by this recipe are common for all targets\" which, because this is basically just installing some files, seems true.\n\nConsidering that I'd like the ability to install these files on the BMC, I don't think native would apply here, or maybe I'm not understanding what native means.  I thought it meant \"just for the build machine\"."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2021.4.bb",
                    "line": 21,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "oh wait. there is only yaml files in here. If I install the yaml file in that folder it will fail. Not sure why it didn't fail before.\n\n```\nSetting up service...\nException caught while creating Service\nTraceback (most recent call last):\n  File \"/usr/lib/redfish-service-validator/RedfishServiceValidator.py\", line 124, in main\n    currentService = traverse.rfService(vars(args))\n  File \"/usr/lib/redfish-service-validator/common/traverse.py\", line 45, in __init__\n    self.catalog = catalog.SchemaCatalog(self.config['metadatafilepath'])\n  File \"/usr/lib/redfish-service-validator/common/catalog.py\", line 104, in __init__\n    schema = SchemaDoc(f.read(), self, my_name)\n  File \"/usr/lib/redfish-service-validator/common/catalog.py\", line 181, in __init__\n    reftags = edmxTag.find_all(\"edmx:Reference\", recursive=False)\nAttributeError: 'NoneType' object has no attribute 'find_all'\nService could not be started: AttributeError(\"'NoneType' object has no attribute 'find_all'\")\n```\n\nShould we just install the `xml` files in csdl?"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2021.4.bb",
                    "line": 21,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "by \"just\" I'm assuming you mean \"don't install the openapi\"?\n\nFor some reason I thought there were tools that used openapi, hence why I installed them, but I don't recall which tools they are at the moment."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2021.4.bb",
                    "line": 21,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "yeah, I believe there are only yaml files in openapi. Don't think there are any tools in it."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 7,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "`branch=...;protocol=https`\n\nprotocol=ssh requires keys which is bad for automation."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 7,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "ACK"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 22,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "trailing whitespace"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 22,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I would like to go on record and official blame Willy for this one;  My original patch didn't have this whitespace issue.  \ud83d\ude0a\n\nACK will fix."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 22,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "oops. should I push a patch to fix it, or are you pushing one?"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 22,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Probably doesn't make sense to push a patch to fix JUST the whitespace issue.  I'm not going to look at this until late next week at the earliest, so whomever makes improvements to this next can just fix the whitespace as part of the next patch."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 22,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Ack.\n\nOops. I 100% do that regularly... probably a bad habit."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 22,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "If you do, it's ok, just make sure that you point out the stuff you DIDN'T fix in the newest patchset so the maintainer doesn't have to review it again."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 25,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Might be good to contribute a setup.py (or some other python packaging) upstream.  This is kind of atrocious."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "line": 25,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I looked into it and tried to write some for what should've been \"easy\";  Didn't get very far because of the way they have their repo laid out is not very standard, and setuptools choked on it a bit.  It's for sure on my list to get back to so I can pip install these things locally at some point.  Agreed, this is awful."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-schema-pack_2021.4.bb",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc-redfish-test",
                    "type": "ADDED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/custom-licenses/DMTF-COPYRIGHT",
                    "type": "ADDED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/conf/layer.conf",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator/openbmc_config.ini",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-service-validator_git.bb",
                    "type": "ADDED",
                    "insertions": 49,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/interfaces/redfish-library_3.1.1.bb",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 145,
            "sizeDeletions": 0
        }
    ]
}