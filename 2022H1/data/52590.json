{
    "project": "openbmc/host-error-monitor",
    "branch": "master",
    "id": "I1bd94fe8bdf2fed0a48c46139a1c7afd195f9d0c",
    "number": 52590,
    "subject": "Add CPU missing event",
    "owner": {
        "name": "vasuvgithub",
        "email": "vasu.v@intel.com",
        "username": "vasuvgithub"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/host-error-monitor/+/52590",
    "commitMessage": "Add CPU missing event\n\nBeep code (1-5-2-1) needs to trigger, if the CPU1 (Base CPU) is not present.\n\nAdded an error monitor for CPU Presence to check the beep signal needs to be raise,\nif the CPU1 is not present in the socket.\nUser needs to hear the beep sound if the system boots without CPU1 (Base CPU) presence.\n\nTested:\n    1. Beep sound is raised if the CPU1 is not present.\n\nSigned-off-by: Vasu V <vasu.v@intel.com>\nChange-Id: I1bd94fe8bdf2fed0a48c46139a1c7afd195f9d0c\n",
    "createdOn": 1649050000,
    "lastUpdated": 1650992825,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1649050000,
            "reviewer": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1649050027,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649050028,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1649050551,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/40390/ : SUCCESS"
        },
        {
            "timestamp": 1649098755,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Patch Set 1:\n\n(3 comments)"
        },
        {
            "timestamp": 1649358889,
            "reviewer": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1649358903,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649358903,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1649358931,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/40748/ : SUCCESS"
        },
        {
            "timestamp": 1649359309,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1649360648,
            "reviewer": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1649360658,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649360658,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1649360695,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/40756/ : SUCCESS"
        },
        {
            "timestamp": 1649361354,
            "reviewer": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1649361364,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649361364,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1649361393,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/40764/ : SUCCESS"
        },
        {
            "timestamp": 1649361868,
            "reviewer": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1649361878,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649361878,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1649361907,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/40766/ : FAILURE"
        },
        {
            "timestamp": 1649362902,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5:\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/40768/ : FAILURE"
        },
        {
            "timestamp": 1649363098,
            "reviewer": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1649363109,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649363109,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1649363138,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/40769/ : SUCCESS"
        },
        {
            "timestamp": 1649434504,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Patch Set 6: Code-Review+2\n\n(1 comment)"
        },
        {
            "timestamp": 1650992825,
            "reviewer": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "message": "Change has been successfully merged"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "dc78113002c106e230af72cdfd4e8e5cdfb956ff",
            "parents": [
                "779e1f8b6adb9516299e471aececc80993a51cb8"
            ],
            "ref": "refs/changes/90/52590/1",
            "uploader": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "createdOn": 1649050000,
            "author": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "include/error_monitors/base_cpu_monitor.hpp",
                    "line": 0,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "The name `base_cpu_monitor` may be confusing with the the other `base` files that are designed as base classes.  Can we just call this `cpu_presence_monitor` or `cpu_missing_monitor`?"
                },
                {
                    "file": "include/error_monitors/base_cpu_monitor.hpp",
                    "line": 34,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "If this becomes a generic \"CPU Presence\" or \"CPU Missing\" monitor, you would want to report the CPU number in the error message.\n\nAlso, it may be better to report \"CPU x missing\" as the message."
                },
                {
                    "file": "include/error_monitors/base_cpu_monitor.hpp",
                    "line": 97,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "This currently will only check CPU presence once when the BMC boots.  If it needs to check each time the host tries to boot, you will need to re-check CPU presence in the hostOn() function.  You can see how it's done in the CPU mismatch monitor here: https://github.com/openbmc/host-error-monitor/blob/master/include/error_monitors/cpu_mismatch_monitor.hpp#L108."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/error_monitors/base_cpu_monitor.hpp",
                    "type": "ADDED",
                    "insertions": 100,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 119,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "57cf305bb79998bc9f7b0f5826c50ecab6266328",
            "parents": [
                "779e1f8b6adb9516299e471aececc80993a51cb8"
            ],
            "ref": "refs/changes/90/52590/2",
            "uploader": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "createdOn": 1649358889,
            "author": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "include/error_monitors/cpu_presence_monitor.hpp",
                    "line": 38,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "This would still need to be the full message to display correctly in Redfish.  If you save the \"CPU x missing\" string from line 35 as std::string msg, then you can change this back to 'msg.c_str()' to correctly display it in Redfish."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/error_monitors/cpu_presence_monitor.hpp",
                    "type": "ADDED",
                    "insertions": 106,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 125,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "10e3aabfbab315c133200444fa7b40cc09e6fc09",
            "parents": [
                "779e1f8b6adb9516299e471aececc80993a51cb8"
            ],
            "ref": "refs/changes/90/52590/3",
            "uploader": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "createdOn": 1649360648,
            "author": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/error_monitors/cpu_presence_monitor.hpp",
                    "type": "ADDED",
                    "insertions": 109,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 128,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "190acfb3bce18b321c476ae688cb71f6204ec6f2",
            "parents": [
                "779e1f8b6adb9516299e471aececc80993a51cb8"
            ],
            "ref": "refs/changes/90/52590/4",
            "uploader": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "createdOn": 1649361354,
            "author": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/error_monitors/cpu_presence_monitor.hpp",
                    "type": "ADDED",
                    "insertions": 107,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 126,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "8caabe45e711daecd5187e179f550d10fc1672ef",
            "parents": [
                "779e1f8b6adb9516299e471aececc80993a51cb8"
            ],
            "ref": "refs/changes/90/52590/5",
            "uploader": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "createdOn": 1649361868,
            "author": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/error_monitors/cpu_presence_monitor.hpp",
                    "type": "ADDED",
                    "insertions": 108,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 127,
            "sizeDeletions": 0
        },
        {
            "number": 6,
            "revision": "57f47c44128222beb859ad9d63e9caf0c702b300",
            "parents": [
                "779e1f8b6adb9516299e471aececc80993a51cb8"
            ],
            "ref": "refs/changes/90/52590/6",
            "uploader": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "createdOn": 1649363098,
            "author": {
                "name": "vasuvgithub",
                "email": "vasu.v@intel.com",
                "username": "vasuvgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "Looks good to me.  It only checks the presence GPIO on boot, but this should be okay as CPU presence is not expected to change while the system is running.  This can be adjusted if that case needs to be handled."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/error_monitors/cpu_presence_monitor.hpp",
                    "type": "ADDED",
                    "insertions": 108,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 127,
            "sizeDeletions": 0
        }
    ]
}