{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I5ce64ebde9789b900daaca6e84554351b35dfbad",
    "number": 51932,
    "subject": "Prevent error when occ-control server not available",
    "owner": {
        "name": "Chris Cain",
        "email": "cjcain@us.ibm.com",
        "username": "cjcain"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/51932",
    "commitMessage": "Prevent error when occ-control server not available\n\nThe Power.Mode and Power.IdlePowerSaver data is only available when the\nocc-control service is running. During a BMC reboot the service may\ntemporarly not be available so this data can not be provided.\n\nRedfish clients would bet getting internalErrors when the power data is\nnot available. This change will allow the other system data to be returned.\n\nChange-Id: I5ce64ebde9789b900daaca6e84554351b35dfbad\nSigned-off-by: Chris Cain <cjcain@us.ibm.com>\n",
    "createdOn": 1647041892,
    "lastUpdated": 1648069769,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1647041892,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1647041911,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1647041911,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1647042491,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/38872/ : SUCCESS"
        },
        {
            "timestamp": 1647099965,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1647262892,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1647262896,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1647262928,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1647262928,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1647263513,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/38922/ : SUCCESS"
        },
        {
            "timestamp": 1647271743,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1647421432,
            "reviewer": {
                "name": "Krzysztof Grobelny",
                "email": "krzysztof.grobelny@intel.com",
                "username": "krzysztof-i"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1647451339,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1648068971,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1648069146,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1648069159,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1648069160,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1648069769,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/39580/ : SUCCESS"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "a69f6753d169e6b127df41325560cedcc6425d26",
            "parents": [
                "1b829889db64dd738660e62de633f1c028b3444c"
            ],
            "ref": "refs/changes/32/51932/1",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1647041892,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 1933,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "?  the other diffs look ok, but I'm not sure why we're removing this.  If we get a PowerMode that's outside the dbus interfaces, we should still return an internal error, correct?"
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 1933,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 30,
            "sizeDeletions": 1
        },
        {
            "number": 2,
            "revision": "3f9acb6334907f72b9dd7bc03bfee561c7b108a1",
            "parents": [
                "c5114a57c5460916141260b5d31680f82fdda324"
            ],
            "ref": "refs/changes/32/51932/2",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1647262896,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "Can we add a bit more about these properties being not required, not important, why it is acceptable these not be there? And why occ-control service might not available? bmcweb does not have a dependency on it, so could it not be up yet but bmcweb is?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "Done"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "Let's describe this in terms of Redfish clients. Not use the word HMC since it doesn't buy anything.\n\nA management Redish client has seen internalErrors when the occ-control service is unreachable."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "Done"
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 2002,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "I am struggling a bit here on when we should return an internal error and when we should not. These were found by the mapper it is just when we go to the service, it returns a host_unreachable.\n\nSo do we think all non-required properties should *not* return an error on host_unreachable? There is very few required properties in Redfish. \n\nDo we think all non-important, non-required properties should not return an error on host_unreachable? \nSo a property like powerstate if it gets a host_unreachable then return an error but LastResetTime and properties like PowerModes if it gets a host_unreachable, just ignore and leave off the response?\n\nNot sure this should guide us but like the OCP profile (the OCP profiles are outdated at this point, just a data point on possible importance to a Redfish client) expects PowerState but not any of these. \n\nhttps://github.com/opencomputeproject/HWMgmt-OCP-Profiles/blob/master/OCPRackManagerController.v1_0_1.json#L426"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 30,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "8201b126df4ad8c0ce8f50338d1243a4ffaf87df",
            "parents": [
                "1c30e500c6f234ed53a8aa84f0f367e5d90eb02f"
            ],
            "ref": "refs/changes/32/51932/3",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1648069146,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 22,
            "sizeDeletions": 5
        }
    ]
}