{
    "project": "openbmc/bios-bmc-smm-error-logger",
    "branch": "main",
    "id": "I1c34a40bd279ee601de33669aabfec27a959ec44",
    "number": 54604,
    "subject": "buffer: Implement \"updateReadPtr\"",
    "owner": {
        "name": "Brandon Kim",
        "email": "brandonkim@google.com",
        "username": "brandonkimbk"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bios-bmc-smm-error-logger/+/54604",
    "commitMessage": "buffer: Implement \"updateReadPtr\"\n\nThis is a helper function for reading the circular buffer\n\nTested: Unit tested\n\nSigned-off-by: Brandon Kim <brandonkim@google.com>\nChange-Id: I1c34a40bd279ee601de33669aabfec27a959ec44\n",
    "createdOn": 1655317317,
    "lastUpdated": 1655343567,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1655317317,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1655317385,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1655317536,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1655317541,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1655317624,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/45088/ : SUCCESS"
        },
        {
            "timestamp": 1655318048,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 1: Code-Review+1"
        },
        {
            "timestamp": 1655319070,
            "reviewer": {
                "name": "Kasun Athukorala",
                "email": "kasunath@google.com",
                "username": "kasunathg"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1655323771,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1655326283,
            "reviewer": {
                "name": "Kasun Athukorala",
                "email": "kasunath@google.com",
                "username": "kasunathg"
            },
            "message": "Patch Set 1: Code-Review+1"
        },
        {
            "timestamp": 1655328246,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 2: Patch Set 1 was rebased."
        },
        {
            "timestamp": 1655328284,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1655328284,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1655328361,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/45112/ : SUCCESS"
        },
        {
            "timestamp": 1655330588,
            "reviewer": {
                "name": "Nikhil Namjoshi",
                "email": "nikhilnamjoshi@google.com",
                "username": "namjoshiniks"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1655332682,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 3: Patch Set 2 was rebased"
        },
        {
            "timestamp": 1655332713,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1655332713,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1655332792,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/45119/ : SUCCESS"
        },
        {
            "timestamp": 1655342854,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1655343567,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Change has been successfully rebased and submitted as cf0b9752a18926b08453d53b307ca04c243449d6"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "ab5a9754ff5ad91e10a7874c74fa8dd0489c3cc3",
            "parents": [
                "17ee1a93779feba7794d17fdf5d84267f3ad2056"
            ],
            "ref": "refs/changes/04/54604/1",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1655317317,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "This will go underneath readEntryHeader commit https://gerrit.openbmc.org/c/openbmc/bios-bmc-smm-error-logger/+/54367 (as well as one more helper function) "
                },
                {
                    "file": "src/buffer.cpp",
                    "line": 88,
                    "reviewer": {
                        "name": "Kasun Athukorala",
                        "email": "kasunath@google.com",
                        "username": "kasunathg"
                    },
                    "message": "since you are truncating this, why not use uint16_t"
                },
                {
                    "file": "src/buffer.cpp",
                    "line": 88,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "I thought I'd do an explicit truncation since the offset that we'd be passing this in (will come up with the next CL where we use this) is a uint32_t. offset should only be up to 16 bit, but I used uint32_t to avoid overflow calculation."
                },
                {
                    "file": "src/buffer.cpp",
                    "line": 108,
                    "reviewer": {
                        "name": "Kasun Athukorala",
                        "email": "kasunath@google.com",
                        "username": "kasunathg"
                    },
                    "message": "Is this the only place you are updating the bmcReadPtr? \n\nDo you think it would be useful to have a dedicated function to update cachedBufferHeader members? Or else we need to make sure to remember to convert to little endian every time we update a cachedBufferHeader member"
                },
                {
                    "file": "src/buffer.cpp",
                    "line": 108,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Yes, besides the header read where all the header gets updated, this will be the only place that the cachedBufferHeader.bmcReadPtr gets updated. The other use cases where we would write is to flag the fault registers, which are single bytes and endianness shouldn't matter. I think this is ok for now, but agreed that we may want a dedicated function in the future if we find that there's other instances where we may forget to update the cached header."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "include/buffer.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/buffer.cpp",
                    "type": "MODIFIED",
                    "insertions": 24,
                    "deletions": 0
                },
                {
                    "file": "test/buffer_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 77,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "4619afc362bbae62668181c02788f7c20cd905ec",
            "parents": [
                "d74608bdf1252ae6a54a690ee9f73117f90b7f8b"
            ],
            "ref": "refs/changes/04/54604/2",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1655328246,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "include/buffer.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/buffer.cpp",
                    "type": "MODIFIED",
                    "insertions": 24,
                    "deletions": 0
                },
                {
                    "file": "test/buffer_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 77,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "bd333946a6f45b6bae18df1f52cffb008fc6d0b0",
            "parents": [
                "282eaab4e77b848b411deed8b7e199087e85d4dd"
            ],
            "ref": "refs/changes/04/54604/3",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1655332682,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "include/buffer.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/buffer.cpp",
                    "type": "MODIFIED",
                    "insertions": 24,
                    "deletions": 0
                },
                {
                    "file": "test/buffer_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 77,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "cf0b9752a18926b08453d53b307ca04c243449d6",
            "parents": [
                "60cab57f94a1ceab6e346f9732e939e2866c11f1"
            ],
            "ref": "refs/changes/04/54604/4",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1655343567,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "include/buffer.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/buffer.cpp",
                    "type": "MODIFIED",
                    "insertions": 24,
                    "deletions": 0
                },
                {
                    "file": "test/buffer_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 77,
            "sizeDeletions": 0
        }
    ]
}