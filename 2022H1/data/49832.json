{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I095d37d429b4974caee6b50224b58e171e0e85b0",
    "number": 49832,
    "subject": "Enable EnvironmentMetrics schema for memory",
    "owner": {
        "name": "Patryk Ciszewski",
        "email": "patryk.ciszewski@intel.com",
        "username": "pciszews"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/49832",
    "commitMessage": "Enable EnvironmentMetrics schema for memory\n\nChanges:\n- additional routing {memory_device<id>}/EnvironmentMetrics\nstoring media temperature data\n\nTested:\n- tested if correct data is being displayed in redfish\non 2 platforms with different memory configurations\n- cold reboot\n- bmc reboot\n- sevice reboot\n\nChange-Id: I095d37d429b4974caee6b50224b58e171e0e85b0\nSigned-off-by: Patryk Ciszewski <patryk.ciszewski@intel.com>\n",
    "createdOn": 1640007041,
    "lastUpdated": 1641300016,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1640007041,
            "reviewer": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1640007059,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1640007098,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/32269/ : FAILURE"
        },
        {
            "timestamp": 1640009996,
            "reviewer": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1640094962,
            "reviewer": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1640094985,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1640095027,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/32319/ : FAILURE"
        },
        {
            "timestamp": 1640095664,
            "reviewer": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1640095700,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1640095742,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/32320/ : FAILURE"
        },
        {
            "timestamp": 1640095989,
            "reviewer": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1640096005,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1640096043,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/32322/ : FAILURE"
        },
        {
            "timestamp": 1640096371,
            "reviewer": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1640096386,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1640096748,
            "reviewer": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1640096762,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/32323/ : FAILURE"
        },
        {
            "timestamp": 1640097402,
            "reviewer": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1640097422,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1640097459,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/32324/ : FAILURE"
        },
        {
            "timestamp": 1640098750,
            "reviewer": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1640098772,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1640099237,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/32325/ : SUCCESS"
        },
        {
            "timestamp": 1640303290,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1640303713,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 7:\n\n(4 comments)"
        },
        {
            "timestamp": 1640308311,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 7:\n\n(12 comments)"
        },
        {
            "timestamp": 1640308343,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1641300016,
            "reviewer": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "message": "Set Work In Progress"
        }
    ],
    "wip": true,
    "patchSets": [
        {
            "number": 1,
            "revision": "6c78319bf6f74e39de2aa62e3d275bc7f9698258",
            "parents": [
                "af4edf686e684d728fccbb69a8f550fd2adab46a"
            ],
            "ref": "refs/changes/32/49832/1",
            "uploader": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "createdOn": 1640007041,
            "author": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "type": "ADDED",
                    "insertions": 130,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "b93ceaf771c5f204372e712c25d53697eb5acd92",
            "parents": [
                "af4edf686e684d728fccbb69a8f550fd2adab46a"
            ],
            "ref": "refs/changes/32/49832/2",
            "uploader": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "createdOn": 1640094962,
            "author": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "type": "ADDED",
                    "insertions": 135,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 158,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "c767dd844b2255db04fa6176f486aefee5155f00",
            "parents": [
                "af4edf686e684d728fccbb69a8f550fd2adab46a"
            ],
            "ref": "refs/changes/32/49832/3",
            "uploader": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "createdOn": 1640095664,
            "author": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "type": "ADDED",
                    "insertions": 149,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 172,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "89cd96799b3bcbb00a63336560013fc36576b7a1",
            "parents": [
                "af4edf686e684d728fccbb69a8f550fd2adab46a"
            ],
            "ref": "refs/changes/32/49832/4",
            "uploader": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "createdOn": 1640095989,
            "author": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "type": "ADDED",
                    "insertions": 150,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 173,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "27a703ed82c1d49aac019f7a12757210e6b841b1",
            "parents": [
                "af4edf686e684d728fccbb69a8f550fd2adab46a"
            ],
            "ref": "refs/changes/32/49832/5",
            "uploader": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "createdOn": 1640096371,
            "author": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "type": "ADDED",
                    "insertions": 150,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 173,
            "sizeDeletions": 0
        },
        {
            "number": 6,
            "revision": "58f742a8bd07acc3f3d32811bdeedd43b8719d0d",
            "parents": [
                "af4edf686e684d728fccbb69a8f550fd2adab46a"
            ],
            "ref": "refs/changes/32/49832/6",
            "uploader": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "createdOn": 1640097402,
            "author": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "type": "ADDED",
                    "insertions": 150,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 173,
            "sizeDeletions": 0
        },
        {
            "number": 7,
            "revision": "4ba4b4f5da140066d259552a8b54c3e4d4693c38",
            "parents": [
                "af4edf686e684d728fccbb69a8f550fd2adab46a"
            ],
            "ref": "refs/changes/32/49832/7",
            "uploader": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "createdOn": 1640098750,
            "author": {
                "name": "Patryk Ciszewski",
                "email": "patryk.ciszewski@intel.com",
                "username": "pciszews"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Why is this useful?\nWhat interfaces does this use?\nAre there any dependent commits?\n\nPlease answer in your commit message."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 14,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "What is \"correct data\"?  What APIs did you test specifically?\n\nI see no matching additional reference in the /redfish/v1/Systems/system/Memory/<str> route handler, which means this wont show up in the redfish tree, and won't work as designed for any \"real\" redfish client.  Please be more specific about how you tested this, because it seems you need to improve your testing procedure a bit, but given this abstract statement, it's difficult for us to give you advice as to how to improve it."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 19,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "Refish Validator ?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 19,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "+1"
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 2,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "It is 2021.. Do you really need this? These tend not to get updated"
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 2,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "+1.  at the very least get the year right, and ideally we should drop these entirely."
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 30,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please use dbus::utility::DbusVariantType for this."
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 32,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please use the existing types for this."
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 40,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I see no calls to find here.  There's no need for these to be maps.  Std::vector<std::pair please."
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 79,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "I don't see this in PDI, this up for review somewhere?"
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 79,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "+1.  This also seems like a very odd API to be using, given that it's clearly overloading the sensor system.  I suspect for dbus we'd prefer a sensor with an association back to the dimm called \"media temperature\" or possibly \"component temperature\" if this has utility outside of this code."
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 81,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "Typically don't use auto here"
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 83,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "More common that I see a internalError and a return"
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 85,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This is 9 code scopes deep.  Please break up your code appropriately into methods."
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 93,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This assumes that the media temperature interface is exposed by the same daemon that exposes the inventory item.  This is almost never the case, and I'm a little surprised it is in your case."
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 95,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please read a specific interface."
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 97,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please remove this variable.  Simply return here, given there's no need to continue looping once you've found the parameter you're looking for."
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "line": 145,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please read and understand the COMMON_ERRORS.md document.  You've missing one significant one in not handling 404 properly.  There should be no properties present in a 404 return code."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/environment_metrics.hpp",
                    "type": "ADDED",
                    "insertions": 150,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 173,
            "sizeDeletions": 0
        }
    ]
}