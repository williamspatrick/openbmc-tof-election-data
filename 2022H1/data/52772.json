{
    "project": "openbmc/intel-ipmi-oem",
    "branch": "master",
    "id": "I74e6e4270523a9abb020745bf4b93b4411bce597",
    "number": 52772,
    "subject": "Add MAC to FRU EEPROM",
    "owner": {
        "name": "Zhikui Ren",
        "email": "zhikui.ren@intel.com",
        "username": "ZhikuiRen"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/intel-ipmi-oem/+/52772",
    "commitMessage": "Add MAC to FRU EEPROM\n\nIf FRU device and MAC offset configuration is found from entity-manager,\nSet MAC command writes MAC to the FRU eeprom.\n\nIf FRU device config is not found or write to the device failed, MAC is\nprogrammed using the existing method.\n\nTested:\nissue ipmi command to write and read MAC\n\n1. On system has the FRU EEPROM, MAC is programmed to the eeprom correctly.\n\t#read MAC\n\tipmitool raw 0x30 0xa2 0\n \t 01 ff ff ff ff ff ff\n\t#write MAC\n\tipmitool raw 0x30 0xa1 0x00 0x16 0xc1 0x5f 0xb9 0x43 0x47\n\t#read MAC\n\tipmitool raw 0x30 0xa2 0\n\t 01 16 c1 5f b9 43 47\n\n2. On system that the eeprom is write protected, return as follow\n\t#read MAC\n\tipmitool raw 0x30 0xa2 0\n\t01 ff ff ff ff ff ff\n\t#write MAC\n\tipmitool raw 0x30 0xa1 0x0 0xbe 0x7f 0x17 0xff 0x59 0x7e\n\tUnable to send RAW command (channel=0x0 netfn=0x30 lun=0x0 cmd=0xa1 rsp=0xd5): Command not supported in present state\n\t#read MAC\n\tipmitool raw 0x30 0xa2 0\n\t 01 ff ff ff ff ff ff\n\n3. On system that does not has FRU EEPROM, MAC is programmed the same\nway as before into filesystem.\n\nSigned-off-by: Zhikui Ren <zhikui.ren@intel.com>\nChange-Id: I74e6e4270523a9abb020745bf4b93b4411bce597\n",
    "createdOn": 1649453515,
    "lastUpdated": 1651615496,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1649453515,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1649453534,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649453534,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1649453577,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/40848/ : FAILURE"
        },
        {
            "timestamp": 1649453587,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1649453898,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1649453910,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649453910,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1649454488,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/40849/ : FAILURE"
        },
        {
            "timestamp": 1649456341,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1649456355,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649456355,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1649456640,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/40855/ : SUCCESS"
        },
        {
            "timestamp": 1649785630,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1649785643,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1649785643,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1649785918,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/41074/ : SUCCESS"
        },
        {
            "timestamp": 1649889945,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1650490094,
            "reviewer": {
                "name": "Johnathan Mantey",
                "email": "johnathanx.mantey@intel.com",
                "username": "Howitzer105mm"
            },
            "message": "Patch Set 4:\n\n(12 comments)"
        },
        {
            "timestamp": 1650668330,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1650668344,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1650668344,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1650668631,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/41911/ : SUCCESS"
        },
        {
            "timestamp": 1650669072,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1650669084,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1650669084,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1650669092,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 6:\n\n(11 comments)"
        },
        {
            "timestamp": 1650669363,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/41912/ : SUCCESS"
        },
        {
            "timestamp": 1650996797,
            "reviewer": {
                "name": "Johnathan Mantey",
                "email": "johnathanx.mantey@intel.com",
                "username": "Howitzer105mm"
            },
            "message": "Patch Set 6:\n\n(5 comments)"
        },
        {
            "timestamp": 1651082943,
            "reviewer": {
                "name": "Johnathan Mantey",
                "email": "johnathanx.mantey@intel.com",
                "username": "Howitzer105mm"
            },
            "message": "Patch Set 6:\n\n(2 comments)"
        },
        {
            "timestamp": 1651121644,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1651121655,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1651121655,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: -Ok-To-Test"
        },
        {
            "timestamp": 1651121946,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/42149/ : SUCCESS"
        },
        {
            "timestamp": 1651169382,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Uploaded patch set 8."
        },
        {
            "timestamp": 1651169394,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1651169394,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: -Ok-To-Test"
        },
        {
            "timestamp": 1651169648,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/42231/ : SUCCESS"
        },
        {
            "timestamp": 1651175975,
            "reviewer": {
                "name": "Johnathan Mantey",
                "email": "johnathanx.mantey@intel.com",
                "username": "Howitzer105mm"
            },
            "message": "Patch Set 8:\n\n(4 comments)"
        },
        {
            "timestamp": 1651185617,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Uploaded patch set 9."
        },
        {
            "timestamp": 1651185630,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1651185630,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: -Ok-To-Test"
        },
        {
            "timestamp": 1651185637,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 8:\n\n(3 comments)"
        },
        {
            "timestamp": 1651185922,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/42247/ : SUCCESS"
        },
        {
            "timestamp": 1651188516,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Uploaded patch set 10: Commit message was updated."
        },
        {
            "timestamp": 1651520925,
            "reviewer": {
                "name": "Johnathan Mantey",
                "email": "johnathanx.mantey@intel.com",
                "username": "Howitzer105mm"
            },
            "message": "Patch Set 10: Code-Review+1"
        },
        {
            "timestamp": 1651614512,
            "reviewer": {
                "name": "Vernon Mauery",
                "email": "vernon.mauery@linux.intel.com",
                "username": "vmauery"
            },
            "message": "Patch Set 10: Code-Review+2"
        },
        {
            "timestamp": 1651615496,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Change has been successfully rebased and submitted as ad129c6891247da7ca707a59e02c36cc1fd3e8a5"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "7e9c84b064cc9f994bc46ab5c2de41d94259129e",
            "parents": [
                "c42c7ede932b1960a83eac3676d6ef0cb1e7b22f"
            ],
            "ref": "refs/changes/72/52772/1",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1649453515,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 154,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 171,
            "sizeDeletions": 10
        },
        {
            "number": 2,
            "revision": "b5d574290d15975b5cecc871c5eddc256f85400c",
            "parents": [
                "c42c7ede932b1960a83eac3676d6ef0cb1e7b22f"
            ],
            "ref": "refs/changes/72/52772/2",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1649453898,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 155,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 172,
            "sizeDeletions": 10
        },
        {
            "number": 3,
            "revision": "1dc32bdfbf6d5a2afda40c49875ceff76abc0091",
            "parents": [
                "c42c7ede932b1960a83eac3676d6ef0cb1e7b22f"
            ],
            "ref": "refs/changes/72/52772/3",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1649456341,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 146,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 163,
            "sizeDeletions": 10
        },
        {
            "number": 4,
            "revision": "4fd9710c2230a9d47f5a7db05db6e9ce2d766e99",
            "parents": [
                "c42c7ede932b1960a83eac3676d6ef0cb1e7b22f"
            ],
            "ref": "refs/changes/72/52772/4",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1649785630,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "I have a few recommendations I'd like to see applied."
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 849,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "Is it possible to perform a find() on the 'fru'?\nIs there ever going to be more than one 'intf' that matches?"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 849,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Currently there is no good field within FRU field to match against. Motherboard interface properties are used to keep it loosely coupled with FRU content. This can later be improved to also support using MAC address field within FRU structure."
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 849,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 868,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "Change to phosphor::logging style.\n\nIf this condition is met is there any merit in trying to 'continue'?"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 868,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Good point, return false here.\nDone"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 891,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "This isn't exactly 'error' level logging. Perhaps this should be a phosphor::log::INFO message? I'd say this is ::DEBUG level, but recent experience shows ::DEBUG logging vanishes."
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 891,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 894,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "What is 'dataType'? Is there some more descriptive variable name that can be applied to clarify what this is doing? After reading the rest of this code it appears to be a nicIndex. Change the name to indicate it indexes which NIC is being used?\n\nConfirm macOffset is never greater than 64Ki-maxEthSize-1?"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 894,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "dataType is what used by existing code. Changed to macIndex for the new function"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 923,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "Same logging comment as before."
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 923,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 926,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "verify macOffset bounds.\nEnsure macOffset leaves space for maxEthSize data bytes to be written. I2C devices have a habit of allowing wrap around accesses. We don't want to overwrite data we're not supposed to touch."
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 926,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 939,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "return (ipmi::i2CWriteRead() == ipmi::ccSuccess)?"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 939,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 949,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "should this be a reference type?"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 949,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "This is existing code. Improvement can be done in a separate patch"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 949,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 953,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "See my comment below, I recommend:\n\nuint8_t nicIndex = dataType & 0x3;\nbool writeFRU = dataType & 0x80;\nif (nicIndex >= maxSupportedEth)"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 953,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "existing code, improvement will be done in a separate patch"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 953,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 961,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "I'm not in favor of blindly writing the FRU. The target of the MAC address should not rely on odd side-effects to determine where the MAC address is written. I would like to suggest embedding the desired location into the 'dataType' variable.\n\nI recommend reserving bit 7 of 'dataType' to be a flag indicating the FRU is to be written, else the SOFS is to be written. Does it make sense to reserve bits 6-2? BMC's have only had access to fewer than 4 NICs.\n\nThus this would become:\nif (writeFRU) {\n  return   writeMacToFRU() ? IPMISuccess : IPMIFail;\n}\n\n// Write SOFS"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 961,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "The command structure is part of IPMI spec. Make the write location transparent to the IPMI command allows different platform to control the behavior through configuration based on actual hardware config."
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 961,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "I don't understand your response. Isn't this an OEM command? As such it's ours to define.\nThe dataType variable has been defined, by Intel, to be an index (0-255) within the EEPROM to write the ethData (i.e. MAC addr) payload.\nWe currently limit it to a range of 0-1.\nThe BMC is never going to control upwards of 256 NICs.\nWe can use dataType to be smarter about how we interact with the EEPROM/SOFS. I want explicit control of where the ethData is being written.\n\nI'm recommending:\nstruct fruCommand {\nuint1_t writeFRU;\nuint5_t reserved;\nuint2_t nicIndex;\n};\n\nstruct fruCommand fruData = static_cast<strct fruCommand>(dataType);\nif (frudate.writeFRU) {\n   return writeMacToFru(ctx, fruData.nicIndex, ethData) ? success : fail;\n}"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 1012,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "else return ipmi::responseSuccess(invalidData, ethData); ?\n\nIf reading from the file and the FRU doesn't work shouldn't this error out?"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 1012,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Good catch!"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 148,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 165,
            "sizeDeletions": 10
        },
        {
            "number": 5,
            "revision": "3ae7fd76a0f4c2eeafff30a06fab197ccbff9136",
            "parents": [
                "c42c7ede932b1960a83eac3676d6ef0cb1e7b22f"
            ],
            "ref": "refs/changes/72/52772/5",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1650668330,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 157,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 174,
            "sizeDeletions": 10
        },
        {
            "number": 6,
            "revision": "263a671adbf8fa025185feffe2c3f0051ef17078",
            "parents": [
                "c42c7ede932b1960a83eac3676d6ef0cb1e7b22f"
            ],
            "ref": "refs/changes/72/52772/6",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1650669072,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "Can you clarify what you mean when you mention the command is IPMI spec?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "It appears you will need better information about the failure state of \"writeFRU\" or you are going to get undesired SOFS write events."
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 921,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "I recommend changing the return type.\nUse an IPMI return type instead to give better information to the caller.\nYou can return \nipmi::ccSuccess\nwhatever cc \"Device is in invalid state\" when the write protect is asserted\nthe cc for \"out of range\" when the offset is wrong or an invalid eth num\nand a cc indicating the EEPROM could not be accessed, which can then be used to switch to SOFS storage."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 157,
                    "deletions": -9
                }
            ],
            "sizeInsertions": 174,
            "sizeDeletions": 9
        },
        {
            "number": 7,
            "revision": "c6dd20d5020bcf976412fadb227d214f506165ec",
            "parents": [
                "c42c7ede932b1960a83eac3676d6ef0cb1e7b22f"
            ],
            "ref": "refs/changes/72/52772/7",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1651121644,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 168,
                    "deletions": -9
                }
            ],
            "sizeInsertions": 185,
            "sizeDeletions": 9
        },
        {
            "number": 8,
            "revision": "fd5e5ba0f2407f1f3f21aca941616751b8f29553",
            "parents": [
                "c42c7ede932b1960a83eac3676d6ef0cb1e7b22f"
            ],
            "ref": "refs/changes/72/52772/8",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1651169382,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "I recommend changing the CC's slightly."
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 971,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "I recommend changing this to ccCommandNotAvailable.\nThere is something to talk to, it just isn't possible to modify the FRU in its current state."
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 971,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 980,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "I suggest making this ccDestinationUnavailable.\nThere's nothing to communicate with/to."
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 980,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 997,
                    "reviewer": {
                        "name": "Johnathan Mantey",
                        "email": "johnathanx.mantey@intel.com",
                        "username": "Howitzer105mm"
                    },
                    "message": "ret != ipmi::ccDestinationUnavailable"
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "line": 997,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 43,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 184,
                    "deletions": -9
                }
            ],
            "sizeInsertions": 227,
            "sizeDeletions": 9
        },
        {
            "number": 9,
            "revision": "1b046e3941cf674ab8c991d274907e9635ae0f61",
            "parents": [
                "c42c7ede932b1960a83eac3676d6ef0cb1e7b22f"
            ],
            "ref": "refs/changes/72/52772/9",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1651185617,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 43,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 184,
                    "deletions": -9
                }
            ],
            "sizeInsertions": 227,
            "sizeDeletions": 9
        },
        {
            "number": 10,
            "revision": "049b6bbf2fe410b33c8402fcb3aeaa456b0a6e37",
            "parents": [
                "c42c7ede932b1960a83eac3676d6ef0cb1e7b22f"
            ],
            "ref": "refs/changes/72/52772/10",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1651188516,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 43,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 184,
                    "deletions": -9
                }
            ],
            "sizeInsertions": 227,
            "sizeDeletions": 9
        },
        {
            "number": 11,
            "revision": "ad129c6891247da7ca707a59e02c36cc1fd3e8a5",
            "parents": [
                "ce3b7577d17f3374c1aac12fff197cf4b3f7c02e"
            ],
            "ref": "refs/changes/72/52772/11",
            "uploader": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "createdOn": 1651615496,
            "author": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 43,
                    "deletions": 0
                },
                {
                    "file": "src/manufacturingcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 184,
                    "deletions": -9
                }
            ],
            "sizeInsertions": 227,
            "sizeDeletions": 9
        }
    ]
}