{
    "project": "openbmc/google-misc",
    "branch": "master",
    "id": "I5bf7b70a3b1d769b697dc821767a58ae1c6485f5",
    "number": 47409,
    "subject": "flashupdate: Add json configuration to setup the tool",
    "owner": {
        "name": "Willy Tu",
        "email": "wltu@google.com",
        "username": "wltu"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/google-misc/+/47409",
    "commitMessage": "flashupdate: Add json configuration to setup the tool\n\nThe json config is used to allow different platform to customize the\nfirmware update that it needs.\n\nIt supports a primary flash and multiple secondary flash for storage.\n\nChange-Id: I5bf7b70a3b1d769b697dc821767a58ae1c6485f5\nSigned-off-by: Willy Tu <wltu@google.com>\n",
    "hashtags": [
        "flashupdate-wltu"
    ],
    "createdOn": 1633113318,
    "lastUpdated": 1634246495,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1633113318,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1633113329,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1633113446,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Hashtag added: flashupdate-wltu"
        },
        {
            "timestamp": 1633113577,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/27303/ : SUCCESS"
        },
        {
            "timestamp": 1633381355,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 1: Code-Review+1\n\n(11 comments)"
        },
        {
            "timestamp": 1633403516,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1633403523,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1633403545,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/27444/ : FAILURE"
        },
        {
            "timestamp": 1633403650,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 2:\n\n(11 comments)"
        },
        {
            "timestamp": 1633407503,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1633407524,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1633407771,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/27455/ : SUCCESS"
        },
        {
            "timestamp": 1633631843,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1633637287,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 4: Patch Set 3 was rebased"
        },
        {
            "timestamp": 1633637294,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1633637577,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/27768/ : SUCCESS"
        },
        {
            "timestamp": 1634246495,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Set Work In Progress"
        }
    ],
    "wip": true,
    "patchSets": [
        {
            "number": 1,
            "revision": "0bba0501611787a42fc193de27533533e6b1779f",
            "parents": [
                "a4e4f9780e78a6c583514946cbac7c092b042ef8"
            ],
            "ref": "refs/changes/09/47409/1",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1633113318,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "subprojects/flashupdate/include/flashupdate/config.hpp",
                    "line": 38,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Why do we need an empty constructor here?"
                },
                {
                    "file": "subprojects/flashupdate/include/flashupdate/config.hpp",
                    "line": 38,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "I thought about having a constructor but decided that I don't need it.\n\nremoved."
                },
                {
                    "file": "subprojects/flashupdate/src/config.cpp",
                    "line": 62,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Can't we just do get_to(config.flash.primary.muxSelect) like we do above?"
                },
                {
                    "file": "subprojects/flashupdate/src/config.cpp",
                    "line": 62,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "it is optional and doesn't work directly.\n\nI have tried \n\n```\nmuxSelect.get_to(*config.flash.primary.muxSelect);\n```\n\nbefore and it populated the values.\n\nHowever, the config.flash.primary.muxSelect.has_value() return false."
                },
                {
                    "file": "subprojects/flashupdate/src/config.cpp",
                    "line": 68,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "I guess you explicitly have the constructor for this? Can't we just do\n```\nConfig::Partition partition;\n```\n?"
                },
                {
                    "file": "subprojects/flashupdate/src/config.cpp",
                    "line": 68,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Done"
                },
                {
                    "file": "subprojects/flashupdate/src/config.cpp",
                    "line": 77,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Similar to above, can't we just do muxSelect.get_to(partition.muxSelect)?"
                },
                {
                    "file": "subprojects/flashupdate/src/config.cpp",
                    "line": 77,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "see above."
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "line": 75,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "question: what's this 4 for?"
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "line": 75,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "The indent spacing. https://nlohmann.github.io/json/doxygen/classnlohmann_1_1basic__json_a476756fb08e7f2416aad116d137977f4.html\n\nBut we don't need it. I have removed it."
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "line": 83,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Maybe good to put a short comment here saying we're putting this as default arguments because they're required."
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "line": 83,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Done"
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "line": 102,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "What's the \"empty\" for?"
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "line": 102,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "flashupdate without the e? as the other commit"
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "line": 102,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Done"
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "line": 102,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "This should just be an empty command to validate the json config. I'll change it to `validate_config` instead."
                },
                {
                    "file": "subprojects/flashupdate/test/config.cpp",
                    "line": 117,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "I think it'd be good test explain the test case here (ie. secondary index > secondaries)"
                },
                {
                    "file": "subprojects/flashupdate/test/config.cpp",
                    "line": 117,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Done"
                },
                {
                    "file": "subprojects/flashupdate/test/meson.build",
                    "line": 30,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "typo?"
                },
                {
                    "file": "subprojects/flashupdate/test/meson.build",
                    "line": 30,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Done"
                },
                {
                    "file": "subprojects/flashupdate/test/meson.build",
                    "line": 36,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "typos? flashupdate/config and flashupdate_config?"
                },
                {
                    "file": "subprojects/flashupdate/test/meson.build",
                    "line": 36,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/include/flashupdate/config.hpp",
                    "type": "ADDED",
                    "insertions": 75,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/internal/flashupdate/args.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/src/args.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/src/config.cpp",
                    "type": "ADDED",
                    "insertions": 102,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/src/meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "type": "MODIFIED",
                    "insertions": 75,
                    "deletions": -1
                },
                {
                    "file": "subprojects/flashupdate/test/config.cpp",
                    "type": "ADDED",
                    "insertions": 147,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/test/meson.build",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 424,
            "sizeDeletions": 1
        },
        {
            "number": 2,
            "revision": "64f8db429c706d3d3cff0f3c07b5e65d866f8b64",
            "parents": [
                "eae721a316b9b5362ac7c6b7d718d4e08eae5f82"
            ],
            "ref": "refs/changes/09/47409/2",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1633403516,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/include/flashupdate/config.hpp",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/internal/flashupdate/args.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -1
                },
                {
                    "file": "subprojects/flashupdate/src/args.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -2
                },
                {
                    "file": "subprojects/flashupdate/src/config.cpp",
                    "type": "ADDED",
                    "insertions": 102,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/src/flashupdate.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "subprojects/flashupdate/src/meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "type": "MODIFIED",
                    "insertions": 80,
                    "deletions": -6
                },
                {
                    "file": "subprojects/flashupdate/test/config.cpp",
                    "type": "ADDED",
                    "insertions": 150,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/test/meson.build",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 437,
            "sizeDeletions": 11
        },
        {
            "number": 3,
            "revision": "6c50b4e8cc17fa8d970fd06874d8ba9dc61cdc7b",
            "parents": [
                "3ad2a7cbd7a4f6c305b3bd9751129821cb748eb3"
            ],
            "ref": "refs/changes/09/47409/3",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1633407503,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/include/flashupdate/config.hpp",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/internal/flashupdate/args.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -1
                },
                {
                    "file": "subprojects/flashupdate/src/args.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -2
                },
                {
                    "file": "subprojects/flashupdate/src/config.cpp",
                    "type": "ADDED",
                    "insertions": 102,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/src/flashupdate.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "subprojects/flashupdate/src/meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "type": "MODIFIED",
                    "insertions": 80,
                    "deletions": -3
                },
                {
                    "file": "subprojects/flashupdate/test/config.cpp",
                    "type": "ADDED",
                    "insertions": 150,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/test/meson.build",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 437,
            "sizeDeletions": 8
        },
        {
            "number": 4,
            "revision": "1ed5f5f55aeb91bc98ac89aff807b07438bcde79",
            "parents": [
                "b9cba2087982027af8585077fbea65edb8e663fc"
            ],
            "ref": "refs/changes/09/47409/4",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1633637287,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/include/flashupdate/config.hpp",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/internal/flashupdate/args.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -1
                },
                {
                    "file": "subprojects/flashupdate/src/args.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -2
                },
                {
                    "file": "subprojects/flashupdate/src/config.cpp",
                    "type": "ADDED",
                    "insertions": 102,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/src/flashupdate.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "subprojects/flashupdate/src/meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/test/args.cpp",
                    "type": "MODIFIED",
                    "insertions": 80,
                    "deletions": -3
                },
                {
                    "file": "subprojects/flashupdate/test/config.cpp",
                    "type": "ADDED",
                    "insertions": 150,
                    "deletions": 0
                },
                {
                    "file": "subprojects/flashupdate/test/meson.build",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 437,
            "sizeDeletions": 8
        }
    ]
}