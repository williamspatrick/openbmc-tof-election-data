{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I6339ae2977faacf50ce708199aaf3b13b4314398",
    "number": 42213,
    "subject": "Fix comparison for proxy/legacy mode",
    "owner": {
        "name": "Przemyslaw Czarnowski",
        "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
        "username": "phawryle"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/bmcweb/+/42213",
    "commitMessage": "Fix comparison for proxy/legacy mode\n\nAfter sdbusplus made available string path wrapper VM code has been\nupdated to use it.  This makes legacy mode unusable as appropriate\nchange introduced a problem with comparison of DBus object path, which\nis now fixed.\n\nTested:\nAfter applying this fix, legacy mode has InsertMedia action enabled\nagain.\n\nChange-Id: I6339ae2977faacf50ce708199aaf3b13b4314398\nSigned-off-by: Przemyslaw Czarnowski <przemyslaw.hawrylewicz.czarnowski@intel.com>\n",
    "createdOn": 1618390988,
    "lastUpdated": 1619104505,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1618390988,
            "reviewer": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1618391008,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618391139,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/15387/ : FAILURE"
        },
        {
            "timestamp": 1618392247,
            "reviewer": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "message": "Patch Set 1:\n\nCI failed for ../redfish-core/include/../lib/ethernet.hpp.\nPlease take a look nonetheless."
        },
        {
            "timestamp": 1618446998,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1618480745,
            "reviewer": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1618504018,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1618509680,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2: Patch Set 1 was rebased"
        },
        {
            "timestamp": 1618509695,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618510393,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15518/ : SUCCESS"
        },
        {
            "timestamp": 1618559191,
            "reviewer": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1618559209,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618559289,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/15562/ : FAILURE"
        },
        {
            "timestamp": 1618989861,
            "reviewer": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "message": "Patch Set 4: Patch Set 3 was rebased"
        },
        {
            "timestamp": 1618989877,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618990298,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15866/ : SUCCESS"
        },
        {
            "timestamp": 1619104502,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4: Code-Review+2"
        },
        {
            "timestamp": 1619104505,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as 1a6258dc985cde406d9098130e4a2d683e82beb2 by Ed Tanous"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "9d723398a9fb903b7db1b63f2332284a079963ac",
            "parents": [
                "9010ec2e1dd5f8ad5edb61281b45019f2ea02eaa"
            ],
            "ref": "refs/changes/13/42213/1",
            "uploader": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "createdOn": 1618390988,
            "author": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "line": 259,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "if (thispath.filename() != \"Legacy\"){\n    continue;\n}\nthispath = thispath.parent_path();\nif (thisPath.filename() != \"VirtualMedia\"){\n    continue;\n}\n\nThat way there's no issues if / gets escaped into the vm path.\n\nApologies, I should've caught this in my testing, but I don't have a VM capable system."
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "line": 259,
                    "reviewer": {
                        "name": "Przemyslaw Czarnowski",
                        "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                        "username": "phawryle"
                    },
                    "message": "There is a following part, that has to be run for both legacy and proxy mode. Just this single item has to be added for legacy. \n\nI think sth like this will implement your concept (if I understood it correctly):\n    auto mode = item.first.parent_path();\n    auto type = mode.parent_path();\n    if (mode.filename().empty() || type.filename().empty())\n        continue; -> here comes unexpected paths\n    if (mode.filename() == \"Legacy\")\n        aResp->res.jsonValue = ...\n    ...common part..."
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "line": 259,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Seems ok to me.  The key here is that we're using the filename() api with exact matching, not find, which would be incorrect in some cases."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 2,
            "sizeDeletions": 1
        },
        {
            "number": 2,
            "revision": "79d8e0cdcb0fa96f1d8b97e4676db8dd0387af24",
            "parents": [
                "c47b845812c16495803a858a7bc63f5511daf27d"
            ],
            "ref": "refs/changes/13/42213/2",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1618509680,
            "author": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 2,
            "sizeDeletions": 1
        },
        {
            "number": 3,
            "revision": "a9e9769b35552b333002fd772d6248449aa18941",
            "parents": [
                "9010ec2e1dd5f8ad5edb61281b45019f2ea02eaa"
            ],
            "ref": "refs/changes/13/42213/3",
            "uploader": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "createdOn": 1618559191,
            "author": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 15,
            "sizeDeletions": 1
        },
        {
            "number": 4,
            "revision": "d979ab14164c01c20146b0e2b6c41728ee72e4fd",
            "parents": [
                "601af5ed832deae3f525064d94bb5a65b04554ae"
            ],
            "ref": "refs/changes/13/42213/4",
            "uploader": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "createdOn": 1618989861,
            "author": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 15,
            "sizeDeletions": 1
        },
        {
            "number": 5,
            "revision": "1a6258dc985cde406d9098130e4a2d683e82beb2",
            "parents": [
                "9a128eb3fc3008f802974360e98de6495ed1a66b"
            ],
            "ref": "refs/changes/13/42213/5",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1619104505,
            "author": {
                "name": "Przemyslaw Czarnowski",
                "email": "przemyslaw.hawrylewicz.czarnowski@intel.com",
                "username": "phawryle"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 15,
            "sizeDeletions": 1
        }
    ]
}