{
    "project": "openbmc/phosphor-logging",
    "branch": "master",
    "id": "I9205c084c32576734c2b5b4c79c273f8defde9d4",
    "number": 42324,
    "subject": "PEL: Support user supplied flag to indicate a fatal/terminating",
    "owner": {
        "email": "vijaylobo@gmail.com",
        "username": "vflobo"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-logging/+/42324",
    "commitMessage": "PEL: Support user supplied flag to indicate a fatal/terminating\n\nUser can supply SEVERITY_DETAIL=SYSTEM_TERM as part\nof AdditionalData entry in the event log to set the\nseverity level in User Header of PEL\n\nTested: I ran unit test using docker. Also tested manually\nby setting D-bus event log\n\nChange-Id: I9205c084c32576734c2b5b4c79c273f8defde9d4\nSigned-off-by: Vijay Lobo <vijaylobo@gmail.com>\n",
    "createdOn": 1618546935,
    "lastUpdated": 1619101963,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1618546935,
            "reviewer": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1618546946,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618547117,
            "reviewer": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1618547131,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618547134,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/15540/ : ABORTED"
        },
        {
            "timestamp": 1618547767,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15541/ : SUCCESS"
        },
        {
            "timestamp": 1618581392,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1618587013,
            "reviewer": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1618588883,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2:\n\n(8 comments)"
        },
        {
            "timestamp": 1618612011,
            "reviewer": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "message": "Patch Set 2:\n\n(6 comments)"
        },
        {
            "timestamp": 1618613425,
            "reviewer": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1618613435,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618614113,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15639/ : SUCCESS"
        },
        {
            "timestamp": 1618844232,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1618851811,
            "reviewer": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1618851834,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618851888,
            "reviewer": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1618852097,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/15744/ : FAILURE"
        },
        {
            "timestamp": 1618852647,
            "reviewer": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1618852661,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618853392,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15745/ : SUCCESS"
        },
        {
            "timestamp": 1618854066,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 5: Code-Review+1"
        },
        {
            "timestamp": 1618864736,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 5: Code-Review+1"
        },
        {
            "timestamp": 1618906699,
            "reviewer": {
                "email": "sumit_kumar@in.ibm.com",
                "username": "sumitk56"
            },
            "message": "Patch Set 5: Code-Review+1"
        },
        {
            "timestamp": 1619101944,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 5: Code-Review+2"
        },
        {
            "timestamp": 1619101963,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Change has been successfully rebased and submitted as 6b3f345b3f265036ec339d097f9d60d12998015d by Matt Spinler"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "4b24a76f8675caba751df19035259e54fff814db",
            "parents": [
                "993168de4791dc83ea787c2180187654a9f37e89"
            ],
            "ref": "refs/changes/24/42324/1",
            "uploader": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "createdOn": 1618546935,
            "author": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/pel.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/user_header.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "test/openpower-pels/user_header_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 72,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 103,
            "sizeDeletions": 8
        },
        {
            "number": 2,
            "revision": "7493cf8301550eb3297e52bd5dd36b60f340b051",
            "parents": [
                "993168de4791dc83ea787c2180187654a9f37e89"
            ],
            "ref": "refs/changes/24/42324/2",
            "uploader": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "createdOn": 1618547117,
            "author": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "extensions/openpower-pels/README.md",
                    "line": 50,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "maybe something like:\nThis is used when the passed in event log severity determines the PEL severity and a more granular PEL severity is needed beyond what the normal event log to PEL severity conversion could give.\n\nthough that sound wordy"
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "line": 50,
                    "reviewer": {
                        "email": "vijaylobo@gmail.com",
                        "username": "vflobo"
                    },
                    "message": "It makes more sense... I will change it"
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "line": 50,
                    "reviewer": {
                        "email": "vijaylobo@gmail.com",
                        "username": "vflobo"
                    },
                    "message": "Done"
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "line": 60,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "How about a bulleted list of the possible values along with what they do?  Like how SYSTEM_TERM is used with the Critical severity to make the 0x51 value, etc."
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "line": 60,
                    "reviewer": {
                        "email": "vijaylobo@gmail.com",
                        "username": "vflobo"
                    },
                    "message": "Do you want me to put SYSTEM_FAIL, PARTITION_TERM, PARTITION_FAIL etc? we don't support them.. so I can say not-supported?"
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "line": 60,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "You can just list the one supported one."
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "line": 60,
                    "reviewer": {
                        "email": "vijaylobo@gmail.com",
                        "username": "vflobo"
                    },
                    "message": "Done"
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "line": 91,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "can you add a comment that says what this code is doing?"
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "line": 91,
                    "reviewer": {
                        "email": "vijaylobo@gmail.com",
                        "username": "vflobo"
                    },
                    "message": "Done"
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "line": 92,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "we try to use camelCase for all variables."
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "line": 92,
                    "reviewer": {
                        "email": "vijaylobo@gmail.com",
                        "username": "vflobo"
                    },
                    "message": "Done"
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "line": 93,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "instead of looking in PelValues, there are severity types defined here: https://github.com/openbmc/phosphor-logging/blob/master/extensions/openpower-pels/pel_types.hpp#L91\n\nthen you can just compare the upper nibble against this type to see if it is critical.  This is probably done in other places in the code you could look at."
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "line": 93,
                    "reviewer": {
                        "email": "vijaylobo@gmail.com",
                        "username": "vflobo"
                    },
                    "message": "Done"
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "line": 93,
                    "reviewer": {
                        "email": "vijaylobo@gmail.com",
                        "username": "vflobo"
                    },
                    "message": "Done"
                },
                {
                    "file": "test/openpower-pels/user_header_test.cpp",
                    "line": 211,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "doesn't apply for this testcase, can remove.  you could also just leave adData empty."
                },
                {
                    "file": "test/openpower-pels/user_header_test.cpp",
                    "line": 235,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "same comment as above."
                },
                {
                    "file": "test/openpower-pels/user_header_test.cpp",
                    "line": 259,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "same comment as above."
                },
                {
                    "file": "test/openpower-pels/user_header_test.cpp",
                    "line": 281,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "..."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/pel.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/user_header.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "test/openpower-pels/user_header_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 72,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 103,
            "sizeDeletions": 8
        },
        {
            "number": 3,
            "revision": "ee87dd5c2c65255177d1dc773fd846f3ef3a1a95",
            "parents": [
                "993168de4791dc83ea787c2180187654a9f37e89"
            ],
            "ref": "refs/changes/24/42324/3",
            "uploader": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "createdOn": 1618613425,
            "author": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "line": 101,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "There's 5 total different critical severities - 0x50 through 0x54.  So if you ORed in a 1, you would be changing a 0x52 to a 0x53, which isn't what is desired.  Even though that isn't really a use case, it wouldn't be good if it happened.\n\nprobably better to just set it directly to 0x51.  Also I guess you could just do a hardcoded check to see if it's 0x50, and then set/or it to 0x51 if necessary."
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "line": 101,
                    "reviewer": {
                        "email": "vijaylobo@gmail.com",
                        "username": "vflobo"
                    },
                    "message": "I intentionally did not use 0x50 at line 96 just to make it more verbatim. But if I have to set it as hard-coded value 0x51 then I will test for 0x50"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/pel.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -2
                },
                {
                    "file": "extensions/openpower-pels/user_header.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "test/openpower-pels/user_header_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 59,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 93,
            "sizeDeletions": 10
        },
        {
            "number": 4,
            "revision": "38d5bb3efa0b967181301814d2d5208ddb877375",
            "parents": [
                "993168de4791dc83ea787c2180187654a9f37e89"
            ],
            "ref": "refs/changes/24/42324/4",
            "uploader": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "createdOn": 1618851811,
            "author": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/pel.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -2
                },
                {
                    "file": "extensions/openpower-pels/user_header.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "test/openpower-pels/user_header_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 59,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 93,
            "sizeDeletions": 10
        },
        {
            "number": 5,
            "revision": "5e3b1645c2b2714541ba4c90dc5db4c5dce58095",
            "parents": [
                "993168de4791dc83ea787c2180187654a9f37e89"
            ],
            "ref": "refs/changes/24/42324/5",
            "uploader": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "createdOn": 1618852647,
            "author": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/pel.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -1
                },
                {
                    "file": "extensions/openpower-pels/user_header.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "test/openpower-pels/user_header_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 59,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 92,
            "sizeDeletions": 9
        },
        {
            "number": 6,
            "revision": "6b3f345b3f265036ec339d097f9d60d12998015d",
            "parents": [
                "7dc8c3bea5747b430b7df2eea891f9df1169f23a"
            ],
            "ref": "refs/changes/24/42324/6",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1619101963,
            "author": {
                "email": "vijaylobo@gmail.com",
                "username": "vflobo"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/README.md",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "extensions/openpower-pels/pel.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "extensions/openpower-pels/user_header.cpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -1
                },
                {
                    "file": "extensions/openpower-pels/user_header.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "test/openpower-pels/user_header_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 59,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 92,
            "sizeDeletions": 9
        }
    ]
}