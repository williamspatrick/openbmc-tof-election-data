{
    "project": "openbmc/sdbusplus",
    "branch": "master",
    "id": "Ie2e4ec66b083924b8f331d919ebd2c883f68e204",
    "number": 23955,
    "subject": "sdbusplus: Support added for async match rule",
    "owner": {
        "name": "Richard Marian Thomaiyar",
        "email": "richard.marian.thomaiyar@linux.intel.com",
        "username": "rthomaiy"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/sdbusplus/+/23955",
    "commitMessage": "sdbusplus: Support added for async match rule\n\nCurrently match rule uses sd_bus_add_match API, which is\nsync call, and combining it with any async daemon, may\nhang in scenarios, where match rule called before io.run()\nand after a async response reaching before match sync call\nresponse from D-Bus broker. Adding async support avoids this\nproblem, as io.run() will take care of the order.\nAdded sd_bus_add_match_async() call based on the match()\nparameter requested.\n\nTested:\nUpdated the code to the async version, and verified image\nworks fine without any issues, and expected signalling works\n1. Verfied ipmi daemon still works\n2. async daemon also works, like entity-manager etc.\n3. Tried with wrong match rule, say \"type=signal123\", and verified\nthat it throws exception as expected\n\nChange-Id: Ie2e4ec66b083924b8f331d919ebd2c883f68e204\nSigned-off-by: Richard Marian Thomaiyar <richard.marian.thomaiyar@linux.intel.com>\n",
    "createdOn": 1564321380,
    "lastUpdated": 1617224728,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1564321380,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1564321403,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1564321423,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 1:\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/33526/"
        },
        {
            "timestamp": 1564321531,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://openpower.xyz/job/openbmc-repository-ci/33526/ : SUCCESS"
        },
        {
            "timestamp": 1564367805,
            "reviewer": {
                "name": "Brad Bishop",
                "email": "bradleyb@fuzziesquirrel.com",
                "username": "bradbishop"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1564379728,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1564472417,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Patch Set 1:\n\nI realize the previous call wasn't checking for errors, but now you can't check for them at all since you are using an async call with no callback. The errors presented by this call are a subset of errors when doing the sync version of the call, and any failure in the DBus request to add the match will just silently fail. Worse, code will now continue to execute before the match has been added, so we have no guarantee anything was established.\n\nThe \"rare hang\" sounds like a bug that needs to be fixed. sd-bus should be able to handle both async and sync operations co-existing in its internal event structure without issue."
        },
        {
            "timestamp": 1564500674,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 1:\n\n> I realize the previous call wasn't checking for errors, but now you\n > can't check for them at all since you are using an async call with\n > no callback. The errors presented by this call are a subset of\n > errors when doing the sync version of the call, and any failure in\n > the DBus request to add the match will just silently fail. Worse,\n > code will now continue to execute before the match has been added,\n > so we have no guarantee anything was established.\n > \n > The \"rare hang\" sounds like a bug that needs to be fixed. sd-bus\n > should be able to handle both async and sync operations co-existing\n > in its internal event structure without issue.\n\nWe can provide a param option, so that either sync / async call can be specified when instantiating the Match class.\nIn that way user can select. But i want to make sure default is async, else we need to update daemons which make use of this code to use async (say ipmid etc). \nLet me know"
        },
        {
            "timestamp": 1564930562,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1564930585,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1564930601,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 2:\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/33921/"
        },
        {
            "timestamp": 1564930690,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://openpower.xyz/job/openbmc-repository-ci/33921/ : FAILURE"
        },
        {
            "timestamp": 1564989966,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 3: New patch set was added with same tree, parent, and commit message as Patch Set 2."
        },
        {
            "timestamp": 1564989986,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 3:\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1564989997,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 3: -Verified\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/33939/"
        },
        {
            "timestamp": 1564990077,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://openpower.xyz/job/openbmc-repository-ci/33939/ : FAILURE"
        },
        {
            "timestamp": 1565027416,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1565027453,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1565027490,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 4:\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/33975/"
        },
        {
            "timestamp": 1565027599,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://openpower.xyz/job/openbmc-repository-ci/33975/ : SUCCESS"
        },
        {
            "timestamp": 1565091625,
            "reviewer": {
                "name": "Brad Bishop",
                "email": "bradleyb@fuzziesquirrel.com",
                "username": "bradbishop"
            },
            "message": "Patch Set 4:\n\n(1 comment)\n\n> The \"rare hang\" sounds like a bug that needs to be fixed\n\nAgreed, this sounds like software working around other broken software which is not acceptable upstream.\n\n> Worse, code will now continue to execute\n\nI share this problem.  I'm not certain, but this patch will likely introduce races into several of the applications I use.\n\nRichard IMO your best bet is to add a new async api, and then update the applications you want to use it.  That way noone that relies on the existing behavior is impacted, and you can audit any places you move to the new API to ensure that they can handle continuing to execute before the match is actually added."
        },
        {
            "timestamp": 1565110475,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 4:\n\n> (1 comment)\n > \n > > The \"rare hang\" sounds like a bug that needs to be fixed\n > \n > Agreed, this sounds like software working around other broken\n > software which is not acceptable upstream.\n > \n > > Worse, code will now continue to execute\n > \n > I share this problem.  I'm not certain, but this patch will likely\n > introduce races into several of the applications I use.\n > \n > Richard IMO your best bet is to add a new async api, and then\n > update the applications you want to use it.  That way noone that\n > relies on the existing behavior is impacted, and you can audit any\n > places you move to the new API to ensure that they can handle\n > continuing to execute before the match is actually added.\n\nHi brad, \nThe code is now updated with optional parameter to enable the async and not changing the existing default. (The exact scenario, where issue will happen is also mentioned in the commit message)."
        },
        {
            "timestamp": 1565129137,
            "reviewer": {
                "name": "Brad Bishop",
                "email": "bradleyb@fuzziesquirrel.com",
                "username": "bradbishop"
            },
            "message": "Patch Set 4:\n\n(1 comment)\n\n> Hi brad, \n> The code is now updated with optional parameter to enable the async and not changing the existing default. (The exact scenario, where issue will happen is also mentioned in the commit message).\n\nThank you Richard."
        },
        {
            "timestamp": 1565139375,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 5: Commit message was updated."
        },
        {
            "timestamp": 1565139484,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1565139506,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1565139517,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1565139518,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 6:\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/34065/"
        },
        {
            "timestamp": 1565139674,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://openpower.xyz/job/openbmc-repository-ci/34065/ : SUCCESS"
        },
        {
            "timestamp": 1565633715,
            "reviewer": {
                "name": "Vernon Mauery",
                "email": "vernon.mauery@linux.intel.com",
                "username": "vmauery"
            },
            "message": "Patch Set 6: Code-Review+1"
        },
        {
            "timestamp": 1565654354,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 6:\n\n(2 comments)"
        },
        {
            "timestamp": 1565682677,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 6:\n\n(2 comments)"
        },
        {
            "timestamp": 1567009501,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1567015837,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Patch Set 6:\n\n(3 comments)"
        },
        {
            "timestamp": 1567230432,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 6:\n\n(2 comments)"
        },
        {
            "timestamp": 1567274557,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1567274581,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 8."
        },
        {
            "timestamp": 1567274593,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1567274598,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1567274599,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 7:\n\nNo Builds Executed"
        },
        {
            "timestamp": 1567274616,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 8:\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/35255/"
        },
        {
            "timestamp": 1567274725,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 8: Verified-1\n\nBuild Failed \n\nhttps://openpower.xyz/job/openbmc-repository-ci/35255/ : FAILURE"
        },
        {
            "timestamp": 1567274737,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 6:\n\n(3 comments)"
        },
        {
            "timestamp": 1567275408,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 9: New patch set was added with same tree, parent, and commit message as Patch Set 8."
        },
        {
            "timestamp": 1567275429,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 9:\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1567275442,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 9: -Verified\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/35256/"
        },
        {
            "timestamp": 1567275482,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1567275567,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 9: Verified+1\n\nBuild Successful \n\nhttps://openpower.xyz/job/openbmc-repository-ci/35256/ : SUCCESS"
        },
        {
            "timestamp": 1567275629,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 10."
        },
        {
            "timestamp": 1567275649,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 10: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1567275662,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 10:\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/35257/"
        },
        {
            "timestamp": 1567275786,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 10: Verified+1\n\nBuild Successful \n\nhttps://openpower.xyz/job/openbmc-repository-ci/35257/ : SUCCESS"
        },
        {
            "timestamp": 1567355237,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 10:\n\n(1 comment)"
        },
        {
            "timestamp": 1567356867,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 11."
        },
        {
            "timestamp": 1567356887,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 11: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1567356899,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 11:\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/35260/"
        },
        {
            "timestamp": 1567357003,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 11: Verified-1\n\nBuild Failed \n\nhttps://openpower.xyz/job/openbmc-repository-ci/35260/ : FAILURE"
        },
        {
            "timestamp": 1567359626,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Uploaded patch set 12: New patch set was added with same tree, parent, and commit message as Patch Set 11."
        },
        {
            "timestamp": 1567359647,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 12:\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1567359660,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 12: -Verified\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/35263/"
        },
        {
            "timestamp": 1567359784,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 12: Verified+1\n\nBuild Successful \n\nhttps://openpower.xyz/job/openbmc-repository-ci/35263/ : SUCCESS"
        },
        {
            "timestamp": 1580316448,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 12:\n\nAny update on this one ?"
        },
        {
            "timestamp": 1580488089,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1580490264,
            "reviewer": {
                "name": "James Feist",
                "email": "james.feist@linux.intel.com",
                "username": "feistjj"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1598301539,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Removed reviewer Adriana Kobylak."
        },
        {
            "timestamp": 1617224728,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Removed reviewer Ed Tanous."
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "3490afbb82357e6c31a99300e5c95afe56f23ed9",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/1",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1564321380,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Brad Bishop",
                        "email": "bradleyb@fuzziesquirrel.com",
                        "username": "bradbishop"
                    },
                    "message": "Can more be said about the impact to synchronous callers that expect their handlers to be getting callbacks as soon as this is constructed?  Would it make sense to add a _new_ match_async interface rather than changing the behavior of the existing one?"
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "Initially i thought about that, but the problem is, many of our daemons are in async (including ipmi daemon), so if added separately then it will require to update the code in all the places with this param.\n\nThought of adding it in reverse(i.e. default is async & if param specifies using sync one), but dropped that idea, as no code so far handled the error case. (i.e. even if sd_bus_add_match() failed, match() ignored and proceeded). So, realized that current behavior is not changed because of this.\n\nNote: There are other 2 reviews on top of this, which throws accordingly, when there is failure."
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Brad Bishop",
                        "email": "bradleyb@fuzziesquirrel.com",
                        "username": "bradbishop"
                    },
                    "message": "> but the problem is, many of our daemons are in async (including ipmi daemon), so if added separately then it will require to update the code in all the places with this param.\n\nThis is not an acceptable rationale for changing the behavior of an existing library method."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 4,
            "sizeDeletions": 3
        },
        {
            "number": 2,
            "revision": "f87eb18a9462bc5996c41040635936ccb0bf57c6",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/2",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1564930562,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 73,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 73,
            "sizeDeletions": 10
        },
        {
            "number": 3,
            "revision": "685eb7cc3e70cfa16a797bed3237c9c6de6da917",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/3",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1564989966,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "NO_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 73,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 73,
            "sizeDeletions": 10
        },
        {
            "number": 4,
            "revision": "d08a7aaee28dade9523df74f5bba1a97d27e60d2",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/4",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1565027416,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 41,
                    "reviewer": {
                        "name": "Brad Bishop",
                        "email": "bradleyb@fuzziesquirrel.com",
                        "username": "bradbishop"
                    },
                    "message": "do you want to add the new parameters to the doxygen here?"
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 41,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 70,
                    "deletions": -12
                }
            ],
            "sizeInsertions": 70,
            "sizeDeletions": 12
        },
        {
            "number": 5,
            "revision": "108d9923d91a5278708a0142b38f73156d78cf0b",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/5",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1565139375,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 70,
                    "deletions": -12
                }
            ],
            "sizeInsertions": 70,
            "sizeDeletions": 12
        },
        {
            "number": 6,
            "revision": "7d37f344d1ac0dd617a48ec98344dfc3a5f8712d",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/6",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1565139484,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Aren't these two parameters redundant, considering that you forgot a nullptr check on installHandler?\n\nI suspect asyncCall could just be removed, and the condition on line 53 changed to installHandler != nullptr."
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "Not necessarily. i.e. asyncCall can exist, with installHandler being nullptr.\n(i.e. nullptr doesn't mean it is asyncCall only, and asyncCall doesn't need to have installHandler). \n\nCheck for nullptr is not needed, as we forward the same to the API. (i.e. in API it can be nullptr)."
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I guess I disagree.  In what you wrote, there are 4 cases\n\nasyncCall == false  installHandler == nullptr Normal synchronous call\nasyncCall == false installHandler != nullptr  Non-sensical.  Callbacks will not be called here if the install fails, the error will be thrown in the code you've written, and installHandler will be ignored.\nasyncCall == true  installHandler == nullptr  Ideally should not be used, as it means you're not handling your errors.\nasyncCall == true  installHandler != nullptr  Should be used for async cases.\n\nIt seems a lot easier to just make the distinction that if a callback is given, the user wants to do an ldap call"
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "It would be better if the async part was a separate codepath, not sharing the same constructor path as the non-async version. Then you could get rid of the installHandler param for the synchronous call and not have runtime branching."
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "thought that difference was on 2 lines based on the param whether it is sd_bus_add_match_async / sd_bus_add_match,\nWill try to make it as different"
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "Got your point now. I thought of exposing the sd_bus_add_match_async to the upper layer too, but it's not needed / doesn't make sense when the options are provided.\nHence will rewrite this to differentiate it based on asyncInstallHandler param only (and will remove asyncCall)."
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "latest patch has that one, but you can check patch 8 too."
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "william check both patch 7 & 8"
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 48,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "I rolled back to the old one itself, as argument base approach results in multiple match. The other option we have is creating match_async.hpp which handles the async, but will result in duplicate code and just thought maintenance may be a problem"
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 64,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Throw the relevant error code."
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 64,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "Done"
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 72,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Same comment as above."
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 72,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "refer above"
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 80,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Get rid of the unique_ptrs in here."
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 80,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 74,
                    "deletions": -12
                }
            ],
            "sizeInsertions": 74,
            "sizeDeletions": 12
        },
        {
            "number": 7,
            "revision": "b1cd29c37886dd12b8a21f7b7a1c631c11154686",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/7",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1567274557,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 69,
                    "deletions": -13
                }
            ],
            "sizeInsertions": 69,
            "sizeDeletions": 13
        },
        {
            "number": 8,
            "revision": "a57f8851ecb55fba5a9ce8cec8fcad3949265f30",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/8",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1567274581,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 102,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 102,
            "sizeDeletions": 8
        },
        {
            "number": 9,
            "revision": "63565e54100c663e1e4a690be45f58bb3cc98d2f",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/9",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1567275408,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "NO_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 102,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 102,
            "sizeDeletions": 8
        },
        {
            "number": 10,
            "revision": "8b97d902b910f2660d3f9ad78e899e3ad3c09355",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/10",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1567275629,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 102,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 102,
            "sizeDeletions": 8
        },
        {
            "number": 11,
            "revision": "ec023a11e43d6c849405541de9dd13999c57f55b",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/11",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1567356867,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 69,
                    "deletions": -13
                }
            ],
            "sizeInsertions": 69,
            "sizeDeletions": 13
        },
        {
            "number": 12,
            "revision": "8bc6c1231c3f7e82697661ab38aac8a437078766",
            "parents": [
                "4212292bcf136d04b38ba5116aa568b0fa312798"
            ],
            "ref": "refs/changes/55/23955/12",
            "uploader": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "createdOn": 1567359626,
            "author": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "kind": "NO_CHANGE",
            "comments": [
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 87,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Can we just put up separate constructors?  All the extra logic and stuff on line 90 makes this really difficult to understand."
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "line": 87,
                    "reviewer": {
                        "name": "James Feist",
                        "email": "james.feist@linux.intel.com",
                        "username": "feistjj"
                    },
                    "message": "+1"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 69,
                    "deletions": -13
                }
            ],
            "sizeInsertions": 69,
            "sizeDeletions": 13
        }
    ]
}