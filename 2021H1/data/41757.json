{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "If8bd09140450a6104a5410b69ec33faeca26eca3",
    "number": 41757,
    "subject": "Add BMC health metrics",
    "owner": {
        "name": "Sui Chen",
        "email": "suichen@google.com",
        "username": "quadpixels"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/bmcweb/+/41757",
    "commitMessage": "Add BMC health metrics\n\nThe phosphor-health-monitor repository is publishing a few metrics\nrelated the health of the BMC on DBus. This makes them very easy\nto work with from BMCWeb, and allows a user to know the state of\nthe BMC on the web user interface.\n\nThis change adds a route to enable a user to read BMC health\nmetrics using the GET method.\n\nTested:\n - Tested using evb-ast2500 image on QEMU\n   - when the DBus objects from health-monitor is not available,\n     an error is returned\n   - when health-monitor is running, the metrics it provides are\n     correctly returned\n\nSigned-off-by: Sui Chen <suichen6@gmail.com>\nChange-Id: If8bd09140450a6104a5410b69ec33faeca26eca3\n",
    "createdOn": 1617225052,
    "lastUpdated": 1626944572,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1617225052,
            "reviewer": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1617225065,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617225137,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/14666/ : FAILURE"
        },
        {
            "timestamp": 1617226618,
            "reviewer": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1617226632,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617226739,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/14669/ : FAILURE"
        },
        {
            "timestamp": 1617226791,
            "reviewer": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1617226807,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617227345,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/14670/ : FAILURE"
        },
        {
            "timestamp": 1617228204,
            "reviewer": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1617228237,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617228310,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/14672/ : FAILURE"
        },
        {
            "timestamp": 1617228411,
            "reviewer": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1617228426,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617229140,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/14673/ : SUCCESS"
        },
        {
            "timestamp": 1617230637,
            "reviewer": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "message": "Uploaded patch set 6: Commit message was updated."
        },
        {
            "timestamp": 1617232811,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1617234723,
            "reviewer": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1617235697,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1617679102,
            "reviewer": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1626944572,
            "reviewer": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "message": "Abandoned\n\nConfirming that no changes are needed in BMCWeb."
        }
    ],
    "wip": true,
    "patchSets": [
        {
            "number": 1,
            "revision": "b1718a75278571f361071e0eb9b0be7c4320972b",
            "parents": [
                "f6f97199eb879540fb807645795149a7f6b9ae35"
            ],
            "ref": "refs/changes/57/41757/1",
            "uploader": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "createdOn": 1617225052,
            "author": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/bmc_health.hpp",
                    "type": "ADDED",
                    "insertions": 44,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 48,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "f4cecf0fbba4e8830f28f7c63ae84347458c16b1",
            "parents": [
                "f6f97199eb879540fb807645795149a7f6b9ae35"
            ],
            "ref": "refs/changes/57/41757/2",
            "uploader": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "createdOn": 1617226618,
            "author": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/bmc_health.hpp",
                    "type": "ADDED",
                    "insertions": 41,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 45,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "9d3503eec8f817bd61f4472d505222d43c9acf85",
            "parents": [
                "f6f97199eb879540fb807645795149a7f6b9ae35"
            ],
            "ref": "refs/changes/57/41757/3",
            "uploader": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "createdOn": 1617226791,
            "author": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/bmc_health.hpp",
                    "type": "ADDED",
                    "insertions": 41,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 45,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "9694bc30077bab8f1a9e775f495fe437ab8dd714",
            "parents": [
                "f6f97199eb879540fb807645795149a7f6b9ae35"
            ],
            "ref": "refs/changes/57/41757/4",
            "uploader": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "createdOn": 1617228204,
            "author": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/bmc_health.hpp",
                    "type": "ADDED",
                    "insertions": 40,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 44,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "155c8fda9aa8258d49823c89061030b46e159c08",
            "parents": [
                "f6f97199eb879540fb807645795149a7f6b9ae35"
            ],
            "ref": "refs/changes/57/41757/5",
            "uploader": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "createdOn": 1617228411,
            "author": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/bmc_health.hpp",
                    "type": "ADDED",
                    "insertions": 43,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 47,
            "sizeDeletions": 0
        },
        {
            "number": 6,
            "revision": "e0c873df2ea958765e8e9cecd1042eea60805d4f",
            "parents": [
                "f6f97199eb879540fb807645795149a7f6b9ae35"
            ],
            "ref": "refs/changes/57/41757/6",
            "uploader": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "createdOn": 1617230637,
            "author": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "include/bmc_health.hpp",
                    "line": 13,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "Why can't these just be a sensor?\n\nhttps://redfish.dmtf.org/schemas/v1/Sensor.v1_2_0.json\n\nThere is a Percent for sensor. \n\n                \"Percent\": \"This value shall indicate a percentage measurement, in percent units, and the ReadingUnits value shall be `%`.\",\n\n\nIf these can't be sensor, have we asked Redfish to add these to the spec?"
                },
                {
                    "file": "include/bmc_health.hpp",
                    "line": 13,
                    "reviewer": {
                        "name": "Sui Chen",
                        "email": "suichen@google.com",
                        "username": "quadpixels"
                    },
                    "message": "I realize phosphor-health-monitor maintains those readings as sensor objects, I will modify this section so that the readings are handled similarly to other sensors."
                },
                {
                    "file": "include/bmc_health.hpp",
                    "line": 13,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "+1.  I suspect no code changes are needed in bmcweb.  phosphor-health-monitor just needs to publish the dbus interfaces and map them back to a chassis (should be the current baseboard) then the existing sensor and telemetry schemas should just work with no changes needed here."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/bmc_health.hpp",
                    "type": "ADDED",
                    "insertions": 43,
                    "deletions": 0
                },
                {
                    "file": "src/webserver_main.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 47,
            "sizeDeletions": 0
        }
    ]
}