{
    "project": "openbmc/phosphor-fan-presence",
    "branch": "master",
    "id": "I7b2ffc538eb1f17017826235353dba85e4f92ebe",
    "number": 40505,
    "subject": "monitor: Trust group cancel/start monitoring",
    "owner": {
        "name": "Matthew Barth",
        "email": "msbarth@linux.ibm.com",
        "username": "msbarth"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-fan-presence/+/40505",
    "commitMessage": "monitor: Trust group cancel/start monitoring\n\nAny fan monitoring trust groups configured should cancel the monitoring\nof all fan sensors configured in the trust group for all monitoring\nmethods(timer based or count based) when the group is determined not to\nbe trusted.\n\nAlso, the trust manager should restart monitoring all the sensors in the\ngroup by processing each sensor against the configured monitoring\nmethod. This matches how each sensor is processed on each tach changed\nsignal where only when a tach changed signal is received does the trust\nstate of the sensor get checked prior to processing the state of the\nsensor.\n\nTested:\n    Verify fan sensors in trust group's functional state is correct\n\nSigned-off-by: Matthew Barth <msbarth@us.ibm.com>\nChange-Id: I7b2ffc538eb1f17017826235353dba85e4f92ebe\n",
    "createdOn": 1612989109,
    "lastUpdated": 1613406311,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1612989109,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1612989124,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1612989279,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12273/ : SUCCESS"
        },
        {
            "timestamp": 1613056945,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 1:\n\n(1 comment)\n\nThis change is ready for review."
        },
        {
            "timestamp": 1613056972,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 1: Code-Review-1"
        },
        {
            "timestamp": 1613074656,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1613074668,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1613074811,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12324/ : SUCCESS"
        },
        {
            "timestamp": 1613083215,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1613083941,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1613161292,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1613161302,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1613161306,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1613161453,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12398/ : SUCCESS"
        },
        {
            "timestamp": 1613163752,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1613405913,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1613406306,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1613406311,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Change has been successfully merged by Matthew Barth"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "c7546031900f7e33de92709cd9dd323199177502",
            "parents": [
                "871bfeaeb3eb651c3c2d0bd3ed9bb67c753ca824"
            ],
            "ref": "refs/changes/05/40505/1",
            "uploader": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "createdOn": 1612989109,
            "author": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "monitor/trust_manager.hpp",
                    "line": 111,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "I believe this was to handle the case where a fan that was being untrusted doesnt provide an updated tach changed signal after becoming trusted."
                },
                {
                    "file": "monitor/trust_manager.hpp",
                    "line": 111,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Left this in to process the state of the fans down the normal processing code path instead now."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 23,
                    "deletions": 0
                },
                {
                    "file": "monitor/tach_sensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "monitor/trust_group.hpp",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -23
                },
                {
                    "file": "monitor/trust_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -12
                }
            ],
            "sizeInsertions": 26,
            "sizeDeletions": 35
        },
        {
            "number": 2,
            "revision": "9ec2dd2cb173ec93bf3364288ee3fe89c406c4f4",
            "parents": [
                "871bfeaeb3eb651c3c2d0bd3ed9bb67c753ca824"
            ],
            "ref": "refs/changes/05/40505/2",
            "uploader": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "createdOn": 1613074656,
            "author": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "monitor/trust_group.hpp",
                    "line": 119,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Thinking this should be encapsulated in a function on each sensor so the trust groups doesnt need to be updated when different monitoring methods are added...though that should be infrequent."
                },
                {
                    "file": "monitor/trust_group.hpp",
                    "line": 119,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.hpp",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                },
                {
                    "file": "monitor/tach_sensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "monitor/trust_group.hpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -20
                },
                {
                    "file": "monitor/trust_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -6
                }
            ],
            "sizeInsertions": 63,
            "sizeDeletions": 26
        },
        {
            "number": 3,
            "revision": "fcb0dbcb144020606780da9dd2e2be517ef7cf6d",
            "parents": [
                "871bfeaeb3eb651c3c2d0bd3ed9bb67c753ca824"
            ],
            "ref": "refs/changes/05/40505/3",
            "uploader": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "createdOn": 1613161292,
            "author": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.hpp",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "monitor/tach_sensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "monitor/trust_group.hpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -20
                },
                {
                    "file": "monitor/trust_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -6
                }
            ],
            "sizeInsertions": 71,
            "sizeDeletions": 26
        }
    ]
}