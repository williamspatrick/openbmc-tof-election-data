{
    "project": "openbmc/openbmc",
    "branch": "master",
    "id": "Id03695ccd1ef57f078eefb9e3638bbd802234e58",
    "number": 41822,
    "subject": "meta-google: add nanopb recipe",
    "owner": {
        "name": "Zhenfei Tai",
        "email": "ztai@google.com",
        "username": "ztai-goog"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/openbmc/+/41822",
    "commitMessage": "meta-google: add nanopb recipe\n\nWe want to create a nanopb recipe instead of copying nanopb code into\nmultiple recipes that need it.\n\nSigned-off-by: Zhenfei Tai <ztai@google.com>\nChange-Id: Id03695ccd1ef57f078eefb9e3638bbd802234e58\n",
    "createdOn": 1617408371,
    "lastUpdated": 1617939898,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1617408371,
            "reviewer": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1617408412,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617408420,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/2835/"
        },
        {
            "timestamp": 1617409397,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/2835/ : SUCCESS"
        },
        {
            "timestamp": 1617410693,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 1:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1617817131,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 1: Code-Review+1"
        },
        {
            "timestamp": 1617831964,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Patch Set 1:\n\n(4 comments)"
        },
        {
            "timestamp": 1617908407,
            "reviewer": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1617908438,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617908447,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/2927/"
        },
        {
            "timestamp": 1617908614,
            "reviewer": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "message": "Patch Set 2:\n\n(4 comments)"
        },
        {
            "timestamp": 1617909208,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/2927/ : SUCCESS"
        },
        {
            "timestamp": 1617910504,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1617912346,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(6 comments)"
        },
        {
            "timestamp": 1617917838,
            "reviewer": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1617917869,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617917879,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/2933/"
        },
        {
            "timestamp": 1617917894,
            "reviewer": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "message": "Patch Set 2:\n\n(5 comments)"
        },
        {
            "timestamp": 1617918467,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/2933/ : SUCCESS"
        },
        {
            "timestamp": 1617919291,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1617919499,
            "reviewer": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1617919532,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617919539,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/2934/"
        },
        {
            "timestamp": 1617919546,
            "reviewer": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1617920499,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/2934/ : SUCCESS"
        },
        {
            "timestamp": 1617921616,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1617924081,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 4:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1617938781,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Patch Set 4: Code-Review+2\n\n(2 comments)"
        },
        {
            "timestamp": 1617939725,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1617939898,
            "reviewer": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "message": "Change has been successfully rebased and submitted as cd9f5f00d75fe3735eebe886a1e0701bb25ea967 by Zhenfei Tai"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "7ac43809fc7bfb9ff06be254a88165f305a7e4cb",
            "parents": [
                "b19a57fc39f3da4d9380d00c4b9793567eb6ffcf"
            ],
            "ref": "refs/changes/22/41822/1",
            "uploader": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "createdOn": 1617408371,
            "author": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 12,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "We should use the latest release if viable (0.4.5), otherwise provide both alternatives.\nhttps://github.com/nanopb/nanopb/releases\n\nThis will require a recipe rename."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 12,
                    "reviewer": {
                        "name": "Zhenfei Tai",
                        "email": "ztai@google.com",
                        "username": "ztai-goog"
                    },
                    "message": "updated to 0.4.5."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 21,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Even though gBMC would likely not use it this way, I think we want to have 2 subpackages. One for the generator and one for the runtime. That way you can have native packages built against the nanopb runtime (libcr51 for instance if we use to it work with BMC images during build) as well as the generator inside an image if desired. By having separate packages, you would be able to avoid bloating images that only want one or the other too."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 21,
                    "reviewer": {
                        "name": "Zhenfei Tai",
                        "email": "ztai@google.com",
                        "username": "ztai-goog"
                    },
                    "message": "added two subpackages."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 23,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Just add a symlink `ln -sv . ${D}${includedir}/nanopb` so we don't have multiple copies of the files."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 23,
                    "reviewer": {
                        "name": "Zhenfei Tai",
                        "email": "ztai@google.com",
                        "username": "ztai-goog"
                    },
                    "message": "No longer needed after setting to nanopb 0.4 version."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 29,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Looking at the cmake file, we shouldn't need to be doing anything here."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 29,
                    "reviewer": {
                        "name": "Zhenfei Tai",
                        "email": "ztai@google.com",
                        "username": "ztai-goog"
                    },
                    "message": "Due to the python path issue, I added a symlink to dist-packages in /usr/bin."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 33,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "1f2690f4dd41ae91ed2682bf83c1c324fc5de7df",
            "parents": [
                "b19a57fc39f3da4d9380d00c4b9793567eb6ffcf"
            ],
            "ref": "refs/changes/22/41822/2",
            "uploader": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "createdOn": 1617908407,
            "author": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 1,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Should we have the version in the filename of this?  \n\nie nanopb_4.5_git.bb like other recipes do?  That would means that we don't need to explicitly set PV on line 5 as well."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 1,
                    "reviewer": {
                        "name": "Zhenfei Tai",
                        "email": "ztai@google.com",
                        "username": "ztai-goog"
                    },
                    "message": "updated recipe name."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 5,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Presumably we're not using 1.0."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 5,
                    "reviewer": {
                        "name": "Zhenfei Tai",
                        "email": "ztai@google.com",
                        "username": "ztai-goog"
                    },
                    "message": "updated to 0.4.5."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 5,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I'm betting this line goes away when you implement the first comment on this file"
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 11,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "nit, this doesn't need to be specified, as it's the default."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 11,
                    "reviewer": {
                        "name": "Zhenfei Tai",
                        "email": "ztai@google.com",
                        "username": "ztai-goog"
                    },
                    "message": "Done"
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 15,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "nit;  Should be ="
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 15,
                    "reviewer": {
                        "name": "Zhenfei Tai",
                        "email": "ztai@google.com",
                        "username": "ztai-goog"
                    },
                    "message": "Done"
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 15,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "I think this depends on protobuf, not protobuf native. This needs to be considered from the perspective that the output code is leveraging it. You might even need to add RDEPENDS_${PN}-generator += \"protobuf-native\" if the python routines have it as an internal dependency."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 15,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Ack"
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 17,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This should probably be in one of our bbappends specific to our distro.  Ideally this recipe would go to open embedded at some point, in which case we don't want to make assumptions like this for others."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 17,
                    "reviewer": {
                        "name": "Zhenfei Tai",
                        "email": "ztai@google.com",
                        "username": "ztai-goog"
                    },
                    "message": "Removed from here."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 17,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Or just generate both. But the default distro assumes the listed combination"
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 21,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "If the generator relies on python3, we should have that in the RDEPENDS when building that specific target."
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "line": 21,
                    "reviewer": {
                        "name": "Zhenfei Tai",
                        "email": "ztai@google.com",
                        "username": "ztai-goog"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "type": "ADDED",
                    "insertions": 29,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 29,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "e3979e8f47c5c804cf6cde6510e845da5afe0dbc",
            "parents": [
                "b19a57fc39f3da4d9380d00c4b9793567eb6ffcf"
            ],
            "ref": "refs/changes/22/41822/3",
            "uploader": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "createdOn": 1617917838,
            "author": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_git.bb",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 25,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "e1e284797216b2a90d9ef609a309ba837fcdb892",
            "parents": [
                "b19a57fc39f3da4d9380d00c4b9793567eb6ffcf"
            ],
            "ref": "refs/changes/22/41822/4",
            "uploader": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "createdOn": 1617919499,
            "author": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_0.4.5.bb",
                    "type": "ADDED",
                    "insertions": 24,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 24,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "cd9f5f00d75fe3735eebe886a1e0701bb25ea967",
            "parents": [
                "f9995a8cf0d0096355ffc1c020e0617c40762f3f"
            ],
            "ref": "refs/changes/22/41822/5",
            "uploader": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "createdOn": 1617939898,
            "author": {
                "name": "Zhenfei Tai",
                "email": "ztai@google.com",
                "username": "ztai-goog"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meta-google/recipes-google/nanopb/nanopb_0.4.5.bb",
                    "type": "ADDED",
                    "insertions": 24,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 24,
            "sizeDeletions": 0
        }
    ]
}