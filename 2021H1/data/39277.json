{
    "project": "openbmc/dbus-sensors",
    "branch": "master",
    "id": "I4199b0498370e72992d218f0ac28764ac11429e5",
    "number": 39277,
    "subject": "fansensor: Add fan present support",
    "owner": {
        "name": "lotus xu",
        "email": "xuxiaohan@bytedance.com",
        "username": "lotus0007"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/dbus-sensors/+/39277",
    "commitMessage": "fansensor: Add fan present support\n\nAdd fan present support for pca9555 GPIO, that does not has interrupt\nsupport and thus has to poll the GPIO to detect the fan presence.\n\nTested: `busctl introspect xyz.openbmc_project.FanSensor\n        /xyz/openbmc_project/inventory/Fan1_0`\n        can see Present property\n\nSigned-off-by: Lotus Xu <xuxiaohan@bytedance.com>\nChange-Id: I4199b0498370e72992d218f0ac28764ac11429e5\n",
    "createdOn": 1609232823,
    "lastUpdated": 1623136685,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1609232823,
            "reviewer": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1609232837,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nUser not approved, see admin, no CI"
        },
        {
            "timestamp": 1609233443,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(1 comment)"
        },
        {
            "timestamp": 1609233556,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1609883205,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 1:\n\n(4 comments)"
        },
        {
            "timestamp": 1612217048,
            "reviewer": {
                "name": "Yong Zhao",
                "email": "yozhao@google.com",
                "username": "YongZhao12"
            },
            "message": "Patch Set 1:\n\n(4 comments)"
        },
        {
            "timestamp": 1612499678,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1612499693,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1612499734,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1612500114,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/11944/ : FAILURE"
        },
        {
            "timestamp": 1612500887,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1612500903,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1612501585,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/11947/ : SUCCESS"
        },
        {
            "timestamp": 1612540294,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3:\n\nSorry for the drive-by review, but the kernel will do the polling for you: https://github.com/openbmc/linux/blob/dev-5.8/arch/arm/boot/dts/aspeed-bmc-opp-witherspoon.dts#L84"
        },
        {
            "timestamp": 1612540396,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3:\n\n> Patch Set 3:\n> \n> Sorry for the drive-by review, but the kernel will do the polling for you: https://github.com/openbmc/linux/blob/dev-5.8/arch/arm/boot/dts/aspeed-bmc-opp-witherspoon.dts#L84\n\noh I guess that uses gpio keys.  probably not what you want."
        },
        {
            "timestamp": 1612547830,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n> Patch Set 3:\n> \n> Sorry for the drive-by review, but the kernel will do the polling for you: https://github.com/openbmc/linux/blob/dev-5.8/arch/arm/boot/dts/aspeed-bmc-opp-witherspoon.dts#L84\n\nThat will poll normal GPIO.  Is it able to poll i2c connected GPIO?"
        },
        {
            "timestamp": 1612547869,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n> Patch Set 3:\n> \n> > Patch Set 3:\n> > \n> > Sorry for the drive-by review, but the kernel will do the polling for you: https://github.com/openbmc/linux/blob/dev-5.8/arch/arm/boot/dts/aspeed-bmc-opp-witherspoon.dts#L84\n> \n> That will poll normal GPIO.  Is it able to poll i2c connected GPIO?\n\nNever mind... I immediately answered my own question."
        },
        {
            "timestamp": 1612684961,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 4: Patch Set 3 was rebased."
        },
        {
            "timestamp": 1612684975,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1612685240,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12021/ : SUCCESS"
        },
        {
            "timestamp": 1612685708,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Patch Set 4:\n\n> Patch Set 3:\n> \n> > Patch Set 3:\n> > \n> > Sorry for the drive-by review, but the kernel will do the polling for you: https://github.com/openbmc/linux/blob/dev-5.8/arch/arm/boot/dts/aspeed-bmc-opp-witherspoon.dts#L84\n> \n> oh I guess that uses gpio keys.  probably not what you want.\n\nYup, we are encouraged to use libgpiod to read the gpios, so we did not use the gpio-keys-polled driver. (Actually we did but according to the discussion in Discord, we changed the code to poll the gpio by libgpiod)"
        },
        {
            "timestamp": 1614295627,
            "reviewer": {
                "name": "Yong Zhao",
                "email": "yozhao@google.com",
                "username": "YongZhao12"
            },
            "message": "Patch Set 4:\n\n(3 comments)"
        },
        {
            "timestamp": 1614295929,
            "reviewer": {
                "name": "Yong Zhao",
                "email": "yozhao@google.com",
                "username": "YongZhao12"
            },
            "message": "Patch Set 4:\n\nAlso, you did not address the previous comments properly, did you?"
        },
        {
            "timestamp": 1614491830,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1614491842,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1614491906,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Patch Set 5:\n\n(3 comments)\n\n> Patch Set 4:\n> \n> Also, you did not address the previous comments properly, did you?\n\nSorry for the delay. The comments are now fixed.\nAnd thanks for the comments, the code is much more clean now."
        },
        {
            "timestamp": 1614492040,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/13129/ : SUCCESS"
        },
        {
            "timestamp": 1614492130,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1614492145,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1614492340,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/13132/ : SUCCESS"
        },
        {
            "timestamp": 1614624837,
            "reviewer": {
                "name": "Yong Zhao",
                "email": "yozhao@google.com",
                "username": "YongZhao12"
            },
            "message": "Patch Set 6:\n\n(1 comment)\n\nOne comment, otherwise looks good to me."
        },
        {
            "timestamp": 1616569370,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1616569387,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1616569436,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Patch Set 7:\n\n(1 comment)\n\n> Patch Set 6:\n> \n> (1 comment)\n> \n> One comment, otherwise looks good to me."
        },
        {
            "timestamp": 1616569519,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/14283/ : SUCCESS"
        },
        {
            "timestamp": 1616608717,
            "reviewer": {
                "name": "Yong Zhao",
                "email": "yozhao@google.com",
                "username": "YongZhao12"
            },
            "message": "Patch Set 7: Code-Review+1"
        },
        {
            "timestamp": 1617143864,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1617167192,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1617307283,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1617400628,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 7:\n\n(4 comments)\n\nIncomplete comments, but I suspect it's going to force some changes that will invalidate a lot of this patch."
        },
        {
            "timestamp": 1618991601,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Patch Set 7:\n\n(5 comments)"
        },
        {
            "timestamp": 1618992102,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 8."
        },
        {
            "timestamp": 1618992120,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618992245,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15869/ : SUCCESS"
        },
        {
            "timestamp": 1619502692,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Patch Set 8:\n\n@Ed @Zhikui All the comments are fixed, could you kindly review this patch?"
        },
        {
            "timestamp": 1619503002,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 9: Patch Set 8 was rebased."
        },
        {
            "timestamp": 1619503016,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1619503147,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/16245/ : SUCCESS"
        },
        {
            "timestamp": 1619561356,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 9:\n\n(2 comments)"
        },
        {
            "timestamp": 1623090322,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 9:\n\nis this patchset still being worked?"
        },
        {
            "timestamp": 1623136585,
            "reviewer": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "message": "Patch Set 9: Code-Review-1\n\n> Patch Set 9:\n> \n> is this patchset still being worked?\n\nThere is no update on the above comment, and I could not find a proper way to tell if a i2c supports interrupt or not.\nLet me drop this patch."
        },
        {
            "timestamp": 1623136685,
            "reviewer": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "message": "Abandoned"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "6adf232c0a7928aff96f53f4d3ecef16d5d64c79",
            "parents": [
                "6736d4b2a77cec00a8919f26035176c8b8025a4d"
            ],
            "ref": "refs/changes/77/39277/1",
            "uploader": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "createdOn": 1609232823,
            "author": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Yong Zhao",
                        "email": "yozhao@google.com",
                        "username": "YongZhao12"
                    },
                    "message": "I think more explanation sentences are needed, as it is a bit hard for people who are not familiar with this area to get to know why you made the changes."
                },
                {
                    "file": "CMakeLists.txt",
                    "line": 179,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please add this to the entity-manager configuration, not a compile time config."
                },
                {
                    "file": "CMakeLists.txt",
                    "line": 179,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "Fixed at PS2"
                },
                {
                    "file": "include/TachSensor.hpp",
                    "line": 21,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Move this into PresenceSensor so no need for a separate namespace"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 219,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "This can be moved between line 225 and line 226 to avoid duplication of code"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 248,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This is a blocking call.  Please use the character device to get events on change.  x86-power-control has examples of merging GPIOs with boost asio."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 266,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "duplicate line 263"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 277,
                    "reviewer": {
                        "name": "Yong Zhao",
                        "email": "yozhao@google.com",
                        "username": "YongZhao12"
                    },
                    "message": "better to use the type explicitly for improved readability."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 282,
                    "reviewer": {
                        "name": "Yong Zhao",
                        "email": "yozhao@google.com",
                        "username": "YongZhao12"
                    },
                    "message": "This will overwrite the the case for gpiochip0. Is it intended?"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 307,
                    "reviewer": {
                        "name": "Yong Zhao",
                        "email": "yozhao@google.com",
                        "username": "YongZhao12"
                    },
                    "message": "a space is needed after ,"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 320,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Is it OK to read even if it is not \"Interruptible\"? Trying to reduce the places that the flag has to be checked."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "CMakeLists.txt",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "include/TachSensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "src/TachSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 83,
                    "deletions": -37
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 37
        },
        {
            "number": 2,
            "revision": "f32bc0d83ecd19006856fc7c7acc878c5ab7225e",
            "parents": [
                "feb19ef095c4ab9ec037b2f23ab6318f59a96eab"
            ],
            "ref": "refs/changes/77/39277/2",
            "uploader": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "createdOn": 1612499678,
            "author": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "include/TachSensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "src/TachSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 109,
                    "deletions": -41
                }
            ],
            "sizeInsertions": 118,
            "sizeDeletions": 41
        },
        {
            "number": 3,
            "revision": "9628008807ee74a663f48ed5464df5f7c034a904",
            "parents": [
                "feb19ef095c4ab9ec037b2f23ab6318f59a96eab"
            ],
            "ref": "refs/changes/77/39277/3",
            "uploader": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "createdOn": 1612500887,
            "author": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "include/TachSensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "src/TachSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 109,
                    "deletions": -41
                }
            ],
            "sizeInsertions": 118,
            "sizeDeletions": 41
        },
        {
            "number": 4,
            "revision": "e853b93febd64782ac32f0f766bc3f5ae70abc25",
            "parents": [
                "495855861648f082a73d4ba4afe23262d6fb0ad0"
            ],
            "ref": "refs/changes/77/39277/4",
            "uploader": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "createdOn": 1612684961,
            "author": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "src/TachSensor.cpp",
                    "line": 206,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Considering a majority of this implementation is changing, does it make sense to roll this into another class entirely?"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 206,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "The two implementation (gpio interrupt and polling) do share a mount of code, and they are both presence sensors, so for now I prefer to use the same class."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 206,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "getValue and update are the only things that are shared between the two implementations.  I'd like to see this better abstracted, but if you have other ideas, I won't tell you how it should be done."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 218,
                    "reviewer": {
                        "name": "Yong Zhao",
                        "email": "yozhao@google.com",
                        "username": "YongZhao12"
                    },
                    "message": "Better to call it InitGPIOInterruptibleFlag() or something like that. checkGPIOInterruptible() sounds like that you should return something."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 218,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 257,
                    "reviewer": {
                        "name": "Yong Zhao",
                        "email": "yozhao@google.com",
                        "username": "YongZhao12"
                    },
                    "message": "Seems you can do this to share this piece of code:\n\ntry\n{\n    if (...)\n    else\n}\ncatch (std::system_error&)"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 257,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This doesn't look right to me.  gpiochip0 is no more special than gpiochip1.  They're all just names and indexes."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "That's true. Do you have any suggest on how to represent this info? Maybe an extra property on Dbus/json to tell if the GPIO should use interrupt or polling?"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "It's not about representation, it's about what the kernel chip supports.  You might want to look at the kernel interfaces to see if there's a sysfs interface that will tell you, or do something like try to event it, and if you get an unsupported error code, fall back to polling."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 312,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "should be std::move"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 312,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 341,
                    "reviewer": {
                        "name": "Yong Zhao",
                        "email": "yozhao@google.com",
                        "username": "YongZhao12"
                    },
                    "message": "You can do this:\n\nif (previousStatus == status)  return;\n\nThen share the if else part in the end."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 341,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "include/TachSensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "src/TachSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 109,
                    "deletions": -41
                }
            ],
            "sizeInsertions": 118,
            "sizeDeletions": 41
        },
        {
            "number": 5,
            "revision": "a8a867d60bf96a2fefd97890d6300ee9773d94ff",
            "parents": [
                "a0683a889a12bf665595ccdcb349c5f4ab321eea"
            ],
            "ref": "refs/changes/77/39277/5",
            "uploader": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "createdOn": 1614491830,
            "author": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "include/TachSensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "src/TachSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 84,
                    "deletions": -34
                }
            ],
            "sizeInsertions": 93,
            "sizeDeletions": 34
        },
        {
            "number": 6,
            "revision": "dbfcd7fea470d8af602493778a4ea8704ea20ac9",
            "parents": [
                "a0683a889a12bf665595ccdcb349c5f4ab321eea"
            ],
            "ref": "refs/changes/77/39277/6",
            "uploader": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "createdOn": 1614492130,
            "author": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "src/TachSensor.cpp",
                    "line": 255,
                    "reviewer": {
                        "name": "Yong Zhao",
                        "email": "yozhao@google.com",
                        "username": "YongZhao12"
                    },
                    "message": "Some one mentioned this before: this line is the same as line 252, which does not seem right."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 255,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "Done.\nRemove the \"gpioFd.close();\" on line 252."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 268,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "?  How does the name of the chip determine if it's interrupt capable?"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 268,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "This is actually specific to aspeed.\nOn aspeed, gpiochip0 is the \"native\" one on chip, which supports gpio interrupt.\nIf there are other GPIO chips, they are GPIO expanders on i2c that do not support interrupt.\n\nPossibly we should specify this in entity-manager's json config?"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "include/TachSensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "src/TachSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 83,
                    "deletions": -33
                }
            ],
            "sizeInsertions": 92,
            "sizeDeletions": 33
        },
        {
            "number": 7,
            "revision": "9e164a796cfe1614c2eb5b33815aa0fff100759d",
            "parents": [
                "373225765ec76e358d11b2ee58488a72fc6c446e"
            ],
            "ref": "refs/changes/77/39277/7",
            "uploader": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "createdOn": 1616569370,
            "author": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "src/TachSensor.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "timer cancel should be added to line 280, currently it will just fall through line84 and continue to line292, which will re-start the timer"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "This is kind of expected behavior.\nThis functions is invoked when the timer expires (if it's using polling), and the ec will be OK, and fall back to line 290 to call `read()` to get the fan presence sensor, and then schedule the next timer.\n\nIf we split the logic, the handler code will look like:\n\n if (isGPIOInterruptible)\n {\n     ... // existing code, including read();\n }\n else\n {\n     read();\n }\n monitorPresence();\n\nIt's OK to combine the logic and use one `read()`."
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "When line 258 is called, ec would be operation_aborted, we would want return like line 282, right?"
                },
                {
                    "file": "src/TachSensor.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "yulei.sh@bytedance.com",
                        "username": "mine260309"
                    },
                    "message": "Oh I get your point.\nFixed"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "include/TachSensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "src/TachSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 83,
                    "deletions": -34
                }
            ],
            "sizeInsertions": 92,
            "sizeDeletions": 34
        },
        {
            "number": 8,
            "revision": "c6ce05b117ceef7a4d47416e102b43ff49d25261",
            "parents": [
                "12e3d67e3ba76bc832e2e1e1fc38933b055afd79"
            ],
            "ref": "refs/changes/77/39277/8",
            "uploader": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "createdOn": 1618992102,
            "author": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "include/TachSensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "src/TachSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 84,
                    "deletions": -34
                }
            ],
            "sizeInsertions": 93,
            "sizeDeletions": 34
        },
        {
            "number": 9,
            "revision": "371bf68873f250b15c3e65b695ca5a69b663369c",
            "parents": [
                "eb0b84de9fd39a74a4a67990de6054b9d9f49833"
            ],
            "ref": "refs/changes/77/39277/9",
            "uploader": {
                "name": "Lei YU",
                "email": "yulei.sh@bytedance.com",
                "username": "mine260309"
            },
            "createdOn": 1619503002,
            "author": {
                "name": "lotus xu",
                "email": "xuxiaohan@bytedance.com",
                "username": "lotus0007"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "include/TachSensor.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "src/TachSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 84,
                    "deletions": -34
                }
            ],
            "sizeInsertions": 93,
            "sizeDeletions": 34
        }
    ]
}