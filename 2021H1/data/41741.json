{
    "project": "openbmc/phosphor-power",
    "branch": "master",
    "id": "Ib8dd23465bfd36b510197a88d41fc8419862f33b",
    "number": 41741,
    "subject": "psu-ng: Validate configuration during power on",
    "owner": {
        "name": "Adriana Kobylak",
        "email": "anoo@linux.ibm.com",
        "username": "anoo1"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-power/+/41741",
    "commitMessage": "psu-ng: Validate configuration during power on\n\nCreate a function to validate the power supply configuration. Initially,\ncheck that all power supplies are of the same model, and if not, create\nan error log. This function will later add checks for total number of\npower supplies and expected input voltage.\n\nThe validation is run on every power on. To cover the case where entity\nmanager has not run yet on power, trigger the validation on interfaces\nadded signal. Use a boolean flag to determine if the validation needs to\nbe run to avoid running it multiple times.\n\nTested: Verified the validation was successful on Rainier.\n        Verified the error log data:\n$ curl -k -H \"X-Auth-Token: $token\" \\\n  https://${bmc}/xyz/openbmc_project/logging/entry/2\n{\n  \"data\": {\n    \"AdditionalData\": [\n      \"ACTUAL_MODEL=51E8\",\n      \"CALLOUT_INVENTORY_PATH=/xyz/openbmc_project/inventory/system/chassis/motherboard/powersupply1\",\n      \"EXPECTED_MODEL=51E9\"\n    ],\n    \"Associations\": [],\n    \"Id\": 2,\n    \"Message\":\n\"xyz.openbmc_project.Power.PowerSupply.Error.NotSupported\",\n    \"Path\":\n\"/var/lib/phosphor-logging/extensions/pels/logs/2021040718580625_50000002\",\n\nChange-Id: Ib8dd23465bfd36b510197a88d41fc8419862f33b\nSigned-off-by: Adriana Kobylak <anoo@us.ibm.com>\n",
    "createdOn": 1617211451,
    "lastUpdated": 1624914311,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1617211451,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1617211471,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617211549,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/14659/ : SUCCESS"
        },
        {
            "timestamp": 1617220193,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1617221190,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1617640148,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1617651281,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1617657275,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1617721999,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1617722007,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1617807724,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1617807734,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617807844,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1617807863,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617807866,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/14976/ : ABORTED"
        },
        {
            "timestamp": 1617807894,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 3:\n\nCreating an error for now until we get feedback about the EM severity fields."
        },
        {
            "timestamp": 1617807941,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/14977/ : SUCCESS"
        },
        {
            "timestamp": 1617807947,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1617808586,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1617813870,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 3:\n\n(1 comment)\n\nLack of a co-req system in Gerrit makes it not completely obvious that there is a message registry update commit that goes with this. I am assuming there is one with Mismatched that you plan on changing to NotSupported."
        },
        {
            "timestamp": 1617823432,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1617823458,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617823540,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/14996/ : SUCCESS"
        },
        {
            "timestamp": 1617823547,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 4:\n\n(1 comment)\n\n> Patch Set 3:\n> \n> (1 comment)\n> \n> Lack of a co-req system in Gerrit makes it not completely obvious that there is a message registry update commit that goes with this. I am assuming there is one with Mismatched that you plan on changing to NotSupported.\n\nYeah, I wanted to get some feedback on the name. Now that we have it, created a commit to add the NotSupported error: https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-logging/+/42019"
        },
        {
            "timestamp": 1617823631,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1617831141,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1617911141,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Patch Set 4:\n\n(3 comments)"
        },
        {
            "timestamp": 1618253822,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1618253835,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618254174,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 5:\n\n(4 comments)"
        },
        {
            "timestamp": 1618254443,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15267/ : SUCCESS"
        },
        {
            "timestamp": 1618285412,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 5: Code-Review+1\n\n(1 comment)\n\nIt looks like good from the code specification."
        },
        {
            "timestamp": 1618325319,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1618331364,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1618332277,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1618332570,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 5:\n\nTracked down the NotSupported commit for phosphor-logging: https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-logging/+/42019"
        },
        {
            "timestamp": 1618407768,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1618501607,
            "reviewer": {
                "name": "Derek Howard",
                "email": "derekh@us.ibm.com",
                "username": "derekhoward55"
            },
            "message": "Patch Set 5:\n\n(2 comments)"
        },
        {
            "timestamp": 1623353680,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1623353704,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1623354112,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/19387/ : SUCCESS"
        },
        {
            "timestamp": 1623355630,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1623355772,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 6:\n\n(2 comments)"
        },
        {
            "timestamp": 1623361819,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1623684235,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1623684744,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1623684763,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1623684804,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1623685665,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/19627/ : SUCCESS"
        },
        {
            "timestamp": 1623872750,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Uploaded patch set 8: Patch Set 7 was rebased."
        },
        {
            "timestamp": 1623872767,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1623873226,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/19914/ : SUCCESS"
        },
        {
            "timestamp": 1623878080,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Patch Set 8: Code-Review+1"
        },
        {
            "timestamp": 1623948659,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1624024807,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1624472375,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Uploaded patch set 9."
        },
        {
            "timestamp": 1624472389,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624472627,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 9:\n\n(1 comment)"
        },
        {
            "timestamp": 1624472813,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/20536/ : SUCCESS"
        },
        {
            "timestamp": 1624575184,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 9:\n\n(1 comment)"
        },
        {
            "timestamp": 1624630601,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 10: Commit message was updated."
        },
        {
            "timestamp": 1624630645,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 10:\n\n(1 comment)"
        },
        {
            "timestamp": 1624642190,
            "reviewer": {
                "name": "Derek Howard",
                "email": "derekh@us.ibm.com",
                "username": "derekhoward55"
            },
            "message": "Patch Set 10: Code-Review+1\n\nLooks good, I assume we'll add the SRC to the message registry with a later commit."
        },
        {
            "timestamp": 1624644592,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 10: Code-Review+1"
        },
        {
            "timestamp": 1624646445,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 10:\n\n> Patch Set 10: Code-Review+1\n> \n> Looks good, I assume we'll add the SRC to the message registry with a later commit.\n\nYep, I've set the commit to Ready for Review: https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-logging/+/42019"
        },
        {
            "timestamp": 1624913319,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Patch Set 10: Code-Review+2"
        },
        {
            "timestamp": 1624914311,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Change has been successfully merged by Shawn McCarney"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "c84b646a1dede420e274603c9fb6c399f98f28cb",
            "parents": [
                "5eae692fb974c59df4130bd61645ee3ef3e15bd3"
            ],
            "ref": "refs/changes/41/41741/1",
            "uploader": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "createdOn": 1617211451,
            "author": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 436,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Do you have plans to create an event log too?"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 436,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Yeah, the plan would be to have a behavior based on a configuration option, so that the psu app could be compiled with an option to create an event log, and/or halt power on, bring the system to a lower power usage, etc, but all those being config options that can be opted in.\n\nDo we think that creating an event log should be the default and any system behavior be the opt-in options?"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 436,
                    "reviewer": {
                        "name": "Shawn McCarney",
                        "email": "shawnmm@us.ibm.com",
                        "username": "smccarney"
                    },
                    "message": "Would it make sense to have that option in EM next to the other data?\n\ne.g. here is the config that should be there, and here is what to do if it is not"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 436,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "That'd be useful. I asked Ed in Discord if 'actions' could be added to EM, waiting for his reply."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 436,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "If IBM systems need the different behaviors then it makes sense to be an EM option.  If not, then chances are nobody would ever tweak this option you so you may as well just default to creating an error log."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 436,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Yeah good point. We'll likely use different options for the IBM systems since the original request was to add compile-time options. Ed mentioned that 'severities' could be added to EM, so that ERROR could be creating an error log, CRITICAL could be some action like power off, etc. Going to go add that to the schema and come back to this commit. Setting it as WIP."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 436,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Creating an error for now, we can change to choose behavior once we get feedback on the EM change."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "line": 226,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "nit: spelling"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "line": 226,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Ack"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "line": 226,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 37,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "63fded007649a56313b4b49bb49f6a9551efb9ac",
            "parents": [
                "1553cd9a91df1d4cd0d1ba2feb53ba63004d3fdd"
            ],
            "ref": "refs/changes/41/41741/2",
            "uploader": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "createdOn": 1617807724,
            "author": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 31,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 43,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "24edfc9cb523fe5e632290ce87c36ec90967e4c6",
            "parents": [
                "1553cd9a91df1d4cd0d1ba2feb53ba63004d3fdd"
            ],
            "ref": "refs/changes/41/41741/3",
            "uploader": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "createdOn": 1617807844,
            "author": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 444,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "As I continue to add more checks to this, started to think that maybe any error condition should be something like \"Error.NotSupported\" instead of specifics like \"Mismatched\", or \"NotEnough\" etc."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 444,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "I would agree that something more generic like NotSupported is possibly better. The AdditionalData and/or the journal tracing should give a more specific reason as to why it is not supported."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 444,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Done. Agree, changed to NotSupported."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 31,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 43,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "039c62a8354ab22e6ddb7720d831171b5c6ec0b0",
            "parents": [
                "1553cd9a91df1d4cd0d1ba2feb53ba63004d3fdd"
            ],
            "ref": "refs/changes/41/41741/4",
            "uploader": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "createdOn": 1617823432,
            "author": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 279,
                    "reviewer": {
                        "name": "Shawn McCarney",
                        "email": "shawnmm@us.ibm.com",
                        "username": "smccarney"
                    },
                    "message": "If EM hasn't put the data needed for this yet on D-Bus, does it get checked later when the data is available?  Do we need a call to validateConfig() in the signal handler for EM interfaces added?"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 279,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "The challenge is that individual EM interfaces trigger the callback, so we don't know when all the interfaces are done being added to trigger the validation. I think we're ok on this rare case when the EM interfaces are not present and power on is issued, especially with the new regulators code that would block the power on until EM is present? https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-power/+/41824"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 279,
                    "reviewer": {
                        "name": "Shawn McCarney",
                        "email": "shawnmm@us.ibm.com",
                        "username": "smccarney"
                    },
                    "message": "Is the issue that you need one xyz.openbmc_project.Configuration.SupportedConfiguration interface to be found as well as N copies of the xyz.openbmc_project.Configuration.IBMCFFPSConnector interface before config validation can be done?\n\nDoes the power state change after pgoods have been established?  If so, you are correct that this code will run after the regulators app has waited for EM to publish the compatible systems interface.  I'm not sure if there is a case where EM has published that interface but not the ones you are looking for.\n\nBrandon, what do you think here?"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 279,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "I thought I saw some cases where that Compatible interface stuff showed up prior to the IBMCFFPSConnector interfaces. I wonder if it was seen as more obvious when I had some debug tracing put in when trying to get the inerfacesAdded for IBMCFFPSConnector.\n\nIt would seem that maybe we would want to check if the interfacesAdded happens when the power is already on, but we probably would not want to run that twice."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 279,
                    "reviewer": {
                        "name": "Derek Howard",
                        "email": "derekh@us.ibm.com",
                        "username": "derekhoward55"
                    },
                    "message": "Sorry for late response.\n\nIf the configs required from EM never shows up, I think we need to log an error because they might have incorrect ps's attached and could be at risk of system crashing and data loss.  Hopefully the likelyhood is extremely rare that the CompatibleSystems interface that the vrms use does show up but the ones we use for this don't, but I have heard nothing guarantees that this can't happen.\n\nSaying that, and I'm assuming we do this ps validation after the vrm config happens and before we start the pon sequence, if we don't have the EM config yet when we do this can we log an error (details TBD), and let the boot continue.  If/when the EM data eventually shows up, then do the validation then, and log an error if it fails?\n\nWe'd need to work out the details later what SRC do we log, what to put in the iso procedure for both cases etc."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 279,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Added a check so that on interfaces added we call the validation if both the interfaces have been processed:\nif (powerOn && !psus.empty() && !supportedConfigs.empty())\n\nAlso added a flag to mark if the validation has passed, to avoid doing the validation multiple times in a row."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 421,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Changed it to string, since need the model to stick around for the subsequent validation in the next commit."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 441,
                    "reviewer": {
                        "name": "Shawn McCarney",
                        "email": "shawnmm@us.ibm.com",
                        "username": "smccarney"
                    },
                    "message": "Since you are assigning into a std::string, is there a reason to use the C style string?  Same question on line below."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 441,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Done. Ugh thanks, just habit since the phosphor-logging APIs only take C strings."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 442,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Would this need a FRU callout?\n\nIf nothing else, maybe you could put the inventory paths of the PSs in the additionalData assuming you can get it from the object."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 442,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Added the inventory path for now until we hear if a FRU callout is needed."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 442,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "Looks like we used to basically point to the first power supply that we thought was not what it should be, with the PWRSPLY symbolic FRU, to an SRC for power supply missing. I am not sure if we want to mimic that for this or not. Adding the inventory path sounds good though."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 442,
                    "reviewer": {
                        "name": "Derek Howard",
                        "email": "derekh@us.ibm.com",
                        "username": "derekhoward55"
                    },
                    "message": "Can we discuss the correct SRC and callout info when we resolve the potential EM timing issue above?"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "line": 86,
                    "reviewer": {
                        "name": "Shawn McCarney",
                        "email": "shawnmm@us.ibm.com",
                        "username": "smccarney"
                    },
                    "message": "Do you need to add a call to validateConfig() here (poll for power state) to match the call in powerStateChanged() (callback for power state change)?"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "line": 86,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Done. Yeah, i can see a scenario where the cec is at powered on, and the BMC is rebooted, so when the psu-monitor app starts up, the state is already set to power on. Added it."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 43,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "9cd978b7fedf9a274893af8c72d48eade240c589",
            "parents": [
                "c12c53b985b9ac12c3c83df47371e7c2c70ae21b"
            ],
            "ref": "refs/changes/41/41741/5",
            "uploader": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "createdOn": 1618253822,
            "author": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 421,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "nit: std::string model{};"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 421,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 45,
            "sizeDeletions": 0
        },
        {
            "number": 6,
            "revision": "2f9bba7872cdd69bdbbfe1ccd94a5cae50ed2412",
            "parents": [
                "f06e8ab6a9470126591a2ec41d46bd6de3cd2e14"
            ],
            "ref": "refs/changes/41/41741/6",
            "uploader": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "createdOn": 1623353680,
            "author": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 456,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "when you return early here, does it matter if runValidateConfig doesn't get set to false?"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 456,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "The thought was to only set the runValidateConfig if the validation was successful to handle the EM interfaces added being triggered. This is probably more obvious in the next commit, where in the corner case where there are more than one different supported configuration defined for the system, and the first one that showed up in dbus didn't validate, an error is created, then the next supported config that appears on d-bus gets validated then the flag is set so that future d-bus interfaces if any don't trigger the validation anymore since the supported one has been found.\n\nBut in the case of mismatched models, a future d-bus interface is not going to fix things, so it can probably be set the false so it doesn't run again. Will add it."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 456,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Done. Setting it to false on mismatched levels, but not setting it if the supported config doesn't match on the next commit, added comments for clarity."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 52,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 70,
            "sizeDeletions": 0
        },
        {
            "number": 7,
            "revision": "21b20392227f310975357887bc15e9653de1ef4e",
            "parents": [
                "f06e8ab6a9470126591a2ec41d46bd6de3cd2e14"
            ],
            "ref": "refs/changes/41/41741/7",
            "uploader": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "createdOn": 1623684744,
            "author": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 56,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 74,
            "sizeDeletions": 0
        },
        {
            "number": 8,
            "revision": "eb94024e5c8a0b5177cf22eb08d78b0aec93c27d",
            "parents": [
                "d3a70d987614bb29ff326d911e41b4eb505a40df"
            ],
            "ref": "refs/changes/41/41741/8",
            "uploader": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "createdOn": 1623872750,
            "author": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 463,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "How is this going to work if this is starting up with power on, and entity-manager is adding inthe IBMCFFPSConnector entries?\n\nThe sequence I would typically see is:\nifacesAdded for Compatible Type.\n...\nifacesAdded for IBMCFFPSConnector\n...\nifacesAdded for IBMCFFPSConnector\n...\n\nIn other words, there is an interfaces added for each power supply. After the first one, psus.empty() would be false, but we did not add all the power supplies yet.\n\nWouldn't this only run validateConfig() with one power supply in the configuration, and then stop, even if there were say 3 more to add to finish out getting all the power supplies in the system?"
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 463,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "I don't know how one could even work around this, other than not checking if restarting with power on."
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "line": 463,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Removed setting it to false so that the validation runs for each PSU as they get added to D-Bus."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 56,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 74,
            "sizeDeletions": 0
        },
        {
            "number": 9,
            "revision": "718aefc5032291354197607274a66b806012a089",
            "parents": [
                "d3a70d987614bb29ff326d911e41b4eb505a40df"
            ],
            "ref": "refs/changes/41/41741/9",
            "uploader": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "createdOn": 1624472375,
            "author": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 16,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "doubled up word typo"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 16,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Done. Thanks."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 55,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 73,
            "sizeDeletions": 0
        },
        {
            "number": 10,
            "revision": "8f16fb5e81ec4d92cc94175d6fe0c6ec8a39f589",
            "parents": [
                "d3a70d987614bb29ff326d911e41b4eb505a40df"
            ],
            "ref": "refs/changes/41/41741/10",
            "uploader": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "createdOn": 1624630601,
            "author": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 55,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/psu_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 73,
            "sizeDeletions": 0
        }
    ]
}