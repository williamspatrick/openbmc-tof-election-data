{
    "project": "openbmc/libmctp",
    "branch": "master",
    "topic": "routing",
    "id": "I91eb79d0f13fb172724a3a5c2c9ff2a38536fd73",
    "number": 34293,
    "subject": "core: Introduce provisional endpoint IDs",
    "owner": {
        "name": "Andrew Jeffery",
        "email": "andrew@aj.id.au",
        "username": "amboar"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/libmctp/+/34293",
    "commitMessage": "core: Introduce provisional endpoint IDs\n\nDSP0236 outlines two addressing methods for message exchange in MCTP\nnetworks: with and without Endpoint ID association. Typically the MCTP\nheader contains valid, non-special source and destination endpoint IDs,\nhowever in some circumstances the special NULL endpoint ID may be used\nfor bus-peer communication. In the NULL endpoint ID scenario we must\nrely on bus device addresses to differentiate message sources.\n\nProvisional endpoint IDs isolate use of device addresses to the route\ntable by locally allocating an endpoint ID from a parallel\naddress-space. Provisional endpoint ID values are substituted in\nmessages on receipt or transmission as appropropriate, thereby allowing\nthe libmctp consumer to operate the same interface for sending and\nreceiving messages both before and after network initialisation has\noccurred.\n\nSigned-off-by: Andrew Jeffery <andrew@aj.id.au>\nChange-Id: I91eb79d0f13fb172724a3a5c2c9ff2a38536fd73\n",
    "createdOn": 1593619971,
    "lastUpdated": 1611014022,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1593619971,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1593620016,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1593620026,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Started https://jenkins.openbmc.org/job/ci-repository/323/"
        },
        {
            "timestamp": 1593620272,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/323/ : SUCCESS"
        },
        {
            "timestamp": 1593656888,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1593656914,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1593656924,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Started https://jenkins.openbmc.org/job/ci-repository/359/"
        },
        {
            "timestamp": 1593656963,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/359/ : SUCCESS"
        },
        {
            "timestamp": 1594835673,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1603888671,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1605067417,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1605067473,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1605067536,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/7653/ : FAILURE"
        },
        {
            "timestamp": 1605068670,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1605068707,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1605068755,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/7664/ : SUCCESS"
        },
        {
            "timestamp": 1611014022,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Abandoned\n\nThe provisional endpoint ID concept was a bit of a straw man to flush out other proposals, and there's not a lot of acceptance of the idea itself. I think it's served it's purpose and is unlikely to be merged, so I'm abandoning the patch."
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "a4e9db5fd395a65c844c5aa38f49dfd53fa150d8",
            "parents": [
                "d0d70136b0a6b8de26370f22ca88717eb92aa27b"
            ],
            "ref": "refs/changes/93/34293/1",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1593619971,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "CMakeLists.txt",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 202,
                    "deletions": -94
                },
                {
                    "file": "libmctp.h",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": -5
                },
                {
                    "file": "serial.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                },
                {
                    "file": "tests/test-utils.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -2
                },
                {
                    "file": "tests/test-utils.h",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "tests/test_cmds.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "tests/test_eid.c",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -5
                },
                {
                    "file": "tests/test_route.c",
                    "type": "MODIFIED",
                    "insertions": 233,
                    "deletions": -24
                },
                {
                    "file": "tests/test_seq.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "utils/mctp-demux-daemon.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 488,
            "sizeDeletions": 147
        },
        {
            "number": 2,
            "revision": "7a7c06d0809f5eda3cb4506b8ba5e5ae33f2c517",
            "parents": [
                "f480bfa9699764a90319b2476b7f739774b651eb"
            ],
            "ref": "refs/changes/93/34293/2",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1593656888,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 18,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "1. Going to end up with one Provisional EID for all the bus/address of the device which is in communication. \n(i.e), say when we are in bridge, we need to issue SetEndPointID with Destination NULL EID for that address (making a provisional EID).\n2. Need to understand the management of the same? When we will remove, from the way i see this, it is never going to be removed and will stay. \n3. Problem will happen (not worried about this one that much though), when the addressing exceeds with addition & removal of device.\nNote: Because even in that case for NULL EID to work (for assigning proper EID, we need provisional EID)."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 18,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "The provisional EID can be removed once it is no longer useful to whoever created it. If the device sends packets with a NULL EID then a new provisional EID will be created for it."
                },
                {
                    "file": "core.c",
                    "line": 1272,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "There is a problem here. \nSay, we have proper EID for a source, but the source is requesting a command with NULL SRC_EID, then we need to respond with NULL_EID. This case will have a problem with that approach, as it will match a valid one."
                },
                {
                    "file": "core.c",
                    "line": 1272,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "The intent of the API design is that you can't send to a NULL EID, you first have to allocate a provisional EID and use that."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "CMakeLists.txt",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 202,
                    "deletions": -94
                },
                {
                    "file": "libmctp.h",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": -5
                },
                {
                    "file": "serial.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                },
                {
                    "file": "tests/test-utils.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -2
                },
                {
                    "file": "tests/test-utils.h",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "tests/test_cmds.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "tests/test_eid.c",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -5
                },
                {
                    "file": "tests/test_route.c",
                    "type": "MODIFIED",
                    "insertions": 233,
                    "deletions": -24
                },
                {
                    "file": "tests/test_seq.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "utils/mctp-demux-daemon.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 488,
            "sizeDeletions": 147
        },
        {
            "number": 3,
            "revision": "e8e9f89f0ef574a6cd89d7daa64dc0677d0e1050",
            "parents": [
                "adbd1679ca0e1d15042ac540b8f76e4cb1cf545a"
            ],
            "ref": "refs/changes/93/34293/3",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1605067417,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "CMakeLists.txt",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 202,
                    "deletions": -94
                },
                {
                    "file": "libmctp.h",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": -5
                },
                {
                    "file": "serial.c",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -1
                },
                {
                    "file": "tests/test-utils.c",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -3
                },
                {
                    "file": "tests/test-utils.h",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -5
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "tests/test_cmds.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "tests/test_eid.c",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -5
                },
                {
                    "file": "tests/test_route.c",
                    "type": "MODIFIED",
                    "insertions": 239,
                    "deletions": -24
                },
                {
                    "file": "tests/test_seq.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "utils/mctp-demux-daemon.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 510,
            "sizeDeletions": 153
        },
        {
            "number": 4,
            "revision": "2174b8094ee4880640f61a7a2de60aa5512811ab",
            "parents": [
                "8bf57feff81a257f9290ad2a01935f9e5cab92fe"
            ],
            "ref": "refs/changes/93/34293/4",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1605068670,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "CMakeLists.txt",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 206,
                    "deletions": -94
                },
                {
                    "file": "libmctp.h",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": -5
                },
                {
                    "file": "serial.c",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -1
                },
                {
                    "file": "tests/test-utils.c",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -3
                },
                {
                    "file": "tests/test-utils.h",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -5
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "tests/test_cmds.c",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "tests/test_eid.c",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -5
                },
                {
                    "file": "tests/test_route.c",
                    "type": "MODIFIED",
                    "insertions": 239,
                    "deletions": -24
                },
                {
                    "file": "tests/test_seq.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "utils/mctp-demux-daemon.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 514,
            "sizeDeletions": 153
        }
    ]
}