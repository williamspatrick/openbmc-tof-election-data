{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I921cafeca8b2a1813f4aa4c41ecd01c831e3465b",
    "number": 40300,
    "subject": "Added Validation on MessageId and RegistryPrefix",
    "owner": {
        "name": "P Dheeraj Srujan Kumar",
        "email": "p.dheeraj.srujan.kumar@intel.com",
        "username": "dheerajpdsk"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/bmcweb/+/40300",
    "commitMessage": "Added Validation on MessageId and RegistryPrefix\n\nMessage ID's and Registry prefixes used to subscribe to an event\nwill be checked against allowed values.\nCorrected \"Task\" registry prefix to \"TaskEvent\".\n\nTested:\n - Validated POST action with different combinations of\n   Message id's and Registry Prefix.\n - Redfish validator passed.\n\nSigned-off-by: P Dheeraj Srujan Kumar <p.dheeraj.srujan.kumar@intel.com>\nChange-Id: I921cafeca8b2a1813f4aa4c41ecd01c831e3465b\n",
    "createdOn": 1612469747,
    "lastUpdated": 1618239949,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1612469747,
            "reviewer": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1612469764,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1612470193,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/11930/ : FAILURE"
        },
        {
            "timestamp": 1612470899,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(9 comments)\n\nBunch of minor fixes, otherwise looks good."
        },
        {
            "timestamp": 1612552639,
            "reviewer": {
                "name": "AppaRao Puli",
                "email": "apparao.puli@linux.intel.com",
                "username": "apuli1"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1612553757,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1614201717,
            "reviewer": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1614201748,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1614201776,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/13001/ : FAILURE"
        },
        {
            "timestamp": 1614202030,
            "reviewer": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1614202048,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1614202382,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/13002/ : FAILURE"
        },
        {
            "timestamp": 1614203676,
            "reviewer": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1614203693,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1614204638,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/13005/ : SUCCESS"
        },
        {
            "timestamp": 1614205183,
            "reviewer": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "message": "Patch Set 4:\n\n(4 comments)"
        },
        {
            "timestamp": 1614206521,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4: Code-Review+2"
        },
        {
            "timestamp": 1614206546,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4: Code-Review+1"
        },
        {
            "timestamp": 1614206968,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\nLGTM.  Leaving this open for a bit in case others have opinions."
        },
        {
            "timestamp": 1614752307,
            "reviewer": {
                "name": "AppaRao Puli",
                "email": "apparao.puli@linux.intel.com",
                "username": "apuli1"
            },
            "message": "Patch Set 4: Code-Review+1"
        },
        {
            "timestamp": 1617867853,
            "reviewer": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "message": "Uploaded patch set 5: Patch Set 4 was rebased."
        },
        {
            "timestamp": 1617867873,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617868594,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15046/ : SUCCESS"
        },
        {
            "timestamp": 1618048851,
            "reviewer": {
                "name": "Saravanan Palanisamy",
                "email": "saravanan.palanisamy@linux.intel.com",
                "username": "saravanan-palanisamy"
            },
            "message": "Patch Set 5: Code-Review+1\n\n@Ed : Can you please provide +2 and merge, since there are no further comments for past 1-month ?"
        },
        {
            "timestamp": 1618079791,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5:\n\nYep, sorry about that;  I thought I merged this already."
        },
        {
            "timestamp": 1618079795,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 6: Patch Set 5 was rebased"
        },
        {
            "timestamp": 1618079823,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618080553,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15219/ : SUCCESS"
        },
        {
            "timestamp": 1618199983,
            "reviewer": {
                "name": "Saravanan Palanisamy",
                "email": "saravanan.palanisamy@linux.intel.com",
                "username": "saravanan-palanisamy"
            },
            "message": "Patch Set 6:\n\nThanks Ed. Seems you again forgot to +2 & merge after rebase \ud83d\ude0a"
        },
        {
            "timestamp": 1618200180,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 6: Code-Review+2\n\n> Patch Set 6:\n> \n> Thanks Ed. Seems you again forgot to +2 & merge after rebase \ud83d\ude0a\n\nThis time it was intentional. I was waiting to make sure it still builds once rebased on master."
        },
        {
            "timestamp": 1618200183,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully merged by Ed Tanous"
        },
        {
            "timestamp": 1618239949,
            "reviewer": {
                "name": "Saravanan Palanisamy",
                "email": "saravanan.palanisamy@linux.intel.com",
                "username": "saravanan-palanisamy"
            },
            "message": "Patch Set 6:\n\nok. Thanks Ed"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "1de26615a0d45ac3fddb165cafa606111c2c7950",
            "parents": [
                "349a2ac3921e17ff0e2bce47ba6698112d586e67"
            ],
            "ref": "refs/changes/00/40300/1",
            "uploader": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "createdOn": 1612469747,
            "author": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "line": 68,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "inline."
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "line": 70,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "spans should be taken by value."
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "line": 85,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "inline."
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "line": 85,
                    "reviewer": {
                        "name": "P Dheeraj Srujan Kumar",
                        "email": "p.dheeraj.srujan.kumar@intel.com",
                        "username": "dheerajpdsk"
                    },
                    "message": "Done"
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "line": 88,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This string construction isn't required.  std::string can be directly compared against const char*"
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "line": 88,
                    "reviewer": {
                        "name": "P Dheeraj Srujan Kumar",
                        "email": "p.dheeraj.srujan.kumar@intel.com",
                        "username": "dheerajpdsk"
                    },
                    "message": "Done"
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "line": 136,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please split this onto two lines for clarity."
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "line": 400,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Need to return an error if this isn't filled?"
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "line": 400,
                    "reviewer": {
                        "name": "AppaRao Puli",
                        "email": "apparao.puli@linux.intel.com",
                        "username": "apuli1"
                    },
                    "message": "MessageId's is not mandatory parameter. So don't need to handle else part."
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "line": 400,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Gotcha.  Done."
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "line": 409,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I wonder if we need to do this deeper in the code.  If someone adds a subscription for all registries, then we add a new registry later, it would need to be supported, right?  That tells me this check probably needs to be in the add subscription call, not the message handler."
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "line": 409,
                    "reviewer": {
                        "name": "AppaRao Puli",
                        "email": "apparao.puli@linux.intel.com",
                        "username": "apuli1"
                    },
                    "message": "If registry prefix is not specified, In subscription store, storing it as empty only(subValue->registryPrefixes). So adding new registry, Will not impact the subscribers functionality( Example: If registry is empty and messageId's is empty, adding new registry later still work fine. If Regitry is empty and MessageId's have some entries, validation will happen while adding subscription. Adding new registry, will have no impact to subscriber either)\n\nThis code block is used only for validating MessageId's if anything added. So this vlidation is done during addition of subscription. If MessageId's are empty, This code is not used."
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "line": 409,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "yep, you're right, I misread this code, fine as is."
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "line": 423,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Spans should be taken by copy/value."
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "line": 423,
                    "reviewer": {
                        "name": "P Dheeraj Srujan Kumar",
                        "email": "p.dheeraj.srujan.kumar@intel.com",
                        "username": "dheerajpdsk"
                    },
                    "message": "Done"
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "line": 433,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I wonder if std::any_of would be more clear here.  Up to you if you want to try it, but it seems like it would be much more obvious what check you're doing."
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "line": 433,
                    "reviewer": {
                        "name": "P Dheeraj Srujan Kumar",
                        "email": "p.dheeraj.srujan.kumar@intel.com",
                        "username": "dheerajpdsk"
                    },
                    "message": "Agree.. it makes it more clear and simpler. Switched to std::any_of"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 37,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 43,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 80,
            "sizeDeletions": 15
        },
        {
            "number": 2,
            "revision": "6b2512cb9dcfefe4c1f425abd07d0d25f9c49268",
            "parents": [
                "feaf15005555a3099c7f22a7e3d16c99ccb40e72"
            ],
            "ref": "refs/changes/00/40300/2",
            "uploader": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "createdOn": 1614201717,
            "author": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 70,
            "sizeDeletions": 15
        },
        {
            "number": 3,
            "revision": "be6a3e4aec94625e1f8032d1534d195ec35c0f49",
            "parents": [
                "feaf15005555a3099c7f22a7e3d16c99ccb40e72"
            ],
            "ref": "refs/changes/00/40300/3",
            "uploader": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "createdOn": 1614202030,
            "author": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 69,
            "sizeDeletions": 15
        },
        {
            "number": 4,
            "revision": "43d0531e15f2846b18ea5f471cff6371433afd61",
            "parents": [
                "feaf15005555a3099c7f22a7e3d16c99ccb40e72"
            ],
            "ref": "refs/changes/00/40300/4",
            "uploader": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "createdOn": 1614203676,
            "author": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 69,
            "sizeDeletions": 15
        },
        {
            "number": 5,
            "revision": "e2aa3a29edf10a471bdaa1879b521472db8de1c8",
            "parents": [
                "dab0604af234bdd5010407031a01343d6c242edf"
            ],
            "ref": "refs/changes/00/40300/5",
            "uploader": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "createdOn": 1617867853,
            "author": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 69,
            "sizeDeletions": 15
        },
        {
            "number": 6,
            "revision": "b304bd7965eeba71b10645bc9bc3f64254cd242f",
            "parents": [
                "8d1b46d7f8d39db2ba048f9e9007106ca3a28c9b"
            ],
            "ref": "refs/changes/00/40300/6",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1618079795,
            "author": {
                "name": "P Dheeraj Srujan Kumar",
                "email": "p.dheeraj.srujan.kumar@intel.com",
                "username": "dheerajpdsk"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -12
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 69,
            "sizeDeletions": 15
        }
    ]
}