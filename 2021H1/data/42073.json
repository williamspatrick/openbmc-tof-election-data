{
    "project": "openbmc/phosphor-virtual-sensor",
    "branch": "master",
    "id": "I6d908fc206ef9c50316df606f71f47316ae6f9cf",
    "number": 42073,
    "subject": "Add MaxValue/MinValue setting in config",
    "owner": {
        "name": "Harvey Wu",
        "email": "Harvey.Wu@quantatw.com",
        "username": "harveyquta"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-virtual-sensor/+/42073",
    "commitMessage": "Add MaxValue/MinValue setting in config\n\n- Adding MaxValue, MinValue setting in json config file,\n  so sel-logger could show correct sensor value on journal log\n  if user set MaxValue, MinValue in config.\n\nTested:\n- set MaxValue: 127, MinValue: -128\n\n- modified virtual sensor formula to let trigger CriticalHigh\n\n- trigger threshold and see journal log and sel log\nJan 01 00:48:29 gbs sel-logger[435]: i2cool_0 sensor crossed a warning high threshold going high. Reading=57.000000 Threshold=35.000000.\nJan 01 00:48:29 gbs sel-logger[435]: i2cool_0 sensor crossed a critical high threshold going high. Reading=57.000000 Threshold=35.000000.\n\n1 |  Pre-Init  |0000002909| Temperature i2cool_0 | Upper Critical going high | Asserted | Reading 57 > Threshold 35 degrees C\n\nSigned-off-by: Harvey Wu <Harvey.Wu@quantatw.com>\nChange-Id: I6d908fc206ef9c50316df606f71f47316ae6f9cf\nSigned-off-by: Patrick Williams <patrick@stwcx.xyz>\n",
    "createdOn": 1617958466,
    "lastUpdated": 1619729772,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1617958466,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1617958479,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617958593,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/15186/ : FAILURE"
        },
        {
            "timestamp": 1617958728,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1617958744,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617958929,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15187/ : SUCCESS"
        },
        {
            "timestamp": 1617959373,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 3: Commit message was updated."
        },
        {
            "timestamp": 1617970946,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1617982933,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1617987593,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Patch Set 3:\n\n(4 comments)"
        },
        {
            "timestamp": 1617990237,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1619583425,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1619583441,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1619583466,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/16293/ : FAILURE"
        },
        {
            "timestamp": 1619583540,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1619583556,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1619583629,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/16294/ : SUCCESS"
        },
        {
            "timestamp": 1619583777,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Patch Set 5:\n\n(3 comments)"
        },
        {
            "timestamp": 1619680712,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1619680745,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1619680906,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/16368/ : SUCCESS"
        },
        {
            "timestamp": 1619703555,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1619703592,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1619703666,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 7: Code-Review+2\n\nI made minor changes to this patch.\n\nI agree with Ed that the better long-term support would be to automatically calculate min/max from the underlying sensors, but that is significantly more work.  This support is a good interim solution which we can deprecate in the future if someone wants to pick up auto-calculating the range.  (It may also be useful to be able to pin the min/max even if the underlying sensors have a larger range)"
        },
        {
            "timestamp": 1619704548,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 7:\n\n> Patch Set 7: Code-Review+2\n> \n> I made minor changes to this patch.\n> \n> I agree with Ed that the better long-term support would be to automatically calculate min/max from the underlying sensors, but that is significantly more work.  This support is a good interim solution which we can deprecate in the future if someone wants to pick up auto-calculating the range.  (It may also be useful to be able to pin the min/max even if the underlying sensors have a larger range)\n\nIn that case then this patchset is still missing the logic to actually clamp the output value between min and max, considering that mathematically they can go out of range with the wrong combination of inputs."
        },
        {
            "timestamp": 1619705135,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 7:\n\n> In that case then this patchset is still missing the logic to actually clamp the output value between min and max, considering that mathematically they can go out of range with the wrong combination of inputs.\n\nThanks for keeping us honest. ;)\n\nI created a follow up commit to add clamping."
        },
        {
            "timestamp": 1619705386,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 7:\n\n> Patch Set 7:\n> \n> > In that case then this patchset is still missing the logic to actually clamp the output value between min and max, considering that mathematically they can go out of range with the wrong combination of inputs.\n> \n> Thanks for keeping us honest. ;)\n> \n> I created a follow up commit to add clamping.\n\nFor what it's worth I only really thought of it because we messed this up the first time around when we build the CFM sensor and exit air temp sensor."
        },
        {
            "timestamp": 1619713860,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1619714137,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1619714236,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1619714549,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1619714737,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1619716654,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Uploaded patch set 8."
        },
        {
            "timestamp": 1619716668,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1619722616,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: -Ok-To-Test"
        },
        {
            "timestamp": 1619722619,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1619722698,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/16420/ : SUCCESS"
        },
        {
            "timestamp": 1619727878,
            "reviewer": {
                "name": "Mustafa Shehabi",
                "email": "mustafa.shehabi@fii-na.com",
                "username": "mustafa20192"
            },
            "message": "Patch Set 8: Code-Review+1\n\nI tested it works"
        },
        {
            "timestamp": 1619729765,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 8: Code-Review+2"
        },
        {
            "timestamp": 1619729772,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Change has been successfully merged by Patrick Williams"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "066e285a1ef9a6ef204bd9501c0bbbe3d46b66cd",
            "parents": [
                "187582bd2c1d55199d2f65f33b37b8d65b452ee6"
            ],
            "ref": "refs/changes/73/42073/1",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1617958466,
            "author": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "virtualSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "virtual_sensor_config.json",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 16,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "5f157e6b1d72894bfbd8cb757ecdaecd73e62b9b",
            "parents": [
                "187582bd2c1d55199d2f65f33b37b8d65b452ee6"
            ],
            "ref": "refs/changes/73/42073/2",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1617958728,
            "author": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "virtualSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "virtual_sensor_config.json",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 15,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "6c1a4b6f2c2c85550d5f765c7a2333a23f4b3f7e",
            "parents": [
                "187582bd2c1d55199d2f65f33b37b8d65b452ee6"
            ],
            "ref": "refs/changes/73/42073/3",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1617959373,
            "author": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Considering that the sensors this uses as input have the ability to adjust, I suspect that this value should be calculated at runtime, not hardcoded.  It seems like it should just be a matter of grabbing all your inputs Min/Max values, and plug them each into the equation to determine the possible min and max that this sensor could take.  This would require less complex config files."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Hi Ed,\nSorry, I don't really understand your mean. You mean it couldn't set virtual sensors' MaxValue/MinValue in its json file?\nBut for example, the phosphor-hwmon sensors' MaxValue/MinValue can hardcode in conf file, and dbus-sensor's HwmonTempSensors' is hardcode(https://github.com/openbmc/dbus-sensors/blob/master/src/HwmonTempSensor.cpp#L37).\nWhy cannot phosphor-virtual-sensor set MaxValue/MinValue in json file? Is there something I misunderstanding?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "If you have a virtual sensor that based on A and B, with the equation A.Value + B.Value\n\nThe max range for that is:\nA.MaxValue + B.MaxValue\n\nand the min range for that sensor is:\nA.MinValue + B.Minvalue\n\nIf A or B are something like power supplies, and are replaced with variants that have a larger range, the min values and max values need to be updated accordingly, but because they're hardcoded in this file, they can't be, or would need new sensors for every possible combination of PSUs.\n\nHwmonTempSensor can pull this from a config file because it's based on the actual input device, and isn't based on any other dbus inputs that it needs to consider, and we know the exact range that a tmp75 (for example) allows.\n\nI don't use phosphor-virtual-sensor because of other reasons, so it's up to the maintainers if they want to put it into the config file, it just seems like it's an opportunity to get it wrong, when it's easy enough to calculate automatically."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please test a calculation of inputs that takes this value out of range.  I don't see any code to clamp the values, which would be required here."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "OK, I will change my test case. Thanks."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "virtualSensor.cpp",
                    "line": 155,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I think these should default to either quiet_NaN or +/- infinity.  We should make an update to the xyz.openbmc_project.Sensor.Value interface to default them there as well."
                },
                {
                    "file": "virtualSensor.cpp",
                    "line": 155,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "I saw your PR. So I don't need to set default value here? Or I change this to NaN value like  threshold is better?"
                },
                {
                    "file": "virtualSensor.cpp",
                    "line": 155,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "I set the default value to NaN."
                },
                {
                    "file": "virtual_sensor_config.json",
                    "line": 15,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Is it ok if we just put these into the \"Desc\" dictionary?"
                },
                {
                    "file": "virtual_sensor_config.json",
                    "line": 15,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Thanks for suggestion. It seems better than my origin setting way. I will modified it."
                },
                {
                    "file": "virtual_sensor_config.json",
                    "line": 15,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done. Move to \"Desc\" group"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "virtualSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "virtual_sensor_config.json",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 15,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "2c0766697c2043301dbba09120977c2903f45720",
            "parents": [
                "d9aa22790f772a5a713e84076c25f34a595fffb6"
            ],
            "ref": "refs/changes/73/42073/4",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1619583425,
            "author": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "virtualSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "virtual_sensor_config.json",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 18,
            "sizeDeletions": 1
        },
        {
            "number": 5,
            "revision": "a4b1aced9c2161ca290aec55ed9187dc1e4de375",
            "parents": [
                "d9aa22790f772a5a713e84076c25f34a595fffb6"
            ],
            "ref": "refs/changes/73/42073/5",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1619583540,
            "author": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "virtualSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "virtual_sensor_config.json",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 18,
            "sizeDeletions": 1
        },
        {
            "number": 6,
            "revision": "5a61b064c1cea36b939a2964ec36325b33530e33",
            "parents": [
                "d9aa22790f772a5a713e84076c25f34a595fffb6"
            ],
            "ref": "refs/changes/73/42073/6",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1619680712,
            "author": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "virtualSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "virtual_sensor_config.json",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 18,
            "sizeDeletions": 1
        },
        {
            "number": 7,
            "revision": "4e71566c26ff3be9edfa6a20abf7792f9b6bf75f",
            "parents": [
                "d9aa22790f772a5a713e84076c25f34a595fffb6"
            ],
            "ref": "refs/changes/73/42073/7",
            "uploader": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "createdOn": 1619703555,
            "author": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "virtualSensor.cpp",
                    "line": 156,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Considering the target of this patch is IPMI, and IPMI dynamic doesn't handle non-rational numbers, this is a bad default to pick.  Most other things default to -127, and +128"
                },
                {
                    "file": "virtualSensor.cpp",
                    "line": 156,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "tbh, this code never does anything.  The code is only executed if contains is true, which means \"MaxValue\" is something.  The JSON code doesn't support a non-default lookup though so you have to supply it with something.   I just made sure the \"something\" is the same \"something\" that the underlying class defaults to.\n\nI want to change the generator to give some static constexprs based on what is in the YAML but that isn't done yet and nobody else has been enlightened enough to do it for me."
                },
                {
                    "file": "virtualSensor.cpp",
                    "line": 156,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Doh.  I was looking at code in my local repository for phosphor-dbus-interfaces which you similarly took issue with.\n\nhttps://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/42078"
                },
                {
                    "file": "virtualSensor.cpp",
                    "line": 156,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "OH, this is a nlohmann object?  Sorry, coffee just kicked in.  The way this file parses uses some well trodden antipatterns we've found in the past.  Namely you're doing two key lookups for every value, duplicating the key value, and having to declare an unused default.\n\nin other places we'd do something more like:\n\nauto confDesc = sensorConfig.find(\"Desc\");\nif (confDesc != sensorConfig.end()){\n    auto* maxIt = confDesc.get_if<double>(\"MaxValue\");\n    if (maxIt){\n         max = *maxIt;\n    }\n}"
                },
                {
                    "file": "virtualSensor.cpp",
                    "line": 156,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Ug.... hit submit on accident.  Ignore that code\n\nauto confDesc = sensorConfig.find(\"Desc\");\nif (confDesc != sensorConfig.end()){\n    auto maxValue = confDesc->find(\"MaxValue\");\n    if (maxValue != confDesc.end()){\n        auto* maxIt = maxValue->get_if<double>(\"MaxValue\");\n        if (maxIt){\n            max = *maxIt;\n        } else {\n            // LOG \"GOT Max value key of unknown type.\n        }\n    }\n}"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "virtualSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "virtual_sensor_config.json",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 18,
            "sizeDeletions": 1
        },
        {
            "number": 8,
            "revision": "f6443742a6e383a4fec63a005aa3e50fa1848b1c",
            "parents": [
                "d9aa22790f772a5a713e84076c25f34a595fffb6"
            ],
            "ref": "refs/changes/73/42073/8",
            "uploader": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "createdOn": 1619716654,
            "author": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "virtualSensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "virtual_sensor_config.json",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 16,
            "sizeDeletions": 1
        }
    ]
}