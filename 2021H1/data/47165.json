{
    "project": "openbmc/phosphor-dbus-interfaces",
    "branch": "master",
    "id": "I8ef75a938ddb49a9659101d971519ac0297ede56",
    "number": 47165,
    "subject": "Control.Power.IdlePowerSaver: Add Idle Power Saver Interface",
    "owner": {
        "name": "Chris Cain",
        "email": "cjcain@us.ibm.com",
        "username": "cjcain"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/47165",
    "commitMessage": "Control.Power.IdlePowerSaver: Add Idle Power Saver Interface\n\nAdd idle power saver properties to allow users to control the\nidle power saver function. This is part of the Redfish 2021.2 Schema.\n\nChange-Id: I8ef75a938ddb49a9659101d971519ac0297ede56\nSigned-off-by: Chris Cain <cjcain@us.ibm.com>\n",
    "createdOn": 1632422601,
    "lastUpdated": 1633535687,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1632422601,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1632422617,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1632422676,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/26870/ : FAILURE"
        },
        {
            "timestamp": 1632427322,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Uploaded patch set 2: Patch Set 1 was rebased."
        },
        {
            "timestamp": 1632427338,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1632427725,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/26879/ : SUCCESS"
        },
        {
            "timestamp": 1632487996,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Patch Set 2:\n\nPlease review commit to add Idle Power Saver interface to dbus"
        },
        {
            "timestamp": 1632511620,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1632759039,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1632768196,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1632859090,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1632859094,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1632859110,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1632859502,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/27112/ : SUCCESS"
        },
        {
            "timestamp": 1633017527,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3: Code-Review+1\n\nLooks good to me, though I'm not sure if Patrick still has concerns about the data types."
        },
        {
            "timestamp": 1633103005,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1633357981,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1633530439,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1633535166,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1633535175,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1633535431,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 4: Code-Review+2"
        },
        {
            "timestamp": 1633535559,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/27576/ : SUCCESS"
        },
        {
            "timestamp": 1633535685,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1633535687,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Change has been successfully merged by Patrick Williams"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "1052fd131da34b07737c78274f4ac024b02b7d67",
            "parents": [
                "d81cff3c7a1b4b8f4a4442c26dcac3773e457ad2"
            ],
            "ref": "refs/changes/65/47165/1",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1632422601,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/Control/Power/IdlePowerSaver/meson.build",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/Control/Power/meson.build",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "type": "ADDED",
                    "insertions": 34,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 62,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "8f29d8dc4ac036c81f4107dce495729617f51e3a",
            "parents": [
                "3a665b28dcc0d9f6926a1f5eb20bc0d9d768418d"
            ],
            "ref": "refs/changes/65/47165/2",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1632427322,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Should this be a float?  What granularity of percentages are useful in this context?  Since you used `uint16` that seems like you intended more granularity than simply 0-100 (because you would have chosen `uint8`?)."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 11,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "I got an error when I had uint8, so I assumed that was not a valid value"
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 11,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "Done"
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 14,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Is this a direct copy of the redfish text?\nIf it is, is that OK?"
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 14,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "Yes it is a copy of the redfish text."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 16,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I prefer time to be uint64_t and microseconds to match EpochTime.  Any reason this cannot be?"
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 16,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "It can be a uint64, but internally we only allow 2 bytes which is why I made it uint16."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 16,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/Control/Power/IdlePowerSaver/meson.build",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/Control/Power/meson.build",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "type": "ADDED",
                    "insertions": 34,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 62,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "1a6d8ffb6fa4fa3f8496e228ea3d98d022d918d2",
            "parents": [
                "3a665b28dcc0d9f6926a1f5eb20bc0d9d768418d"
            ],
            "ref": "refs/changes/65/47165/3",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1632859094,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I kind of see `byte` as a useless optimization here, but I'm not too hung up on it."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 11,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "This is actually stored internally as a byte.\nYou previously indicated that uint16 made you think it had higher granularity than whole percent, so I reduced it to a byte."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "> This is actually stored internally as a byte.\n\nInternal representation in one implementation is still not a great reason to \"optimize\" this down to a byte.\n\n> You previously indicated that uint16 made you think it had higher granularity than whole percent, so I reduced it to a byte.\n\nYep, I'm fine with either `byte` or `float` or `size` in this context at this point in time.  We already have some inconsistency in terms of \"how do you represent a percentage\".  If someone needs additional granularity in the future than whole percentages we can refactor at that point in time."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 16,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Is there a reason to express this in seconds?  As I mentioned elsewhere we're mostly using smaller units for time.  EpochTime uses microseconds, but a few other places use milliseconds (I'd like to refactor them all to use microseconds at some point).  If use use consistent timing there is less need to name these properties \"...Seconds\" (and I'd rather we drop that)."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 16,
                    "reviewer": {
                        "name": "Chris Cain",
                        "email": "cjcain@us.ibm.com",
                        "username": "cjcain"
                    },
                    "message": "These are defined in the Redfish spec 2021.2\nThese values are normally defined in seconds because it is a delay in going into/out of a low power mode and you typically do not want to drop to low power after milliseconds of idle.  Typical ranges are 10-600 seconds."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 16,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "> These are defined in the Redfish spec 2021.2\n\nI'd still prefer consistency on time concepts to milliseconds even if you don't use the granularity here.  It is a pretty trivial conversion using `std::chrono` to round down to the nearest second in your implementation.\n\nI'll try to elevate the priority of https://github.com/openbmc/sdbusplus/issues/42 so we don't need to have these discussions in the future.  If you implement as milliseconds now it will certainly me refactoring work when I get #42 done."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "line": 16,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/Control/Power/IdlePowerSaver/meson.build",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/Control/Power/meson.build",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "type": "ADDED",
                    "insertions": 34,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 62,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "7f832232325ec1b0fc7324764aa1491a7807d36c",
            "parents": [
                "e52a525730974c72219ad5758d0c8573c8d6fd4c"
            ],
            "ref": "refs/changes/65/47165/4",
            "uploader": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "createdOn": 1633535166,
            "author": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/Control/Power/IdlePowerSaver/meson.build",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/Control/Power/meson.build",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Control/Power/IdlePowerSaver.interface.yaml",
                    "type": "ADDED",
                    "insertions": 34,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 62,
            "sizeDeletions": 0
        }
    ]
}