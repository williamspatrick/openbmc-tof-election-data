{
    "project": "openbmc/libmctp",
    "branch": "master",
    "id": "Iaa976ce636c1eb617afa75e852b39c50699ebeb2",
    "number": 44117,
    "subject": "core: Handle arithmetic overflow in adding new fragments",
    "owner": {
        "name": "Sumanth Bhat",
        "email": "sumanth.bhat@linux.intel.com",
        "username": "sumbhat90"
    },
    "assignee": {
        "name": "Andrew Jeffery",
        "email": "andrew@aj.id.au",
        "username": "amboar"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/libmctp/+/44117",
    "commitMessage": "core: Handle arithmetic overflow in adding new fragments\n\nLarge fragment sizes can cause arithmetic overflows and can\ncause memory corruptions. However, this condition will not be hit\nwith a fragment size check in place and with a sane memory allocator\nin place.\n\nAdding this check to ensure that we have defense in depth.\n\nSigned-off-by: Sumanth Bhat <sumanth.bhat@linux.intel.com>\nChange-Id: Iaa976ce636c1eb617afa75e852b39c50699ebeb2\n",
    "createdOn": 1623828857,
    "lastUpdated": 1624366144,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1623828857,
            "reviewer": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1623829711,
            "reviewer": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "message": "Assignee added: Andrew Jeffery <andrew@aj.id.au>"
        },
        {
            "timestamp": 1623887777,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 1: Code-Review+1"
        },
        {
            "timestamp": 1623899594,
            "reviewer": {
                "name": "Jeremy Kerr",
                "email": "jk@ozlabs.org",
                "username": "jk-ozlabs"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1623902461,
            "reviewer": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1623903163,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1623966102,
            "reviewer": {
                "name": "Joseph Reynolds",
                "email": "joseph-reynolds@charter.net",
                "username": "joseph-reynolds"
            },
            "message": "Patch Set 2:\n\nSeems okay, but I am not familiar with the code."
        },
        {
            "timestamp": 1624254106,
            "reviewer": {
                "name": "Jeremy Kerr",
                "email": "jk@ozlabs.org",
                "username": "jk-ozlabs"
            },
            "message": "Patch Set 2: Code-Review+2\n\nPerfect, thanks!"
        },
        {
            "timestamp": 1624318543,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Unset private"
        },
        {
            "timestamp": 1624318567,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 2: Ok-To-Test+1"
        },
        {
            "timestamp": 1624318668,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/20291/ : FAILURE"
        },
        {
            "timestamp": 1624356860,
            "reviewer": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "message": "Patch Set 3: Patch Set 2 was rebased"
        },
        {
            "timestamp": 1624356872,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624356917,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/20345/ : SUCCESS"
        },
        {
            "timestamp": 1624365098,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 4: Patch Set 3 was rebased."
        },
        {
            "timestamp": 1624365113,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624365167,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/20374/ : FAILURE"
        },
        {
            "timestamp": 1624365918,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1624365938,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624365988,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/20379/ : SUCCESS"
        },
        {
            "timestamp": 1624366130,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5: Code-Review+2"
        },
        {
            "timestamp": 1624366144,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Change has been successfully merged by Andrew Jeffery"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "f0903aa64c6ea0400b25dadf25605f6e3b7e9396",
            "parents": [
                "b1b914178b2c45a2d60d32606a765f387240d08e"
            ],
            "ref": "refs/changes/17/44117/1",
            "uploader": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "createdOn": 1623828857,
            "author": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "core.c",
                    "line": 232,
                    "reviewer": {
                        "name": "Jeremy Kerr",
                        "email": "jk@ozlabs.org",
                        "username": "jk-ozlabs"
                    },
                    "message": "Looks good, but see below..."
                },
                {
                    "file": "core.c",
                    "line": 242,
                    "reviewer": {
                        "name": "Jeremy Kerr",
                        "email": "jk@ozlabs.org",
                        "username": "jk-ozlabs"
                    },
                    "message": "... we should also ensure that the new allocation size will fit len + ctx->buf_size; possibly:\n\n    } else {\n        new_alloc_size = MAX(ctx->buf_alloc_size * 2, len + ctx->buf_size);\n    }\n\nI'm aware that this will be addressed by enforcing consistent fragment sizes, but I'd rather do that explicitly here, rather than relying on that."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "tests/test_core.c",
                    "type": "MODIFIED",
                    "insertions": 29,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 33,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "069f6a2caa7517fa15207c6a8ef7454b0f3a3895",
            "parents": [
                "1251bd18ca5e1b18811796a3d02be3afdedd2fa3"
            ],
            "ref": "refs/changes/17/44117/2",
            "uploader": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "createdOn": 1623902461,
            "author": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -1
                },
                {
                    "file": "tests/test_core.c",
                    "type": "MODIFIED",
                    "insertions": 29,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 34,
            "sizeDeletions": 1
        },
        {
            "number": 3,
            "revision": "a835b9de5840b13c4a66f0f44a9ad8c3c2708a4a",
            "parents": [
                "09b7d23b92b2026da5c46e2a52323bacc98b157d"
            ],
            "ref": "refs/changes/17/44117/3",
            "uploader": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "createdOn": 1624356860,
            "author": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -1
                },
                {
                    "file": "tests/test_core.c",
                    "type": "MODIFIED",
                    "insertions": 29,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 34,
            "sizeDeletions": 1
        },
        {
            "number": 4,
            "revision": "c826e3cf50fba83924602ac1b8ff5a45a0dfcab8",
            "parents": [
                "f1cdddce60a84c46f73cb443febeb3412800ea54"
            ],
            "ref": "refs/changes/17/44117/4",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1624365098,
            "author": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -1
                },
                {
                    "file": "tests/test_core.c",
                    "type": "MODIFIED",
                    "insertions": 29,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 34,
            "sizeDeletions": 1
        },
        {
            "number": 5,
            "revision": "bc79c24e07f9532c0095de431628b47510ff033a",
            "parents": [
                "69f545f72264931cbdda0b2dd6e11686f836b938"
            ],
            "ref": "refs/changes/17/44117/5",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1624365918,
            "author": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -1
                },
                {
                    "file": "tests/test_core.c",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 35,
            "sizeDeletions": 1
        }
    ]
}