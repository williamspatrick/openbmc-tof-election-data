{
    "project": "openbmc/phosphor-state-manager",
    "branch": "master",
    "id": "I4e12f1df96cc1321beee0c4eae648d71e2d4a3b9",
    "number": 41360,
    "subject": "bmc-state-manager: Add support BMC Reboot Cause feature",
    "owner": {
        "name": "Tim Lee",
        "email": "timlee660101@gmail.com",
        "username": "timlee66"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-state-manager/+/41360",
    "commitMessage": "bmc-state-manager: Add support BMC Reboot Cause feature\n\nBelow is patch supporting this change.\nhttps://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/41359\n\nTested:\nbusctl get-property xyz.openbmc_project.State.BMC /xyz/openbmc_project/state/bmc0 xyz.openbmc_project.State.BMC LastRebootCause\n\nWhen unplug/plug in BMC power cable then return as below:\ns \"xyz.openbmc_project.State.BMC.BMCResetCause.POR\"\n\nWhen executing reboot command then return as below:\ns \"xyz.openbmc_project.State.BMC.BMCResetCause.Watchdog\"\n\nSigned-off-by: Tim Lee <timlee660101@gmail.com>\nChange-Id: I4e12f1df96cc1321beee0c4eae648d71e2d4a3b9\n",
    "createdOn": 1615945870,
    "lastUpdated": 1635246367,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1615945870,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1615945883,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1615945934,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/13895/ : FAILURE"
        },
        {
            "timestamp": 1615947898,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 1:\n\nNow Build failed, because this commit need below patch be merged it.\n\nBelow is patch supporting this change.\nhttps://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/41359"
        },
        {
            "timestamp": 1615948451,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1615948463,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1615948513,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/13898/ : FAILURE"
        },
        {
            "timestamp": 1615949576,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1615949589,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1615949634,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/13903/ : FAILURE"
        },
        {
            "timestamp": 1615949989,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1615950004,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1615950051,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/13904/ : FAILURE"
        },
        {
            "timestamp": 1615951525,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1615951554,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1615951600,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/13907/ : FAILURE"
        },
        {
            "timestamp": 1615952089,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 5:\n\n> Patch Set 1:\n> \n> Now Build failed, because this commit need below patch be merged it.\n> \n> Below is patch supporting this change.\n> https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/41359\n\nHi Andrew,\n\nThis is the first time I try to add BMC Reboot Cause feature in phosphor-state-manager, but I got merge conflict due to another non-merged commit \"clear temp reset file on chassis on\".\nCould you do me a favorite to check how to fix this conflict?\nOr I need to wait for your commit be merged then submit my commit later? Thank you help in advance.\n\nBelow are patches reviewing for BMC Reboot Cause feature for you refer it.\nhttps://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/41359\nhttps://gerrit.openbmc-project.xyz/c/openbmc/phosphor-webui/+/41366\n\nSincerely,\nTim"
        },
        {
            "timestamp": 1616012697,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 5:\n\n> Patch Set 5:\n> \n> > Patch Set 1:\n> > \n> > Now Build failed, because this commit need below patch be merged it.\n> > \n> > Below is patch supporting this change.\n> > https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/41359\n> \n> Hi Andrew,\n> \n> This is the first time I try to add BMC Reboot Cause feature in phosphor-state-manager, but I got merge conflict due to another non-merged commit \"clear temp reset file on chassis on\".\n> Could you do me a favorite to check how to fix this conflict?\n> Or I need to wait for your commit be merged then submit my commit later? Thank you help in advance.\n\nNo need to worry about the conflict. Whoever gets merged first, the other person gets to just rebase on it. Before we review this too much, lets get the D-Bus interface reviewed and merged (https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/41359)"
        },
        {
            "timestamp": 1616049879,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 5:\n\n> Patch Set 5:\n> \n> > Patch Set 5:\n> > \n> > > Patch Set 1:\n> > > \n> > > Now Build failed, because this commit need below patch be merged it.\n> > > \n> > > Below is patch supporting this change.\n> > > https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/41359\n> > \n> > Hi Andrew,\n> > \n> > This is the first time I try to add BMC Reboot Cause feature in phosphor-state-manager, but I got merge conflict due to another non-merged commit \"clear temp reset file on chassis on\".\n> > Could you do me a favorite to check how to fix this conflict?\n> > Or I need to wait for your commit be merged then submit my commit later? Thank you help in advance.\n> \n> No need to worry about the conflict. Whoever gets merged first, the other person gets to just rebase on it. Before we review this too much, lets get the D-Bus interface reviewed and merged (https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/41359)\n\nHi Andrew,\nThanks your prompt feedback, I'm looking forward to hearing your decision. Thanks you.\n\nBest regards,\nTim"
        },
        {
            "timestamp": 1626312051,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 5:\n\nHi Patrick,\n\nCould you please help us to review this commit?\nI had posted this in #general discord channel.\nBelow are related commit, please kindly help me to review it. Thank you!!!\n\nAdd last bmc reboot cause with date and time to Reboot BMC Page\nhttps://gerrit.openbmc-project.xyz/c/openbmc/phosphor-webui/+/41366\n\nAdd LastRebootCause property for BMC Reboot Cause feature\nhttps://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/41359\n\nSincerely,\nTim"
        },
        {
            "timestamp": 1628600743,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 5:\n\nHi Patrick,\nThanks your review and merge below commit.\nhttps://gerrit.openbmc-project.xyz/c/openbmc/phosphor-dbus-interfaces/+/41359\n\nCould you also help us to review this related commit? Thanks in advance.\n\nSincerely,\nTim"
        },
        {
            "timestamp": 1629286391,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 6: Patch Set 5 was rebased"
        },
        {
            "timestamp": 1629286429,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1629286457,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/24541/ : FAILURE"
        },
        {
            "timestamp": 1629286645,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 6:\n\n(5 comments)\n\nThis code still doesn't compile even though the interface has been merged."
        },
        {
            "timestamp": 1629855092,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 6:\n\n(5 comments)\n\nHi Patrick,\nThanks your great help to provide more suggestions for this commit.\nI've reply for each your suggestion. Please take a look. Thank you so much !!\n\nSincerely,\nTim"
        },
        {
            "timestamp": 1629858255,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1629858268,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1629858305,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/24969/ : FAILURE"
        },
        {
            "timestamp": 1629861080,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 8."
        },
        {
            "timestamp": 1629861093,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1629861124,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/24979/ : FAILURE"
        },
        {
            "timestamp": 1629861998,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 9."
        },
        {
            "timestamp": 1629862013,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1629862134,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/24980/ : SUCCESS"
        },
        {
            "timestamp": 1629891957,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 9:\n\n(5 comments)"
        },
        {
            "timestamp": 1630983533,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 10."
        },
        {
            "timestamp": 1630983546,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1630983568,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/25780/ : FAILURE"
        },
        {
            "timestamp": 1630983828,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 11."
        },
        {
            "timestamp": 1630983841,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1630983955,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/25781/ : SUCCESS"
        },
        {
            "timestamp": 1630984523,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 11:\n\n(5 comments)\n\nHello Patrick,\n\nThanks your review and provide more useful suggestions for me.\nI have modified the code and removed unnecessary configuration in meson build.\nPlease help me to review it again. Thanks in advance.\n\nBest regards,\nTim"
        },
        {
            "timestamp": 1631016746,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 11:\n\n(2 comments)"
        },
        {
            "timestamp": 1631034761,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 12."
        },
        {
            "timestamp": 1631034774,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1631034889,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/25825/ : SUCCESS"
        },
        {
            "timestamp": 1631035208,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 12:\n\n(2 comments)\n\nHi Patrick,\nThanks your suggestion again. I have modified it. Thank you.\n\nBest regards,\nTim"
        },
        {
            "timestamp": 1631045606,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 12:\n\n(2 comments)\n\nAndrewJ, I wonder if we'll be able to enhance this to show when the host initiates the BMC reset per your https://github.com/openbmc/docs/blob/master/designs/bmc-service-failure-debug-and-recovery.md design?"
        },
        {
            "timestamp": 1631059002,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 13."
        },
        {
            "timestamp": 1631059017,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 13: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1631059155,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 13: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/25867/ : SUCCESS"
        },
        {
            "timestamp": 1631059972,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 13:\n\n(1 comment)"
        },
        {
            "timestamp": 1631101574,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 13: Code-Review+1"
        },
        {
            "timestamp": 1631220359,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 13:\n\nStill have an open question in previous patch set on commit message test."
        },
        {
            "timestamp": 1631266499,
            "reviewer": {
                "name": "Thang Q. Nguyen",
                "email": "thang@os.amperecomputing.com",
                "username": "thangqn-ampere"
            },
            "message": "Patch Set 13:\n\n(1 comment)"
        },
        {
            "timestamp": 1631267239,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 13:\n\n(1 comment)"
        },
        {
            "timestamp": 1631275161,
            "reviewer": {
                "name": "Thang Q. Nguyen",
                "email": "thang@os.amperecomputing.com",
                "username": "thangqn-ampere"
            },
            "message": "Patch Set 13:\n\n(1 comment)"
        },
        {
            "timestamp": 1631349846,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 13:\n\n(1 comment)"
        },
        {
            "timestamp": 1631370990,
            "reviewer": {
                "name": "Thang Q. Nguyen",
                "email": "thang@os.amperecomputing.com",
                "username": "thangqn-ampere"
            },
            "message": "Patch Set 13:\n\n(1 comment)"
        },
        {
            "timestamp": 1631508395,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 13:\n\n(1 comment)\n\n> Patch Set 13:\n> \n> Still have an open question in previous patch set on commit message test.\n\nHi Andrew,\nSorry for late to answer your question.\nDue to I trace more detail in kernel then hope can answer it correctly.\nWhen issuing \"reboot\" command on BMC that will call reboot syscall as below.\n\nkernel/reboot.c:\nSYSCALL_DEFINE4(reboot)\n->case LINUX_REBOOT_CMD_RESTART:\n  ->kernel_restart(NULL);\n    ->machine_restart()\n      ->do_kernel_restart()\n        ->atomic_notifier_call_chain(&restart_handler_list, reboot_mode, cmd)\n\ndrivers/watchdog/watchdog_core.c:\nxxx_wdt_probe() (xxx platform wdt driver)\n->devm_watchdog_register_device()\n  ->watchdog_register_device()\n    ->__watchdog_register_device()\n      ->if (wdd->ops->restart) {\n            wdd->restart_nb.notifier_call = watchdog_restart_notifier;\n            ret = register_restart_handler(&wdd->restart_nb);\n        }\n\nIf your platform had implement your own watchdog driver,\nand watchdog_restart_notifier() will be called with register_restart_handler().\nEventually, your own watchdog reset ops will executed.\nThus, the \"reboot\" command will involve watchdog reset mechanism to achieve it.\n\nBTW, according linux watchdog framework, we can use WDIOC_GETBOOTSTATUS\nto get boot status if your platform have implement watchdog driver\nto monitor status of the watchdog device at boot.\nThat's why we leverage linux watchdog to implement this feature on BMC.\n\nSincerely,\nTim"
        },
        {
            "timestamp": 1631515549,
            "reviewer": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "message": "Patch Set 13:\n\nHi Thang Q. Nguyen,\n\nThis CONFIG_WATCHDOG_SYSFS kernel config is use to enable linux watchdog sysfs\nsupport. According linux watchdog framework, you need write watchdog driver to\nsupport bootstatus information for your platform.\n\nIn watchdog driver, you can check SCU_SYS_EXT_RESET_FLAG or related registers\nto update wdt->wdd.bootstatus then /sys/class/watchdog/watchdog0/bootstatus\nshould show the reset cause information as your expectation.\n\nSincerely,\nTim"
        },
        {
            "timestamp": 1631533203,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 13:\n\n> In watchdog driver, you can check SCU_SYS_EXT_RESET_FLAG or related registers\n> to update wdt->wdd.bootstatus then /sys/class/watchdog/watchdog0/bootstatus\n> should show the reset cause information as your expectation.\n\nThang, I think it is worth pointing out that Tim is mostly focused on Nuvoton systems and the driver on Nuvoton systems already supports this flag.  The Aspeed one does not, but when this feature was added, it was hopefully done in a way that once the Aspeed driver adds support the rest of the code will automatically follow.\n\nIf you want this support but do not want to make the driver changes yourself, I suggest pointing this feature out to your development contacts at Aspeed."
        },
        {
            "timestamp": 1631590712,
            "reviewer": {
                "name": "Thang Q. Nguyen",
                "email": "thang@os.amperecomputing.com",
                "username": "thangqn-ampere"
            },
            "message": "Patch Set 13:\n\n> Patch Set 13:\n> \n> > In watchdog driver, you can check SCU_SYS_EXT_RESET_FLAG or related registers\n> > to update wdt->wdd.bootstatus then /sys/class/watchdog/watchdog0/bootstatus\n> > should show the reset cause information as your expectation.\n> \n> Thang, I think it is worth pointing out that Tim is mostly focused on Nuvoton systems and the driver on Nuvoton systems already supports this flag.  The Aspeed one does not, but when this feature was added, it was hopefully done in a way that once the Aspeed driver adds support the rest of the code will automatically follow.\n> \n> If you want this support but do not want to make the driver changes yourself, I suggest pointing this feature out to your development contacts at Aspeed.\n\nThanks Patrick,\nIt's clear for me now. I have not been aware that Aspeed watchdog missing this."
        },
        {
            "timestamp": 1631654678,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 13: Code-Review+2"
        },
        {
            "timestamp": 1631654683,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Change has been successfully rebased and submitted as 2bfb1efc4bc7e781224e19c05b51e6675f13a488 by Andrew Geissler"
        },
        {
            "timestamp": 1635241162,
            "reviewer": {
                "name": "Chanh Nguyen",
                "email": "chanh@os.amperecomputing.com",
                "username": "chnguyen-ampere"
            },
            "message": "Patch Set 14:\n\n(1 comment)"
        },
        {
            "timestamp": 1635246367,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 14:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "002734a31c032706213f6d121f49b665ad9d12da",
            "parents": [
                "35ca2e34cd04b7288a5b659e4e7dcd4590056b7d"
            ],
            "ref": "refs/changes/60/41360/1",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1615945870,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "b6caa3b2ef3dd213cbea8842ebf446212467ebee",
            "parents": [
                "35ca2e34cd04b7288a5b659e4e7dcd4590056b7d"
            ],
            "ref": "refs/changes/60/41360/2",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1615948451,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -1
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 1
        },
        {
            "number": 3,
            "revision": "d9eca5e2c03eef03e725cc779e5b24851fd22fcd",
            "parents": [
                "35ca2e34cd04b7288a5b659e4e7dcd4590056b7d"
            ],
            "ref": "refs/changes/60/41360/3",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1615949576,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 36,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 105,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "17a76ec3c298d724b6a7a06c877275fc6d88cdae",
            "parents": [
                "35ca2e34cd04b7288a5b659e4e7dcd4590056b7d"
            ],
            "ref": "refs/changes/60/41360/4",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1615949989,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -29
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": -12
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 41
        },
        {
            "number": 5,
            "revision": "4e6876a7b28553ea92dd1b19b06078761bde98b5",
            "parents": [
                "35ca2e34cd04b7288a5b659e4e7dcd4590056b7d"
            ],
            "ref": "refs/changes/60/41360/5",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1615951525,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 0
        },
        {
            "number": 6,
            "revision": "49cc5c40797f992cc03687ecf98e311f043f733b",
            "parents": [
                "0d1c3f1f9329c853677f0581287afef83eeea0f0"
            ],
            "ref": "refs/changes/60/41360/6",
            "uploader": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "createdOn": 1629286391,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 268,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Is this method and/or values specific to one particular BMC?  How do we know we are on that BMC type?"
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 268,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "No, this method is leverage by Linux kernel watchdog design. It is a read only file.\nIt contains status of the watchdog device at boot. It is equivalent to\nWDIOC_GETBOOTSTATUS of ioctl interface."
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 268,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "If this is all \"standard kernel\" stuff, why aren't we using watchdog.h for the constants?"
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 268,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Yes, you are right. we should use watchdog.h for the constants."
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Would this be clearer as a case?"
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "This define WDIOF_EXTERN1 is means External monitoring relay/source 1 was triggered.\nControllers intended for real world applications include external monitoring pins\nthat will trigger a reset. This description is from Linux watchdog-api.\nCustomer know this API definition when they design userspace application."
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I meant:\n\nswitch(bootstatus) {\n    case WDIOF_EXTERN1:\n...\n    case WDIOF_CARDRESET:\n...\n    default:\n}"
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 287,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Yes, switch is more clear and flexible for extend."
                },
                {
                    "file": "meson.build",
                    "line": 53,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I don't think there is a good reason to make these packageconfig is there?  This seems a little ridiculous."
                },
                {
                    "file": "meson.build",
                    "line": 53,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "I just want to make consistence of phosphor-state-manager with our modification."
                },
                {
                    "file": "meson.build",
                    "line": 53,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "None of this should be configured though.  We have WAY too many configuration options in this repository as it is.\n\nThese WDIOF_* constants come from the kernel in watchdog.h.  Use that header.  There is zero reason anyone would ever change that."
                },
                {
                    "file": "meson.build",
                    "line": 53,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Thanks for review this. I have removed those option and use watchdog.h for constant."
                },
                {
                    "file": "meson_options.txt",
                    "line": 100,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Can this just be a constant in the code?  Is it likely to change?"
                },
                {
                    "file": "meson_options.txt",
                    "line": 100,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "It's could be changed by customer.\nDue to their system might be have one more watchdogs.\nHowever, they might be use watchdog1 or watchdog2 for their BMC system."
                },
                {
                    "file": "meson_options.txt",
                    "line": 100,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Shouldn't we make it a json file then?  Or something picked up from an entity-manager config?"
                },
                {
                    "file": "meson_options.txt",
                    "line": 100,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Thanks for review this. I have modified this be a constant in the code."
                },
                {
                    "file": "meson_options.txt",
                    "line": 114,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Why would we ever need to change these?"
                },
                {
                    "file": "meson_options.txt",
                    "line": 114,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Those changes are need for updating bmc reboot cause to dbus.\nAnd customer can just query this dbus property for their userspace application\nto know the reboot reason. Also want to make consistence with phosphor-state-manger."
                },
                {
                    "file": "meson_options.txt",
                    "line": 114,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "> Those changes are need for updating bmc reboot cause to dbus.\n\nBut is there any value in making them configurable at build time?  This are literals from the dbus schema.\n\n> Also want to make consistence with phosphor-state-manger.\n\nI guess this is up to the maintainer of this repository to decide.  My opinion is there are WAY WAY WAY too many build-configuration options in this repository.  The repository has been around for a while and I don't think there is a single example of a meta-layer leveraging any of these options.\n\nMeson options should not be turned into a replacement for #define."
                },
                {
                    "file": "meson_options.txt",
                    "line": 114,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Yes, you are right. We don't need to change these in meson build. I have removed it. Thanks."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 0
        },
        {
            "number": 7,
            "revision": "d24c1a57512edc7d381eacb90c5ec27a80e32b11",
            "parents": [
                "35ca2e34cd04b7288a5b659e4e7dcd4590056b7d"
            ],
            "ref": "refs/changes/60/41360/7",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1629858255,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -2
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": -6
                }
            ],
            "sizeInsertions": 103,
            "sizeDeletions": 8
        },
        {
            "number": 8,
            "revision": "9ff8943ad68950a6714aba9633c3394cd4a9578f",
            "parents": [
                "0d1c3f1f9329c853677f0581287afef83eeea0f0"
            ],
            "ref": "refs/changes/60/41360/8",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1629861080,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 98,
            "sizeDeletions": 0
        },
        {
            "number": 9,
            "revision": "e7fa9b547ab5bd18cd1e52696dd9daa13d8ab55c",
            "parents": [
                "0d1c3f1f9329c853677f0581287afef83eeea0f0"
            ],
            "ref": "refs/changes/60/41360/9",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1629861998,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 47,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 0
        },
        {
            "number": 10,
            "revision": "5bdfec1af789d4d25856f647acd881fc06ab98f6",
            "parents": [
                "0d1c3f1f9329c853677f0581287afef83eeea0f0"
            ],
            "ref": "refs/changes/60/41360/10",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1630983533,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 51,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 62,
            "sizeDeletions": 1
        },
        {
            "number": 11,
            "revision": "52c4abfc282e796b8c8f08a46d0f623ca9fe2025",
            "parents": [
                "0d1c3f1f9329c853677f0581287afef83eeea0f0"
            ],
            "ref": "refs/changes/60/41360/11",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1630983828,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 266,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Suggest:\n\nauto bootstatusPath = \"/sys/class/watchdog/watchdog0/bootstatus\";\n\nI don't see a reason to force as a std::string and do concatenation."
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 266,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Thanks. I have changed it as full path."
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 276,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "catch (const std::exception& e)"
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 276,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Thanks. I have changed it as const."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 52,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 64,
            "sizeDeletions": 1
        },
        {
            "number": 12,
            "revision": "8a138cde4a8857a88a83790a91bd38feb1a1dba6",
            "parents": [
                "0d1c3f1f9329c853677f0581287afef83eeea0f0"
            ],
            "ref": "refs/changes/60/41360/12",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1631034761,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 18,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Why is this? Does a BMC \"reboot\" command utilize the watchdog? That's not what we really want here is it? i.e. if someone just types \"reboot\" on the BMC console, I'd prefer to use \"User\" or something like that for the reason. If the BMC hangs, and the watchdog expires and forces a reboot then I'd like to see \"Watchdog\"."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 18,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Hi Andrew,\nSorry for late to answer your question.\nDue to I trace more detail in kernel then hope can answer it correctly.\nWhen issuing \"reboot\" command on BMC that will call reboot syscall as below.\n\nkernel/reboot.c:\nSYSCALL_DEFINE4(reboot)\n->case LINUX_REBOOT_CMD_RESTART:\n  ->kernel_restart(NULL);\n    ->machine_restart()\n      ->do_kernel_restart()\n        ->atomic_notifier_call_chain(&restart_handler_list, reboot_mode, cmd)\n\ndrivers/watchdog/watchdog_core.c:\nxxx_wdt_probe() (xxx platform wdt driver)\n->devm_watchdog_register_device()\n  ->watchdog_register_device()\n    ->__watchdog_register_device()\n      ->if (wdd->ops->restart) {\n            wdd->restart_nb.notifier_call = watchdog_restart_notifier;\n            ret = register_restart_handler(&wdd->restart_nb);\n        }\n\nIf your platform had implement your own watchdog driver,\nand watchdog_restart_notifier() will be called with register_restart_handler().\nEventually, your own watchdog reset ops will executed.\nThus, the \"reboot\" command will involve watchdog reset mechanism to achieve it.\n\nBTW, according linux watchdog framework, we can use WDIOC_GETBOOTSTATUS\nto get boot status if your platform have implement watchdog driver\nto monitor status of the watchdog device at boot.\nThat's why we leverage linux watchdog to implement this feature on BMC.\n\nSincerely,\nTim"
                },
                {
                    "file": "meson_options.txt",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Seems like the diff here is un-needed."
                },
                {
                    "file": "meson_options.txt",
                    "line": 0,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Thanks. I have modified it."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 51,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 63,
            "sizeDeletions": 1
        },
        {
            "number": 13,
            "revision": "3c0fc1f7bf7a0c67b4095a0576ae08ffdc172d56",
            "parents": [
                "0d1c3f1f9329c853677f0581287afef83eeea0f0"
            ],
            "ref": "refs/changes/60/41360/13",
            "uploader": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "createdOn": 1631059002,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 265,
                    "reviewer": {
                        "name": "Thang Q. Nguyen",
                        "email": "thang@os.amperecomputing.com",
                        "username": "thangqn-ampere"
                    },
                    "message": "Hi Tim,\nDo we need to enable any kernel config to make this work? In my system it always return 0"
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 265,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Hi Thang Q. Nauyen,\nYou need to enable this configuration CONFIG_WATCHDOG_SYSFS.\nThis configuration can read different watchdog information through sysfs. Thanks."
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 265,
                    "reviewer": {
                        "name": "Thang Q. Nguyen",
                        "email": "thang@os.amperecomputing.com",
                        "username": "thangqn-ampere"
                    },
                    "message": "I already have this config enabled.\n\nroot@mtjade:~# zcat /proc/config.gz | grep CONFIG_WATCHDOG_SYSFS\nCONFIG_WATCHDOG_SYSFS=y"
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 265,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "timlee660101@gmail.com",
                        "username": "timlee66"
                    },
                    "message": "Did you have implemented your own platform watchdog driver?\nThe watchdog driver need to update wdd->bootstatus according your platform.\nThus, you can check whether is watchdog driver on your platform first."
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 265,
                    "reviewer": {
                        "name": "Thang Q. Nguyen",
                        "email": "thang@os.amperecomputing.com",
                        "username": "thangqn-ampere"
                    },
                    "message": "No, Tim. I have not implemented anything. Currently I check the SCU_SYS_EXT_RESET_FLAG in u-boot for reset reason and update command line (/proc/cmdline) for reset reason. Then use it to decide if initializing platform GPIOs (when BMC is booted from A/C) and prevent chassis power policy applied when BMC rebooted.\nI think I can replace my current implementation by your approach so I asked you on how can I have /sys/class/watchdog/watchdog0/bootstatus with reset cause information"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 51,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 62,
            "sizeDeletions": 0
        },
        {
            "number": 14,
            "revision": "2bfb1efc4bc7e781224e19c05b51e6675f13a488",
            "parents": [
                "0a675215d6a6d2eb13e030ba0f618a4691de58d4"
            ],
            "ref": "refs/changes/60/41360/14",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1631654683,
            "author": {
                "name": "Tim Lee",
                "email": "timlee660101@gmail.com",
                "username": "timlee66"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 285,
                    "reviewer": {
                        "name": "Chanh Nguyen",
                        "email": "chanh@os.amperecomputing.com",
                        "username": "chnguyen-ampere"
                    },
                    "message": "Hi all, How's about the WDIOF_EXTERN2? Thanks!"
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "line": 285,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Commenting on already merged patch sets is not particularly useful, especially when the code has been merged for over a month.  If you feel supporting WDIOF_EXTERN2 is important, just add a commit to support it."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 51,
                    "deletions": 0
                },
                {
                    "file": "bmc_state_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 62,
            "sizeDeletions": 0
        }
    ]
}