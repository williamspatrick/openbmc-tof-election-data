{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "Id928bafa645f035169cf65d1ccea6acf1cd115a0",
    "number": 38377,
    "subject": "Migrate Lockservice from /ibm/v1 to Oem",
    "owner": {
        "name": "ManojKiran Eda",
        "email": "manojkiran.eda@gmail.com",
        "username": "manojkiraneda"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/bmcweb/+/38377",
    "commitMessage": "Migrate Lockservice from /ibm/v1 to Oem\n\n- This is an Initial commit in the series of commits\n  that plans to migrate the /ibm/v1 resources to\n  /redfish/v1/Oem Resources.\n\n- There were lot of concerns on leaveraging the existing\n  redfish infrastructure with /ibm/v1 rest API's as the\n  redfish framework should not be used on a rest endpoint.\n\n- This commit would bring in the necessary CSDL & JSON schemas\n  that are required for migratring the /ibm/v1 Lockservice to\n  /redfish/v1/Oem/IBM/LockService.\n\nTested By:\n\n- Redfish validator passed on both /redfish/v1 as well as\n /redfish/v1/Oem/LockService:\n\n* /redfish/v1/\n  /redfish/v1/ @odata.id: Expected @odata.id to match URI link /redfish/v1\n  Type (#ServiceRoot.v1_5_0.ServiceRoot), GET SUCCESS (time: 0.138021)\n  PASS\n\n* /redfish/v1/Oem/IBM/LockService\n  Type (#LockService.v1_0_0.LockService), GET SUCCESS (time: 0.220838)\n  PASS\n\n- Did a basic sanity testing on Lock functionality, it is not affected as\n  only the URI's are changed.\n\nSigned-off-by: Manojkiran Eda <manojkiran.eda@gmail.com>\nChange-Id: Id928bafa645f035169cf65d1ccea6acf1cd115a0\n",
    "createdOn": 1605680804,
    "lastUpdated": 1623146058,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1605680804,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1605680822,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1605680866,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/8086/ : FAILURE"
        },
        {
            "timestamp": 1605681139,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1607751473,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1607751490,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1607753274,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/9642/ : SUCCESS"
        },
        {
            "timestamp": 1607753337,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Patch Set 2:\n\nThis change is ready for review."
        },
        {
            "timestamp": 1607753337,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1607753611,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1607753631,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1607753637,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Uploaded patch set 4: Commit message was updated."
        },
        {
            "timestamp": 1607753878,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Patch Set 4:\n\nEd/Gunnar/Ratan - I have not tried writing a CSDL before, Can you guys have a quick look and help suggest if I did the changes correctly?"
        },
        {
            "timestamp": 1607754630,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/9643/ : SUCCESS"
        },
        {
            "timestamp": 1607967573,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(4 comments)"
        },
        {
            "timestamp": 1608004771,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1608054457,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 4:\n\n(7 comments)"
        },
        {
            "timestamp": 1608055517,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\nI've had a couple days to think about this, and this commit as written doesn't feel right to me.  I'm sure it wasn't the intent, but reading through, this commit feels like a back door around the rules we have about development of Redfish OEM schemas, as so far as I'm aware, this module was developed without input from a lot of the OpenBMC community nor Redfish.  To be clear, that was fine when it was an IBM-only, non-Redfish API, but as this commit simply changes the URIs on the IBM resources, and adds CSDL definitions, that alone doesn't bring it up to par with what an OpenBMC Redfish resource is, or how it's developed.\n\nIf your goal is to get an OEM Redfish resource available for these things, I'd suggest the following path.\n\n1. Start with a commit in the series that completely removes the /ibm/v1 URL route handlers entirely.  This will leave a clean slate for review.\n2. Add back the route handlers in subsections that make sense, so they can be reviewed for redfish correctness, as well as community interest for being in the OpenBMC namespace.\n3. Write up some form of documentation (design doc, updated redfish markdown, ect) on what these OEM schemas are used for, and why they're useful within Redfish.\n\nI'm open to other paths forward here, but as written, I don't see how we can let this commit proceed as-is."
        },
        {
            "timestamp": 1608285363,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Patch Set 4:\n\n> Patch Set 4:\n> \n> I've had a couple days to think about this, and this commit as written doesn't feel right to me.  I'm sure it wasn't the intent, but reading through, this commit feels like a back door around the rules we have about development of Redfish OEM schemas, as so far as I'm aware, this module was developed without input from a lot of the OpenBMC community nor Redfish.\n\nEd, I am not sure on why this commit feels like a back door to you , but there was a gerrit commit that explains the internal details of the lock management in openbmc/docs, unfortunately this document has not gained much of attraction in the community. \nhttps://gerrit.openbmc-project.xyz/c/openbmc/docs/+/23419\n\nI would also like to tell that this has been discussed in the redfish forum, post that is when we decided that its going to be an ibm only feature. So I belive it has had enough discussion in the community before we even started the coding process.\n\n> To be clear, that was fine when it was an IBM-only, non-Redfish API, but as this commit simply changes the URIs on the IBM resources, and adds CSDL definitions, that alone doesn't bring it up to par with what an OpenBMC Redfish resource is, or how it's developed.\n\nWhat is different in OpenBMC Redfish Reource? I am hoping we are defining some methods in the oem service. Is it not supported in Redfish ? I ran the redfish validator and it worked fine. so was thking that i am following the protocol in this case.\n\n> 1. Start with a commit in the series that completely removes the /ibm/v1 URL route handlers entirely.  This will leave a clean slate for review.\n\nDo you want us to remove all the code related to whole lock management , save area , eventing support which are under /ibm/v1 handlers completely ? which took us almost half an year to upstream ?\n\nI am okay to just remove the handlers alone, but I would want to see a concrete agreement with you on the future direction to proceed before that. \n\n> 2. Add back the route handlers in subsections that make sense, so they can be reviewed for redfish correctness, as well as community interest for being in the OpenBMC namespace.\n\nThe lock management has never gained attraction even in our OpenBMC community, as its coming from legacy IBM servers. So I prefer Oem/IBM rather than Oem/Openbmc as it is not generic to all platforms in OpenBMC & other companies.\n\n> 3. Write up some form of documentation (design doc, updated redfish markdown, ect) on what these OEM schemas are used for, and why they're useful within Redfish.\n> \n\nThere is already a design doc which I had pointed above."
        },
        {
            "timestamp": 1608321265,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n> Patch Set 4:\n> \n> > Patch Set 4:\n> > \n> > I've had a couple days to think about this, and this commit as written doesn't feel right to me.  I'm sure it wasn't the intent, but reading through, this commit feels like a back door around the rules we have about development of Redfish OEM schemas, as so far as I'm aware, this module was developed without input from a lot of the OpenBMC community nor Redfish.\n> \n> Ed, I am not sure on why this commit feels like a back door to you , but there was a gerrit commit that explains the internal details of the lock management in openbmc/docs, unfortunately this document has not gained much of attraction in the community. \n> https://gerrit.openbmc-project.xyz/c/openbmc/docs/+/23419\n\nThat's fine, but the concept of a \"lock service\" doesn't really fit within the hypermedia model, which models resources, and assumes any locks that need to be taken, are taken within an http transaction, and the resources are designed in such a way that the API itself doesn't expose the locking aside from the context of PUT/PATCH/POST/GET transactions.\n\nIt should be noted, Patrick brought up these concerns in the doc above's review, to which the response was \"This is a NOT the design for a Redfish Interface , and this is the design for Custom REST Interface and is only for IBM Systems\"\n\nThat comment seems like it's out of date, but the design doc never got updated with the new plan/intent, nor reviewed for being a Redfish API.  This is why I'm suggesting the path I laid out.\n\n> \n> I would also like to tell that this has been discussed in the redfish forum, post that is when we decided that its going to be an ibm only feature. So I belive it has had enough discussion in the community before we even started the coding process.\n\nThat's great this was done.  Would you mind putting the link to that discussion in your commit message for the new commit you create?\n\n> \n> > To be clear, that was fine when it was an IBM-only, non-Redfish API, but as this commit simply changes the URIs on the IBM resources, and adds CSDL definitions, that alone doesn't bring it up to par with what an OpenBMC Redfish resource is, or how it's developed.\n> \n> What is different in OpenBMC Redfish Reource? I am hoping we are defining some methods in the oem service.\n\nThat would be a great discussion for the new review I'm asking for.  As-is, this review doesn't contain a diff big enough to point out all the things that differ from a well behaving redfish API.\n\n> Is it not supported in Redfish ? I ran the redfish validator and it worked fine. so was thinking that i am following the protocol in this case.\n\nThe Redfish validator doesn't cover all cases, and certainly can't test anything that would require setting a parameter, which all of your actions seem to do.  It also can't distinguish between what should be modeled as an action, and what should be modeled as a resource collection, as it would require knowledge of what the resources do, which the validator doesn't do.  The validator is largely only capable of checking parameter names and value types against the schema, which while valuable, isn't the complete picture for Redfish APIs, especially when designing new CSDL.\n\n> \n> > 1. Start with a commit in the series that completely removes the /ibm/v1 URL route handlers entirely.  This will leave a clean slate for review.\n> \n> Do you want us to remove all the code related to whole lock management , save area , eventing support which are under /ibm/v1 handlers completely ? which took us almost half an year to upstream ?\n\nFor the resources being moved to redfish, I would like to see a commit to remove it, and a commit to add it back.  Considering that the files themselves need to move into the redfish folders anyway now that they're redfish resources, it doesn't significantly change the effort involved, although it will be much bigger than your patch here.\n\nIt should be noted, the existing resources were upstreamed under the assumption that they were IBM specific, and would never be redfish APIs.  Considering that you're intending to have an API break anyway, now is the time to review them as redfish resources, not after the transition has been made.  One API break is better than two.\n\nAlong those lines, do you intend to support your old API as well as the new one?  I don't have a strong opinion either way, as it's not a redfish API and I suspect there's only one client, but we should get that documented somewhere (probably in the commit message)\n\n> \n> I am okay to just remove the handlers alone, but I would want to see a concrete agreement with you on the future direction to proceed before that. \n\nI don't really know what your intention is, if your intention is to move all of /ibm/v1 into redfish OEM resources, yes, they'll need reworked.  If your intention is to only move lock service, then only those resources need to be removed then added.\n\n> \n> > 2. Add back the route handlers in subsections that make sense, so they can be reviewed for redfish correctness, as well as community interest for being in the OpenBMC namespace.\n> \n> The lock management has never gained attraction even in our OpenBMC community, as its coming from legacy IBM servers. So I prefer Oem/IBM rather than Oem/Openbmc as it is not generic to all platforms in OpenBMC & other companies.\n\nThe idea of a \"lock\" doesn't really fit within a hypermedia API, that's likely why you're not seeing any traction.  I don't really have a problem with them going into OEM/IBM, but they need to be correct per-Redfish to do so.\n\n> \n> > 3. Write up some form of documentation (design doc, updated redfish markdown, ect) on what these OEM schemas are used for, and why they're useful within Redfish.\n> > \n> \n> There is already a design doc which I had pointed above.\n\nI was unaware of that design doc prior to this discussion, but it looks like it was documenting the non-redfish API which, to be clear, is completely acceptable path to go down.    Do you plan to update the doc for Redfish?"
        },
        {
            "timestamp": 1610100879,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Patch Set 4:\n\n(1 comment)\n\n> Patch Set 4:\n> \n> > Patch Set 4:\n> > \n> > > Patch Set 4:\n> > > \n> > > I've had a couple days to think about this, and this commit as written doesn't feel right to me.  I'm sure it wasn't the intent, but reading through, this commit feels like a back door around the rules we have about development of Redfish OEM schemas, as so far as I'm aware, this module was developed without input from a lot of the OpenBMC community nor Redfish.\n> > \n> > Ed, I am not sure on why this commit feels like a back door to you , but there was a gerrit commit that explains the internal details of the lock management in openbmc/docs, unfortunately this document has not gained much of attraction in the community. \n> > https://gerrit.openbmc-project.xyz/c/openbmc/docs/+/23419\n> \n> That's fine, but the concept of a \"lock service\" doesn't really fit within the hypermedia model, which models resources, and assumes any locks that need to be taken, are taken within an http transaction, and the resources are designed in such a way that the API itself doesn't expose the locking aside from the context of PUT/PATCH/POST/GET transactions.\n> \n> It should be noted, Patrick brought up these concerns in the doc above's review, to which the response was \"This is a NOT the design for a Redfish Interface , and this is the design for Custom REST Interface and is only for IBM Systems\"\n> \n> That comment seems like it's out of date, but the design doc never got updated with the new plan/intent, nor reviewed for being a Redfish API.  This is why I'm suggesting the path I laid out.\n> \n> > \n> > I would also like to tell that this has been discussed in the redfish forum, post that is when we decided that its going to be an ibm only feature. So I belive it has had enough discussion in the community before we even started the coding process.\n> \n> That's great this was done.  Would you mind putting the link to that discussion in your commit message for the new commit you create?\n> \n> > \n> > > To be clear, that was fine when it was an IBM-only, non-Redfish API, but as this commit simply changes the URIs on the IBM resources, and adds CSDL definitions, that alone doesn't bring it up to par with what an OpenBMC Redfish resource is, or how it's developed.\n> > \n> > What is different in OpenBMC Redfish Reource? I am hoping we are defining some methods in the oem service.\n> \n> That would be a great discussion for the new review I'm asking for.  As-is, this review doesn't contain a diff big enough to point out all the things that differ from a well behaving redfish API.\n> \n> > Is it not supported in Redfish ? I ran the redfish validator and it worked fine. so was thinking that i am following the protocol in this case.\n> \n> The Redfish validator doesn't cover all cases, and certainly can't test anything that would require setting a parameter, which all of your actions seem to do.  It also can't distinguish between what should be modeled as an action, and what should be modeled as a resource collection, as it would require knowledge of what the resources do, which the validator doesn't do.  The validator is largely only capable of checking parameter names and value types against the schema, which while valuable, isn't the complete picture for Redfish APIs, especially when designing new CSDL.\n> \n> > \n> > > 1. Start with a commit in the series that completely removes the /ibm/v1 URL route handlers entirely.  This will leave a clean slate for review.\n> > \n> > Do you want us to remove all the code related to whole lock management , save area , eventing support which are under /ibm/v1 handlers completely ? which took us almost half an year to upstream ?\n> \n> For the resources being moved to redfish, I would like to see a commit to remove it, and a commit to add it back.  Considering that the files themselves need to move into the redfish folders anyway now that they're redfish resources, it doesn't significantly change the effort involved, although it will be much bigger than your patch here.\n> \n> It should be noted, the existing resources were upstreamed under the assumption that they were IBM specific, and would never be redfish APIs.  Considering that you're intending to have an API break anyway, now is the time to review them as redfish resources, not after the transition has been made.  One API break is better than two.\n> \n> Along those lines, do you intend to support your old API as well as the new one?  I don't have a strong opinion either way, as it's not a redfish API and I suspect there's only one client, but we should get that documented somewhere (probably in the commit message)\n> \n> > \n> > I am okay to just remove the handlers alone, but I would want to see a concrete agreement with you on the future direction to proceed before that. \n> \n> I don't really know what your intention is, if your intention is to move all of /ibm/v1 into redfish OEM resources, yes, they'll need reworked.  If your intention is to only move lock service, then only those resources need to be removed then added.\n> \n> > \n> > > 2. Add back the route handlers in subsections that make sense, so they can be reviewed for redfish correctness, as well as community interest for being in the OpenBMC namespace.\n> > \n> > The lock management has never gained attraction even in our OpenBMC community, as its coming from legacy IBM servers. So I prefer Oem/IBM rather than Oem/Openbmc as it is not generic to all platforms in OpenBMC & other companies.\n> \n> The idea of a \"lock\" doesn't really fit within a hypermedia API, that's likely why you're not seeing any traction.  I don't really have a problem with them going into OEM/IBM, but they need to be correct per-Redfish to do so.\n> \n> > \n> > > 3. Write up some form of documentation (design doc, updated redfish markdown, ect) on what these OEM schemas are used for, and why they're useful within Redfish.\n> > > \n> > \n> > There is already a design doc which I had pointed above.\n> \n> I was unaware of that design doc prior to this discussion, but it looks like it was documenting the non-redfish API which, to be clear, is completely acceptable path to go down.    Do you plan to update the doc for Redfish?\n\nEd, In the document i had captured the REST way of doing it,and Yes I will be the updating the design document once we agree up on the design.\n\nI had captured what i did in this commit & asked the redfish forum too see what they think from a redfish perspective.\n\nhttps://redfishforum.com/thread/408/uri-actions\n\nWhile they said that the proposed commit as-is does not break the protocol, they also suggested that there are several ways to model the lock better , but that is actually done based on the client. So i still feel this commit can go in as-is, as it is valid as per the spec."
        },
        {
            "timestamp": 1610120740,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n> Patch Set 4:\n> \n> (1 comment)\n> \n> > Patch Set 4:\n> > \n> > > Patch Set 4:\n> > > \n> > > > Patch Set 4:\n> > > > \n> > > > I've had a couple days to think about this, and this commit as written doesn't feel right to me.  I'm sure it wasn't the intent, but reading through, this commit feels like a back door around the rules we have about development of Redfish OEM schemas, as so far as I'm aware, this module was developed without input from a lot of the OpenBMC community nor Redfish.\n> > > \n> > > Ed, I am not sure on why this commit feels like a back door to you , but there was a gerrit commit that explains the internal details of the lock management in openbmc/docs, unfortunately this document has not gained much of attraction in the community. \n> > > https://gerrit.openbmc-project.xyz/c/openbmc/docs/+/23419\n> > \n> > That's fine, but the concept of a \"lock service\" doesn't really fit within the hypermedia model, which models resources, and assumes any locks that need to be taken, are taken within an http transaction, and the resources are designed in such a way that the API itself doesn't expose the locking aside from the context of PUT/PATCH/POST/GET transactions.\n> > \n> > It should be noted, Patrick brought up these concerns in the doc above's review, to which the response was \"This is a NOT the design for a Redfish Interface , and this is the design for Custom REST Interface and is only for IBM Systems\"\n> > \n> > That comment seems like it's out of date, but the design doc never got updated with the new plan/intent, nor reviewed for being a Redfish API.  This is why I'm suggesting the path I laid out.\n> > \n> > > \n> > > I would also like to tell that this has been discussed in the redfish forum, post that is when we decided that its going to be an ibm only feature. So I belive it has had enough discussion in the community before we even started the coding process.\n> > \n> > That's great this was done.  Would you mind putting the link to that discussion in your commit message for the new commit you create?\n> > \n> > > \n> > > > To be clear, that was fine when it was an IBM-only, non-Redfish API, but as this commit simply changes the URIs on the IBM resources, and adds CSDL definitions, that alone doesn't bring it up to par with what an OpenBMC Redfish resource is, or how it's developed.\n> > > \n> > > What is different in OpenBMC Redfish Reource? I am hoping we are defining some methods in the oem service.\n> > \n> > That would be a great discussion for the new review I'm asking for.  As-is, this review doesn't contain a diff big enough to point out all the things that differ from a well behaving redfish API.\n> > \n> > > Is it not supported in Redfish ? I ran the redfish validator and it worked fine. so was thinking that i am following the protocol in this case.\n> > \n> > The Redfish validator doesn't cover all cases, and certainly can't test anything that would require setting a parameter, which all of your actions seem to do.  It also can't distinguish between what should be modeled as an action, and what should be modeled as a resource collection, as it would require knowledge of what the resources do, which the validator doesn't do.  The validator is largely only capable of checking parameter names and value types against the schema, which while valuable, isn't the complete picture for Redfish APIs, especially when designing new CSDL.\n> > \n> > > \n> > > > 1. Start with a commit in the series that completely removes the /ibm/v1 URL route handlers entirely.  This will leave a clean slate for review.\n> > > \n> > > Do you want us to remove all the code related to whole lock management , save area , eventing support which are under /ibm/v1 handlers completely ? which took us almost half an year to upstream ?\n> > \n> > For the resources being moved to redfish, I would like to see a commit to remove it, and a commit to add it back.  Considering that the files themselves need to move into the redfish folders anyway now that they're redfish resources, it doesn't significantly change the effort involved, although it will be much bigger than your patch here.\n> > \n> > It should be noted, the existing resources were upstreamed under the assumption that they were IBM specific, and would never be redfish APIs.  Considering that you're intending to have an API break anyway, now is the time to review them as redfish resources, not after the transition has been made.  One API break is better than two.\n> > \n> > Along those lines, do you intend to support your old API as well as the new one?  I don't have a strong opinion either way, as it's not a redfish API and I suspect there's only one client, but we should get that documented somewhere (probably in the commit message)\n> > \n> > > \n> > > I am okay to just remove the handlers alone, but I would want to see a concrete agreement with you on the future direction to proceed before that. \n> > \n> > I don't really know what your intention is, if your intention is to move all of /ibm/v1 into redfish OEM resources, yes, they'll need reworked.  If your intention is to only move lock service, then only those resources need to be removed then added.\n> > \n> > > \n> > > > 2. Add back the route handlers in subsections that make sense, so they can be reviewed for redfish correctness, as well as community interest for being in the OpenBMC namespace.\n> > > \n> > > The lock management has never gained attraction even in our OpenBMC community, as its coming from legacy IBM servers. So I prefer Oem/IBM rather than Oem/Openbmc as it is not generic to all platforms in OpenBMC & other companies.\n> > \n> > The idea of a \"lock\" doesn't really fit within a hypermedia API, that's likely why you're not seeing any traction.  I don't really have a problem with them going into OEM/IBM, but they need to be correct per-Redfish to do so.\n> > \n> > > \n> > > > 3. Write up some form of documentation (design doc, updated redfish markdown, ect) on what these OEM schemas are used for, and why they're useful within Redfish.\n> > > > \n> > > \n> > > There is already a design doc which I had pointed above.\n> > \n> > I was unaware of that design doc prior to this discussion, but it looks like it was documenting the non-redfish API which, to be clear, is completely acceptable path to go down.    Do you plan to update the doc for Redfish?\n> \n> Ed, In the document i had captured the REST way of doing it,and Yes I will be the updating the design document once we agree up on the design.\n> \n> I had captured what i did in this commit & asked the redfish forum too see what they think from a redfish perspective.\n> \n> https://redfishforum.com/thread/408/uri-actions\n> \n> While they said that the proposed commit as-is does not break the protocol,\n\nI haven't seen them comment on the commit, only on your submitted examples of your API.\n\n> they also suggested that there are several ways to model the lock better , but that is actually done based on the client. So i still feel this commit can go in as-is, as it is valid as per the spec.\n\nI read the thread.  At this point, three people have given you pretty similar advice on how to model this as a well behaved Redfish endpoint.  While many things are \"legal\" in a redfish sense, they are not well formed, and don't encapsulate the ideas of Redfish, or hypermedia resources in general.\n\nOverall, I think your best path to move forward here is to:\n1. Submit a new design doc on the redfish version of your schema.\n2. Remove the existing ibm/v1 routes in one patch.\n3. Submit a new patch, incorporating the changes that both the Redfish forum and myself have suggested to your resources.\n\nThe the major changes suggested have been:\n1. Model locks as a collection, with POST/DELETE/GET as your resource model.\n2. Include the SessionId as part of the lock structure, to tie together the session and the lock from an API perspective.\n\nIf you have good technical reasons why the API should be modeled entirely as Actions, I'm happy to have that discussion, but as-is, I'm not seeing any good reasons for avoiding the object model there, and overall it will simplify maintenance of this feature as a whole."
        },
        {
            "timestamp": 1623114066,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\nIs this still being worked?  Last activity was 6 months ago."
        },
        {
            "timestamp": 1623145907,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Patch Set 4:\n\n> Patch Set 4:\n> \n> Is this still being worked?  Last activity was 6 months ago.\n\nHi Ed, Unfortunately i could not work on this due to change in priorities. We can abandon this change for now as i would not able to spend time on this activity at-least for some more time. Thanks for all your comments & time."
        },
        {
            "timestamp": 1623146058,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Abandoned\n\nAbandoning as i would not be able to work on this item now. Appreciate all the reviewers time & efforts."
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "f5659aa0d1ccf90fc0261afea972a799d2a8dfd9",
            "parents": [
                "929d4b57f10bc4200e16b71fbcf32521d8cc23c1"
            ],
            "ref": "refs/changes/77/38377/1",
            "uploader": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "createdOn": 1605680804,
            "author": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 39,
                    "deletions": 0
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -11
                },
                {
                    "file": "redfish-core/lib/service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                },
                {
                    "file": "static/redfish/v1/$metadata/index.xml",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/LockService.json",
                    "type": "ADDED",
                    "insertions": 315,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/index.json",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/OemRedfish/index.json",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/SegmentFlags/SegmentFlags.json",
                    "type": "ADDED",
                    "insertions": 78,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/SegmentFlags/index.json",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/LockService_v1.xml",
                    "type": "ADDED",
                    "insertions": 120,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/OemRedfish_v1.xml",
                    "type": "ADDED",
                    "insertions": 57,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/SegmentFlags_v1.xml",
                    "type": "ADDED",
                    "insertions": 62,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 739,
            "sizeDeletions": 12
        },
        {
            "number": 2,
            "revision": "043ffa5ef69c64d8d3bf44b1a52d84e163786dd1",
            "parents": [
                "8ba7ae5b697305b9e9829186e1017977325225ce"
            ],
            "ref": "refs/changes/77/38377/2",
            "uploader": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "createdOn": 1607751473,
            "author": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 39,
                    "deletions": 0
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -11
                },
                {
                    "file": "redfish-core/lib/service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -1
                },
                {
                    "file": "static/redfish/v1/$metadata/index.xml",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/LockService.json",
                    "type": "ADDED",
                    "insertions": 315,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/index.json",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/OemRedfish/index.json",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/SegmentFlags/SegmentFlags.json",
                    "type": "ADDED",
                    "insertions": 78,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/SegmentFlags/index.json",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/LockService_v1.xml",
                    "type": "ADDED",
                    "insertions": 120,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/OemRedfish_v1.xml",
                    "type": "ADDED",
                    "insertions": 49,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/SegmentFlags_v1.xml",
                    "type": "ADDED",
                    "insertions": 62,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 739,
            "sizeDeletions": 12
        },
        {
            "number": 3,
            "revision": "9726b3a8f81c3c86e0e52638f2e52778d711b90e",
            "parents": [
                "8ba7ae5b697305b9e9829186e1017977325225ce"
            ],
            "ref": "refs/changes/77/38377/3",
            "uploader": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "createdOn": 1607753611,
            "author": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 39,
                    "deletions": 0
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -11
                },
                {
                    "file": "redfish-core/lib/service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -1
                },
                {
                    "file": "static/redfish/v1/$metadata/index.xml",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/LockService.json",
                    "type": "ADDED",
                    "insertions": 315,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/index.json",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/OemRedfish/index.json",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/SegmentFlags/SegmentFlags.json",
                    "type": "ADDED",
                    "insertions": 78,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/SegmentFlags/index.json",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/LockService_v1.xml",
                    "type": "ADDED",
                    "insertions": 120,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/OemRedfish_v1.xml",
                    "type": "ADDED",
                    "insertions": 49,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/SegmentFlags_v1.xml",
                    "type": "ADDED",
                    "insertions": 62,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 739,
            "sizeDeletions": 12
        },
        {
            "number": 4,
            "revision": "2fdef3ec758a9726241433fb594207782ef7e88b",
            "parents": [
                "8ba7ae5b697305b9e9829186e1017977325225ce"
            ],
            "ref": "refs/changes/77/38377/4",
            "uploader": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "createdOn": 1607753637,
            "author": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 36,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "More needs to change than just the URLs to be a well defined OEM resource.  Please see my comments about making your resources actual resources.\n\n\nhttps://github.com/openbmc/bmcweb/blob/83cf8189e5f9d414efb5c5fa73227e977cf5f84d/include/sessions.hpp#L361\n\nThat line of code needs removed, as it imposes between-resource constraints between both the code files, and the redfish resources themselves.  Implement the delete handler on your new collection to implement that functionality."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 36,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "It should be noted, the above isn't a complete list of what needs changed.  Please review the existing redfish resources, as well as the redfish spec to understand how your OEM service needs to change to become a well behaving OEM resource."
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "line": 212,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "You're already in an OEM resource...  Why do you need a secondary OEM within the oem?"
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "line": 212,
                    "reviewer": {
                        "name": "ManojKiran Eda",
                        "email": "manojkiran.eda@gmail.com",
                        "username": "manojkiraneda"
                    },
                    "message": "Agree, this is not required."
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "line": 618,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Redfish would generally implement these as a collection, not as an Action, as they're a specific resource you're acquiring, not a latent action being imposed."
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "line": 664,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "GetLockList is deffinitely not a redfish action."
                },
                {
                    "file": "static/redfish/v1/$metadata/index.xml",
                    "line": 0,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "update https://github.com/openbmc/bmcweb/blob/master/scripts/update_schemas.py#L141 ?"
                },
                {
                    "file": "static/redfish/v1/$metadata/index.xml",
                    "line": 2722,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "All the other Oems schemas have the word \"Oem\" in them. Should this have ibm as well?"
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/LockService.json",
                    "line": 2,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "I see this in other Oem schemas (like https://github.com/openbmc/bmcweb/blob/master/static/redfish/v1/JsonSchemas/OemVirtualMedia/index.json#L2) but this isn't correct.\nI would vote add a link to bmcweb. e.g. ...static/redfish/v1/JsonSchemas/LockService/LockService.json\nThe other choice would be to just remove?"
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/LockService.json",
                    "line": 13,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "spelling"
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/LockService.json",
                    "line": 161,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "spelling"
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/SegmentFlags/SegmentFlags.json",
                    "line": 2,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "This isn't correct"
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/SegmentFlags/SegmentFlags.json",
                    "line": 68,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "spelling single"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 39,
                    "deletions": 0
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -11
                },
                {
                    "file": "redfish-core/lib/service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -1
                },
                {
                    "file": "static/redfish/v1/$metadata/index.xml",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/LockService.json",
                    "type": "ADDED",
                    "insertions": 315,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/LockService/index.json",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/OemRedfish/index.json",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/SegmentFlags/SegmentFlags.json",
                    "type": "ADDED",
                    "insertions": 78,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/JsonSchemas/SegmentFlags/index.json",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/LockService_v1.xml",
                    "type": "ADDED",
                    "insertions": 120,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/OemRedfish_v1.xml",
                    "type": "ADDED",
                    "insertions": 49,
                    "deletions": 0
                },
                {
                    "file": "static/redfish/v1/schema/SegmentFlags_v1.xml",
                    "type": "ADDED",
                    "insertions": 62,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 739,
            "sizeDeletions": 12
        }
    ]
}