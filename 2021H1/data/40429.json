{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I98c9e235019472d3e39a2c142b5a5aec4bca8f4e",
    "number": 40429,
    "subject": "Add 404 handling to COMMON_ERRORS.md",
    "owner": {
        "name": "Ed Tanous",
        "email": "ed@tanous.net",
        "username": "edtanous"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/bmcweb/+/40429",
    "commitMessage": "Add 404 handling to COMMON_ERRORS.md\n\nAt least 50% of all patchsets I see adding a collection handler seem to\nget this wrong, despite a small comment in the developing doc, lets add\na concrete example so that we can be sure this gets handled in the\nfuture, and we have something to point at in code review.\n\nSigned-off-by: Ed Tanous <edtanous@google.com>\nChange-Id: I98c9e235019472d3e39a2c142b5a5aec4bca8f4e\n",
    "createdOn": 1612899938,
    "lastUpdated": 1613156646,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1612899938,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1612899953,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1612900216,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2: Published edit on patch set 1."
        },
        {
            "timestamp": 1612900233,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1612900235,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/12180/ : ABORTED"
        },
        {
            "timestamp": 1612901259,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12182/ : SUCCESS"
        },
        {
            "timestamp": 1612977938,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1612983636,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1612984169,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1612992356,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1613003178,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3: Published edit on patch set 2."
        },
        {
            "timestamp": 1613003193,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1613003219,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1613004245,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12284/ : SUCCESS"
        },
        {
            "timestamp": 1613070679,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1613156642,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1613156646,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as ae6595ef5349a290bd36d5da967190aa4a461355 by Ed Tanous"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "cad50dcd846e1bc7704281ad8285d983cbc32964",
            "parents": [
                "081ebf06b4c947e828408029273699ff2d49a54f"
            ],
            "ref": "refs/changes/29/40429/1",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1612899938,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "COMMON_ERRORS.md",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 34,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "7646b0f11e52c3ae8d43930a48032f9834ff598c",
            "parents": [
                "081ebf06b4c947e828408029273699ff2d49a54f"
            ],
            "ref": "refs/changes/29/40429/2",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1612900216,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "COMMON_ERRORS.md",
                    "line": 201,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "The example shows the \"before\" case, could we add an \"after\" that shows the correct handling? is the fix to return \"messages::resourceNotFound()\" instead of internalError() for example?"
                },
                {
                    "file": "COMMON_ERRORS.md",
                    "line": 201,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "If i understand it correctly, the fix would be:\n -                   messages::internalError(asyncResp->res);\n +                   messages::resourceNotFound(asyncResp->res, \"myendpoint\", myProperty);"
                },
                {
                    "file": "COMMON_ERRORS.md",
                    "line": 201,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "The problem here is that we don't have a consistent \"not found\" message on dbus that everything implements the same, so it's hard to give generic advice in a doc like this.  With that said, I could put something like.\n\n'''\nDepending on the daemon being called, a fix to this might look like\nif (ec == <error code that gets returned by not found>){\n   messages::resourceNotFound(res);\n   return;\n}\nif (ec){\n   messages::internalError(res);\n   return;\n}\n'''\n\nIn as the \"correct\" version, leaving it up to the implementer to figure out the return code.  Does that work?"
                },
                {
                    "file": "COMMON_ERRORS.md",
                    "line": 201,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Ah I see. Yeah that should work."
                },
                {
                    "file": "COMMON_ERRORS.md",
                    "line": 201,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "COMMON_ERRORS.md",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 34,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "33a44999e0d1ff79548a2f5c74602a26062bd2af",
            "parents": [
                "081ebf06b4c947e828408029273699ff2d49a54f"
            ],
            "ref": "refs/changes/29/40429/3",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1613003178,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "COMMON_ERRORS.md",
                    "type": "MODIFIED",
                    "insertions": 58,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 58,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "ae6595ef5349a290bd36d5da967190aa4a461355",
            "parents": [
                "ae34c8e888aba0108042acddbcf155a5c1a48992"
            ],
            "ref": "refs/changes/29/40429/4",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1613156646,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "COMMON_ERRORS.md",
                    "type": "MODIFIED",
                    "insertions": 58,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 58,
            "sizeDeletions": 0
        }
    ]
}