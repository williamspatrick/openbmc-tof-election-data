{
    "project": "openbmc/webui-vue",
    "branch": "master",
    "id": "I1b62f47fb05d4f36796c5cdb4e7529b1f3afd0d5",
    "number": 41367,
    "subject": "Add run-ci shell script",
    "owner": {
        "name": "Derick Montague",
        "email": "derick.montague@ibm.com",
        "username": "derick-montague"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/webui-vue/+/41367",
    "commitMessage": "Add run-ci shell script\n\nThe GUI has a set of unit tests that are currrently only being run\nusing a pre-comit hook. This hook can be overridden and we would\nlike to have the unit tests run during the CI build to assure that the\nGUI unit tests are passing. Adding this shell script so that we can\nrun any GUI unit tests during the CI build.\n\nSigned-off-by: Derick Montague <derick.montague@ibm.com>\nChange-Id: I1b62f47fb05d4f36796c5cdb4e7529b1f3afd0d5\n",
    "createdOn": 1615947976,
    "lastUpdated": 1621345001,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1615947976,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1615947999,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1615948113,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/13897/ : SUCCESS"
        },
        {
            "timestamp": 1615948374,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 1:\n\nI have just replicated the format-code shell script and replaced the npm commands we are calling. I expect we need the same requirement to check the current directory before running the npm commands, but I am not sure. I am also not sure who else I should add as a reviewer for this script. I added Patrick to the CC since he resolved some issues we had with the format-code script."
        },
        {
            "timestamp": 1615994520,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1616045540,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1616083390,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1616545812,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 2: Commit message was updated."
        },
        {
            "timestamp": 1616546268,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1616546281,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1616546293,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1616546560,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/14270/ : SUCCESS"
        },
        {
            "timestamp": 1619206525,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 3: Code-Review+1\n\n(1 comment)\n\nI am fine as is. \nI can see an argument for having and not having npm ci in this script.\nI'll leave up to you."
        },
        {
            "timestamp": 1619206535,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 4: Patch Set 3 was rebased"
        },
        {
            "timestamp": 1619206550,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1619206577,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 4:\n\nRebased since just merged \"enable shellcheck\", want to make sure this passes."
        },
        {
            "timestamp": 1619206827,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/16104/ : SUCCESS"
        },
        {
            "timestamp": 1619583108,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1620930769,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 4:\n\nRefresh"
        },
        {
            "timestamp": 1621017237,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 4: Code-Review+2"
        },
        {
            "timestamp": 1621345001,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Change has been successfully rebased and submitted as 9b27bc0863022765df696daf34c2f285619147ec by Derick Montague"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "253323adf6a9695e5ae57ba3c05b69aff09f55f4",
            "parents": [
                "7006806d21cf8d13666524a8124b8395f2f1e156"
            ],
            "ref": "refs/changes/67/41367/1",
            "uploader": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "createdOn": 1615947976,
            "author": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "run-ci.sh",
                    "line": 1,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I would suggest dropping the `.sh` part of the file name.  My opinion is the language the script is written in isn't particularly useful to people calling your script."
                },
                {
                    "file": "run-ci.sh",
                    "line": 1,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "+1"
                },
                {
                    "file": "run-ci.sh",
                    "line": 1,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "Done"
                },
                {
                    "file": "run-ci.sh",
                    "line": 13,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Both format-code and run-ci are running `npm ci` which means you run it twice during CI.  Is that necessary?"
                },
                {
                    "file": "run-ci.sh",
                    "line": 13,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "I don't think so. It was suggested I create the run-ci script soley to run the unit tests since it didn't make sense to have the test in the format-code script. As long as the node dependencies are already installed, I can remove that command."
                },
                {
                    "file": "run-ci.sh",
                    "line": 13,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "Done"
                },
                {
                    "file": "run-ci.sh",
                    "line": 13,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "But without the npm ci here.. This can't be called on its own right? i.e. what if I just wanted to call this script..\n\nIf I called npm ci twice in a row, I thought the 2nd one doesn't do anything and quickly finishes."
                },
                {
                    "file": "run-ci.sh",
                    "line": 13,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "No, npm ci is a complete replacement of the node_modules director based on the package-lock.json."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "run-ci.sh",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 14,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "eee66e8bc34367042adf161cb6cd8157e0ae3bdc",
            "parents": [
                "7006806d21cf8d13666524a8124b8395f2f1e156"
            ],
            "ref": "refs/changes/67/41367/2",
            "uploader": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "createdOn": 1616545812,
            "author": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "run-ci.sh",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 14,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "3f48c83ade9e26b0964cf944b91403a16dd4d7c9",
            "parents": [
                "7006806d21cf8d13666524a8124b8395f2f1e156"
            ],
            "ref": "refs/changes/67/41367/3",
            "uploader": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "createdOn": 1616546268,
            "author": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "run-ci",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 15,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "ccdff4f7e9b85b29716cf6ea16e08a91dec7e6ab",
            "parents": [
                "5ed21f2d1e8b82be699a623bfdef550dfd598dbb"
            ],
            "ref": "refs/changes/67/41367/4",
            "uploader": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "createdOn": 1619206535,
            "author": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "run-ci",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 15,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "9b27bc0863022765df696daf34c2f285619147ec",
            "parents": [
                "c237e3081f15522ba12b40d3b662f7f6f2c9dc7f"
            ],
            "ref": "refs/changes/67/41367/5",
            "uploader": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "createdOn": 1621345001,
            "author": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "run-ci",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 15,
            "sizeDeletions": 0
        }
    ]
}