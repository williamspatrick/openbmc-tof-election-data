{
    "project": "openbmc/docs",
    "branch": "master",
    "topic": "usb-code-update",
    "id": "I04ad3d5f50d619cf6c60d0876c4b0138c0b5298c",
    "number": 47753,
    "subject": "Add USB code update design doc",
    "owner": {
        "name": "George Liu",
        "email": "liuxiwei@inspur.com",
        "username": "lxwinspur"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/docs/+/47753",
    "commitMessage": "Add USB code update design doc\n\nThis is a pretty simple draft and will continue to be updated\nin the future.\n\nSigned-off-by: George Liu <liuxiwei@inspur.com>\nChange-Id: I04ad3d5f50d619cf6c60d0876c4b0138c0b5298c\n",
    "createdOn": 1634032431,
    "lastUpdated": 1641287501,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1634032431,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1634069910,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 1:\n\n(3 comments)"
        },
        {
            "timestamp": 1634094110,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1634094214,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1634158684,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1634172091,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1636450510,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1636592173,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Topic set to usb-code-update"
        },
        {
            "timestamp": 1637186024,
            "reviewer": {
                "name": "Bruce Mitchell",
                "email": "bruce.mitchell@linux.vnet.ibm.com",
                "username": "BMC-Bruce"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1637356353,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 3:\n\n(3 comments)"
        },
        {
            "timestamp": 1637561549,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1637561564,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 3:\n\n(4 comments)"
        },
        {
            "timestamp": 1638290592,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 4: Code-Review+1"
        },
        {
            "timestamp": 1638795602,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 4: Code-Review-1\n\n(10 comments)"
        },
        {
            "timestamp": 1638999880,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 4: -Code-Review\n\n(3 comments)"
        },
        {
            "timestamp": 1639389739,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1639389743,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 4:\n\n(11 comments)"
        },
        {
            "timestamp": 1639428567,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 5: Code-Review+1\n\nDoc describes the requested implementation updates, including having the compile option being enabled by default and having a udev rule that starts a systemd service file."
        },
        {
            "timestamp": 1639614963,
            "reviewer": {
                "name": "Chicago Duan",
                "email": "duanzhijia01@inspur.com",
                "username": "ChicagoDuan"
            },
            "message": "Patch Set 5: Code-Review+1"
        },
        {
            "timestamp": 1639679574,
            "reviewer": {
                "name": "Bruce Mitchell",
                "email": "bruce.mitchell@linux.vnet.ibm.com",
                "username": "BMC-Bruce"
            },
            "message": "Patch Set 5: Code-Review+1\n\nLooks reasonable."
        },
        {
            "timestamp": 1640040013,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 5: Code-Review-1\n\n(10 comments)"
        },
        {
            "timestamp": 1640422005,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1640422012,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 5:\n\n(10 comments)"
        },
        {
            "timestamp": 1641287501,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 7."
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "5933abce960294fe2aa2924e3872332f5c3ed037",
            "parents": [
                "7e1776ee0fa3db5bcffcd3fb68c7b546f5d2beec"
            ],
            "ref": "refs/changes/53/47753/1",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "createdOn": 1634032431,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 22,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "We can probably add a bit more details on using udev rules. Brad is recommending to follow the implementation done in the hwmon repo."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 22,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 34,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "How are security vulnerabilities going to be checked in the USB driver? Not sure that's a requirement. Maybe need more details to understand what the intention is for that sentence."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 34,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Right, This is not within the scope of the current design doc.\nRemoved."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 41,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "Just a bit more details, it'll need to set the RequestedActivation to Active, follow the state of the update, and reboot the BMC once it's done."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 41,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "type": "ADDED",
                    "insertions": 46,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 46,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "172cc5bd3e3dc4d7112bbc1848da1354e5b17103",
            "parents": [
                "7e1776ee0fa3db5bcffcd3fb68c7b546f5d2beec"
            ],
            "ref": "refs/changes/53/47753/2",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "createdOn": 1634094110,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "As George mentions, this doc can be updated with additional details as implementation gets started."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "type": "ADDED",
                    "insertions": 62,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 62,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "78a8103d2079aaf4e2314bc671377dabcd5fb49d",
            "parents": [
                "7e1776ee0fa3db5bcffcd3fb68c7b546f5d2beec"
            ],
            "ref": "refs/changes/53/47753/3",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "createdOn": 1636450510,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 13,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "\"through\""
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 13,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 32,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "probably \"extract the image\" so that we don't specify the method of uncompression."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 32,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 34,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "I'm going to propose to add that we set the ApplyTime property to OnReset so that the proposed usb code update app does not reboot the BMC after activation, this gives the user an opportunity to remove the key then reset the BMC. This is to avoid unintentional automatic code updates if the bmc were to be rebooted with the usb key still plugged in."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 34,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 72,
                    "reviewer": {
                        "name": "Bruce Mitchell",
                        "email": "bruce.mitchell@linux.vnet.ibm.com",
                        "username": "BMC-Bruce"
                    },
                    "message": "nit: I believe a typo it should be firmware"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 72,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "type": "ADDED",
                    "insertions": 75,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 75,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "854beaa4b357a28ed1c20a5b467647170e7e00ec",
            "parents": [
                "7e1776ee0fa3db5bcffcd3fb68c7b546f5d2beec"
            ],
            "ref": "refs/changes/53/47753/4",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "createdOn": 1637561549,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 14,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Everything up until this seems uselessly wordy.  We already have a way to do everything you've talked about here.  Just delete this."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 14,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 15,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I think we should avoid this term (out-of-band) here.  In general many people consider everything the BMC does to be the \"out of band\".\n\n\nAll we're proposing is a new way for images to get into the machine, right?  Instead of Redfish or scp?  Simplify this whole paragraph to get to the point then."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 15,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 21,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "We don't have any existing code update design to reference?"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 21,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "We can reference the code update architecture doc that describes in order to perform an update, need first to copy the tarball image to the BMC - https://github.com/openbmc/docs/blob/master/architecture/code-update/code-update.md#steps-to-update"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 21,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 25,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "This is a design and not a requirement."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 25,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 26,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I have no idea what this means.  Again, avoid 'in-band' and 'out-of-band' because I think you're using them in an entirely different manner than most people interacting with BMCs do.  (I suspect this is IBM terminology, but nobody else uses them in this way.)"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 26,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Yes, this is IBM terminology, and I have updated it."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 30,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Please fix the word wrap through this whole document.  It makes it hard to review."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 30,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 31,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Add \"ex.\", right?  This is an example and not a literal?"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 31,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 50,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Everything in the repository should be _enabled_ by default so we get good CI testing.  Disable it in the recipe if you want."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 50,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 63,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "If this is a requirement, put it in the requirements section."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 63,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 67,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "I've added a comment in the service-config review to disable the update by disabling the usb code update udev rule by creating a symlink to /dev/null so that we don't have dependencies on the code update repo."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 67,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Ack"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 73,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "This script should not go in /usr/bin.  See the other docs on file locations.\n\nAlso, I really despise this practice of naming files \"foo.sh\".  I don't care that you wrote it in shell, or python, or whatever language you chose.    All you're doing is adding maintenance trouble if we decide to refactor it into another language down the line."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 73,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "This needs updating, the udev rule was changed in favor of starting a service file instead:\nSUBSYSTEM==\"block\", ACTION==\"add\", KERNEL==\"sda1\", ENV{SYSTEMD_WANTS}=\"usb-code-update@sda1\", TAG+=\"systemd\"\nSUBSYSTEM==\"block\", ACTION==\"add\", KERNEL==\"sdb1\", ENV{SYSTEMD_WANTS}=\"usb-code-update@sdb1\", TAG+=\"systemd\""
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 73,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "> This needs updating, the udev rule was changed in favor of starting a service file instead:\n> SUBSYSTEM==\"block\", ACTION==\"add\", KERNEL==\"sda1\", ENV{SYSTEMD_WANTS}=\"usb-code-update@sda1\", TAG+=\"systemd\"\n> SUBSYSTEM==\"block\", ACTION==\"add\", KERNEL==\"sdb1\", ENV{SYSTEMD_WANTS}=\"usb-code-update@sdb1\", TAG+=\"systemd\"\n\nUpdate this udev rule file"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "type": "ADDED",
                    "insertions": 84,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 84,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "7453735fb6fb002661d02e09e647709fcc99cc81",
            "parents": [
                "7e1776ee0fa3db5bcffcd3fb68c7b546f5d2beec"
            ],
            "ref": "refs/changes/53/47753/5",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "createdOn": 1639389739,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Do you intend this to be the commit message?  Doesn't seem particularly useful."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "No, I don't.\n\nSorry, this only applies to the description of the review stage, I will update when the entire design document is fine."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Redfish or scp"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 11,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 20,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "'lack things' ?"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 20,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Updated"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 32,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I think you're missing the [] around the 1 here."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 32,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Yes\uff0c Updated"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 37,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "What happens if there are multiple Activation interfaces (see multi-host / multi-slot design)?  For the A/B BMC images, which one gets Activated?  I don't think you want both of them to be automatically activated?\n\nHow do you know the image update is for the BMC?  Is there a restriction that we're only doing this for the BMC itself?  Can you document that?\n\nIs there any reason we're doing this automatically and not requiring at least an op-panel interaction of some sort?  Is this safe from a security perspective?  Is there any way for a user and/or system designer to disable this automatic update aspect?"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 37,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "> What happens if there are multiple Activation interfaces (see multi-host / multi-slot design)?  For the A/B BMC images, which one gets Activated?  I don't think you want both of them to be automatically activated?\n\nSorry, Maybe I am not following.\nI think this will only activate the currently running BMC image right?\nBecause the Activation interface is created under the `xyz.openbmc_project.Software.BMC.Updater/xxx` path of the `xyz.openbmc_project.Software.BMC.Updater` service, and when we copy `image-bmc` to `/tmp/images`, it will immediately Untar and generate a new path under this service.\n\n> \n> How do you know the image update is for the BMC?  Is there a restriction that we're only doing this for the BMC itself?  Can you document that?\n\nFor the USB Code Update function, there is no restriction on whether the incoming image is BMC or something else. It will be checked when the BMC is upgraded after untar. If it is not a BMC image, the upgrade will fail.\n\n> \n> Is there any reason we're doing this automatically and not requiring at least an op-panel interaction of some sort?  Is this safe from a security perspective?  Is there any way for a user and/or system designer to disable this automatic update aspect?\n\nAs described below, this interaction mode is specially designed.  If we need to disable updates, we can disable this function through redfish.\nlike this: https://gerrit.openbmc-project.xyz/c/openbmc/service-config-manager/+/48780"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 42,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I don't understand how key-removal is related here.  Are you missing something in the design?\n\nWe've already copied the image to /tmp.  You could remove the USB key and the update would still be successful."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 42,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "This is a design scheme. We don\u2019t want to reboot the BMC to complete the upgrade when the USB key is inserted. This will cause unexpected situations, such as the user does not want to upgrade or inserts the USB key by mistake."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 43,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Check line wrap throughout the document."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 43,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Sorry, I don't understand, you mean that is there a spec that each line cannot exceed 80 bytes?"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 47,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "What is it?  Who is \"the caller\"?"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 47,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "We can enable/disable this function(USB Code Update) via Redfish.\nI have removed these descriptions."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 58,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Shell script?  I don't see any shell script referenced anywhere else."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 58,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Yeah, We have removed the shell script.\nUpdated"
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 83,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Suggest dropping this part."
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "line": 83,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@inspur.com",
                        "username": "lxwinspur"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "type": "ADDED",
                    "insertions": 83,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 83,
            "sizeDeletions": 0
        },
        {
            "number": 6,
            "revision": "bd394d57dd9f3c255983ce9e6e654406ff88a212",
            "parents": [
                "7e1776ee0fa3db5bcffcd3fb68c7b546f5d2beec"
            ],
            "ref": "refs/changes/53/47753/6",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "createdOn": 1640422005,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "type": "ADDED",
                    "insertions": 80,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 80,
            "sizeDeletions": 0
        },
        {
            "number": 7,
            "revision": "49e0e4e389865df14f441bcaff8371490c0fc3ef",
            "parents": [
                "7e1776ee0fa3db5bcffcd3fb68c7b546f5d2beec"
            ],
            "ref": "refs/changes/53/47753/7",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "createdOn": 1641287501,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": "lxwinspur"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "designs/firmware-update-via-usb.md",
                    "type": "ADDED",
                    "insertions": 88,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 88,
            "sizeDeletions": 0
        }
    ]
}