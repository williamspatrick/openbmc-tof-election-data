{
    "project": "openbmc/host-error-monitor",
    "branch": "master",
    "id": "I890979c46722901ca5bc7f16f343fcc5e24b01c4",
    "number": 39871,
    "subject": "Use a synchronous call to initalize host state",
    "owner": {
        "name": "Jason Bills",
        "email": "jason.m.bills@linux.intel.com",
        "username": "jmbills"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/host-error-monitor/+/39871",
    "commitMessage": "Use a synchronous call to initalize host state\n\nThe host state is needed when checking the initial status of the\nsignal monitors, so use a synchronous call to get it before\nstarting the signal monitors.\n\nTested:\nConfirmed that the host state is initialized and used correctly\nwhen the signal monitors start.\n\nChange-Id: I890979c46722901ca5bc7f16f343fcc5e24b01c4\nSigned-off-by: Jason M. Bills <jason.m.bills@intel.com>\n",
    "createdOn": 1611187414,
    "lastUpdated": 1613161780,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1611187414,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1611187484,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1611187630,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/11198/ : SUCCESS"
        },
        {
            "timestamp": 1611188546,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Uploaded patch set 2: New patch set was added with same tree, parent, and commit message as Patch Set 1."
        },
        {
            "timestamp": 1611188609,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1611188612,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1611188729,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/11211/ : SUCCESS"
        },
        {
            "timestamp": 1611873976,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Uploaded patch set 3: Patch Set 2 was rebased."
        },
        {
            "timestamp": 1611874052,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1611874114,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/11556/ : SUCCESS"
        },
        {
            "timestamp": 1613092125,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Uploaded patch set 4: Patch Set 3 was rebased."
        },
        {
            "timestamp": 1613092201,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1613092259,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12357/ : SUCCESS"
        },
        {
            "timestamp": 1613144027,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1613156999,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1613161687,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Abandoned\n\nSwitch back to async call to get host state."
        },
        {
            "timestamp": 1613161780,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "a7fb65082a90ae6e452fb565a371fa017628ea8d",
            "parents": [
                "503dea9720f10046ebcded2b17e7286919438ae6"
            ],
            "ref": "refs/changes/71/39871/1",
            "uploader": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "createdOn": 1611187414,
            "author": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/host_error_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -17
                }
            ],
            "sizeInsertions": 22,
            "sizeDeletions": 17
        },
        {
            "number": 2,
            "revision": "af9cdb375dfec2ec682ef8cdb61f9f3df5a07a65",
            "parents": [
                "2cce30531656563605e5d9c82774bed6ad170ad0"
            ],
            "ref": "refs/changes/71/39871/2",
            "uploader": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "createdOn": 1611188546,
            "author": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "kind": "NO_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/host_error_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -17
                }
            ],
            "sizeInsertions": 22,
            "sizeDeletions": 17
        },
        {
            "number": 3,
            "revision": "6605606d11ea2dc0ed23bd60c212d58899e508da",
            "parents": [
                "2cb39975daa0b4ff8d13977af765bd30f9f77d83"
            ],
            "ref": "refs/changes/71/39871/3",
            "uploader": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "createdOn": 1611873976,
            "author": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/host_error_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -17
                }
            ],
            "sizeInsertions": 22,
            "sizeDeletions": 17
        },
        {
            "number": 4,
            "revision": "e405f791376e7372f779a31d443cdb8ff6e49b3a",
            "parents": [
                "12b3a06e2dddab57f6e42335f17d846bbd290bb5"
            ],
            "ref": "refs/changes/71/39871/4",
            "uploader": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "createdOn": 1613092125,
            "author": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "src/host_error_monitor.cpp",
                    "line": 123,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "this is going to cause problem, esp. ObjectMapper, will complain about introspect failure during AC cycle boot, as it won't get response, till the response for the initializeHostState is handled.\nBetter logic is do io post of this and below line, to give a chance to handle object mapper request."
                },
                {
                    "file": "src/host_error_monitor.cpp",
                    "line": 123,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "I chose this way so that host-error-monitor could still exit with a failure on line 128 if any of the signal monitors fails to start.  If I io::post startMonitors(), is there a good way to exit on failure?"
                },
                {
                    "file": "src/host_error_monitor.cpp",
                    "line": 123,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "I found the io.stop() method which exits, but doesn't clearly show the failure.  So, I went with a throw for now.  We can discuss other options if there are better ways.  Thanks!"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/host_error_monitor.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -17
                }
            ],
            "sizeInsertions": 22,
            "sizeDeletions": 17
        }
    ]
}