{
    "project": "openbmc/phosphor-fan-presence",
    "branch": "master",
    "id": "I0dec7fc7c42d5007c1466700470faefbf6976dff",
    "number": 40233,
    "subject": "sensor-mon: Check for threshold alarms on startup",
    "owner": {
        "name": "Matt Spinler",
        "email": "spinler@us.ibm.com",
        "username": "spinler"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-fan-presence/+/40233",
    "commitMessage": "sensor-mon: Check for threshold alarms on startup\n\nAdd the functionality to the ThresholdAlarmLogger class to check for any\nactive alarms on startup and make a createEventLog() call for them.\n\nIt also keeps track of the alarm values so that the propertiesChanged\nhandler can know if an alarm changed state or is just new.\n\nSigned-off-by: Matt Spinler <spinler@us.ibm.com>\nChange-Id: I0dec7fc7c42d5007c1466700470faefbf6976dff\n",
    "createdOn": 1612295268,
    "lastUpdated": 1614012108,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1612295268,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1612295291,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1612295620,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/11814/ : SUCCESS"
        },
        {
            "timestamp": 1612458823,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Uploaded patch set 2: Patch Set 1 was rebased."
        },
        {
            "timestamp": 1612458860,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1612459045,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/11912/ : SUCCESS"
        },
        {
            "timestamp": 1612800085,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Uploaded patch set 3: Patch Set 2 was rebased."
        },
        {
            "timestamp": 1612800123,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1612800282,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12101/ : SUCCESS"
        },
        {
            "timestamp": 1612994049,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1613078802,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1613078802,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 4:\n\n(2 comments)"
        },
        {
            "timestamp": 1613078821,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1613078830,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1613079612,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12326/ : SUCCESS"
        },
        {
            "timestamp": 1613098473,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 4: Code-Review+1"
        },
        {
            "timestamp": 1613149559,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1613157418,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1613158586,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 4: Code-Review+2\n\n(1 comment)"
        },
        {
            "timestamp": 1614012108,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Change has been successfully rebased and submitted as 50bf816a6e4801d4f529a1bd2252a97366df880a by Matt Spinler"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "ea62a1d6801f7ded8972e4115fc9a87cb31bce1e",
            "parents": [
                "ffb4c8f51916df30be9474912cec315ef120ec9b"
            ],
            "ref": "refs/changes/33/40233/1",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1612295268,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "type": "MODIFIED",
                    "insertions": 106,
                    "deletions": -1
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.hpp",
                    "type": "MODIFIED",
                    "insertions": 33,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 139,
            "sizeDeletions": 1
        },
        {
            "number": 2,
            "revision": "ffcf8f7619c83ce0510cc926281a9be13b79114c",
            "parents": [
                "70f5819b49cc2bd02bc59197ce63532a8ff26dd3"
            ],
            "ref": "refs/changes/33/40233/2",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1612458823,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "type": "MODIFIED",
                    "insertions": 106,
                    "deletions": -1
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.hpp",
                    "type": "MODIFIED",
                    "insertions": 33,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 139,
            "sizeDeletions": 1
        },
        {
            "number": 3,
            "revision": "477d6e96ecdb06b3771dfc6598534166678cdd7c",
            "parents": [
                "cc1ef31a18f8ba79cd3488e9297c6ecd2b5e3e21"
            ],
            "ref": "refs/changes/33/40233/3",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1612800085,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "line": 107,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Using getSubTreeRaw would provide the service so that doesnt have to be looked up on the `getProperty` call in checkThresholds. Since you know the interface already, getting the path and service from getSubTreeRaw would just be the first two keys."
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "line": 107,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Done"
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "line": 137,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "this is backwards."
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "line": 137,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "type": "MODIFIED",
                    "insertions": 106,
                    "deletions": -1
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.hpp",
                    "type": "MODIFIED",
                    "insertions": 33,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 139,
            "sizeDeletions": 1
        },
        {
            "number": 4,
            "revision": "5e5b4dc6cc12609123e1246e4472b21e995cf664",
            "parents": [
                "cc1ef31a18f8ba79cd3488e9297c6ecd2b5e3e21"
            ],
            "ref": "refs/changes/33/40233/4",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1613078802,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "line": 114,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "More than one service could be returned, so this should loop over those entries right?"
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "line": 114,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "As in multiple services providing the same threshold interface on the same sensor object path?  That would also imply there would be multiple Value interfaces on that object path, so I'm not sure it's something I'd need to worry about."
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "line": 114,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Good point. I guess when providing a single interface to getSubTree, there should really be only a single service instance under each path."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "type": "MODIFIED",
                    "insertions": 110,
                    "deletions": -1
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.hpp",
                    "type": "MODIFIED",
                    "insertions": 35,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 145,
            "sizeDeletions": 1
        },
        {
            "number": 5,
            "revision": "50bf816a6e4801d4f529a1bd2252a97366df880a",
            "parents": [
                "403d1f5229e0058b0398eb4b63a4a602ada4fc83"
            ],
            "ref": "refs/changes/33/40233/5",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1614012108,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.cpp",
                    "type": "MODIFIED",
                    "insertions": 110,
                    "deletions": -1
                },
                {
                    "file": "sensor-monitor/threshold_alarm_logger.hpp",
                    "type": "MODIFIED",
                    "insertions": 35,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 145,
            "sizeDeletions": 1
        }
    ]
}