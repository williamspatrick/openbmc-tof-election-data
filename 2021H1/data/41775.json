{
    "project": "openbmc/intel-ipmi-oem",
    "branch": "master",
    "id": "Ie15cfa06371b7c77901fb10b9bc61f70ae0dd0c9",
    "number": 41775,
    "subject": "Fix the ResetBIOS value from bios-settings-mgr srv",
    "owner": {
        "name": "Suryakanth Sekar",
        "email": "suryakanth.sekar@linux.intel.com",
        "username": "htnakayrus"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/intel-ipmi-oem/+/41775",
    "commitMessage": "Fix the ResetBIOS value from bios-settings-mgr srv\n\nGetStoredHash command always return 0xCE becuase fail to\nget the proper resetBIOS value from ReadResetBIOSSettings function\n\nFix: Added proper ResetBIOS value check in ReadResetBIOSSettings\nfunction and also corrected the seedData filename.\n\nTested:\n\nGetStoredHash command is working fine.\n ipmitool  raw 0x30 0xd8  // Request\n 02 18 de c8 83 d1 5d cc 58 a4 f1 af ee f0 2a 9c\n d0 12 83 45 eb f7 06 72 62 e9 dd f5 1d 78 68 13\n 41 63 2c 8a fb 9f 01 17 30 6c 69 b8 1d 67 d6 6d\n 13 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n 00 75 99 3f 96 e2 e0 81 2d 4e 40 b7 ee 2a be a3\n 6a 9d c9 69 6b 3a d3 6c 04 a0 0b 41 82 0c a4 b1\n 48 2b 92 7a 2a 23 7f 86 5b 22 6b e7 08 31 87 b8\n 14 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n 00\n\nSigned-off-by: Suryakanth Sekar <suryakanth.sekar@linux.intel.com>\nChange-Id: Ie15cfa06371b7c77901fb10b9bc61f70ae0dd0c9\n",
    "createdOn": 1617269760,
    "lastUpdated": 1618241928,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1617269760,
            "reviewer": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1617269786,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1617270286,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/14710/ : SUCCESS"
        },
        {
            "timestamp": 1617306498,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1617336982,
            "reviewer": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1617468991,
            "reviewer": {
                "name": "Saravanan Palanisamy",
                "email": "saravanan.palanisamy@linux.intel.com",
                "username": "saravanan-palanisamy"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1617679838,
            "reviewer": {
                "name": "Kuiying Wang",
                "email": "wangkuiying.wky@alibaba-inc.com",
                "username": "kuiyingw"
            },
            "message": "Patch Set 1:\n\n(3 comments)"
        },
        {
            "timestamp": 1617679878,
            "reviewer": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1617730672,
            "reviewer": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "message": "Patch Set 1:\n\n(4 comments)"
        },
        {
            "timestamp": 1617732453,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1617762861,
            "reviewer": {
                "name": "Kuiying Wang",
                "email": "wangkuiying.wky@alibaba-inc.com",
                "username": "kuiyingw"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1617778878,
            "reviewer": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "message": "Patch Set 1:\n\n(3 comments)"
        },
        {
            "timestamp": 1618199332,
            "reviewer": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1618199344,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618199918,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15226/ : SUCCESS"
        },
        {
            "timestamp": 1618208047,
            "reviewer": {
                "name": "Kuiying Wang",
                "email": "wangkuiying.wky@alibaba-inc.com",
                "username": "kuiyingw"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1618232113,
            "reviewer": {
                "name": "AppaRao Puli",
                "email": "apparao.puli@linux.intel.com",
                "username": "apuli1"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1618233876,
            "reviewer": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1618237583,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1618237668,
            "reviewer": {
                "name": "Saravanan Palanisamy",
                "email": "saravanan.palanisamy@linux.intel.com",
                "username": "saravanan-palanisamy"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1618238032,
            "reviewer": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1618239592,
            "reviewer": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1618239604,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618239764,
            "reviewer": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1618239778,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1618239780,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/15254/ : ABORTED"
        },
        {
            "timestamp": 1618240488,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/15255/ : SUCCESS"
        },
        {
            "timestamp": 1618240905,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 4: Code-Review+1\n\nCode works with current bios config manager. Just minor"
        },
        {
            "timestamp": 1618241354,
            "reviewer": {
                "name": "Saravanan Palanisamy",
                "email": "saravanan.palanisamy@linux.intel.com",
                "username": "saravanan-palanisamy"
            },
            "message": "Patch Set 4: Code-Review+1"
        },
        {
            "timestamp": 1618241917,
            "reviewer": {
                "name": "AppaRao Puli",
                "email": "apparao.puli@linux.intel.com",
                "username": "apuli1"
            },
            "message": "Patch Set 4: Code-Review+2"
        },
        {
            "timestamp": 1618241928,
            "reviewer": {
                "name": "AppaRao Puli",
                "email": "apparao.puli@linux.intel.com",
                "username": "apuli1"
            },
            "message": "Change has been successfully merged by AppaRao Puli"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "f2c1b6ba6624b854fb8e47b19b6690ae4b8331b6",
            "parents": [
                "06aa21ab75cecce354b2a17e05d053c6f61d6a29"
            ],
            "ref": "refs/changes/75/41775/1",
            "uploader": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "createdOn": 1617269760,
            "author": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Kuiying Wang",
                        "email": "wangkuiying.wky@alibaba-inc.com",
                        "username": "kuiyingw"
                    },
                    "message": "duplicate. remove it."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "Ack"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "Saravanan Palanisamy",
                        "email": "saravanan.palanisamy@linux.intel.com",
                        "username": "saravanan-palanisamy"
                    },
                    "message": "nit: may be move this word to next line : \n'function'."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "Kuiying Wang",
                        "email": "wangkuiying.wky@alibaba-inc.com",
                        "username": "kuiyingw"
                    },
                    "message": "could review it."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "Ack"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 189,
                    "reviewer": {
                        "name": "Kuiying Wang",
                        "email": "wangkuiying.wky@alibaba-inc.com",
                        "username": "kuiyingw"
                    },
                    "message": "string_view is better to avoid copy?"
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 189,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "HI Kwin, I didnt get ur comments. can u please explain"
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 189,
                    "reviewer": {
                        "name": "Kuiying Wang",
                        "email": "wangkuiying.wky@alibaba-inc.com",
                        "username": "kuiyingw"
                    },
                    "message": "You could search string_view in the storagecommands.cpp and get reference.\nLike below:\n#include <string_view>\nstd::string_view entry(targetEntry);"
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 189,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 203,
                    "reviewer": {
                        "name": "Saravanan Palanisamy",
                        "email": "saravanan.palanisamy@linux.intel.com",
                        "username": "saravanan-palanisamy"
                    },
                    "message": "Here, you are setting Bit-1 to 1. I don't see definition for Bit-1 in EPS. Is this intended ?"
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 203,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "Good catch, Currently, we are supporting 0-1  as BIOS support only default settings. I will update the EPS. BIT1-BIT0 stands for default flags."
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 203,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "Ack"
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Should there be else clause and set ResetFlag to default? and return success? or simply return error?"
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "Init value is zero. so  it wont cause any issues if no string matches."
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "return success if no str matches, is that OK? \nAlso, code would be more robust not to depend on the ResetFlag is initialized to 0."
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "yes. 0 means No action.  only supported value is NoAction, DefaultSettings, FailSafeSettings. any way other than this string, everything will be rejected by oob-biosconfig-daemon itself. \nSo it should match with any one of string.  Worst case, no matches. it will take no action as default. as no harm in this."
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "I understand it works as intended. My question is:  should the function return some error code if the string did not match, i.e. rejected."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 19,
            "sizeDeletions": 3
        },
        {
            "number": 2,
            "revision": "2471ef812a9526b7b80d89b66300f21d25105ea6",
            "parents": [
                "9420416abe06d943301ab304044ed8001d49e315"
            ],
            "ref": "refs/changes/75/41775/2",
            "uploader": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "createdOn": 1618199332,
            "author": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 205,
                    "reviewer": {
                        "name": "Saravanan Palanisamy",
                        "email": "saravanan.palanisamy@linux.intel.com",
                        "username": "saravanan-palanisamy"
                    },
                    "message": "nit: As Zhikui mentioned, you can add else condition with ResetFlag = 0 (or) 0xff - a failure value to catch unexpected input string in future (if any), so that this will not have dependency with caller."
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 205,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "else is not needed. only 0,1,2 is valid in bios setting-manager. If its not matching. if someone set any not valid value via busctl then BMC have to consider as Noaction. thats 0 by default value."
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 817,
                    "reviewer": {
                        "name": "AppaRao Puli",
                        "email": "apparao.puli@linux.intel.com",
                        "username": "apuli1"
                    },
                    "message": "nit: I don't see scope of this change in commit message. Id this intentional filename change? If yes, Can you update commit message?"
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "line": 817,
                    "reviewer": {
                        "name": "Suryakanth Sekar",
                        "email": "suryakanth.sekar@linux.intel.com",
                        "username": "htnakayrus"
                    },
                    "message": "This is actual bug. we wrote in seedData and read in passwordData file. whihc causes 0xCE for GetStoredPassword and RestBIOS value also not set properly."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 20,
            "sizeDeletions": 3
        },
        {
            "number": 3,
            "revision": "e3e8d5718c106616119129e07a584230cd553007",
            "parents": [
                "9420416abe06d943301ab304044ed8001d49e315"
            ],
            "ref": "refs/changes/75/41775/3",
            "uploader": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "createdOn": 1618239592,
            "author": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 25,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 25,
            "sizeDeletions": 3
        },
        {
            "number": 4,
            "revision": "cc4025986d958a852bdb07142cea4419e574122f",
            "parents": [
                "9420416abe06d943301ab304044ed8001d49e315"
            ],
            "ref": "refs/changes/75/41775/4",
            "uploader": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "createdOn": 1618239764,
            "author": {
                "name": "Suryakanth Sekar",
                "email": "suryakanth.sekar@linux.intel.com",
                "username": "htnakayrus"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "src/biosconfigcommands.cpp",
                    "type": "MODIFIED",
                    "insertions": 24,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 24,
            "sizeDeletions": 3
        }
    ]
}