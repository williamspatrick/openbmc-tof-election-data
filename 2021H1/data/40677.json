{
    "project": "openbmc/webui-vue",
    "branch": "master",
    "id": "Id3895d43012e8c711a182026cb40aaa64234f9bf",
    "number": 40677,
    "subject": "Refit SoL terminal on window resize",
    "owner": {
        "name": "Konstantin Aladyshev",
        "email": "aladyshev22@gmail.com",
        "username": "Kostr"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/webui-vue/+/40677",
    "commitMessage": "Refit SoL terminal on window resize\n\n'xterm' addon used in the \"Serial over LAN (SOL) console\" page\ndoesn't resize terminal screen on window size change.\nIf the initial window is small after its increase in size\nthere would be gaps in the terminal screen workspace.\nTo solve this use fit addon when window size is changed.\nFor optimization add throttle for the event function and remove\nlistener on page destroy.\n\nSee https://github.com/openbmc/webui-vue/issues/53 for details.\n\nSigned-off-by: Konstantin Aladyshev <aladyshev22@gmail.com>\nChange-Id: Id3895d43012e8c711a182026cb40aaa64234f9bf\n",
    "createdOn": 1613571978,
    "lastUpdated": 1614976595,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1613571978,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1613571993,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1613572082,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12542/ : SUCCESS"
        },
        {
            "timestamp": 1613572118,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Patch Set 1:\n\nHello!\n\nPlease review my patch for the https://github.com/openbmc/webui-vue/issues/53"
        },
        {
            "timestamp": 1613585322,
            "reviewer": {
                "name": "Yoshie Muranaka",
                "email": "yoshiemuranaka@gmail.com",
                "username": "yoshiemuranaka"
            },
            "message": "Patch Set 1: Code-Review+1"
        },
        {
            "timestamp": 1613589913,
            "reviewer": {
                "name": "Dixsie Wolmers",
                "email": "dixsiew@gmail.com",
                "username": "dixsie"
            },
            "message": "Patch Set 1: Code-Review+1"
        },
        {
            "timestamp": 1613672149,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(1 comment)"
        },
        {
            "timestamp": 1613681887,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1613697279,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1613857995,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1613858009,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1613858061,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12742/ : SUCCESS"
        },
        {
            "timestamp": 1613975085,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 2:\n\n(6 comments)\n\nThere are couple of issues with this that can be resolved with this approach."
        },
        {
            "timestamp": 1613986783,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1613986796,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1613987249,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/12768/ : SUCCESS"
        },
        {
            "timestamp": 1614000155,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1614004314,
            "reviewer": {
                "name": "Yoshie Muranaka",
                "email": "yoshiemuranaka@gmail.com",
                "username": "yoshiemuranaka"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1614050699,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1614050718,
            "reviewer": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "message": "Change has been successfully rebased and submitted as 64f260c7583671e0a90953fb58fa690cf7d6bec2 by Derick Montague"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "5a685daa9d55767826b4359ff53a04aae3d75bb0",
            "parents": [
                "8026797012a0cbdce357a5c47304134fec9eca73"
            ],
            "ref": "refs/changes/77/40677/1",
            "uploader": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "createdOn": 1613571978,
            "author": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "line": 98,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "This seems like a heavy handed approach for handling the scroll bars on smaller screens. Part of my concern is that once this is registered, it is continuously fired on any page when the browser is resized. I don't think that is the approach we want to take. I have a couple of suggestions.\n\n1. Use lodash to debounce the calls\n2. Stop listening on the route change\n\nDebounce is needed and this will assure that the method is called only after the resize event has stopped. So 1 call instead potentially hundreds.\n\nSince that event is only needed for that page, I don't think we should listen for it if we are not using Serial over LAN."
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "line": 98,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "Stop listening on the route change == use the beforeDestroy hook to stop listening."
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "line": 98,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "I actually think that throttle might be better than debounce in this case."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 4,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "87bede39a5b67bb4d244b1470f2bd98014caf2e5",
            "parents": [
                "8026797012a0cbdce357a5c47304134fec9eca73"
            ],
            "ref": "refs/changes/77/40677/2",
            "uploader": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "createdOn": 1613857995,
            "author": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "line": 48,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "I would rename this resizeConsoleWindow."
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "line": 71,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "This doesn't remove the event listener since the resizeConsoleWindow is not the function referenced when the event listener is added. However, if you use the data property to store your function it will work as you expected."
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "line": 93,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "You can use a const here as it was previously.\nconst fitAddon = new FitAddon();\nterm.loadAddon(fitAddon);"
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "line": 103,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "use the variable from line 92."
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "line": 108,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "You could save the function as a function expression in the data property.\n\nthis.resizeConsoleWindow = throttle(() => {\n  // Log for testing if it the event is removed as expected\n  console.log('fit');\n  fitAddon.fit();\n}, 1000);\nwindow.addEventListener('resize', this.resizeConsoleWindow);"
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "line": 128,
                    "reviewer": {
                        "name": "Derick Montague",
                        "email": "derick.montague@ibm.com",
                        "username": "derick-montague"
                    },
                    "message": "You could remove this and use the data property."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 20,
            "sizeDeletions": 3
        },
        {
            "number": 3,
            "revision": "c199ac96888564634c423e6f6fe9e766e67525a2",
            "parents": [
                "8026797012a0cbdce357a5c47304134fec9eca73"
            ],
            "ref": "refs/changes/77/40677/3",
            "uploader": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "createdOn": 1613986783,
            "author": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 14,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "64f260c7583671e0a90953fb58fa690cf7d6bec2",
            "parents": [
                "99e20d8f59502be081836fd79a041ab3cc389b72"
            ],
            "ref": "refs/changes/77/40677/4",
            "uploader": {
                "name": "Derick Montague",
                "email": "derick.montague@ibm.com",
                "username": "derick-montague"
            },
            "createdOn": 1614050718,
            "author": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "src/views/Control/SerialOverLan/SerialOverLanConsole.vue",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 14,
            "sizeDeletions": 0
        }
    ]
}