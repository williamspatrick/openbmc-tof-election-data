{
    "project": "openbmc/phosphor-fan-presence",
    "branch": "master",
    "id": "I0a109a1d85390c0201f8a54942efcd2fb21a2b65",
    "number": 43544,
    "subject": "monitor: Read fan state from dbus inventory upon starting",
    "owner": {
        "name": "Mike Capps",
        "email": "mikepcapps@gmail.com",
        "username": "mikecgithub"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-fan-presence/+/43544",
    "commitMessage": "monitor: Read fan state from dbus inventory upon starting\n\ntach sensors previously defaulted to functional. Now they default to the\ninventory state. For counter-based sensors, nonfunctional state forces\nthe count to exceed the threshold.\n\nFan's functional state now depends on the number of functional sensors.\n\ntest plan:\n1) power-off chassis, stop phosphor-fan-monitor service\n2) use busctl to make a fan's tach sensor nonfunctional\n3) start fan-monitor\n4) verify the fan's state == nonfunctional\n5) poweron chassis, verify that fan-monitor updates _sensor_ to\n   functional\n6) fan should remain nonfunctional\n7) set Fan to non-present, then to present again (simulate\n   replacement)\n8) observe the fans functional state is now true in inventory\n\nSigned-off-by: Mike Capps <mikepcapps@gmail.com>\nChange-Id: I0a109a1d85390c0201f8a54942efcd2fb21a2b65\n",
    "createdOn": 1622040115,
    "lastUpdated": 1624562876,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1622040115,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1622040142,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1622040228,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/18157/ : SUCCESS"
        },
        {
            "timestamp": 1622040327,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 1:\n\ntach sensors previously defaulted to functional. Now they default to the inventory state. For counter-based sensors, nonfunctional state forces the count to exceed the threshold.\n\nFan's functional state now depends on the number of functional sensors."
        },
        {
            "timestamp": 1622040842,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 2: Commit message was updated."
        },
        {
            "timestamp": 1622071856,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1622071869,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1622071957,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/18171/ : SUCCESS"
        },
        {
            "timestamp": 1622122967,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3:\n\nYou tried booting starting with nonfunctional sensors to make sure there aren't any error messages or logs?"
        },
        {
            "timestamp": 1622130166,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1622130177,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1622130259,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 4:\n\n> Patch Set 3:\n> \n> You tried booting starting with nonfunctional sensors to make sure there aren't any error messages or logs?\n\nYes, please see updated commit message."
        },
        {
            "timestamp": 1622130355,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/18251/ : SUCCESS"
        },
        {
            "timestamp": 1622219525,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 4: Code-Review+1"
        },
        {
            "timestamp": 1622565406,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 4:\n\n(4 comments)"
        },
        {
            "timestamp": 1622728521,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1622728550,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1622728632,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 5:\n\n(4 comments)"
        },
        {
            "timestamp": 1622728636,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/18634/ : SUCCESS"
        },
        {
            "timestamp": 1623181780,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 5:\n\n(7 comments)"
        },
        {
            "timestamp": 1623248871,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1623248886,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1623248891,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 5:\n\n(6 comments)"
        },
        {
            "timestamp": 1623248910,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/19150/ : FAILURE"
        },
        {
            "timestamp": 1623248967,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1623248986,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1623249077,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/19151/ : SUCCESS"
        },
        {
            "timestamp": 1623252682,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1623253324,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1623254547,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1623254672,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1623254805,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1623256440,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1623261613,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 8."
        },
        {
            "timestamp": 1623261627,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1623261691,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/19176/ : FAILURE"
        },
        {
            "timestamp": 1623263012,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 9."
        },
        {
            "timestamp": 1623263052,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1623263135,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/19180/ : SUCCESS"
        },
        {
            "timestamp": 1623945443,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 9:\n\n(2 comments)"
        },
        {
            "timestamp": 1624285481,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 10."
        },
        {
            "timestamp": 1624285494,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624285523,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 10: Code-Review+1\n\n(2 comments)"
        },
        {
            "timestamp": 1624285597,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/20256/ : SUCCESS"
        },
        {
            "timestamp": 1624290638,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Removed Code-Review+1 by Mike Capps <mikepcapps@gmail.com>\n"
        },
        {
            "timestamp": 1624298371,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 10:\n\n(1 comment)"
        },
        {
            "timestamp": 1624299792,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Uploaded patch set 11."
        },
        {
            "timestamp": 1624299804,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1624299818,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1624299898,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/20268/ : SUCCESS"
        },
        {
            "timestamp": 1624465163,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 11: Code-Review+1"
        },
        {
            "timestamp": 1624477896,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 11: Code-Review+1"
        },
        {
            "timestamp": 1624480367,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 11: Code-Review+2"
        },
        {
            "timestamp": 1624549341,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Change has been successfully rebased and submitted as ce6820ab79e7c75b74e57ffb30a063b4d46f43a2 by Mike Capps"
        },
        {
            "timestamp": 1624562876,
            "reviewer": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "e34af347f02ed12fba85275b4530d73ffe850b5a",
            "parents": [
                "3efec61c8f0ba530a24ad46e6c10d8827fbf9219"
            ],
            "ref": "refs/changes/44/43544/1",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1622040115,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 16,
            "sizeDeletions": 6
        },
        {
            "number": 2,
            "revision": "961d613941b0854d8efa8ced4e9daf507304cc2e",
            "parents": [
                "3efec61c8f0ba530a24ad46e6c10d8827fbf9219"
            ],
            "ref": "refs/changes/44/43544/2",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1622040842,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 16,
            "sizeDeletions": 6
        },
        {
            "number": 3,
            "revision": "240540503e09522f0b4da74acf78e5db29672a4d",
            "parents": [
                "3efec61c8f0ba530a24ad46e6c10d8827fbf9219"
            ],
            "ref": "refs/changes/44/43544/3",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1622071856,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 16,
            "sizeDeletions": 6
        },
        {
            "number": 4,
            "revision": "e626644878a4dc8adac549d54d5f5df6c4ea08fb",
            "parents": [
                "3efec61c8f0ba530a24ad46e6c10d8827fbf9219"
            ],
            "ref": "refs/changes/44/43544/4",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1622130166,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 20,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "In place of doing this, should poweron the chassis, verify that the sensor is updated to functional by fan monitor, the fan should stay nonfunctional until doing the next step to simulate a fan being removed & replugged."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 20,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                },
                {
                    "file": "monitor/fan.cpp",
                    "line": 91,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Was there a reason to not call `updateInventory(false);` here?\n\nI believe we'd want to update inventory to mark this fan FRU as nonfunctional upon creation if the number of nonfunctional sensors it contains is greater than or equal to the configured number of failed sensors for this fan to be nonfunc."
                },
                {
                    "file": "monitor/fan.cpp",
                    "line": 91,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "It appeared to me that the only thing updateInventory() does (other than set that bool) is save off the inventory we just read in. I will change the code since there's probably another sequence I'm not thinking of."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 85,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "To eliminate confusion, lets remove this since \"persistent\" could be take to refer to persisted storage on the BMC, which we're not doing here. We're reading the sensor's functional state from inventory on dbus. Inventory manager would set each sensor's functional state from persisted storage if it exists, otherwise the sensor would not exist in inventory on dbus."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 85,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 89,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Looking at the code path of this call, we need to replace this with dealing with the raw responses from dbus in reading these properties since they may not exist in inventory on dbus (i.e. genesis poweron).\n\nMy suggestion would be to add a `getServiceRaw` method to the SDBusPlus class that is first called, then if the the service name returned from that is not empty, call `getProperty(bus, service, path, intf, prop)` directly. Then if the service name is empty or the getProperty call throws an exception (that we'd catch here), default the sensor to functional = false."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 89,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 18,
            "sizeDeletions": 6
        },
        {
            "number": 5,
            "revision": "966efa405fb1853fa1b79ce84be80428c0dc4b59",
            "parents": [
                "3efec61c8f0ba530a24ad46e6c10d8827fbf9219"
            ],
            "ref": "refs/changes/44/43544/5",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1622728521,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 20,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Looks like something caused this to not get line-breaked correctly."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 20,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                },
                {
                    "file": "monitor/fan.cpp",
                    "line": 92,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "So the sequence I'm thinking of is for setting the fan inventory's functional state from a genesis BMC state. At genesis BMC state, inventory would not exist for this fan yet, so we'd want to create it in inventory. That means, there should also be an `updateInventory(true)` when the count of nonfunc sensors are below the configured number of sensors failed for nonfunc.\n\nSo really, this could be updated to be:\n\n  updateInventory((countNonFunctionalSensors() < _numSensorFailsForNonFunc));\n\nThis should cover setting the fan's state in inventory on genesis BMC state and any point after that."
                },
                {
                    "file": "monitor/fan.cpp",
                    "line": 92,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 87,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "It appears `getServiceRaw` method is not actually needed and `getService` can just be used instead here for checking if the inventory manager service is running prior to attempting to get the fan sensor's last known functional state from inventory (if it exists).\n\nWe really just needed to separate getting the service name and getting the property to handle a genesis BMC state."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 87,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 93,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Since you have the service name now, you can eliminate the service name lookup that this `getProperty` function does and call the `getProperty` function that takes the service name as an arg.\n\nhttps://github.com/openbmc/phosphor-fan-presence/blob/master/sdbusplus.hpp#L357-L377"
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 99,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "I had a side discussion on this, and it was decided that when the inventory service is not up, this should default to _functional = true and attempt to update inventory. So updating this to:\n\n_functional = true;\nupdateInventory(_functional);\n\nwould expose that the inventory manager service isnt available and we attempted to set a fan sensor's functional state to true causing the fan monitor service to fail since having inventory manager started is a dependency."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 99,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 104,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "I dont think we want to log an error here, we should log it as <level::DEBUG> since this exception will happen on the genesis BMC state where the fan sensor doesnt exist in inventory yet.\n\nfwiw, the `phosphor::logging::` namespace isnt needed."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 104,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 105,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Same for here, I had a discussion on this and for the case that its the genesis poweron (where fan inventory has not been added yet), this should default to _functional = true and then update inventory. So updating this to:\n\n_functional = true;\nupdateInventory(_functional);\n\nwould set the genesis state of this fan sensor's functional state to true since we did not retrieve it from inventory."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 105,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -4
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 28,
                    "deletions": -2
                },
                {
                    "file": "sdbusplus.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 48,
            "sizeDeletions": 14
        },
        {
            "number": 6,
            "revision": "914df6e06b58cf1a038bc92cf75652f9628f300d",
            "parents": [
                "3efec61c8f0ba530a24ad46e6c10d8827fbf9219"
            ],
            "ref": "refs/changes/44/43544/6",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1623248871,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -4
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 31,
                    "deletions": -2
                },
                {
                    "file": "sdbusplus.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 48,
            "sizeDeletions": 14
        },
        {
            "number": 7,
            "revision": "f6196ff637d0df29bf2f1d66edefe2d86a4442e8",
            "parents": [
                "3efec61c8f0ba530a24ad46e6c10d8827fbf9219"
            ],
            "ref": "refs/changes/44/43544/7",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1623248967,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 86,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "If the inventory service isn't running, the GetObject call will throw an exception:\n\nroot@p10bmc:~# busctl call xyz.openbmc_project.ObjectMapper /xyz/openbmc_project/object_mapper xyz.openbmc_project.ObjectMapper GetObject sas /xyz/openbmc_project/inventory/system/chassis/motherboard/fan0/fan0_0 0\n\na{sas} 1 \"xyz.openbmc_project.Inventory.Manager\" 4 \"org.freedesktop.DBus.Introspectable\" \"org.freedesktop.DBus.Peer\" \"org.freedesktop.DBus.Properties\" \"xyz.openbmc_project.State.Decorator.OperationalStatus\"\n\n\nroot@p10bmc:~# systemctl stop xyz.openbmc_project.Inventory.Manager\n\nroot@p10bmc:~# busctl call xyz.openbmc_project.ObjectMapper /xyz/openbmc_project/object_mapper xyz.openbmc_project.ObjectMapper GetObject sas /xyz/openbmc_project/inventory/system/chassis/motherboard/fan0/fan0_0 0\n\nCall failed: path or object not found"
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 86,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "See Matt B's comment from 8-Jun. He's saying inventory is a requirement for fan-monitor, so it may actually be desirable to bail with an unhandled exception."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 86,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "The scope of this change will have a dependency on the inventory service running when fan monitor starts.\n\nIssue https://github.com/openbmc/phosphor-fan-presence/issues/25 has been created to handle the case here where the inventory service is not running yet and to retrieve the tach sensor and fan functional states once it becomes available."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 86,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Add a \"TODO - phosphor-fan-presence/issues/25\" for now here."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 86,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "I think you guys were probably right in the first place.  I do see the inventory dependency in the service file.  I just wasn't paying close enough attention."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 86,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Yep, eventually though I'd like to have any dependencies removed from the service files and handled in the code but we're good for now and can address that later in issue #25."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 86,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -4
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -2
                },
                {
                    "file": "sdbusplus.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 49,
            "sizeDeletions": 14
        },
        {
            "number": 8,
            "revision": "783ec6b0f2b909f916884f4da16c14b9c63be09a",
            "parents": [
                "fdfcc679e69e4fd289c44e58740a5f2f4011b284"
            ],
            "ref": "refs/changes/44/43544/8",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1623261613,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -2
                },
                {
                    "file": "sdbusplus.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 50,
            "sizeDeletions": 13
        },
        {
            "number": 9,
            "revision": "d197c7f689490fdea5bbedae6f1bb82a86bc029f",
            "parents": [
                "fdfcc679e69e4fd289c44e58740a5f2f4011b284"
            ],
            "ref": "refs/changes/44/43544/9",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1623263012,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "monitor/fan.cpp",
                    "line": 83,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Apologies... I just realized that a user could configure _numSensorFailsForNonFunc = 0 which would mean to never set the fan to nonfunc based on its sensors. So if _numSensorFailsForNonFunc == 0, lets set the Fan object's functional state in inventory = true, otherwise do what you have here."
                },
                {
                    "file": "monitor/fan.cpp",
                    "line": 83,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 99,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "If the inventory service is not up, what you have here would throw an exception. I think you wanted to update the `getService` call above to `getServiceRaw` and handle parsing the result yourself here."
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "line": 99,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -4
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -2
                },
                {
                    "file": "sdbusplus.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 49,
            "sizeDeletions": 14
        },
        {
            "number": 10,
            "revision": "1d5075e88261ea3805dcd69be92ca8a88a559cbc",
            "parents": [
                "7072237b9a2bbea7d800c81a09f376a57cb17413"
            ],
            "ref": "refs/changes/44/43544/10",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1624285481,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "monitor/fan.cpp",
                    "line": 85,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "I dont think this results in what we want when _numSensorFailsForNonFunc == 0.\n\n\"So if _numSensorFailsForNonFunc == 0, lets set the Fan object's functional state in inventory = true, otherwise do what you have here.\""
                },
                {
                    "file": "monitor/fan.cpp",
                    "line": 85,
                    "reviewer": {
                        "name": "Mike Capps",
                        "email": "mikepcapps@gmail.com",
                        "username": "mikecgithub"
                    },
                    "message": "yikes! that was close. thanks"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -5
                },
                {
                    "file": "monitor/fan.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 33,
                    "deletions": -2
                },
                {
                    "file": "sdbusplus.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 56,
            "sizeDeletions": 16
        },
        {
            "number": 11,
            "revision": "3e6be78bf4744f3ecb841400827863fafe197f0e",
            "parents": [
                "7072237b9a2bbea7d800c81a09f376a57cb17413"
            ],
            "ref": "refs/changes/44/43544/11",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1624299792,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -5
                },
                {
                    "file": "monitor/fan.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 33,
                    "deletions": -2
                },
                {
                    "file": "sdbusplus.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 56,
            "sizeDeletions": 16
        },
        {
            "number": 12,
            "revision": "ce6820ab79e7c75b74e57ffb30a063b4d46f43a2",
            "parents": [
                "058180f9d6e6b9d6f9deb75e3ebd09404e89bde6"
            ],
            "ref": "refs/changes/44/43544/12",
            "uploader": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "createdOn": 1624549341,
            "author": {
                "name": "Mike Capps",
                "email": "mikepcapps@gmail.com",
                "username": "mikecgithub"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "monitor/fan.cpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -5
                },
                {
                    "file": "monitor/fan.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "monitor/tach_sensor.cpp",
                    "type": "MODIFIED",
                    "insertions": 33,
                    "deletions": -2
                },
                {
                    "file": "sdbusplus.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 56,
            "sizeDeletions": 16
        }
    ]
}