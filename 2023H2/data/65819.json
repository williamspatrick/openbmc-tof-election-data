{
    "project": "openbmc/docs",
    "branch": "master",
    "id": "Ia405ca264b048e9dac84b0e045c8e0bc3b10ad81",
    "number": 65819,
    "subject": "design: Make StaticNTPServers network irrelevant",
    "owner": {
        "name": "Lei YU",
        "email": "mine260309@gmail.com",
        "username": "mine260309"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/docs/+/65819",
    "hashtags": [],
    "createdOn": 1691495726,
    "lastUpdated": 1701415747,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1691495726,
            "reviewer": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1691495759,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1691495759,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1691495781,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/72628/ : SUCCESS"
        },
        {
            "timestamp": 1691683366,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(3 comments)"
        },
        {
            "timestamp": 1691748172,
            "reviewer": {
                "name": "Sunitha Harish",
                "email": "sunithaharish04@gmail.com",
                "username": "sunharis"
            },
            "message": "Patch Set 1:\n\n(3 comments)"
        },
        {
            "timestamp": 1691750812,
            "reviewer": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "message": "Patch Set 1:\n\n(4 comments)"
        },
        {
            "timestamp": 1692171869,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1692600230,
            "reviewer": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1692600247,
            "reviewer": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "message": "Uploaded patch set 3: Commit message was updated."
        },
        {
            "timestamp": 1692600290,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1692600290,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1692600314,
            "reviewer": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1692600323,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/73223/ : SUCCESS"
        },
        {
            "timestamp": 1692663333,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1701286806,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1701319332,
            "reviewer": {
                "name": "Sunitha Harish",
                "email": "sunithaharish04@gmail.com",
                "username": "sunharis"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1701323247,
            "reviewer": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1701323854,
            "reviewer": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1701354499,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1701408393,
            "reviewer": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1701415029,
            "reviewer": {
                "name": "Ratan Gupta",
                "email": "ratankgupta31@gmail.com",
                "username": "ratagupt"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1701415747,
            "reviewer": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "cd82ae10253a7027e2a9a0d423fd65cc812d33c5",
            "parents": [
                "afb213e0829cd2d1218beececcd2422be1c60e19"
            ],
            "ref": "refs/changes/19/65819/1",
            "uploader": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "createdOn": 1691495726,
            "author": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Overall I'm in support of this simplification.  I would like to see settingsd removed from the design path, but that doesn't seem to be a significant change."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 28,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "If StaticNTPServers is moving from EthernetInterface to system level - time manager, then NTPServers also can go together. Otherwise again, both interfaces will have to display same set of NTPServers values."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 28,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "NTPServers are kept in this proposal, and it's still a read-only property to expose the NTP servers, including the DHCP ones, and the static ones."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 28,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "Sure. The question is - Is this read-only property is also moving to the system level?"
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 28,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "No, the read-only property is kept in `EthernetInterface`.\n\nThe \"global\" setting in time manager becomes the \"static\" NTP servers, and `EthernetInterface` contains both the static and DHCP ones.\n\nThey do display same static ones."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 45,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Why doesn't phosphor-time-manager just implement this property?  There are systems that don't use settingsd, and implementing it in the time-manager daemon allows error codes to be propogated if something about the set fails."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 45,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "> Why doesn't phosphor-time-manager just implement this property?\n\nThe current time sync method is implemented in settingsd, and time-manager has a match of the porpertiesChanged signal to handle the setting update.\n\n> There are systems that don't use settingsd, and implementing it in the time-manager daemon allows error codes to be propogated if something about the set fails.\n\nI am not aware of such systems. But it's true that implementing the time related interfaces in time-manager makes sensor, and it involves some refactor of time-manager. It's a little of off-topic though."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 45,
                    "reviewer": {
                        "name": "ManojKiran Eda",
                        "email": "manojkiran.eda@gmail.com",
                        "username": "manojkiraneda"
                    },
                    "message": "> The current time sync method is implemented in settingsd, and time-manager has a match of the porpertiesChanged signal to handle the setting update.\n\nwhich match are we talking about ? can you add this information as well in the document ?\n\nEven i think phosphor-time-manager hosting this would be a simpler design rather than settings."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 45,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "Updated the doc"
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 63,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This is arguably just a bug, right?  THere's no reason that pnm needs to do a reload?"
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 63,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "Network Manager reloads the interface when there is any parameter change. Static NTP server is one of them.\nBut yes, if this goes out of Network Manager, then reloads also goes away."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 63,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "Yes, previously the reload is required to let systemd-networkd to load the updated config."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 89,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "DHCP server provided NTPS servers needs to be tested.\n\nEnable DHCPv4 on one of then interface, verify if the read-only property NTPServers is getting updated with the dynamically provided server IP and the time is getting synced."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 89,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "Sure, this is the same behavior as before."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "type": "ADDED",
                    "insertions": 98,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 112,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "bf2069782b49ab56661240d02b1092c2b91520d5",
            "parents": [
                "afb213e0829cd2d1218beececcd2422be1c60e19"
            ],
            "ref": "refs/changes/19/65819/2",
            "uploader": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "createdOn": 1692600230,
            "author": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "type": "ADDED",
                    "insertions": 109,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 123,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "c99741a99463efc5eeaa03715b5382c3213c413e",
            "parents": [
                "afb213e0829cd2d1218beececcd2422be1c60e19"
            ],
            "ref": "refs/changes/19/65819/3",
            "uploader": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "createdOn": 1692600247,
            "author": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "What is the status on this design?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "The plan is to implement the change if the doc is accepted in the community."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Do we have consensus on it?  I don't see a single maintainer of phosphor\n-network invited to review and there seems to only be one +1."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "You are right. Invited phosphor-networkd maintainers and reviewers."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 16,
                    "reviewer": {
                        "name": "Ratan Gupta",
                        "email": "ratankgupta31@gmail.com",
                        "username": "ratagupt"
                    },
                    "message": "https://www.freedesktop.org/software/systemd/man/latest/systemd.network.html, Eevn in the systemd-networkd it is in the network section."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 16,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "There is NTP setting as well in\nhttps://www.freedesktop.org/software/systemd/man/latest/timesyncd.conf.html#NTP="
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 22,
                    "reviewer": {
                        "name": "Ratan Gupta",
                        "email": "ratankgupta31@gmail.com",
                        "username": "ratagupt"
                    },
                    "message": "This is the same design principle was followed for NTP and NameServer/DNS, \nNameServer/NTP server can be different for different networks, Hence tied to the ethernetInterface."
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "line": 22,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "This doc is to propose to sets NTP servers that apply globally in BMC, instead of per ethernet interface.\n\nSo that bmcweb could use the setting directly, instead of querying all the ethernet interfaces."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/make-staticntpservers-network-irrelevant.md",
                    "type": "ADDED",
                    "insertions": 109,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 123,
            "sizeDeletions": 0
        }
    ]
}