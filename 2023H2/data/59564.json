{
    "project": "openbmc/sdbusplus",
    "branch": "master",
    "id": "I8f404b2df879b519d17548e602a105e56fcbecef",
    "number": 59564,
    "subject": "bus/match: Remove redundant inline and stringify",
    "owner": {
        "name": "William A. Kennington III",
        "email": "wak@google.com",
        "username": "wak-google"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/sdbusplus/+/59564",
    "hashtags": [],
    "createdOn": 1670623951,
    "lastUpdated": 1689203535,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1670623951,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1670623984,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1670623984,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1670624584,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1670624798,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/57415/ : SUCCESS"
        },
        {
            "timestamp": 1689197229,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1689197244,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1689197244,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1689197603,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1689197679,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1689198008,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1689198032,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/70841/ : SUCCESS"
        },
        {
            "timestamp": 1689198437,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2: Code-Review+2\n\n(2 comments)"
        },
        {
            "timestamp": 1689198539,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1689198548,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2: -Code-Review"
        },
        {
            "timestamp": 1689200705,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1689200729,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1689200729,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1689200768,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1689200853,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1689201390,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/70854/ : SUCCESS"
        },
        {
            "timestamp": 1689203535,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Change has been successfully merged"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "d7acc8a04e51dddbd13f3e668300e3c1509eb596",
            "parents": [
                "5d26ec9ef5e46b93fe629fea55f1f9af8da7ded0"
            ],
            "ref": "refs/changes/64/59564/1",
            "uploader": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "createdOn": 1670623951,
            "author": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Why?  The way it was they could be string_views if it was all constexpr content.\n\n\nWe will need to run clang-tidy against EM and bmcweb before merging this if we go forward.  There were a number of gotchas I ran into previously with clang's worse support and that's how I arrived at which pieces were strings and which weren't."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Because ultimately no one is using the string view bits on their own and always concatenating multiple of them together. The `std::string` versions of all of these strings will always fit in SSO space and not heap allocate anyway. They generally should be wrapping these calls into something that materializes the string at compile time (Ex. `stdplus::cexprSv<[]() { return propertiesChanged(\"srv\", \"obj\"); }>`).\n\nI can run the tests against those repos to make sure it still works."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "bmcweb is tested"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -38
                }
            ],
            "sizeInsertions": 46,
            "sizeDeletions": 38
        },
        {
            "number": 2,
            "revision": "c329922383f38ab1106bc6858a675a2954381ac1",
            "parents": [
                "fa663aec1ec21036f972318cb9cd59b3623f7afd"
            ],
            "ref": "refs/changes/64/59564/2",
            "uploader": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "createdOn": 1689197229,
            "author": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Please test at least EM, bmcweb and dbus-sensors on these.  I think it is fine if it doesn't regress the compile on those."
                },
                {
                    "file": "include/sdbusplus/bus/match.hpp",
                    "line": 107,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Why did we remove all the noexcept?"
                },
                {
                    "file": "include/sdbusplus/bus/match.hpp",
                    "line": 107,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Anything using `std::string` technically allows for exceptions (those functions are not noexcept in case it did allocate)."
                },
                {
                    "file": "include/sdbusplus/bus/match.hpp",
                    "line": 107,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "But... do we really want to handle the exceptions for memory allocation failures in std::string?  I'd rather `std::terminate`."
                },
                {
                    "file": "include/sdbusplus/bus/match.hpp",
                    "line": 107,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Sure, I don't care either way I guess. Linux would never even allow us to get there."
                },
                {
                    "file": "include/sdbusplus/bus/match.hpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "It's interesting that this can be constexpr?  Why can't the other inline ones become constexpr too?"
                },
                {
                    "file": "include/sdbusplus/bus/match.hpp",
                    "line": 204,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "The other ones do string conversion that isn't constexpr. This change makes it possible to use all of them in a constexpr context https://gerrit.openbmc.org/c/openbmc/sdbusplus/+/59566/3"
                },
                {
                    "file": "include/sdbusplus/bus/match.hpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Got it.  Any place we use `to_string` we can't currently mark as constexpr."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 36,
                    "deletions": -42
                }
            ],
            "sizeInsertions": 50,
            "sizeDeletions": 42
        },
        {
            "number": 3,
            "revision": "102fc04b062490846e5917fb23dd01b3ab88742b",
            "parents": [
                "fa663aec1ec21036f972318cb9cd59b3623f7afd"
            ],
            "ref": "refs/changes/64/59564/3",
            "uploader": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "createdOn": 1689200705,
            "author": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "include/sdbusplus/bus/match.hpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -38
                }
            ],
            "sizeInsertions": 46,
            "sizeDeletions": 38
        }
    ]
}