{
    "project": "openbmc/docs",
    "branch": "master",
    "id": "Id3cd518580cf024ccbfe47db4231ee2b9aa781ea",
    "number": 66327,
    "subject": "Propose  a Generic Discrete Sensor Design",
    "owner": {
        "name": "krishna Raj",
        "email": "krishnar@ami.com",
        "username": "krishnar4"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/docs/+/66327",
    "hashtags": [],
    "createdOn": 1693212501,
    "lastUpdated": 1694084709,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1693212501,
            "reviewer": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1693212542,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1693212543,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1693212567,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/73569/ : FAILURE"
        },
        {
            "timestamp": 1693214962,
            "reviewer": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "message": "Patch Set 2: Published edit on patch set 1.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1693214997,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1693214997,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1693215023,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/73570/ : FAILURE"
        },
        {
            "timestamp": 1693216631,
            "reviewer": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "message": "Patch Set 3: Published edit on patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1693216678,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1693216678,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1693216707,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/73571/ : FAILURE"
        },
        {
            "timestamp": 1693218463,
            "reviewer": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "message": "Patch Set 4: Published edit on patch set 3.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1693218523,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1693218523,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1693218548,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/73572/ : FAILURE"
        },
        {
            "timestamp": 1693220220,
            "reviewer": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "message": "Uploaded patch set 5.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1693220269,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1693220269,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1693220293,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/73578/ : FAILURE"
        },
        {
            "timestamp": 1693225975,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 5: Code-Review-2\n\n(1 comment)"
        },
        {
            "timestamp": 1694065724,
            "reviewer": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1694084709,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "655fba4fc5084b86c90a020addb0d38f55b8337b",
            "parents": [
                "afb213e0829cd2d1218beececcd2422be1c60e19"
            ],
            "ref": "refs/changes/27/66327/1",
            "uploader": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "createdOn": 1693212501,
            "author": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/discrete-sensor.md",
                    "type": "ADDED",
                    "insertions": 143,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 157,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "390db9c30d01a4412b5198189740953b2a12ec32",
            "parents": [
                "afb213e0829cd2d1218beececcd2422be1c60e19"
            ],
            "ref": "refs/changes/27/66327/2",
            "uploader": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "createdOn": 1693214962,
            "author": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/discrete-sensor.md",
                    "type": "ADDED",
                    "insertions": 149,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 163,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "16945358f917f8de95e3121efff6d92e239e8023",
            "parents": [
                "afb213e0829cd2d1218beececcd2422be1c60e19"
            ],
            "ref": "refs/changes/27/66327/3",
            "uploader": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "createdOn": 1693216631,
            "author": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/discrete-sensor.md",
                    "type": "ADDED",
                    "insertions": 148,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 162,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "68d2a1131d4f37205db7fe270c78da00c03e3585",
            "parents": [
                "afb213e0829cd2d1218beececcd2422be1c60e19"
            ],
            "ref": "refs/changes/27/66327/4",
            "uploader": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "createdOn": 1693218463,
            "author": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/discrete-sensor.md",
                    "type": "ADDED",
                    "insertions": 144,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 158,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "30934b392d2b865d1eb7e7bfb0d57fb3c4ff3a17",
            "parents": [
                "afb213e0829cd2d1218beececcd2422be1c60e19"
            ],
            "ref": "refs/changes/27/66327/5",
            "uploader": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "createdOn": 1693220220,
            "author": {
                "name": "krishna Raj",
                "email": "krishnar@ami.com",
                "username": "krishnar4"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "\u201cDiscrete sensors\u201d has been discussed multiple times in the past and rejected. I don\u2019t see enough in this proposal as to why it is now a good direction. \n\nPlease read through https://lore.kernel.org/openbmc/YznibmIQxFIRa+mf@heinlein/ and any linked-to discussions."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "krishna Raj",
                        "email": "krishnar@ami.com",
                        "username": "krishnar4"
                    },
                    "message": "Many of the enterprise and cloud data center is still using IPMI for out of \nband manageability with proprietary BMC firmware. If they wanted to switch to \nopen source-based firmware stack like openbmc, many of the mandatory IPMI \ncommands and IPMI functionality are not available today. Even though Redfish \nis next to IPMI but not everyone is fully migrated to redfish, still legacy \nIPMI support is required and used in the production. As per IPMI specification \nany sensor can be analog or discrete based on the reading and sensor events \ncan be generated based on discrete or digital discrete or threshold based.\n\n\nExample: Any GPIO pins can be considered as discrete or digital discrete \nsensors. Similarly any state of the components and its transition can also be \nrepresented through discrete. Discrete sensors are not only used for event \ngeneration, it is not event only SDR type, it is also used like threshold \nsensors to know the status of the sensors when the event is occurred and to \nget the details of the full, compact sensor data record.\n\nProblem Description:\n\nRefer Table 42 in ipmi-second-gen-interface-spec-v2-rev1-1 specification.\nHow to generically support all the discrete sensor event/reading type code\nrange from 02h to 7Fh\n\nRefer Table 42.2 in ipmi-second-gen-interface-spec-v2-rev1-1.html specification.\nHow to generically support all type of the discrete sensors and offset\n\nHow to list all the sensors and SDR in ipmi and Redfish similar to threshold sensors?\n\nHow to support other IPMI functionality like \u201cadd SEL\u201d if no sensor for discrete?\n\nHow to support PEF and PET?\n\nCommon framework is required to handle the discrete type in the community,\nall other alternative approach doesn\u2019t meet the spec requirement.\nAlso not good to have two different design for threshold and discrete.\nExample: https://github.com/openbmc/phosphor-host-ipmid/blob/master/scripts/sensor-example.yaml \nWe also need to check how other contributors are using IPMI discrete sensors(not only for event).\n\nEveryone is following their own way in discrete sensor case, so it would be\nbetter to have concise discussion to conclude. If no plan to support the IPMI\nbased features since it is more using redfish driven model , let the community\nknow the same."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "If you have solid rationale, it needs to be added to the docs.\n\n> How to support ...\n\nAs I have written in the previous discussions, the way to do this is to create proper dbus objects to represent the concept you are trying to expose as an IPMI sensor and then write code to turn the non-generic dbus object into a generic IPMI sensor.\n\nRedfish doesn't have a \"discrete sensor\", but instead has something more like our specific dbus objects.  If you do all this work on a \"discrete sensor\" for IPMI, it only works for IPMI and you have to completely redo the backend later on for Redfish.  If you do it as a specific dbus object now, yes, it makes it more work on the IPMI side but that work isn't throw-away when someone wants to expose the same information over Redfish.  Also, from an architecture perspective it allows *other* BMC applications to also access the information; with \"discrete sensor\" we have random strings laying around the code that have special meaning based on the desired IPMI sensor name."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/discrete-sensor.md",
                    "type": "ADDED",
                    "insertions": 142,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 156,
            "sizeDeletions": 0
        }
    ]
}