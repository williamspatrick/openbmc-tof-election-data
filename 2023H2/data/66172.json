{
    "project": "openbmc/phosphor-virtual-sensor",
    "branch": "master",
    "id": "If91a2c7e699df71137d0eddd851a48a32c766e4a",
    "number": 66172,
    "subject": "service: Remove configuration",
    "owner": {
        "name": "George Liu",
        "email": "liuxiwei@ieisystem.com",
        "username": "lxwinspur"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/phosphor-virtual-sensor/+/66172",
    "hashtags": [],
    "createdOn": 1692608635,
    "lastUpdated": 1696630002,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1692608635,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@ieisystem.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1692608665,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1692608665,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1692608758,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/73228/ : SUCCESS"
        },
        {
            "timestamp": 1692632406,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/73237/ : SUCCESS"
        },
        {
            "timestamp": 1692633390,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1692664653,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@ieisystem.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1692706240,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1692753030,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@ieisystem.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1692753049,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@ieisystem.com",
                "username": "lxwinspur"
            },
            "message": "Uploaded patch set 2: Patch Set 1 was rebased.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1692753081,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1692753082,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1692753179,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/73336/ : SUCCESS"
        },
        {
            "timestamp": 1692790089,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1692835979,
            "reviewer": {
                "name": "George Liu",
                "email": "liuxiwei@ieisystem.com",
                "username": "lxwinspur"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1696630002,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Abandoned\n\nNot really a significant simplification and makes prefix'd builds not work."
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "7ac0e08cea52fd7b3780a3873d8f159070a48ad7",
            "parents": [
                "f4ad0e44434db5bf0f8654ebd1a2122f78e90419"
            ],
            "ref": "refs/changes/72/66172/1",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@ieisystem.com",
                "username": "lxwinspur"
            },
            "createdOn": 1692608635,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": ""
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Sure... it is installed there by _default_ but now you've made it so the code can't handle prefix'd installs.  Why is this better?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@ieisystem.com",
                        "username": "lxwinspur"
                    },
                    "message": "Thanks Patrick\n\nThere are two things to clarify here:\n1. This service is installed under /usr/bin by default, we have reached a consensus\n2. We use copyfile instead of configure_file, which is what I am doing recently, but copyfile does not support configuration, so I am more inclined to delete @bin@."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "> We use copyfile instead of configure_file, which is what I am doing recently, but copyfile does not support configuration, so I am more inclined to delete @bin@.\n\n\"We\"?  No... you've decided to make some simplifications when there is no configuration done to switch from configure_file to copyfile.  This is fine, but only when there _isn't_ configuration being done.  The whole point of configure_file is to be able to configure files.\n\nAgain, I don't really see a benefit to removing the prefix support, unless you want to make a project-wide proposal that we do not support prefix installs in `.service` files.  We shouldn't be making these changes solely based on what assorted maintainers accept because then we end up with inconsistency across the project.\n\nIf you think we shouldn't use `@bin@` in any service files (for simplicity reasons), please write a TOF proposal so we can get it documented."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@ieisystem.com",
                        "username": "lxwinspur"
                    },
                    "message": "> > We use copyfile instead of configure_file, which is what I am doing recently, but copyfile does not support configuration, so I am more inclined to delete @bin@.\n> \n> \"We\"?  No... you've decided to make some simplifications when there is no configuration done to switch from configure_file to copyfile.  This is fine, but only when there _isn't_ configuration being done.  The whole point of configure_file is to be able to configure files.\n> \nI see what you mean, but if we just use something like @bin@ in the config, I think we can optimize and switch to copyfile.\n> Again, I don't really see a benefit to removing the prefix support, unless you want to make a project-wide proposal that we do not support prefix installs in `.service` files.  We shouldn't be making these changes solely based on what assorted maintainers accept because then we end up with inconsistency across the project.\n> \nThe original purpose of my submission of this patch is because I saw that @bin@ was only used in this `service.in`, and the `bindir` variable[1] was declared in meson.build. For the get_option('bindir') method, its value is actually `/usr/bin`[2]. So my question is, what is the benefit of using prefixes here?\nIf we will put this executable program in a custom directory, for example: `/usr/xxx`, it makes sense to use a prefix at this time.\n> If you think we shouldn't use `@bin@` in any service files (for simplicity reasons), please write a TOF proposal so we can get it documented.\n\n\n[1]: https://gerrit.openbmc.org/c/openbmc/phosphor-virtual-sensor/+/66172/1/meson.build#b62\n[2]: http://www.embeddedlinux.org.cn/OEManual/directories_installation.html"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "https://github.com/openbmc/phosphor-virtual-sensor/blob/ce4241cb7173b41ace52a272dc6a52295f949385/meson.build#L62\n\nPlease look over https://mesonbuild.com/Installing.html relative to `prefix` and `DEST_DIR` concepts."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "George Liu",
                        "email": "liuxiwei@ieisystem.com",
                        "username": "lxwinspur"
                    },
                    "message": "I have read this doc, I mean that for this process, we just installed `/usr/bin`, so I think it is ok to remove `prefix`.\nIf there is a disagreement with the maintainer here, I respect the maintainer's choice and I will abandon this commit."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "phosphor-virtual-sensor.service",
                    "fileOld": "phosphor-virtual-sensor.service.in",
                    "type": "RENAMED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 23,
            "sizeDeletions": 9
        },
        {
            "number": 2,
            "revision": "c5a673201fc9e3f01f6252100857c6e336c06caa",
            "parents": [
                "1021860a2da048aa4510657ad01512b15b7581b7"
            ],
            "ref": "refs/changes/72/66172/2",
            "uploader": {
                "name": "George Liu",
                "email": "liuxiwei@ieisystem.com",
                "username": "lxwinspur"
            },
            "createdOn": 1692753049,
            "author": {
                "name": "George Liu",
                "email": "liuxiwei@inspur.com",
                "username": ""
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "phosphor-virtual-sensor.service",
                    "fileOld": "phosphor-virtual-sensor.service.in",
                    "type": "RENAMED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 23,
            "sizeDeletions": 9
        }
    ]
}