{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "Ia7adfc0348588915440687c3ab83a1de3e6b845a",
    "number": 66887,
    "subject": "Update to boost 1.83.0",
    "owner": {
        "name": "Ed Tanous",
        "email": "ed@tanous.net",
        "username": "edtanous"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/66887",
    "hashtags": [],
    "createdOn": 1696437717,
    "lastUpdated": 1696962956,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1696437717,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1696437799,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1696437799,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1696437933,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/74705/ : FAILURE"
        },
        {
            "timestamp": 1696440158,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Abandoned\n\nNevermind, this is more complicated than I thought."
        },
        {
            "timestamp": 1696440795,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1696466685,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Restored"
        },
        {
            "timestamp": 1696466690,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1696466756,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1696466756,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1696466769,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1696468340,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/74718/ : SUCCESS"
        },
        {
            "timestamp": 1696624529,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1696629048,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1696815409,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1696875967,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1696949616,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1696952924,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1696960086,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1696962930,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2: Code-Review+2"
        },
        {
            "timestamp": 1696962956,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully merged"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "634f6b839e09e95cd4faf3077387b149a3dd52b2",
            "parents": [
                "b8ad583f70f3f4acb9fb3883857a5f8d7af29fd3"
            ],
            "ref": "refs/changes/87/66887/1",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1696437717,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "do we have a dependency on the library declared to meson?   I see https://github.com/openbmc/bmcweb/blob/master/subprojects/packagefiles/boost-url/meson.build was unreferenced from meson.build here (but wasn't deleted)\n\nhttps://github.com/openbmc/bmcweb/commit/079360ae6e04d3f2245e00d70f83d15c5cad3630\n\nI not seeing a reference to the library objects like the second box in this link https://mesonbuild.com/Dependencies.html#boost"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> do we have a dependency on the library declared to meson?\n\nIt wasn't previously required, because it was header only.  The meson options only need to be specified for non header-only libraries.\n\n>   I see https://github.com/openbmc/bmcweb/blob/master/subprojects/packagefiles/boost-url/meson.build was unreferenced from meson.build here (but wasn't deleted)\n\nIt's deleted now.\n\n> \n> https://github.com/openbmc/bmcweb/commit/079360ae6e04d3f2245e00d70f83d15c5cad3630\n> \n> I not seeing a reference to the library objects like the second box in this link https://mesonbuild.com/Dependencies.html#boost\n\nCheck out the latest."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "Ok I guess the url wrap packagefile was leftover from before url became part of boost?   Ack the cleanup.\n\nThis looks reasonable compared to the documentation.\n\nDoes meson upstream need any update to reflect url is a cmake target (even if we just create an issue or emai? to notify them)?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> Ok I guess the url wrap packagefile was leftover from before url became part of boost?   Ack the cleanup.\n\nYep.  We never cleaned it up, although the explicit boost-url has been gone for a while now.\n\n> \n> This looks reasonable compared to the documentation.\n> \n> Does meson upstream need any update to reflect url is a cmake target (even if we just create an issue or emai? to notify them)?\n\nwrapdb doesn't include boost, so I don't think so."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "I was looking at https://github.com/mesonbuild/meson/blob/master/mesonbuild/dependencies/boost.py\n\nwhere they are looking for abi tagged libraries vs cmake"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> I was looking at https://github.com/mesonbuild/meson/blob/master/mesonbuild/dependencies/boost.py\n> \n\nI'm not sure where that file is used.  In terms of this commit, is there anything in that file that needs to be accounted for?  This commit seemed to work with existing meson in my testing.\n\n> where they are looking for abi tagged libraries vs cmake"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "Thinking through this, I realize I am mixing build rules and support at multiple levels.\n\nI was looking at the else clause of boost.found(), comparing to meson documentation at [1] and thinking \"this is replacing the boost dependency with a cmake dependency\".  However, looking again today, it is replacing the include only dependency on the downloaded package with the cmake dependency to build the library when the system installed boost doesn't have the module installed.\n\n[1] https://mesonbuild.com/Dependencies.html#boost\n\nI was inferring when the boost.py file was being used, and thinking about should it automatically invoke cmake from the source.   But after you asking when it is used, I dug a bit deeper and found (1) its invoked from the __init.py__ [2] in the same directory and (2) its purpose is to find and satisfy dependencies for boost that is installed in the system or an alternate system location, and therefore [3] compiling from source is beyond its scope, and the meson build project is not affected.\n\n[2] https://github.com/mesonbuild/meson/blob/3af0632c3d02c552982737580cfac56adb72c8ad/mesonbuild/dependencies/__init__.py#L190\n\nHowever, this does point out we should have some additional yocto integration to build URL as part of our boost packaging.  Without this meson may download the library again and the library would be compiled for each package that needs to use it.\n\nAccording to this stack overflow [3], we have to do this at the meta layer.  Alternately we cand work with yocto to create sub-packages for this library that could be explicitly requested through a standard DEPENDS.\n\n[3] https://stackoverflow.com/questions/69862510/yocto-have-a-dependency-to-a-receipe-and-a-packageconfig\n\u00a0\u00a0\nI'm fine merging this patch as is.  It adds the ability to build the boot URL library standalone from upstream to meet its dependency.  If we don't encounter any other package needing the URL library, the compile time is shifted and the impact is the extra download."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "Seeing Andrews reference in discord to https://github.com/openbmc/openbmc/blob/master/meta-phosphor/recipes-support/boost/boost_%25.bbappend I obviously didn't read https://github.com/openbmc/openbmc/blob/master/poky/meta/recipes-support/boost/boost.inc which has the sub packages"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -1
                },
                {
                    "file": "src/boost_url.cpp",
                    "type": "DELETED",
                    "insertions": 0,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 18,
            "sizeDeletions": 3
        },
        {
            "number": 2,
            "revision": "6fd295531d34a3f1df887200ad904321b6020ddd",
            "parents": [
                "b8ad583f70f3f4acb9fb3883857a5f8d7af29fd3"
            ],
            "ref": "refs/changes/87/66887/2",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1696466690,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "I'll wait for a build test to +1.   This appears to address the issues I identified."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "LGTM, verified this gets latest yocto building and passing CI over with https://gerrit.openbmc.org/c/openbmc/openbmc/+/66999"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/event_service_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/certificate_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "subprojects/packagefiles/boost/meson.build",
                    "type": "DELETED",
                    "insertions": 0,
                    "deletions": -9
                },
                {
                    "file": "redfish-core/include/utils/telemetry_utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/trigger.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/lib/virtual_media.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "subprojects/boost.wrap",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -6
                },
                {
                    "file": "redfish-core/lib/event_service.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "test/http/utility_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/include/redfish_aggregator.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -6
                },
                {
                    "file": "src/boost_url.cpp",
                    "type": "DELETED",
                    "insertions": 0,
                    "deletions": -2
                },
                {
                    "file": "include/event_service_store.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "redfish-core/lib/ethernet.hpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 60,
            "sizeDeletions": 35
        }
    ]
}