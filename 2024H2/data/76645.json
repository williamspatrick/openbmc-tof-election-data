{
    "project": "openbmc/docs",
    "branch": "master",
    "id": "I541f679d9d765ade308cfc2e6e1cfe959ec82c8a",
    "number": 76645,
    "subject": "design: Code update design using FW update manager",
    "owner": {
        "name": "Tom Joseph",
        "email": "rushtotom@gmail.com",
        "username": "tomjoseph83"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/docs/+/76645",
    "hashtags": [],
    "createdOn": 1734405520,
    "lastUpdated": 1736275794,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1734405520,
            "reviewer": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1734405561,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1734405561,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1734405745,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/96778/ : SUCCESS"
        },
        {
            "timestamp": 1734411189,
            "reviewer": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "message": "Set private"
        },
        {
            "timestamp": 1734411649,
            "reviewer": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "message": "Uploaded patch set 2: Commit message was updated.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1734411660,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1734411660,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1734411687,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/96786/ : SUCCESS"
        },
        {
            "timestamp": 1734411797,
            "reviewer": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1734411821,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1734411821,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1734411846,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/96787/ : FAILURE"
        },
        {
            "timestamp": 1734461836,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3:\n\n(4 comments)"
        },
        {
            "timestamp": 1734721072,
            "reviewer": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "message": "Uploaded patch set 4.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1734721103,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1734721103,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1734721176,
            "reviewer": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "message": "Patch Set 4:\n\n(4 comments)"
        },
        {
            "timestamp": 1734721318,
            "reviewer": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "message": "Unset private"
        },
        {
            "timestamp": 1734721329,
            "reviewer": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "message": "Patch Set 4:\n\n(2 comments)"
        },
        {
            "timestamp": 1734721603,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/97380/ : FAILURE"
        },
        {
            "timestamp": 1734722629,
            "reviewer": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "message": "Uploaded patch set 5.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1734722648,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1734722648,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1734722676,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/97383/ : SUCCESS"
        },
        {
            "timestamp": 1736275794,
            "reviewer": {
                "name": "Jagpal S Gill",
                "email": "paligill@gmail.com",
                "username": "jagpalgill"
            },
            "message": "Patch Set 5:\n\n(15 comments)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "58ab7e66c3ae8f4c1bc411bceae21965216444a8",
            "parents": [
                "67032dffe31f98a8638927f74a7a35990d6a1fbc"
            ],
            "ref": "refs/changes/45/76645/1",
            "uploader": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "createdOn": 1734405520,
            "author": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "test.md",
                    "type": "ADDED",
                    "insertions": 0,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 10,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "67942a66e15c2c6d9675e1e8211d5d6e93bb9085",
            "parents": [
                "67032dffe31f98a8638927f74a7a35990d6a1fbc"
            ],
            "ref": "refs/changes/45/76645/2",
            "uploader": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "createdOn": 1734411649,
            "author": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "test.md",
                    "type": "ADDED",
                    "insertions": 0,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 10,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "2dac5093bb4a6f0caa7f20e823f2eeb3c71b37d2",
            "parents": [
                "67032dffe31f98a8638927f74a7a35990d6a1fbc"
            ],
            "ref": "refs/changes/45/76645/3",
            "uploader": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "createdOn": 1734411797,
            "author": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "(I guess this is still marked private so I won't spend much time on it)\n\nPlease be sure to add the phosphor-bmc-code-mgmt owners for review when you are ready."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Tom Joseph",
                        "email": "rushtotom@gmail.com",
                        "username": "tomjoseph83"
                    },
                    "message": "Ack"
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 12,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Why did you add these?"
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 12,
                    "reviewer": {
                        "name": "Tom Joseph",
                        "email": "rushtotom@gmail.com",
                        "username": "tomjoseph83"
                    },
                    "message": "Fixed"
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 12,
                    "reviewer": {
                        "name": "Tom Joseph",
                        "email": "rushtotom@gmail.com",
                        "username": "tomjoseph83"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/code_update_new_arch.png",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Please don't check in image files.  Use mermaid to generate this."
                },
                {
                    "file": "designs/code_update_new_arch.png",
                    "line": 0,
                    "reviewer": {
                        "name": "Tom Joseph",
                        "email": "rushtotom@gmail.com",
                        "username": "tomjoseph83"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/code_update_new_arch.png",
                    "line": 0,
                    "reviewer": {
                        "name": "Tom Joseph",
                        "email": "rushtotom@gmail.com",
                        "username": "tomjoseph83"
                    },
                    "message": "Done"
                },
                {
                    "file": "test.md",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Delete?"
                },
                {
                    "file": "test.md",
                    "line": 0,
                    "reviewer": {
                        "name": "Tom Joseph",
                        "email": "rushtotom@gmail.com",
                        "username": "tomjoseph83"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "test.md",
                    "type": "ADDED",
                    "insertions": 0,
                    "deletions": 0
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "type": "ADDED",
                    "insertions": 236,
                    "deletions": 0
                },
                {
                    "file": "designs/code_update_new_arch.png",
                    "type": "ADDED",
                    "insertions": 0,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 246,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "7b668a64e7beb2a2bcb5b75f1175d7ef96e1fc76",
            "parents": [
                "67032dffe31f98a8638927f74a7a35990d6a1fbc"
            ],
            "ref": "refs/changes/45/76645/4",
            "uploader": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "createdOn": 1734721072,
            "author": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "type": "ADDED",
                    "insertions": 282,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 294,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "7564dc93de41d1ac42d99c2ef2c26ffb17a8c167",
            "parents": [
                "35c2005ffe02fc240dfcd77ad9658fd66dcee524"
            ],
            "ref": "refs/changes/45/76645/5",
            "uploader": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "createdOn": 1734722629,
            "author": {
                "name": "Tom Joseph",
                "email": "rushtotom@gmail.com",
                "username": "tomjoseph83"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 12,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "This is incorrect statement. As long as you provide the correct targetURI list, the PLDM package with diverse component types will be routed to the appropriate backends which can process the component images targeted for them. \nYou need to be more clear in terms of your use case and define it precisely."
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 20,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "This is already proposed https://gerrit.openbmc.org/c/openbmc/docs/+/74653 and you have reviewed it too. So, why are you stating this in \"lacks orchestration capabilities\"?"
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 22,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "This is about adding another property to the proposed platform configuration at https://gerrit.openbmc.org/c/openbmc/docs/+/75500. So, feel free to raise a PR on top of that stack or let me know and i can do that too."
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 24,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "This is already proposed in https://gerrit.openbmc.org/c/openbmc/docs/+/75500 and you have reviewed it and provided comments there. So, why are you stating this in \"lacks orchestration capabilities\"?"
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 27,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "Why do you mean by \"global write protection\" and what are you trying to protect? We already have ActivationBlocksTransition interface."
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 30,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "Again this is incorrect statement with respect to current code design. The solution at https://github.com/openbmc/docs/blob/master/designs/code-update.md already adds supports for TargetURIs."
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 32,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "> ForceUpdate\n\nThis was proposed as a requirement in the https://github.com/openbmc/docs/blob/master/designs/code-update.md but it was removed from initial requirements as there was some push back. I need to dig to figure out who opposed it. But there is no limitation in the design that it cannot be added.\nThis was dropped from initial requirements and considered a followup enhancement. Please refer to PDI changes for this -\nhttps://gerrit.openbmc.org/c/openbmc/phosphor-dbus-interfaces/+/69992/1/yaml/xyz/openbmc_project/Software/Update.interface.yaml."
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 35,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "The images are kept in memory when they are received in BMCWeb and then passed via mem-fd to the backend. This was one of the main requirements imposed by @Ed (BMCWeb mainatiner). There is nothing in design which restricts you from moving that image to filesystem in your backend.\nWhich step in flow are you referring to when you say \"keeps the images in the memory, this does not account for the case where memory is insufficient\"?"
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 50,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "Already supports adding Targets via TargetURIs.\n\nPlease state your requirement precisely what you are referring here?"
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 52,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "Already supported with PDI changes, refer https://gerrit.openbmc.org/c/openbmc/phosphor-dbus-interfaces/+/69992/1/yaml/xyz/openbmc_project/Software/Update.interface.yaml."
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 55,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "There is no restriction imposed by https://github.com/openbmc/docs/commits/master/designs/code-update.md. What are you referring to here?"
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 57,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "Already supported in https://github.com/openbmc/docs/commits/master/designs/code-update.md. What are you referring to here?"
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 64,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "Already being done by Wiwynn team for the PLDM firmware implementation they are doing for the proposed design in https://github.com/openbmc/docs/blob/master/designs/code-update.md."
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 65,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "If its apply immediately, the device reset should should automatically be taken care by your post update condition unless you want user to explicitly trigger it."
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "line": 70,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "Already supported in https://github.com/openbmc/docs/commits/master/designs/code-update.md.\n\nPlease fold your extra requirements into existing design doc and make your changes there. Don't create a complete new doc as its creating confusion on what you are proposing."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "designs/code_update_design_new.md",
                    "type": "ADDED",
                    "insertions": 282,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 294,
            "sizeDeletions": 0
        }
    ]
}