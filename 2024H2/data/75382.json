{
    "project": "openbmc/telemetry",
    "branch": "master",
    "topic": "trigger-interface",
    "id": "I6717d4075de53c91aa179a90c7a844c4a13534cc",
    "number": 75382,
    "subject": "Remove variant from Thresholds interface",
    "owner": {
        "name": "Ed Tanous",
        "email": "ed@tanous.net",
        "username": "edtanous"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/telemetry/+/75382",
    "hashtags": [],
    "createdOn": 1729363408,
    "lastUpdated": 1735681994,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1729363408,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1729363432,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1729363432,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1729364086,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/93403/ : SUCCESS"
        },
        {
            "timestamp": 1729670537,
            "reviewer": {
                "name": "Adrian Ambro\u017cewicz",
                "email": "adrian.ambrozewicz@linux.intel.com",
                "username": "aambroze"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1732732784,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1732732814,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1732732814,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1732732845,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1732732864,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Topic set to trigger-interface"
        },
        {
            "timestamp": 1732733469,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/95463/ : SUCCESS"
        },
        {
            "timestamp": 1732736903,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1733315153,
            "reviewer": {
                "name": "Adrian Ambro\u017cewicz",
                "email": "adrian.ambrozewicz@linux.intel.com",
                "username": "aambroze"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1733329706,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1733392799,
            "reviewer": {
                "name": "Adrian Ambro\u017cewicz",
                "email": "adrian.ambrozewicz@linux.intel.com",
                "username": "aambroze"
            },
            "message": "Patch Set 2: Code-Review+2\n\n(1 comment)"
        },
        {
            "timestamp": 1733860216,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1735325868,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1735551772,
            "reviewer": {
                "name": "Adrian Ambro\u017cewicz",
                "email": "adrian.ambrozewicz@linux.intel.com",
                "username": "aambroze"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1735681994,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as 2efa95d8faec80ee1eb2ce500e2cb08849cd478e"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "5b01191b6962255e2aad3f49a0e6cbc0ae8aa5ca",
            "parents": [
                "b47b7db48c4f883eb191077848d55d96bd884607"
            ],
            "ref": "refs/changes/82/75382/1",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1729363408,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Adrian Ambro\u017cewicz",
                        "email": "adrian.ambrozewicz@linux.intel.com",
                        "username": "aambroze"
                    },
                    "message": "In this implementation we'll have a side effect of property, which after writing will 'erase' contents of the other.\n\nThis is intrinsic property of variant concept.\n\nIf it helps bmcweb then it's OK. I suppose we should also prepare updated interface definition in https://github.com/openbmc/phosphor-dbus-interfaces/blob/master/yaml/xyz/openbmc_project/Telemetry/Trigger.interface.yaml ?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> In this implementation we'll have a side effect of property, which after writing will 'erase' contents of the other.\n\nI think in user facing behavior, we have that already?  That seems like a small thing.\n\n> updated interface definition in\n\nYep.  can do."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Pushed to\nhttps://gerrit.openbmc.org/c/openbmc/phosphor-dbus-interfaces/+/76123"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Adrian Ambro\u017cewicz",
                        "email": "adrian.ambrozewicz@linux.intel.com",
                        "username": "aambroze"
                    },
                    "message": ">> In this implementation we'll have a side effect of property, which after writing >> will 'erase' contents of the other.\n>\n> I think in user facing behavior, we have that already? That seems like a small > thing.\n\nYou are correct. Currently that is the behavior and it's mandated by type being a `variant`. \n\nAfter splitting to separate properties code still treats them as mutually exclusive. Writing to one clears the other.\n\nI believe this behavior should be documented in the updated interface descriptor. Don't you think?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> >> In this implementation we'll have a side effect of property, which after writing >> will 'erase' contents of the other.\n> >\n> > I think in user facing behavior, we have that already? That seems like a small > thing.\n> \n> You are correct. Currently that is the behavior and it's mandated by type being a `variant`. \n> \n> After splitting to separate properties code still treats them as mutually exclusive. Writing to one clears the other.\n> \n> I believe this behavior should be documented in the updated interface descriptor. Don't you think?\n\nI didn\u2019t include it because it\u2019s not an issue with the interface, it\u2019s an issue with the implementation.  we can document it somewhere in this repo if you\u2019d like.  ultimately I\u2019d just like to see the constraint removed and have them be independent parameters, but one step at a time.\n\nwhere would you like to see this documented?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Adrian Ambro\u017cewicz",
                        "email": "adrian.ambrozewicz@linux.intel.com",
                        "username": "aambroze"
                    },
                    "message": "It depends. AFAIK variant was reflecting design of the Redfish interface itself, as you have MetricType enumeration:\nhttps://github.com/openbmc/bmcweb/blob/8274eb11c44f38e51e9c643ae62192bafacf257c/redfish-core/lib/trigger.hpp#L196\n\nIf we assume that openbmc/telemetry serves Redfish only then perhaps requirement coming from the Schema definition itself should be enough and no extra documentation is needed."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 35,
                    "deletions": 0
                },
                {
                    "file": "src/trigger.cpp",
                    "type": "MODIFIED",
                    "insertions": 55,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 90,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "2f3480117190227573bf5dd1a097dfeb8d6744ff",
            "parents": [
                "b47b7db48c4f883eb191077848d55d96bd884607"
            ],
            "ref": "refs/changes/82/75382/2",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1732732784,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Adrian, could you take a look at https://gerrit.openbmc.org/c/openbmc/phosphor-dbus-interfaces/+/76123\nplease"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Adrian, can you please review the PDI change so they can all merge?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Adrian Ambro\u017cewicz",
                        "email": "adrian.ambrozewicz@linux.intel.com",
                        "username": "aambroze"
                    },
                    "message": "Apologies for the delay - holiday season."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 35,
                    "deletions": 0
                },
                {
                    "file": "tests/src/test_trigger.cpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -4
                },
                {
                    "file": "src/trigger.cpp",
                    "type": "MODIFIED",
                    "insertions": 55,
                    "deletions": 0
                },
                {
                    "file": "src/types/trigger_types.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -5
                },
                {
                    "file": "tests/src/test_trigger_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -3
                },
                {
                    "file": "src/trigger_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -10
                },
                {
                    "file": "tests/src/params/trigger_params.hpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 155,
            "sizeDeletions": 22
        },
        {
            "number": 3,
            "revision": "2efa95d8faec80ee1eb2ce500e2cb08849cd478e",
            "parents": [
                "6050b6559bfa80e3372e6bb4145a14c7ebf6a27c"
            ],
            "ref": "refs/changes/82/75382/3",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1735681994,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 35,
                    "deletions": 0
                },
                {
                    "file": "tests/src/test_trigger.cpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -4
                },
                {
                    "file": "src/trigger.cpp",
                    "type": "MODIFIED",
                    "insertions": 55,
                    "deletions": 0
                },
                {
                    "file": "src/types/trigger_types.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -5
                },
                {
                    "file": "tests/src/test_trigger_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -3
                },
                {
                    "file": "src/trigger_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -10
                },
                {
                    "file": "tests/src/params/trigger_params.hpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 155,
            "sizeDeletions": 22
        }
    ]
}