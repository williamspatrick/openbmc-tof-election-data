{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "Id23aef0a77e33bc762cfd4782c9acce33044cb63",
    "number": 74666,
    "subject": "MFA Flow: Utility for MFA flow for first log-in",
    "owner": {
        "name": "Abhilash Raju",
        "email": "abhilash.kollam@gmail.com",
        "username": "abhilashraju"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/74666",
    "hashtags": [],
    "createdOn": 1726560427,
    "lastUpdated": 1728483623,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1726560427,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1726560482,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1726560483,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1726561832,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/91894/ : SUCCESS"
        },
        {
            "timestamp": 1726588788,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(5 comments)"
        },
        {
            "timestamp": 1726598037,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "message": "Patch Set 1:\n\n(4 comments)"
        },
        {
            "timestamp": 1726643746,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Abandoned"
        },
        {
            "timestamp": 1726808272,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Restored"
        },
        {
            "timestamp": 1726808284,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1726808316,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1726808316,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1726808661,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1726808690,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1726808690,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1726808692,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/92036/ : ABORTED"
        },
        {
            "timestamp": 1726808798,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 3:\n\n(5 comments)"
        },
        {
            "timestamp": 1726809045,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1726809059,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1726809059,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1726809062,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/92037/ : ABORTED"
        },
        {
            "timestamp": 1726809233,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1726809255,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1726809255,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1726809257,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/92038/ : ABORTED"
        },
        {
            "timestamp": 1726809442,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 5:\n\n(4 comments)"
        },
        {
            "timestamp": 1726809547,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1726810588,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/92039/ : SUCCESS"
        },
        {
            "timestamp": 1727722189,
            "reviewer": {
                "name": "Jishnu C M",
                "email": "jishnunambiarcm@duck.com",
                "username": "cm-jishnu"
            },
            "message": "Uploaded patch set 6: Patch Set 5 was rebased.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1727722227,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1727722227,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1727723572,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/92420/ : SUCCESS"
        },
        {
            "timestamp": 1727759186,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Uploaded patch set 7.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1727759214,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1727759214,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: -Ok-To-Test"
        },
        {
            "timestamp": 1727760592,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/92451/ : SUCCESS"
        },
        {
            "timestamp": 1727795498,
            "reviewer": {
                "name": "Jishnu C M",
                "email": "jishnunambiarcm@duck.com",
                "username": "cm-jishnu"
            },
            "message": "Uploaded patch set 8: Patch Set 7 was rebased.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1727795515,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1727795515,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: -Ok-To-Test"
        },
        {
            "timestamp": 1727796962,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/92483/ : SUCCESS"
        },
        {
            "timestamp": 1727798631,
            "reviewer": {
                "name": "Jishnu C M",
                "email": "jishnunambiarcm@duck.com",
                "username": "cm-jishnu"
            },
            "message": "Uploaded patch set 9: Patch Set 8 was rebased.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1727798660,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1727798660,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: -Ok-To-Test"
        },
        {
            "timestamp": 1727800037,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/92493/ : SUCCESS"
        },
        {
            "timestamp": 1727812047,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 9:\n\n(4 comments)"
        },
        {
            "timestamp": 1727812076,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 9:\n\n(9 comments)"
        },
        {
            "timestamp": 1727870837,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 9:\n\n(4 comments)"
        },
        {
            "timestamp": 1727924118,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 9:\n\n(2 comments)"
        },
        {
            "timestamp": 1727924428,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 9:\n\n(3 comments)"
        },
        {
            "timestamp": 1727928500,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 9:\n\n(1 comment)"
        },
        {
            "timestamp": 1727929453,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 9:\n\n(1 comment)"
        },
        {
            "timestamp": 1727930433,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 9:\n\n(1 comment)"
        },
        {
            "timestamp": 1727982060,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 9:\n\n(2 comments)"
        },
        {
            "timestamp": 1728012727,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 9:\n\n(1 comment)"
        },
        {
            "timestamp": 1728057420,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 9:\n\n(1 comment)"
        },
        {
            "timestamp": 1728275905,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 9:\n\n(1 comment)"
        },
        {
            "timestamp": 1728276002,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 9:\n\n(1 comment)"
        },
        {
            "timestamp": 1728298010,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Uploaded patch set 10.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1728298036,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1728298036,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: -Ok-To-Test"
        },
        {
            "timestamp": 1728299367,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/92760/ : SUCCESS"
        },
        {
            "timestamp": 1728311294,
            "reviewer": {
                "name": "Jishnu C M",
                "email": "jishnunambiarcm@duck.com",
                "username": "cm-jishnu"
            },
            "message": "Uploaded patch set 11: Patch Set 10 was rebased.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1728311326,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1728311326,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: -Ok-To-Test"
        },
        {
            "timestamp": 1728312673,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/92776/ : SUCCESS"
        },
        {
            "timestamp": 1728313226,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(2 comments)"
        },
        {
            "timestamp": 1728335032,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "message": "Patch Set 11: Code-Review-1\n\n(1 comment)"
        },
        {
            "timestamp": 1728368181,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1728401882,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1728401929,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1728483516,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1728483623,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Abandoned\n\nSince we have now single IsGenerateSecretKeyRequired Dbus method from PUM we no longer needed this utility class. You can see and review the usage of same here https://gerrit.openbmc.org/c/openbmc/bmcweb/+/74938/23/redfish-core/lib/redfish_sessions.hpp"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "4981a782aac69c942b1a463ac5bcf12d1aaeff9c",
            "parents": [
                "d51c61b4b7b57cf1b662f03dc99819bf025f283a"
            ],
            "ref": "refs/changes/66/74666/1",
            "uploader": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "createdOn": 1726560427,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 30,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please just inline most of these in the functions they're used in. They don't change often, and it's easier to review if they're in the spot where they're used."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 30,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 30,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 33,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "We generally follow the asio convention of passing errors back as a parameter (usually called ec).\n\nThe style you use here, which is popular in javascript, forces having a reference counted object to track state, or forces copies to be made."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 33,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 33,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "I was trying function style similar to https://en.cppreference.com/w/cpp/utility/optional. \nChanged the code to bmcweb convention.\ndone"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 33,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 35,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gunnar@gmills.xyz",
                        "username": "gtmills"
                    },
                    "message": "include optional"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 35,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "Done . No need of it now. Token is removed"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 35,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 56,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gunnar@gmills.xyz",
                        "username": "gtmills"
                    },
                    "message": "include memory"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 56,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 56,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 60,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "common error.  string_view::data() does not always return a null terminated string."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 60,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 60,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 63,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gunnar@gmills.xyz",
                        "username": "gtmills"
                    },
                    "message": "#include <utility>, #include <boost/system/error_code.hpp>"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 63,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 63,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 84,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gunnar@gmills.xyz",
                        "username": "gtmills"
                    },
                    "message": "#include <format>"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 84,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 84,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 88,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "moving this while within a member method is undefined behavior.  I suspect it works in this case because of the order in which the variables are initialized, and because the other variables are const, but we'd generally prefer to avoid undefined behavior."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 88,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "done. used shared_pointer instead."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 88,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 139,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please don't write lambdas more than one or two lines."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 139,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "done"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 139,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 146,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 158,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "3d960269f753f34c0e370f7834a20d58e2057553",
            "parents": [
                "d51c61b4b7b57cf1b662f03dc99819bf025f283a"
            ],
            "ref": "refs/changes/66/74666/2",
            "uploader": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "createdOn": 1726808284,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 125,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 150,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "eeb13ef04dd56dc1fd1e8648d59d94478a819dc2",
            "parents": [
                "d51c61b4b7b57cf1b662f03dc99819bf025f283a"
            ],
            "ref": "refs/changes/66/74666/3",
            "uploader": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "createdOn": 1726808661,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 123,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 148,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "76833f1994e7fdaf42f86d16181144d33d70459f",
            "parents": [
                "d51c61b4b7b57cf1b662f03dc99819bf025f283a"
            ],
            "ref": "refs/changes/66/74666/4",
            "uploader": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "createdOn": 1726809045,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "a3e82e7ef7d34e4da12525f0271f55747dc6d9eb",
            "parents": [
                "d51c61b4b7b57cf1b662f03dc99819bf025f283a"
            ],
            "ref": "refs/changes/66/74666/5",
            "uploader": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "createdOn": 1726809233,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 0
        },
        {
            "number": 6,
            "revision": "e40fa642aa42fa801bb6beb5392dec329014ca6d",
            "parents": [
                "e195adb233cb454b097004221b7445505c7ecfcd"
            ],
            "ref": "refs/changes/66/74666/6",
            "uploader": {
                "name": "Jishnu C M",
                "email": "jishnunambiarcm@duck.com",
                "username": "cm-jishnu"
            },
            "createdOn": 1727722189,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 0
        },
        {
            "number": 7,
            "revision": "7ab527c54f5c1bd2fca50278c493136694a16710",
            "parents": [
                "d51c61b4b7b57cf1b662f03dc99819bf025f283a"
            ],
            "ref": "refs/changes/66/74666/7",
            "uploader": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "createdOn": 1727759186,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 0
        },
        {
            "number": 8,
            "revision": "d9ec27d3f47ae95a470dfcd0044d380c1adb7be6",
            "parents": [
                "75edb74d00a994ba36ae0780a863d0e84ea5e838"
            ],
            "ref": "refs/changes/66/74666/8",
            "uploader": {
                "name": "Jishnu C M",
                "email": "jishnunambiarcm@duck.com",
                "username": "cm-jishnu"
            },
            "createdOn": 1727795498,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 0
        },
        {
            "number": 9,
            "revision": "6c5b458d8cfbb17a7f4bec75be1663ef42b5e206",
            "parents": [
                "b575caefa7f7f58c67cf61c8aa7ba7fb5a43e943"
            ],
            "ref": "refs/changes/66/74666/9",
            "uploader": {
                "name": "Jishnu C M",
                "email": "jishnunambiarcm@duck.com",
                "username": "cm-jishnu"
            },
            "createdOn": 1727798631,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 19,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Generally we would use normal methods, and just pass the function through the steps.  Any reason we needed to do a shared_ptr here?"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 19,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "Are you saying that instead of encapsulating the username and continuation handler in to an object , just move both of them through all of the asynchronous functions? I can do that. It is just that it will make it a bit more verbose and not easy to maintain in case if any more member needs to be added in future. Yes there is a small cost of increasing the shared counter."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 19,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I'm saying that putting multiple async ops in an object (and not handling move/forward correctly) causes copies to be made, and code to be more verbose than otherwise.  I'm ok with a class, so long as it's kept to a single debug flow, although I suspect this flow will become simple enough we won't need it"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 19,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "I not sure if I followed you. Here we need three async function to be called before we make any decision on secret key generation required or not. check global mfa, check valid secret present, if not preset check if bypass is enabled or not. I am not sure how are you proposing to make it simpler? \nWhat I see is following options.\n1) Yes if we take out some error paths debug logs, then yes code will be a bit lesser.\n2) Use coroutine to make it look like sync call \n3) Use sync call (don't know if it is recommended)\n4) Use async call as done here but make it free functions and explicitly move the username and continuation in every async operation.\n5) Use the current implementation with shared pointer, that will make sure that there is no unnecessary copy of values at the cost of a share_ptr.\n6) If there is a batch request possible for multiple properties/methods use it. \n7) Use a single Dbus call to user-manager and let user-manager does needed checks and return the final answer.\n\nI am inclined towards 7 and if that is not possible go for 5 ."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 19,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "Or are you saying that remove the shared_ptr and just move the single object instead after making all of them free function? I can do that if we not going for 7 above."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 19,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> Here we need three async function to be called before we make any decision on secret key generation required or not.\n\nThis sentence describes the root of the problem, there should be ONE API for determining whether a user is authenticated and their user is in good standing.  Today that's doing a pam_authenticate call and looking at the return code.  You're trying to make it a significant amount of dbus calls.  It can't be both."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 19,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> > Here we need three async function to be called before we make any decision on secret key generation required or not.\n> \n> This sentence describes the root of the problem, there should be ONE API for determining whether a user is authenticated and their user is in good standing.  Anything else is putting business logic into bmcweb, which we should avoid.\n\nToday that is a call to pam_authenticate call and looking at the return code.  You're trying to change it to be a significant amount of dbus calls.  It can't be both."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 19,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "I agree on your concern about multiple Dbus calls. I have already asked for a single Dbus method(isSecretKeygenerationRequired) that do the necessary checks and returns the true/false.\n\nBut it seems you wanted this to be handled by PAM module. Right Now google_authenticator does not return any error code saying secrete key file required. \n\nNow we have two options.\n1) Make a single Dbus call to user manager\n2) Modify google_pam_authenticator to return secretKeyFileRequired error based on global MFA property and user lever bypassed property.\n\nIf your answer is 2 then we don't need this commit for Bmcweb(Upstream)."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 19,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> I agree on your concern about multiple Dbus calls. I have already asked for a single Dbus method(isSecretKeygenerationRequired) that do the necessary checks and returns the true/false.\n\nThe api needs to be something like\n\n\"AuthenticateUser(Username, Password, Token)\"\n\n> \n> But it seems you wanted this to be handled by PAM module. Right Now google_authenticator does not return any error code saying secrete key file required. \n\nI have no strong opinions on how you solve it, but what I don't want is something that's bifurcated that calls pam to authenticate, but dbus to authorize.  Such a split is difficult to manage.\n\n> \n> Now we have two options.\n> 1) Make a single Dbus call to user manager\n> 2) Modify google_pam_authenticator to return secretKeyFileRequired error based on global MFA property and user lever bypassed property.\n> \n> If your answer is 2 then we don't need this commit for Bmcweb(Upstream).\n\nSuch is up to you.  Either direction would be fine with me.  FWIW, I've started trying to move the pam authenticate stuff into dbus (in the patchset I've linked you before), but either would be fine."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Why are we checking this?  Isn't this something that should be enforced by pam/phosphor-user-manager?"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "No, this check here has nothing to do with pam authentication. This is a redfish property. The entire utility is used in the first time TOTP setup of a user. Pam module can not be used for it. This is something similar to how we change the password after the first login."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "Yes, we can move this to phosphor-user-manager, with a new DBus method say isSecretKeyNeeded."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "it wouldn't be a dbus method, it would be a return code from pam, right?  Similar to how the current password needs changed behavior is handled?"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "pam verifies totp if secret key file is generated for the user ,otherwise it ignores the totp verification and prompts/uses the password to authenticate.See https://github.com/google/google-authenticator-libpam/blob/master/src/pam_google_authenticator.c#L2019 \n\nIt does not know about the redfish properties such as bypass, authenticator enabled/disabled etc."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> It does not know about the redfish properties such as bypass, authenticator enabled/disabled etc.\n\nThis sounds like a missing feature in the implementation then.  Keep in mind, all of these are configurable through pam config files, so it'll depend on what pam config you wrote."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "Are you saying that google_authenticator have implementation to handle missing secret key file, which can be configured through pam service file? I did not see any (may be I am wrong here will recheck). \n\nHaving said that, our design to make bypass work is based on the fact that the google authenticator will not throw any error when secret key file is not present in home. Instead it proceed to verify just the password for the authentication.We use 'nullok' in pam configuration to do that. With this assumption we can enable user specific bypass option. All we have to do for a bypassed user is just delete the secret key file from the user's home directory. Don't you agree on that design? Otherwise I am not sure how we implement runtime enable/disable of MFA and how we bypass pam authentication for a specific user etc."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> Are you saying that google_authenticator have implementation to handle missing secret key file, which can be configured through pam service file? I did not see any (may be I am wrong here will recheck). \n\ngoogle_authenticator might not necessarily implement this, I've never looked.  The key is that all these new rules you're adding need to work across redfish, ssh, and ipmi, so adding them to bmcweb doesn't help. \n\n> \n> Having said that, our design to make bypass work is based on the fact that the google authenticator will not throw any error when secret key file is not present in home. Instead it proceed to verify just the password for the authentication.We use 'nullok' in pam configuration to do that. With this assumption we can enable user specific bypass option. All we have to do for a bypassed user is just delete the secret key file from the user's home directory. Don't you agree on that design?\n\nI'm not a pam expert, nor am I a phosphor-user-manager maintainer, so my opinion here doesn't really matter, but yes, that sounds like it would work.  The key here is that in bmcweb, the changeset should essentially just be handling an extra error from PAM when the token is rejected, and passing in the token in the first place.  If we're doing significant business logic in bmcweb, we're likely missing the point of the authentication APIs, which is to be simple.\n\n> Otherwise I am not sure how we implement runtime enable/disable of MFA and how we bypass pam authentication for a specific user etc.\n\nIt might involve modification of pam files by phosphor-user-manager when MFA is enabled/disabled, or might require another openbmc-specific pam module (like the existing ipmi one).  Not sure how that's intended to work for runtime changable things."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "\"Not sure how that's intended to work for runtime changable things.\"\n\nThis is exactly the real concern. The google_authenticator pam module neither know about bypass property nor is able to read it from Dbus. \n\nAs you suggested if we are going with a new pam module implementation, we have following problem to solve with in pam module.\nAssuming we are not going to modify google_authenticator pam\n1) Need to define a new meta data file in users home directory or modify existing .google_authenticator file to add the by pass property(spec change required)\n2) Need to define a new meta data for global level MFA property which is again a runtime configurable thing.\n3) Add a new Pam implementation and stack it on top and bottom of the google authenticator pam with complex interaction pattern. \n\nOr we should wait for google authenticator to do it for us may be by writing a pull request.\n\nAnother option is to move the authentication/authorization  responsibility from Bmcweb to user manager. Make single call to user manager to create token. Define proper responses types between them so that Bmcweb can let the redfish clients know about whether password change /secret key creation needed or not. \n\nBoth of them requires lots of work and long term views on specifications."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "\" The key is that all these new rules you're adding need to work across redfish, ssh, and ipmi, so adding them to bmcweb doesn't help.\"\n\nI don't think we need secrete key generation path for all login mechanism\nThis is a redfish way to enable MFA. Once it is enabled for a user then pam module works same for all . All logins for the user requires to give TOTP.\nPrecisely this is the one of the reason for not implementing anything in PAM module for bypass flags."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 59,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "At the core, bmcweb shouldn't be making \"should this user be allowed to login\" decisions.  That's owned by phosphor-user-manager.  bmcweb currently calls pam to make this decision.\n\n> Assuming we are not going to modify google_authenticator pam\n\nWhy is this an assumption?\n\n> authentication/authorization responsibility from Bmcweb to user manager. \n\nThis isn't something bmcweb needs to be involved in.  bmcweb calls pam.  If PUM wants to add a pam module, it's perfectly capable of doing so.  I'm not really sure why we're having this discussion in a bmcweb patchset.\n\n> Both of them requires lots of work and long term views on specifications.\n\nYou and I disagree about the amount of effort, but feel free to bring the PUM maintainers into the discussion by opening changes against PUM."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 84,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "please don't use std::format for constructing dbus paths.  There are several instances of this, please fix all of them."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 84,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "I can change that . But curious to know why it is a problem to use std::format?"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 84,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gunnar@gmills.xyz",
                        "username": "gtmills"
                    },
                    "message": "https://github.com/openbmc/bmcweb/commit/2dfd18ef79d3b0a2995ba731983479d492be5949\nhttps://github.com/openbmc/bmcweb/blob/master/COMMON_ERRORS.md#12-imprecise-matching\n\"When using dbus paths, rely on the methods on sdbusplus::message::object_path\"\nWe do that because object_path is designed to do just this, constancy, and a lot of time the path checking is incorrect."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 84,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Also, because invalid dbus paths will get the dbus connection closed which is a dos attack vector."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 113,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Same as above, this isn't something bmcweb should be enforcing.  bmcweb just triggers a pam login, and the pam module can enforce whether or not it's required or not"
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 113,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "This is not a pam authentication use case. This is a case where a user who logged in for the first time should be prompted for mandatory creation of secret key or not."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 113,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "I think you are right. Instead doing it in bmcweb, we can move all these check to user-manager. But Needed a new dbus property /method to check if secretKey required."
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "line": 113,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Clsoing this one, lets discuss in the thread above."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 0
        },
        {
            "number": 10,
            "revision": "cfdcecb729463360cf757315ea3e605a28834c25",
            "parents": [
                "87cdde5d1d3492622c93a2052fbeca2d938080b3"
            ],
            "ref": "refs/changes/66/74666/10",
            "uploader": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "createdOn": 1728298010,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 127,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 152,
            "sizeDeletions": 0
        },
        {
            "number": 11,
            "revision": "cc4c4a2b09ba20d75c219d2259115077c5eb541e",
            "parents": [
                "3e42a3290ae35f05b30fa1863f44e95845577420"
            ],
            "ref": "refs/changes/66/74666/11",
            "uploader": {
                "name": "Jishnu C M",
                "email": "jishnunambiarcm@duck.com",
                "username": "cm-jishnu"
            },
            "createdOn": 1728311294,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "Since we have now single IsGenerateSecretKeyRequired Dbus method from PUM we no longer needed this utility class. You can see and review the usage of same here https://gerrit.openbmc.org/c/openbmc/bmcweb/+/74938/23/redfish-core/lib/redfish_sessions.hpp"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "include/google_authenticator.hpp",
                    "type": "ADDED",
                    "insertions": 127,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 152,
            "sizeDeletions": 0
        }
    ]
}