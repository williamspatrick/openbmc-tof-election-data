{
    "project": "openbmc/openbmc",
    "branch": "master",
    "id": "I217101b4ccec8c6e382fcfe44be3618989cf9e59",
    "number": 74071,
    "subject": "meta-facebook: yosemite4: set powerstate to off during power cycling",
    "owner": {
        "name": "Bright Cheng",
        "email": "bright.cheng.wiwynn@gmail.com",
        "username": "BrightWW"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openbmc/+/74071",
    "hashtags": [],
    "createdOn": 1724804964,
    "lastUpdated": 1727706016,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1724804964,
            "reviewer": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1724805007,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1724805007,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1724805015,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/24707/"
        },
        {
            "timestamp": 1724805543,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/24707/ : SUCCESS"
        },
        {
            "timestamp": 1724805553,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 1:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1724813528,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 1:\n\nIBM Simulation CI: p10bmc simulation tests passed"
        },
        {
            "timestamp": 1724828747,
            "reviewer": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1724843125,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1724894093,
            "reviewer": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1726129372,
            "reviewer": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1726129422,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1726129422,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1726129431,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/25075/"
        },
        {
            "timestamp": 1726129481,
            "reviewer": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "message": "Uploaded patch set 3: Commit message was updated."
        },
        {
            "timestamp": 1726129522,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1726129522,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1726129530,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/25076/"
        },
        {
            "timestamp": 1726129539,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/25075/ : ABORTED"
        },
        {
            "timestamp": 1726130299,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/25076/ : SUCCESS"
        },
        {
            "timestamp": 1726130312,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1726137630,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 3:\n\nIBM Simulation CI: p10bmc simulation tests passed"
        },
        {
            "timestamp": 1726216551,
            "reviewer": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1726769977,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3:\n\n(4 comments)"
        },
        {
            "timestamp": 1726816674,
            "reviewer": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "message": "Uploaded patch set 4.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1726816701,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1726816701,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1726816709,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/25194/"
        },
        {
            "timestamp": 1726817210,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/25194/ : SUCCESS"
        },
        {
            "timestamp": 1726817224,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 4:\n\nBuild Failed \n\nGoogle Internal CI : FAILURE (skipped)"
        },
        {
            "timestamp": 1726817656,
            "reviewer": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "message": "Patch Set 4:\n\n(3 comments)"
        },
        {
            "timestamp": 1726821566,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 4:\n\nIBM Simulation CI: p10bmc simulation tests passed"
        },
        {
            "timestamp": 1727669187,
            "reviewer": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1727706013,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 4: Code-Review+2"
        },
        {
            "timestamp": 1727706016,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Change has been successfully rebased and submitted as fdf0b960fc6a88283ec788c54f2a305d64919fb3"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "8df23550e729661f9f087dea0c81928be6895224",
            "parents": [
                "82b9d02282e7011ef17fdac4465128c0f16e471c"
            ],
            "ref": "refs/changes/71/74071/1",
            "uploader": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "createdOn": 1724804964,
            "author": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Can you explain \"why\"?  We really shouldn't be needing to manually set properties in phosphor-state-manager.  What effect are you getting from doing this?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Bright Cheng",
                        "email": "bright.cheng.wiwynn@gmail.com",
                        "username": "BrightWW"
                    },
                    "message": "When we did chassis power cycling, we observed that \"CurrentPowerState\" kept \"xyz.openbmc_project.State.Chassis.PowerState.On\". It will cause sensor which is expected to get value after chassis power on, but BMC still get value during chassis power off (ex: 12V HSC).\nWe would like to avoid that BMC get unexpected sensor value when actual chassis power status is off and trigger threshold event. So, \"CurrentPowerState\" needs to indicate the real state during chassis power cycling."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Bright Cheng",
                        "email": "bright.cheng.wiwynn@gmail.com",
                        "username": "BrightWW"
                    },
                    "message": "Hi Patrick,\nCurrent phosphor-state-manager won't set Chassis.PowerState.Off while RequestedTransition is PowerCycle, and it impact BMC get correct PSU sensor value during chassis power cycle.\nDo you think we need more investigation for the design? Or it is feasible to the solution?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Bright Cheng",
                        "email": "bright.cheng.wiwynn@gmail.com",
                        "username": "BrightWW"
                    },
                    "message": "Done"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "We really shouldn't be needing to do this.  H"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/host-powercycle",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-powercycle",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/power-cmd",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 30,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "1951f788d4c7c724cf389448af2833848a76c24c",
            "parents": [
                "82b9d02282e7011ef17fdac4465128c0f16e471c"
            ],
            "ref": "refs/changes/71/74071/2",
            "uploader": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "createdOn": 1726129372,
            "author": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/host-powercycle",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-powercycle",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/power-cmd",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-poweron",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 36,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "5c780cb550dcaf179311da2e4eddc802ce8aae7b",
            "parents": [
                "82b9d02282e7011ef17fdac4465128c0f16e471c"
            ],
            "ref": "refs/changes/71/74071/3",
            "uploader": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "createdOn": 1726129481,
            "author": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Please rebase and at a minimum clean up the formatting."
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-powercycle",
                    "line": 81,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "no tab"
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-powercycle",
                    "line": 81,
                    "reviewer": {
                        "name": "Bright Cheng",
                        "email": "bright.cheng.wiwynn@gmail.com",
                        "username": "BrightWW"
                    },
                    "message": "Done"
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-poweron",
                    "line": 47,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "no tab"
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-poweron",
                    "line": 47,
                    "reviewer": {
                        "name": "Bright Cheng",
                        "email": "bright.cheng.wiwynn@gmail.com",
                        "username": "BrightWW"
                    },
                    "message": "Done"
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/power-cmd",
                    "line": 25,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Why do we also have to force the host objects?  Aren't those driven by systemd targets too?"
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/power-cmd",
                    "line": 25,
                    "reviewer": {
                        "name": "Bright Cheng",
                        "email": "bright.cheng.wiwynn@gmail.com",
                        "username": "BrightWW"
                    },
                    "message": "No, \"CurrentHostState\" isn't changed during DC cycling."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/host-powercycle",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-powercycle",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/power-cmd",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-poweron",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 38,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "c571f54f9aa8b98cb52ecbe2fa7f582c3b7ae61b",
            "parents": [
                "068994bf1fa569a752edbc488066745b0341f049"
            ],
            "ref": "refs/changes/71/74071/4",
            "uploader": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "createdOn": 1726816674,
            "author": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/host-powercycle",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-powercycle",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/power-cmd",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-poweron",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 38,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "fdf0b960fc6a88283ec788c54f2a305d64919fb3",
            "parents": [
                "248da882d901745a9e47d710925540dc03cecbdb"
            ],
            "ref": "refs/changes/71/74071/5",
            "uploader": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "createdOn": 1727706016,
            "author": {
                "name": "Bright Cheng",
                "email": "bright.cheng.wiwynn@gmail.com",
                "username": "BrightWW"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/host-powercycle",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-powercycle",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/power-cmd",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager/chassis-poweron",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 38,
            "sizeDeletions": 0
        }
    ]
}