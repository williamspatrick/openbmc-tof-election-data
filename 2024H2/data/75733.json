{
    "project": "openbmc/libpldm",
    "branch": "main",
    "topic": "downstream-device-iterators",
    "id": "I6e79454b94868da73f318635bcaae57cd51fbf97",
    "number": 75733,
    "subject": "dsp: firmware_update: Iterators for downstream device descriptors",
    "owner": {
        "name": "Andrew Jeffery",
        "email": "andrew@codeconstruct.com.au",
        "username": "amboar"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/libpldm/+/75733",
    "hashtags": [],
    "createdOn": 1731052217,
    "lastUpdated": 1732162406,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1731052217,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1731052285,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1731052285,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1731052412,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1731052435,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1731052435,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1731052437,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/94220/ : ABORTED"
        },
        {
            "timestamp": 1731052493,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/94221/ : FAILURE"
        },
        {
            "timestamp": 1731994392,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1731994411,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1731994432,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1731994432,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1731994847,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1731994859,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1731994859,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1731994862,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/94736/ : ABORTED"
        },
        {
            "timestamp": 1731994939,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1731994979,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1731994979,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1731994982,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/94738/ : ABORTED"
        },
        {
            "timestamp": 1731995282,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/94739/ : SUCCESS"
        },
        {
            "timestamp": 1732087138,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 6.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1732087177,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1732087177,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1732087475,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/94816/ : SUCCESS"
        },
        {
            "timestamp": 1732092469,
            "reviewer": {
                "name": "ManojKiran Eda",
                "email": "manojkiran.eda@gmail.com",
                "username": "manojkiraneda"
            },
            "message": "Patch Set 6:\n\n(3 comments)"
        },
        {
            "timestamp": 1732097671,
            "reviewer": {
                "name": "Pavithra Barithaya",
                "email": "pavithrabarithaya07@gmail.com",
                "username": "Pavithrab7"
            },
            "message": "Patch Set 6: Code-Review+1"
        },
        {
            "timestamp": 1732144982,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 6:\n\n(2 comments)"
        },
        {
            "timestamp": 1732150235,
            "reviewer": {
                "name": "Unive Tien",
                "email": "unive.tien.wiwynn@gmail.com",
                "username": "UniveTien"
            },
            "message": "Patch Set 6: Code-Review+1"
        },
        {
            "timestamp": 1732162400,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 6: Code-Review+2"
        },
        {
            "timestamp": 1732162406,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Change has been successfully merged"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "750fa0bee7bf3c067cfb57d4d49517a7bbef6111",
            "parents": [
                "7464df35ca7f996a50eb788272aafe5cf1210c2b"
            ],
            "ref": "refs/changes/33/75733/1",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1731052217,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "src/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -2
                },
                {
                    "file": "include/libpldm/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/dsp/firmware_update.c",
                    "type": "MODIFIED",
                    "insertions": 62,
                    "deletions": 0
                },
                {
                    "file": "include/libpldm/firmware_update.h",
                    "type": "MODIFIED",
                    "insertions": 106,
                    "deletions": 0
                },
                {
                    "file": "tests/dsp/firmware_update.cpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -14
                }
            ],
            "sizeInsertions": 238,
            "sizeDeletions": 16
        },
        {
            "number": 2,
            "revision": "d31e0a5aa50bae42234ac54a3a0564c5aaf050a5",
            "parents": [
                "7464df35ca7f996a50eb788272aafe5cf1210c2b"
            ],
            "ref": "refs/changes/33/75733/2",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1731052412,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "src/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -2
                },
                {
                    "file": "include/libpldm/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/dsp/firmware_update.c",
                    "type": "MODIFIED",
                    "insertions": 62,
                    "deletions": 0
                },
                {
                    "file": "include/libpldm/firmware_update.h",
                    "type": "MODIFIED",
                    "insertions": 106,
                    "deletions": 0
                },
                {
                    "file": "tests/dsp/firmware_update.cpp",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": -16
                }
            ],
            "sizeInsertions": 240,
            "sizeDeletions": 18
        },
        {
            "number": 3,
            "revision": "eaec825276dc4dc8525e134fa291766b056fcac4",
            "parents": [
                "dec237bcdafe852638b1ff3867a2db4e07d0a4b3"
            ],
            "ref": "refs/changes/33/75733/3",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1731994392,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 29,
                    "deletions": 0
                },
                {
                    "file": "include/libpldm/api.h",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "src/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -2
                },
                {
                    "file": "include/libpldm/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/dsp/firmware_update.c",
                    "type": "MODIFIED",
                    "insertions": 62,
                    "deletions": 0
                },
                {
                    "file": "include/libpldm/firmware_update.h",
                    "type": "MODIFIED",
                    "insertions": 187,
                    "deletions": 0
                },
                {
                    "file": "tests/dsp/firmware_update.cpp",
                    "type": "MODIFIED",
                    "insertions": 488,
                    "deletions": -18
                }
            ],
            "sizeInsertions": 804,
            "sizeDeletions": 20
        },
        {
            "number": 4,
            "revision": "c6ef88fa04f89363370f6f776bb88c738ddcb2b2",
            "parents": [
                "dec237bcdafe852638b1ff3867a2db4e07d0a4b3"
            ],
            "ref": "refs/changes/33/75733/4",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1731994847,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 29,
                    "deletions": 0
                },
                {
                    "file": "include/libpldm/api.h",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "src/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -2
                },
                {
                    "file": "include/libpldm/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/dsp/firmware_update.c",
                    "type": "MODIFIED",
                    "insertions": 62,
                    "deletions": 0
                },
                {
                    "file": "include/libpldm/firmware_update.h",
                    "type": "MODIFIED",
                    "insertions": 187,
                    "deletions": 0
                },
                {
                    "file": "tests/dsp/firmware_update.cpp",
                    "type": "MODIFIED",
                    "insertions": 488,
                    "deletions": -18
                }
            ],
            "sizeInsertions": 804,
            "sizeDeletions": 20
        },
        {
            "number": 5,
            "revision": "43bbc049395d467e06126dbf3d9e2faf358261ca",
            "parents": [
                "dec237bcdafe852638b1ff3867a2db4e07d0a4b3"
            ],
            "ref": "refs/changes/33/75733/5",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1731994939,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 29,
                    "deletions": 0
                },
                {
                    "file": "include/libpldm/api.h",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "src/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -2
                },
                {
                    "file": "include/libpldm/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/dsp/firmware_update.c",
                    "type": "MODIFIED",
                    "insertions": 62,
                    "deletions": 0
                },
                {
                    "file": "include/libpldm/firmware_update.h",
                    "type": "MODIFIED",
                    "insertions": 187,
                    "deletions": -1
                },
                {
                    "file": "tests/dsp/firmware_update.cpp",
                    "type": "MODIFIED",
                    "insertions": 488,
                    "deletions": -18
                }
            ],
            "sizeInsertions": 804,
            "sizeDeletions": 21
        },
        {
            "number": 6,
            "revision": "3a2c6589c5660d2066b612bae28ca393a8aa1c2b",
            "parents": [
                "dec237bcdafe852638b1ff3867a2db4e07d0a4b3"
            ],
            "ref": "refs/changes/33/75733/6",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1732087138,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "ManojKiran Eda",
                        "email": "manojkiran.eda@gmail.com",
                        "username": "manojkiraneda"
                    },
                    "message": "just a couple of nit picks, but the code looks fine to me otherwise."
                },
                {
                    "file": "include/libpldm/firmware_update.h",
                    "line": 582,
                    "reviewer": {
                        "name": "ManojKiran Eda",
                        "email": "manojkiran.eda@gmail.com",
                        "username": "manojkiraneda"
                    },
                    "message": "null check for `iter` ?"
                },
                {
                    "file": "include/libpldm/firmware_update.h",
                    "line": 582,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "The expanded definition of `LIBPLDM_ITERATOR` includes `__attribute__((nonnull))`, which requires that callers do not pass a NULL pointer, and warns on any tests for NULL as they are redundant.\n\nNothing marked `LIBPLDM_ITERATOR` should be called directly by user code. Rather, user code must use the `foreach_*()` macro definitions (which correctly call these `LIBPLDM_ITERATOR` functions)."
                },
                {
                    "file": "include/libpldm/firmware_update.h",
                    "line": 638,
                    "reviewer": {
                        "name": "ManojKiran Eda",
                        "email": "manojkiran.eda@gmail.com",
                        "username": "manojkiraneda"
                    },
                    "message": "why can't we have this as a static inline function ? whats the rationale for using the #define vs an inline function ?"
                },
                {
                    "file": "include/libpldm/firmware_update.h",
                    "line": 638,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "The definition of the macro expands to a for-loop header, i.e.\n\n```\nforeach_pldm_downstream_device(...)\n```\n\nbecomes\n\n```\nfor (...)\n```\n\nafter macro expansion.\n\nThis technique can't be implemented as a static inline function."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 29,
                    "deletions": 0
                },
                {
                    "file": "include/libpldm/api.h",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "src/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -2
                },
                {
                    "file": "include/libpldm/compiler.h",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "src/dsp/firmware_update.c",
                    "type": "MODIFIED",
                    "insertions": 71,
                    "deletions": -6
                },
                {
                    "file": "include/libpldm/firmware_update.h",
                    "type": "MODIFIED",
                    "insertions": 173,
                    "deletions": -3
                },
                {
                    "file": "tests/dsp/firmware_update.cpp",
                    "type": "MODIFIED",
                    "insertions": 493,
                    "deletions": -31
                }
            ],
            "sizeInsertions": 804,
            "sizeDeletions": 42
        }
    ]
}