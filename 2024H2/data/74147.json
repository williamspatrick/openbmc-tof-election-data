{
    "project": "openbmc/webui-vue",
    "branch": "master",
    "id": "I8b6c84060a987489cc1d35c46c1b00618a88b607",
    "number": 74147,
    "subject": "Retrieve role information the Redfish standard way",
    "owner": {
        "name": "Paul Fertser",
        "email": "fercerpav@gmail.com",
        "username": "paulfertser"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/webui-vue/+/74147",
    "hashtags": [],
    "createdOn": 1724935997,
    "lastUpdated": 1731010616,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1724935997,
            "reviewer": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1724936027,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1724936027,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1724936108,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/90972/ : SUCCESS"
        },
        {
            "timestamp": 1724936636,
            "reviewer": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1727444341,
            "reviewer": {
                "name": "j-westover",
                "email": "jwestover@nvidia.com",
                "username": "j-westover"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1727464454,
            "reviewer": {
                "name": "j-westover",
                "email": "jwestover@nvidia.com",
                "username": "j-westover"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1727466389,
            "reviewer": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "message": "Patch Set 1:\n\n(3 comments)"
        },
        {
            "timestamp": 1727586307,
            "reviewer": {
                "name": "Arun Lal K M",
                "email": "arun.lal@intel.com",
                "username": "arunlalkm-intel"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1727810305,
            "reviewer": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1727810332,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1727810332,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1727810413,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/92495/ : SUCCESS"
        },
        {
            "timestamp": 1727811051,
            "reviewer": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1727983308,
            "reviewer": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "message": "Patch Set 3: Patch Set 2 was rebased on behalf of Paul Fertser <fercerpav@gmail.com>\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1727983349,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1727983349,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1727983742,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/92585/ : SUCCESS"
        },
        {
            "timestamp": 1730195062,
            "reviewer": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1730206084,
            "reviewer": {
                "name": "j-westover",
                "email": "jwestover@nvidia.com",
                "username": "j-westover"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1730206219,
            "reviewer": {
                "name": "j-westover",
                "email": "jwestover@nvidia.com",
                "username": "j-westover"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1730282352,
            "reviewer": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1730291004,
            "reviewer": {
                "name": "j-westover",
                "email": "jwestover@nvidia.com",
                "username": "j-westover"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1730468584,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1730990264,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1731010616,
            "reviewer": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "message": "Change has been successfully rebased and submitted as ce7db82c9582c4dac04ac81d9af6b557ae7965e3"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "b0884b136f86dce0ea52d2a2a9257a964c27b064",
            "parents": [
                "db2940a8ea63aeaf2f31dcb45a1c17a622a726c5"
            ],
            "ref": "refs/changes/47/74147/1",
            "uploader": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "createdOn": 1724935997,
            "author": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Arun Lal K M",
                        "email": "arun.lal@intel.com",
                        "username": "arunlalkm-intel"
                    },
                    "message": "restricted*"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Paul Fertser",
                        "email": "fercerpav@gmail.com",
                        "username": "paulfertser"
                    },
                    "message": "Done"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Paul Fertser",
                        "email": "fercerpav@gmail.com",
                        "username": "paulfertser"
                    },
                    "message": "Farah, I see this patch is related to the tickets you created recently, please feel free to provide feedback."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Paul Fertser",
                        "email": "fercerpav@gmail.com",
                        "username": "paulfertser"
                    },
                    "message": "Thank you so much for the review! Please see inline."
                },
                {
                    "file": "src/store/modules/Authentication/AuthenticanStore.js",
                    "line": 93,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "If localstorage gets erased, on a browser refresh you'll get an exception here that you can't recover from"
                },
                {
                    "file": "src/store/modules/Authentication/AuthenticanStore.js",
                    "line": 93,
                    "reviewer": {
                        "name": "Paul Fertser",
                        "email": "fercerpav@gmail.com",
                        "username": "paulfertser"
                    },
                    "message": "> If localstorage gets erased, on a browser refresh you'll get an exception here that you can't recover from\n\nThat's indeed something I didn't try. So basically to reproduce I just log in normally, then erase the local storage and then reload current page? Interesting, I'll see what I can do about that."
                },
                {
                    "file": "src/store/modules/Authentication/AuthenticanStore.js",
                    "line": 93,
                    "reviewer": {
                        "name": "Paul Fertser",
                        "email": "fercerpav@gmail.com",
                        "username": "paulfertser"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/store/modules/Authentication/AuthenticanStore.js",
                    "line": 109,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "This does not work for me on a browser reset, because when using the a-auth-token based session, the header is required.  Our server throws a 401 here because the token was not saved anywhere and restored before this call.\n\nI see now that we have not yet picked up your cookie patches for bmcweb.  It may take a little while for us to integrate.  Just letting you know that we are blocking on that internally to downstream these webui changes.  Agreed that these changes are needed."
                },
                {
                    "file": "src/store/modules/Authentication/AuthenticanStore.js",
                    "line": 109,
                    "reviewer": {
                        "name": "Paul Fertser",
                        "email": "fercerpav@gmail.com",
                        "username": "paulfertser"
                    },
                    "message": "> This does not work for me on a browser reset, because when using the a-auth-token based session, the header is required.  Our server throws a 401 here because the token was not saved anywhere and restored before this call.\n\nWhen using X-Auth-Token nothing works on browser reset or even page reload, basically, OWASP prohibits saving data used for authentication in any storage that's accessible to JS. So page reloads without losing session is only possible with an HttpOnly cookie.\n\n> I see now that we have not yet picked up your cookie patches for bmcweb.  It may take a little while for us to integrate.  Just letting you know that we are blocking on that internally to downstream these webui changes.  Agreed that these changes are needed.\n\nI wonder though how obtaining the role (this patch) is related to authentication mechanism? With X-Auth-Token you can not reload the page but getting role this way should still work. Please note bmcweb used to /not/ support that Roles attribute in the Session object, for that I was adding some other patches (now all upstream)."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 38,
                    "deletions": 0
                },
                {
                    "file": "src/store/modules/Authentication/AuthenticanStore.js",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": -20
                },
                {
                    "file": "src/router/index.js",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -2
                },
                {
                    "file": "src/store/api.js",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 60,
            "sizeDeletions": 25
        },
        {
            "number": 2,
            "revision": "c49698762564cd440572c1885f01b630fd2d1b5f",
            "parents": [
                "db2940a8ea63aeaf2f31dcb45a1c17a622a726c5"
            ],
            "ref": "refs/changes/47/74147/2",
            "uploader": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "createdOn": 1727810305,
            "author": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 40,
                    "deletions": 0
                },
                {
                    "file": "src/store/modules/Authentication/AuthenticanStore.js",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -20
                },
                {
                    "file": "src/router/index.js",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -5
                },
                {
                    "file": "src/store/api.js",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 77,
            "sizeDeletions": 28
        },
        {
            "number": 3,
            "revision": "422d5c5ac639f5ebd4c7f2b61cc979a12cb72a24",
            "parents": [
                "1b89e594661e970851c914afa9dcfe094a1e92fd"
            ],
            "ref": "refs/changes/47/74147/3",
            "uploader": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "createdOn": 1727983308,
            "author": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Paul Fertser",
                        "email": "fercerpav@gmail.com",
                        "username": "paulfertser"
                    },
                    "message": "Hello,\nThere were no new comments for almost a month, probably time for the final review and merger please?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "Agreed.  Though this makes it tougher for me to stay in sync as we have not pulled down the related upstream changes in bmcweb \ud83d\ude1e"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Paul Fertser",
                        "email": "fercerpav@gmail.com",
                        "username": "paulfertser"
                    },
                    "message": "> Agreed.  Though this makes it tougher for me to stay in sync as we have not pulled down the related upstream changes in bmcweb \ud83d\ude1e\n\nBut with the current change webui should gracefully fall back to Administrator role so it's still usable with old bmcweb too, right? People were using webui that way for long time, till aeb19816e67f6d3ffb1b37c95d813a25b8be1d7b (Nov 2022). Or is something worse happening in your testing?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "Actually, you're right, this patch only makes things better.  It is the prior change to use Redfish Sessions instead of the legacy login URI (a good change!) is what is causing me to stay in sync a little more difficult right now.  But those are just downstream issues ;)"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "I had noticed this opportunity."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 40,
                    "deletions": 0
                },
                {
                    "file": "src/store/modules/Authentication/AuthenticanStore.js",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -20
                },
                {
                    "file": "src/router/index.js",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -5
                },
                {
                    "file": "src/store/api.js",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 77,
            "sizeDeletions": 28
        },
        {
            "number": 4,
            "revision": "ce7db82c9582c4dac04ac81d9af6b557ae7965e3",
            "parents": [
                "918526f20c16a05c261a56814657942a707323dd"
            ],
            "ref": "refs/changes/47/74147/4",
            "uploader": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "createdOn": 1731010616,
            "author": {
                "name": "Paul Fertser",
                "email": "fercerpav@gmail.com",
                "username": "paulfertser"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 40,
                    "deletions": 0
                },
                {
                    "file": "src/store/modules/Authentication/AuthenticanStore.js",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -20
                },
                {
                    "file": "src/router/index.js",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -5
                },
                {
                    "file": "src/store/api.js",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 77,
            "sizeDeletions": 28
        }
    ]
}