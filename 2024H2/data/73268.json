{
    "project": "openbmc/obmc-console",
    "branch": "master",
    "id": "I08c7523af548968c1545189c0007f44144589aec",
    "number": 73268,
    "subject": "test: console-client can read",
    "owner": {
        "name": "Alexander",
        "email": "alexander.hansen@9elements.com",
        "username": "pointbazaar"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/obmc-console/+/73268",
    "hashtags": [],
    "createdOn": 1722609970,
    "lastUpdated": 1723176780,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1722609970,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1722609995,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1722609995,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1722610062,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/89045/ : FAILURE"
        },
        {
            "timestamp": 1722846442,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1722846473,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1722846473,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1722846517,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/89115/ : SUCCESS"
        },
        {
            "timestamp": 1722908619,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1722908724,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1722946580,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1722946610,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1722946611,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1722946649,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/89271/ : SUCCESS"
        },
        {
            "timestamp": 1722946702,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1722990080,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1722991640,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1723024816,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Uploaded patch set 4.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1723024837,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1723024837,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1723024855,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Patch Set 4:\n\n(2 comments)"
        },
        {
            "timestamp": 1723024881,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/89337/ : SUCCESS"
        },
        {
            "timestamp": 1723073928,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 4: Code-Review-1\n\n(3 comments)"
        },
        {
            "timestamp": 1723112545,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Uploaded patch set 5.\n\nOutdated Votes:\n* Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1723112589,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1723112589,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1723112627,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1723112629,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/89398/ : SUCCESS"
        },
        {
            "timestamp": 1723166624,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 5: Code-Review+1"
        },
        {
            "timestamp": 1723176534,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 6.\n\nOutdated Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1723176580,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1723176580,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1723176620,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/89458/ : SUCCESS"
        },
        {
            "timestamp": 1723176766,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 6: Code-Review+2"
        },
        {
            "timestamp": 1723176780,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Change has been successfully merged"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "595e227d01ab73802935173f758ceba29217ed95",
            "parents": [
                "9c16243d7589fbbf3340ef8029f3a9fc33a11ed2"
            ],
            "ref": "refs/changes/68/73268/1",
            "uploader": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "createdOn": 1722609970,
            "author": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "test/meson.build",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "test/test-console-client-can-read",
                    "type": "ADDED",
                    "insertions": 67,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 85,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "7ef2d160c427945d2936263d26c0743ab2f468d4",
            "parents": [
                "5ea401f8783d149d4974852dbd61a36bac777165"
            ],
            "ref": "refs/changes/68/73268/2",
            "uploader": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "createdOn": 1722846442,
            "author": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Hi Alexander, I think we can reduce the moving parts to detect if the client has received expected data, see the comments inline."
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 20,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "I'd rather we use:\n\n```\n[ -z \"$CLIENT_PID\" ] || kill \"$CLIENT_PID\"\n```\n\nSame for the cases below. The \"`kill -0` has output\" trick involves yet another subshell when we can just test the variable directly.\n\nFinally, the discussion on the implementation below may impact what cleanup needs to be done here."
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 20,
                    "reviewer": {
                        "name": "Alexander",
                        "email": "alexander.hansen@9elements.com",
                        "username": "pointbazaar"
                    },
                    "message": "Done"
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 65,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "So after a bit of experimentation I think we can simplify this a bit. Here's the diff that I've tested:\n\n```\ndiff --git a/test/test-console-client-can-read b/test/test-console-client-can-read\nindex 6ad6f7ea388e..a39416e103ee 100755\n--- a/test/test-console-client-can-read\n+++ b/test/test-console-client-can-read\n@@ -17,8 +17,7 @@ cd \"$TEST_DIR\"\n \n cleanup()\n {\n-  [ $(kill -0 \"$CLIENT_PID\") ] || kill \"$CLIENT_PID\"\n-  kill -- -$PIPER_PID\n+  [ -z \"$CLIENT_PID\" ] || kill \"$CLIENT_PID\"\n   [ $(kill -0 \"$SERVER_PID\") ] || kill -s INT \"$SERVER_PID\"\n   [ $(kill -0 \"$SOCAT_PID\") ] || kill \"$SOCAT_PID\"\n   wait\n@@ -44,22 +43,13 @@ while ! [ -e remote -a -e local ]; do sleep 1; done\n \n \"$SERVER\" --config \"$TEST_CONF\" \"$(realpath local)\" &\n SERVER_PID=\"$!\"\n-\n while ! busctl status --user xyz.openbmc_project.Console.\"${TEST_NAME}\"; do sleep 1; done\n \n-# create the input pipe for the client and keep it open\n-mkfifo input_pipe\n-setsid sh -c 'while true; do sleep 3600; done' > input_pipe &\n-PIPER_PID=\"$!\"\n-\n-# client should read the message\n-\"$CLIENT\" -i \"$TEST_NAME\" > client-read.txt < input_pipe &\n+socat EXEC:\"$CLIENT -i $TEST_NAME\" EXEC:'grep -m1 -F client-reads-this' &\n CLIENT_PID=\"$!\"\n \n+echo client-reads-this > remote\n sleep 1\n \n-printf \"client-reads-this\" > remote\n-\n-sleep 1\n-\n-grep -qF client-reads-this client-read.txt\n+! kill -0 \"$CLIENT_PID\"\n+CLIENT_PID=\"\"\n```\n\nWhat do you think?"
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 65,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Ah, so:\n\n```\n+socat EXEC:\"$CLIENT -i $TEST_NAME\" EXEC:'grep -m1 -F client-reads-this' &\n```\n\nshould be\n\n```\n+$SOCAT EXEC:\"$CLIENT -i $TEST_NAME\" EXEC:'grep -m1 -F client-reads-this' &\n```\n\nI meant to fix that before posting but it slipped through the cracks."
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 65,
                    "reviewer": {
                        "name": "Alexander",
                        "email": "alexander.hansen@9elements.com",
                        "username": "pointbazaar"
                    },
                    "message": "The trick with ```grep -m1``` is great, did not know of that before.\nsocat exec is also great.\n\nBut i do not understand how the grep will influence the exit code.\nDid some experiments to confirm this.\n\n```\n[alex@thonkpadT14 ~]$ false &\n[1] 4304\n[1]+  Exit 1                  false\n[alex@thonkpadT14 ~]$ echo $?\n0\n[alex@thonkpadT14 ~]$ false\n[alex@thonkpadT14 ~]$ echo $?\n1\n```\n\nAlso this one\n\n```\n[alex@thonkpadT14 ~]$ false\n[alex@thonkpadT14 ~]$ socat EXEC:\"echo 1234\" EXEC:\"grep -m1 -F 1234\" &\n[1] 4398\n[alex@thonkpadT14 ~]$ 2024/08/06 10:22:40 socat[4398] E write(5, 0x581753aa3000, 5): Broken pipe\n\n[1]+  Exit 1                  socat EXEC:\"echo 1234\" EXEC:\"grep -m1 -F 1234\"\n[alex@thonkpadT14 ~]$ echo $?\n0\n[alex@thonkpadT14 ~]$ socat EXEC:\"echo 1234\" EXEC:\"grep -m1 -F 12345\" &\n[1] 4412\n[alex@thonkpadT14 ~]$ 2024/08/06 10:22:55 socat[4412] W waitpid(): child 4414 exited with status 1\n\n[1]+  Exit 1                  socat EXEC:\"echo 1234\" EXEC:\"grep -m1 -F 12345\"\n[alex@thonkpadT14 ~]$ echo $?\n0\n```\n\nSo the background process does not seem to influence the exit code, which makes sense since it might live on.\n\nAdded a ```wait``` on the socat which will make the grep timeout the test in the failure case."
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 65,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "> But i do not understand how the grep will influence the exit code.\n\nAh, so I should probably have explained myself a bit more there, just sending you a diff was probably a bit terse \ud83d\ude0a\n\nEssentially, the exit code of the grep does not influence the exit code of the script. That may seem surprising, but it's based on the observation that in the _absence_ of a match `grep -m1` _won't_ exit: We've hooked its input up to an open stream (`stdout` of `obmc-console-client`) and it will keep waiting to read so long as `obmc-console-client` (and `socat`) is running.\n\nA further observation is that if the `EXEC:grep -m1 -F ...` subprocess exits,  which it will when it has a match, the `socat` process will also exit.\n\nCombined, these give us our pass/fail behaviour: If the `socat` process remains running then the grep has not matched, and we have a failure. Alternatively, if the `socat` process has exited we assume the grep has matched and we have success.\n\nSo the exit status of the test is determined by `! kill -0 \"$CLIENT_PID\"`, which is what determines whether our grep has succeeded or not. If we can signal `$CLIENT_PID` then we know that grep can't have found a match. Conversely, if we can't signal `$CLIENT_PID` then we assume we have a match. As the semantics are backwards, we use `!` to negate the exit status of `kill`.\n\n> Added a wait on the socat which will make the grep timeout the test in the failure case.\n\nBased on the above, this should be unnecessary. We can determine a failure well before a timeout."
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 65,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Oh, the other trick is, because we're using `set -e`, if `! kill -0 \"$CLIENT_PID\"` is unsuccessful, then we jump straight to `cleanup` before assigning `CLIENT_PID=\"\"`, which means our cleanup handler will `kill \"$CLIENT_PID\"` as we need it to."
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 65,
                    "reviewer": {
                        "name": "Alexander",
                        "email": "alexander.hansen@9elements.com",
                        "username": "pointbazaar"
                    },
                    "message": "Just looking at this explanation from a distance already shows how many mental hoops one has to go through to use bash effectively \ud83d\ude04\n\nAdded a small comment to summarize your explanations and otherwise changed it to be more in line with your diff."
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 65,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "> Just looking at this explanation from a distance already shows how many mental hoops one has to go through to use bash effectively \ud83d\ude04\n\n`set -e` with `trap` is shell's exception handling, `&` provides concurrency, `wait` is a join; it's the same stuff as is available in most other languages, just this language is optimised for handling these in terms of processes.\n\nThat said, I do have a tendency to shrink-wrap things a bit and look for opportunities to make the code more succinct, which is also at play here.\n\n> Added a small comment to summarize your explanations\n\nGreat, thanks."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "test/meson.build",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "test/test-console-client-can-read",
                    "type": "ADDED",
                    "insertions": 65,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 83,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "ed6ffe5522d875bfa45d191c4be955b114c90277",
            "parents": [
                "49b7893e10fcef1106e8f20ec09b56165237f8ff"
            ],
            "ref": "refs/changes/68/73268/3",
            "uploader": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "createdOn": 1722946580,
            "author": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "test/test-console-client-can-read",
                    "line": 56,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "This should not be necessary. See the discussion here:\n\nhttps://gerrit.openbmc.org/c/openbmc/obmc-console/+/73268/comment/eecc3f16_fd1c0b04/\n\nFurther, if the wait succeeds the `kill` line below is unnecessary, as we know it can't possibly signal `$CLIENT_PID` (if it can then `wait` has a serious bug).\n\nAlso note that I had a `sleep 1` after the `echo client-reads-this > remote` line that you'll need to add back."
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 56,
                    "reviewer": {
                        "name": "Alexander",
                        "email": "alexander.hansen@9elements.com",
                        "username": "pointbazaar"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "test/meson.build",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "test/test-console-client-can-read",
                    "type": "ADDED",
                    "insertions": 59,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 77,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "6a2626efc6c0e9aca21732277e70f02020b0e6b6",
            "parents": [
                "f9672c5e0363dee4572d642dc5156bf64dfd6b82"
            ],
            "ref": "refs/changes/68/73268/4",
            "uploader": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "createdOn": 1723024816,
            "author": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Hi Alexander, just one final thought regarding the grep invocation."
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 49,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Ah, so a thought I had was that we should probably add the `-q` option to `grep` so it won't output the match back into `obmc-console-client`. It probably doesn't matter, but for the purpose of the test such a write is not necessary, and it would be better if it didn't confound someone's reasoning."
                },
                {
                    "file": "test/test-console-client-can-read",
                    "line": 49,
                    "reviewer": {
                        "name": "Alexander",
                        "email": "alexander.hansen@9elements.com",
                        "username": "pointbazaar"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "test/meson.build",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "test/test-console-client-can-read",
                    "type": "ADDED",
                    "insertions": 61,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 79,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "a4a6ddc9f1ea4f0395cc83409e708be63991c4ee",
            "parents": [
                "04a927926b1db17b5eae4592740ce613d61a2ff7"
            ],
            "ref": "refs/changes/68/73268/5",
            "uploader": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "createdOn": 1723112545,
            "author": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "test/meson.build",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "test/test-console-client-can-read",
                    "type": "ADDED",
                    "insertions": 61,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 79,
            "sizeDeletions": 0
        },
        {
            "number": 6,
            "revision": "12bf483bee582d2feed71e6ef345195ef62d53d4",
            "parents": [
                "29a8f9895459ea729de19bee797015ad26e66079"
            ],
            "ref": "refs/changes/68/73268/6",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1723176534,
            "author": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "test/meson.build",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "test/test-console-client-can-read",
                    "type": "ADDED",
                    "insertions": 60,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 79,
            "sizeDeletions": 0
        }
    ]
}