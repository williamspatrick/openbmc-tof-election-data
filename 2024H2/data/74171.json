{
    "project": "openbmc/webui-vue",
    "branch": "master",
    "id": "I1f510dfc9965e9ad8f24da4308e4376f81b0a1a7",
    "number": 74171,
    "subject": "Support SSH public key exchange with BMC",
    "owner": {
        "name": "Jackie14",
        "email": "yongquanx@nvidia.com",
        "username": "Jackie14"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/webui-vue/+/74171",
    "hashtags": [],
    "createdOn": 1724991060,
    "lastUpdated": 1727053809,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1724991060,
            "reviewer": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1724991107,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1724991108,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1724991132,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/91014/ : FAILURE"
        },
        {
            "timestamp": 1724991824,
            "reviewer": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "message": "Uploaded patch set 2: Commit message was updated.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1724991851,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1724991851,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1724991929,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/91016/ : SUCCESS"
        },
        {
            "timestamp": 1725020508,
            "reviewer": {
                "name": "j-westover",
                "email": "jwestover@nvidia.com",
                "username": "j-westover"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1725630571,
            "reviewer": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "message": "Uploaded patch set 3: Patch Set 2 was rebased.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1725630622,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1725630622,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1725630708,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/91479/ : SUCCESS"
        },
        {
            "timestamp": 1726625652,
            "reviewer": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "message": "Uploaded patch set 4: Patch Set 3 was rebased.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1726625703,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1726625703,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1726625937,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/91929/ : SUCCESS"
        },
        {
            "timestamp": 1726843186,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 4:\n\n(2 comments)"
        },
        {
            "timestamp": 1726844192,
            "reviewer": {
                "name": "j-westover",
                "email": "jwestover@nvidia.com",
                "username": "j-westover"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1726844427,
            "reviewer": {
                "name": "j-westover",
                "email": "jwestover@nvidia.com",
                "username": "j-westover"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1726867532,
            "reviewer": {
                "name": "j-westover",
                "email": "jwestover@nvidia.com",
                "username": "j-westover"
            },
            "message": "Patch Set 4:\n\n(2 comments)"
        },
        {
            "timestamp": 1727053809,
            "reviewer": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "message": "Abandoned\n\nThanks for the feedback Milton! We'll abandon this one (and will keep it exclusive to the customer that needs it)."
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "7608a1628b3a366c88ef2089a242eb209c99ce99",
            "parents": [
                "2f0ae509bbcc38765121497d79d464d277d5a81b"
            ],
            "ref": "refs/changes/71/74171/1",
            "uploader": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "createdOn": 1724991060,
            "author": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "src/views/Overview/OverviewFirmware.vue",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "src/locales/ru-RU.json",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareCardsBmc.vue",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareModalConfirmIdentity.vue",
                    "type": "ADDED",
                    "insertions": 130,
                    "deletions": 0
                },
                {
                    "file": "src/locales/en-US.json",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/store/modules/Operations/FirmwareStore.js",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareCardsHost.vue",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareFormUpdate.vue",
                    "type": "MODIFIED",
                    "insertions": 31,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 248,
            "sizeDeletions": 12
        },
        {
            "number": 2,
            "revision": "8828bffa25e20fea25289691ad31f45707a49ab9",
            "parents": [
                "48ddcc50639b32b736b737b0bf6ac7d3c6cc8eb4"
            ],
            "ref": "refs/changes/71/74171/2",
            "uploader": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "createdOn": 1724991824,
            "author": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "Adding some comments.  Interested to what others think about this approach."
                },
                {
                    "file": "src/store/modules/Operations/FirmwareStore.js",
                    "line": 50,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "This JS function was modeled after `UserAuthenticationMethod` in https://redfish.dmtf.org/schemas/v1/AggregationSource.v1_4_2.json.\n\nHowever, in this case these return values are not mutually exclusive (a SCP service can support both Key and Password based auth).\n\nWe are returning an array here but supporting only \"PublicKey\" at this time, room for \"Password\" to be added if needed."
                },
                {
                    "file": "src/store/modules/Operations/FirmwareStore.js",
                    "line": 199,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "Note:  This `.PublicKeyExchange` Action in this case is an OEM action.  This JS function searches all Keys in the Action block and returns the Target if found, regardless of OEM name.  There are plans to standardize but we thought best to get community feedback here, and craft the feature so that it is hidden, shown only if the Redfish response includes this action.. and can be easily altered in the future."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "src/views/Overview/OverviewFirmware.vue",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "src/locales/ru-RU.json",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareCardsBmc.vue",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareModalConfirmIdentity.vue",
                    "type": "ADDED",
                    "insertions": 130,
                    "deletions": 0
                },
                {
                    "file": "src/locales/en-US.json",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/store/modules/Operations/FirmwareStore.js",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareCardsHost.vue",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareFormUpdate.vue",
                    "type": "MODIFIED",
                    "insertions": 31,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 250,
            "sizeDeletions": 12
        },
        {
            "number": 3,
            "revision": "ac8c881b03ae6afb15b69442b70d07dc8b512300",
            "parents": [
                "b5d1873ff9c04727c9b0fb64f62e96ad4df08b6e"
            ],
            "ref": "refs/changes/71/74171/3",
            "uploader": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "createdOn": 1725630571,
            "author": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "src/views/Overview/OverviewFirmware.vue",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "src/locales/ru-RU.json",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareCardsBmc.vue",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareModalConfirmIdentity.vue",
                    "type": "ADDED",
                    "insertions": 130,
                    "deletions": 0
                },
                {
                    "file": "src/locales/en-US.json",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/store/modules/Operations/FirmwareStore.js",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareCardsHost.vue",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareFormUpdate.vue",
                    "type": "MODIFIED",
                    "insertions": 31,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 250,
            "sizeDeletions": 12
        },
        {
            "number": 4,
            "revision": "ac4ad81c24cb56a246304e74e79d1b2404d82e90",
            "parents": [
                "ab69efbb2ddc03a4368521172cef555076ddae37"
            ],
            "ref": "refs/changes/71/74171/4",
            "uploader": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "createdOn": 1726625652,
            "author": {
                "name": "Jackie14",
                "email": "yongquanx@nvidia.com",
                "username": "Jackie14"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "is there documentation the proposed  UX (user experience)?\n\n\nI could see a few potential flows:\n  BMC contacts server, should display resolved IP and retrieved public key , and the fingerprint picture \n  UI offers input box for user to paste public key\n  UI offers box for user to fill and button to fetch with a fetch public key (combining the above)\n  UI contacts ssh server vs BMC to retrieve public key \n  \nif you trigger the model in the URL then you have already submitted the update to the BMC before it's authorized and will fail for lack of authorization.\n\nunlike the aggregation source resource commented the server in uri isn't likely to be known from prior interaction"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "> is there documentation the proposed  UX (user experience)?\n\nSadly no.  This feature resulted from a quick turnaround from a customer request.  We tried to adopt UI flow and layout found elsewhere in the webui project.\n\nRegarding the SSH exchange UI flow; we already had this key exchange function available from a previous need (but it is much more limited compared to your example flows):\n* The feature is hidden in the webUI unless the OEM `PublicKeyExchange` Action is found in the response to UpdateService\n* The \"file source\" section will have a radio to select Local file or SCP server (and HTTP server and HTTPS server if those are also discovered in UpdateService)\n* if SCP Server is selected an input box appears to type in the full URL to the image (and the IP address is then chopped off via JS)\n* User can then do 1 of 2 things:\n  1. Click the \"Start update\" button, and it will fail if the key exchange has not been performed.\n  2. Click the \"Confirm the Identity Link\".  This brings up a modal dialog and has the following steps:\n    a) Input Box for remote server IP (pre-filled based on URL already provided)\n    b) Input box for SSH Key of Remote Server\n    c) Output box appears with a public key that the user must copy and then add to the authorized_keys on the remote server.\n    Agreed that last part is hefty requirement.\n    Agreed the requirement to have the resolved IP and remote public key already is also an unnecessary burden.\n    \nThanks for the feedback Milton!  We'll abandon this one (and will keep it exclusive to the customer that needs it)."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "why is this an IP address and not a hostname (with option for IP address)?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "> why is this an IP address and not a hostname (with option for IP address)?\n\nAgreed.  The JS function to verify the entry for this field is likewise too restrictive (I just flagged it).  Do we have an example of hostname validation elsewhere in this project?  IMHO we should do minimal safe checking on the UI form input and then also better handle an error from the API."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "I suppose a better answer is that our current flow does not pre-contact the server to return a resolved IP and public key.  The user must have that information already."
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareFormUpdate.vue",
                    "line": 203,
                    "reviewer": {
                        "name": "j-westover",
                        "email": "jwestover@nvidia.com",
                        "username": "j-westover"
                    },
                    "message": "Too restrictive.  Is there another example used elsewhere in this project"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "src/views/Overview/OverviewFirmware.vue",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "src/locales/ru-RU.json",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareCardsBmc.vue",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareModalConfirmIdentity.vue",
                    "type": "ADDED",
                    "insertions": 130,
                    "deletions": 0
                },
                {
                    "file": "src/locales/en-US.json",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "src/store/modules/Operations/FirmwareStore.js",
                    "type": "MODIFIED",
                    "insertions": 48,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareCardsHost.vue",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "src/views/Operations/Firmware/FirmwareFormUpdate.vue",
                    "type": "MODIFIED",
                    "insertions": 31,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 250,
            "sizeDeletions": 12
        }
    ]
}