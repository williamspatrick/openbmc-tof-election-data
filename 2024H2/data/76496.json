{
    "project": "openbmc/openbmc-build-scripts",
    "branch": "master",
    "id": "I6f72cf43b32e7f6b9b600b027189a2dcf985f364",
    "number": 76496,
    "subject": "build-unit-test-docker: support podman",
    "owner": {
        "name": "Andrew Geissler",
        "email": "geissonator@yahoo.com",
        "username": "geissonator"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openbmc-build-scripts/+/76496",
    "hashtags": [],
    "createdOn": 1733948594,
    "lastUpdated": 1734115141,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1733948594,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1733948625,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1733948625,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1733948630,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Started https://jenkins.openbmc.org/job/CI-MISC/job/ci-openbmc-build-scripts/1188/ (2/2)"
        },
        {
            "timestamp": 1733948791,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/96365/ : FAILURE\n\nhttps://jenkins.openbmc.org/job/CI-MISC/job/ci-openbmc-build-scripts/1188/ : FAILURE"
        },
        {
            "timestamp": 1733949517,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1: Code-Review+1\n\n(2 comments)"
        },
        {
            "timestamp": 1733949614,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1733949629,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1733949629,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1733949639,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Started https://jenkins.openbmc.org/job/CI-MISC/job/ci-openbmc-build-scripts/1190/ (2/2)"
        },
        {
            "timestamp": 1733950368,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/96368/ : SUCCESS\n\nhttps://jenkins.openbmc.org/job/CI-MISC/job/ci-openbmc-build-scripts/1190/ : SUCCESS"
        },
        {
            "timestamp": 1733950402,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1733950579,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1733955349,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1733958768,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1734052255,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 2: Code-Review+2"
        },
        {
            "timestamp": 1734115141,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Change has been successfully rebased and submitted as 8f7146fafa9565ff6bd4405a660fcb4f7296f4de"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "8591f88e71724d598cc780e5db6735ca6f655465",
            "parents": [
                "c75b543172ecb7435c1ca44f9d860dcd80a09fe4"
            ],
            "ref": "refs/changes/96/76496/1",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1733948594,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "scripts/build-unit-test-docker",
                    "line": 47,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I thought podman installed `docker` executable for backwards compatibility?"
                },
                {
                    "file": "scripts/build-unit-test-docker",
                    "line": 47,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Yeah, it makes a link from docker to the podman executable but it doesn't have the docker sh package, so the import was failing."
                },
                {
                    "file": "scripts/build-unit-test-docker",
                    "line": 47,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Hmm. This is strange, but I guess the change is fine. \n\nThere isn't such a thing as \"the docker sh package\". sh works against anything it can find in the shell. \"from sh import foo\" should pass whenever \"foo\" is a valid executable. I wonder if, for some reason, it fails on symlinks."
                },
                {
                    "file": "scripts/build-unit-test-docker",
                    "line": 47,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Ahh, I take that back, there's a .bashrc setup on the system:\ndocker ()\n{\n    podman $@\n}\n\nSo there is no link from docker to podman. So you're right. The only thing this commit gets us is if a user can't install that link on their system. I just created the link in my $HOME and set my $PATH to it and it worked without this commit.\n\nSo...now that we got that figured out. I think it's still a worthwhile change. This proves that Red Hat does not install that link by default so it would be nice if this script just worked out of the box without needing the docker link."
                },
                {
                    "file": "scripts/build-unit-test-docker",
                    "line": 47,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Yep. sounds good."
                },
                {
                    "file": "scripts/build-unit-test-docker",
                    "line": 691,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "One thing I've noticed is now docker gives warnings for `docker build` and wants us to use `docker buildx`.  Any idea if this is supported on:\n\n1. the older version of Docker we have on some Jenkins executors\n2. podman"
                },
                {
                    "file": "scripts/build-unit-test-docker",
                    "line": 691,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Yeah, I've been seeing that too. Not sure, but I've got it on the TODO list to look into."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "scripts/build-unit-test-docker",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 32,
            "sizeDeletions": 3
        },
        {
            "number": 2,
            "revision": "eea69206e43d8dac146e163f7db1bc84fd578fc7",
            "parents": [
                "c75b543172ecb7435c1ca44f9d860dcd80a09fe4"
            ],
            "ref": "refs/changes/96/76496/2",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1733949614,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "scripts/build-unit-test-docker",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 36,
            "sizeDeletions": 3
        },
        {
            "number": 3,
            "revision": "8f7146fafa9565ff6bd4405a660fcb4f7296f4de",
            "parents": [
                "917b1774d3a9a148fe9c48228a6ad0106d4ef981"
            ],
            "ref": "refs/changes/96/76496/3",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1734115141,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "scripts/build-unit-test-docker",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 36,
            "sizeDeletions": 3
        }
    ]
}