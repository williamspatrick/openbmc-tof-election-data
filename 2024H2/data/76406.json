{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "Id577be522be7c2d3463da9c497d9063a284a4d54",
    "number": 76406,
    "subject": "Always fall back to ChassisType RackMount",
    "owner": {
        "name": "Gunnar Mills",
        "email": "gunnar@gmills.xyz",
        "username": "gtmills"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/76406",
    "hashtags": [],
    "createdOn": 1733843318,
    "lastUpdated": 1733864685,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1733843318,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1733843347,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1733843347,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1733843483,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/96212/ : FAILURE"
        },
        {
            "timestamp": 1733843966,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1733843986,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1733843986,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1733844876,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/96216/ : SUCCESS"
        },
        {
            "timestamp": 1733853564,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1733864118,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1733864328,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1733864348,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1733864683,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2: Code-Review+2"
        },
        {
            "timestamp": 1733864685,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as 19ea2864f50b082773496767b2bc0778e716eef2"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "e725924518f633823771af6f7a597ad734e73438",
            "parents": [
                "be2f124cec67c51dae320e856b83da9e846a148c"
            ],
            "ref": "refs/changes/06/76406/1",
            "uploader": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "createdOn": 1733843318,
            "author": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 31,
            "sizeDeletions": 5
        },
        {
            "number": 2,
            "revision": "bc8c3c59e5b83f4084565a636a1ed1a8461a5981",
            "parents": [
                "be2f124cec67c51dae320e856b83da9e846a148c"
            ],
            "ref": "refs/changes/06/76406/2",
            "uploader": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "createdOn": 1733843966,
            "author": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "line": 541,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "There's 3 cases here:\n1. Chassis type wasn't provided\n2. Chassis type was provided, but we didn't understand it\n3. Chassis type was provided and we understood it.\n\nThe code looks like it only would change the behavior for #2?  What value was being published to dbus that we didn't translate?"
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "line": 541,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gunnar@gmills.xyz",
                        "username": "gtmills"
                    },
                    "message": "1. Chassis type wasn't provided \n\nIf you are have implemented \"xyz.openbmc_project.Inventory.Item.Chassis\", you have Chassis type. If you have implemented \"xyz.openbmc_project.Inventory.Item.Board\" you don't have a Chassis type. \nhttps://github.com/openbmc/phosphor-dbus-interfaces/blob/master/yaml/xyz/openbmc_project/Inventory/Item/Chassis.interface.yaml#L5\nhttps://github.com/openbmc/phosphor-dbus-interfaces/blob/master/yaml/xyz/openbmc_project/Inventory/Item/Board.interface.yaml\n\nThis code doesn't touch this. This should already fall back to ChassisType RackMount\n\n2. Chassis type was provided, but we didn't understand it\n3. Chassis type was provided and we understood it.\nThe code looks like it only would change the behavior for #2? \n\nIs \"Unknown\" https://github.com/openbmc/phosphor-dbus-interfaces/blob/master/yaml/xyz/openbmc_project/Inventory/Item/Chassis.interface.yaml#L44 #2? Then yes, this modifies what happens when there is a chassis type but we can't map it to something we have an enum for.\n\n\n>  What value was being published to dbus that we didn't translate?\n\n\"Unknown\". The default. We (and I suspect others do as well) implemented xyz.openbmc_project.Inventory.Item.Chassis but didn't set ChassisType. \nThis is now a Redfish validator error. I believe https://gerrit.openbmc.org/c/openbmc/openpower-vpd-parser/+/76434 fixes this on the backend but others probably do this as well."
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "line": 541,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "ACK..  I understand now."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -5
                },
                {
                    "file": "test/redfish-core/lib/chassis_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 33,
            "sizeDeletions": 6
        },
        {
            "number": 3,
            "revision": "19ea2864f50b082773496767b2bc0778e716eef2",
            "parents": [
                "56b81992ba8a8e644f2e75251a94df4f4d0d0880"
            ],
            "ref": "refs/changes/06/76406/3",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1733864685,
            "author": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -5
                },
                {
                    "file": "test/redfish-core/lib/chassis_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 33,
            "sizeDeletions": 6
        }
    ]
}