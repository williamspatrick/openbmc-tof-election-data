{
    "project": "openbmc/phosphor-health-monitor",
    "branch": "master",
    "id": "I0e1867311b570fd6894913904908f9a7cf13eaa2",
    "number": 76031,
    "subject": "health-monitor: Remove initramfs permissions check from default config",
    "owner": {
        "name": "Peter Delevoryas",
        "email": "peter@pjd.dev",
        "username": "peterdelevoryas"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/phosphor-health-monitor/+/76031",
    "hashtags": [],
    "createdOn": 1732480978,
    "lastUpdated": 1732570132,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1732480978,
            "reviewer": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1732481034,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1732481034,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1732481070,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/95100/ : FAILURE"
        },
        {
            "timestamp": 1732481118,
            "reviewer": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "message": "Uploaded patch set 2: Commit message was updated.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1732481153,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1732481153,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1732481190,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/95101/ : FAILURE"
        },
        {
            "timestamp": 1732481318,
            "reviewer": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "message": "Uploaded patch set 3: Commit message was updated.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1732481343,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1732481343,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1732481381,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/95102/ : FAILURE"
        },
        {
            "timestamp": 1732499377,
            "reviewer": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "message": "Uploaded patch set 4.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1732499410,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1732499410,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1732499514,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/95123/ : SUCCESS"
        },
        {
            "timestamp": 1732500581,
            "reviewer": {
                "name": "Jagpal S Gill",
                "email": "paligill@gmail.com",
                "username": "jagpalgill"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1732500853,
            "reviewer": {
                "name": "Jagpal S Gill",
                "email": "paligill@gmail.com",
                "username": "jagpalgill"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1732503050,
            "reviewer": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "message": "Patch Set 4:\n\n(2 comments)"
        },
        {
            "timestamp": 1732503769,
            "reviewer": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "message": "Uploaded patch set 5: Commit message was updated.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1732503810,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1732503810,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1732503945,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/95128/ : SUCCESS"
        },
        {
            "timestamp": 1732544855,
            "reviewer": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1732570132,
            "reviewer": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "message": "Abandoned"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "65d03cfcc3581e858f15487312d4915edfbe44d9",
            "parents": [
                "ce8b5ae4e7fc1c88cdd85dab8c007cd14408d93f"
            ],
            "ref": "refs/changes/31/76031/1",
            "uploader": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "createdOn": 1732480978,
            "author": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 112,
                    "deletions": 0
                },
                {
                    "file": "health_metric_config.cpp",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 112,
            "sizeDeletions": 10
        },
        {
            "number": 2,
            "revision": "fa6b8888968440501783b8d51447f9b8593835e5",
            "parents": [
                "ce8b5ae4e7fc1c88cdd85dab8c007cd14408d93f"
            ],
            "ref": "refs/changes/31/76031/2",
            "uploader": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "createdOn": 1732481118,
            "author": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 112,
                    "deletions": 0
                },
                {
                    "file": "health_metric_config.cpp",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 112,
            "sizeDeletions": 10
        },
        {
            "number": 3,
            "revision": "f134ed04bf336473c6773f9da71315ae5e300bd4",
            "parents": [
                "ce8b5ae4e7fc1c88cdd85dab8c007cd14408d93f"
            ],
            "ref": "refs/changes/31/76031/3",
            "uploader": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "createdOn": 1732481318,
            "author": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 125,
                    "deletions": 0
                },
                {
                    "file": "health_metric_config.cpp",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 125,
            "sizeDeletions": 10
        },
        {
            "number": 4,
            "revision": "7e232a91bd9743c76b4f80fec232410fe5e5bb3c",
            "parents": [
                "ce8b5ae4e7fc1c88cdd85dab8c007cd14408d93f"
            ],
            "ref": "refs/changes/31/76031/4",
            "uploader": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "createdOn": 1732499377,
            "author": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "> This health check was not added that long ago (~1 year ago, in the\ninitial commit of the health_metric_config interface),\n\nThis health check was always there. You can refer to https://github.com/openbmc/phosphor-health-monitor/commit/fdf610484be702a484683847935445099c8fcef2#diff-8e469ac36fe6da76bb612089453337e38f44d3176d71e0b9eba8bad7c8b19954L62 deleted bmc_health_config.json. As part of last refactor the config was moved in code."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Jagpal S Gill",
                        "email": "paligill@gmail.com",
                        "username": "jagpalgill"
                    },
                    "message": "> and I would\nconsider this specific check as niche: initramfs/initrd partitions\nnormally *shouldn't* be writable.\n\nI see on romulus, i see following as writable.\n\nroot@romulus:~# echo \"test\" > /run/initramfs/rw/testFile\nroot@romulus:~# cat /run/initramfs/rw/testFile \ntest\n\nSince, the check has been there from beginning i am wondering if there is another way of handling it rather than just dropping it?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Peter Delevoryas",
                        "email": "peter@pjd.dev",
                        "username": "peterdelevoryas"
                    },
                    "message": "Oh ok, I'll amend the description"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Peter Delevoryas",
                        "email": "peter@pjd.dev",
                        "username": "peterdelevoryas"
                    },
                    "message": "If there's a simple alternative, like editing the obmc-phosphor-initramfs-image recipe to add this as a .bbappend, I'd be up for that. That would still require this change though.\n\nI see that the configuration file is applied as a patch using [merge_patch](https://json.nlohmann.me/features/merge_patch/). So we could also just add a .bbappend to obmc-phosphor-image, or to machine images that don't include an initramfs, that removes the `Storage_RW` key.\n\nI'd also be curious to understand the general sentiment about this check, maybe I'll ask in Discord tomorrow if people are aware of this check's existence."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Peter Delevoryas",
                        "email": "peter@pjd.dev",
                        "username": "peterdelevoryas"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 143,
                    "deletions": 0
                },
                {
                    "file": "health_metric_config.cpp",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -10
                },
                {
                    "file": "test/test_health_metric_collection.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 144,
            "sizeDeletions": 11
        },
        {
            "number": 5,
            "revision": "0619af4538d3529d237f937a81bff931e0ecfedc",
            "parents": [
                "ce8b5ae4e7fc1c88cdd85dab8c007cd14408d93f"
            ],
            "ref": "refs/changes/31/76031/5",
            "uploader": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "createdOn": 1732503769,
            "author": {
                "name": "Peter Delevoryas",
                "email": "peter@pjd.dev",
                "username": "peterdelevoryas"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 152,
                    "deletions": 0
                },
                {
                    "file": "health_metric_config.cpp",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -10
                },
                {
                    "file": "test/test_health_metric_collection.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 11
        }
    ]
}