{
    "project": "openbmc/openbmc",
    "branch": "master",
    "id": "Ie0c8455d385859494776a425a560adfa61fd0d6c",
    "number": 70755,
    "subject": "meta-nuvoton: evb-npcm845: network: add rules for using eth naming",
    "owner": {
        "name": "Tim Lee",
        "email": "chli30@nuvoton.com",
        "username": "timlee66"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openbmc/+/70755",
    "hashtags": [],
    "createdOn": 1712823219,
    "lastUpdated": 1721007905,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1712823219,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1712823304,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1712823304,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1712823310,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/22517/"
        },
        {
            "timestamp": 1712823764,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Patch Set 2: Commit message was updated."
        },
        {
            "timestamp": 1712823859,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1712823859,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1712823861,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/22517/ : ABORTED"
        },
        {
            "timestamp": 1712823865,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/22518/"
        },
        {
            "timestamp": 1712824505,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/22518/ : SUCCESS"
        },
        {
            "timestamp": 1712824514,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1712825958,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1713342294,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1713561818,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1713748304,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1713753071,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1713820138,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1713832675,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Abandoned\n\nAfter syncing the latest systemd_255.4 with this PACKAGECONFIG pni-names then ethernet name will keep using ethx, not endx. Thus, this is not necessary from now on. Abandon it and will verify latest subtree update."
        },
        {
            "timestamp": 1715931191,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Restored"
        },
        {
            "timestamp": 1715932037,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1718222068,
            "reviewer": {
                "name": "Benjamin Fair",
                "email": "benjaminfair@google.com",
                "username": "BenjaminFair"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1718259902,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1718327875,
            "reviewer": {
                "name": "Benjamin Fair",
                "email": "benjaminfair@google.com",
                "username": "BenjaminFair"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1718586592,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1718586641,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1718586641,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1718586695,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1718587093,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/23397/"
        },
        {
            "timestamp": 1718595191,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/23397/ : SUCCESS"
        },
        {
            "timestamp": 1718595201,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1718596459,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1718600851,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 3:\n\nIBM Simulation CI: p10bmc simulation tests passed"
        },
        {
            "timestamp": 1720665779,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1720805259,
            "reviewer": {
                "name": "Benjamin Fair",
                "email": "benjaminfair@google.com",
                "username": "BenjaminFair"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1721007905,
            "reviewer": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "message": "Change has been successfully rebased and submitted as 5c3e81ef1520e2a8dfb5bf738f310833700a161d"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "de7f425f66cd3d45b1c2a9e29dce2d8177c22342",
            "parents": [
                "2850a8adcf834b17518801e0c615a670e83de1af"
            ],
            "ref": "refs/changes/55/70755/1",
            "uploader": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "createdOn": 1712823219,
            "author": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 24,
                    "deletions": 0
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-core/systemd/systemd/85-persistent-net.rules",
                    "type": "ADDED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-core/systemd/systemd_%.bbappend",
                    "type": "ADDED",
                    "insertions": 7,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 37,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "c430d9117f4ed5ad69f4723c3c38f24307a7fb3d",
            "parents": [
                "2850a8adcf834b17518801e0c615a670e83de1af"
            ],
            "ref": "refs/changes/55/70755/2",
            "uploader": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "createdOn": 1712823764,
            "author": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "chli30@nuvoton.com",
                        "username": "timlee66"
                    },
                    "message": "Could someone help to review this commit? Thanks in advance."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Is this still necessary?  Can you test on the latest code to confirm?\n\nUpstream poky made a change that temporarily enabled persistent net names and then disabled them later.  I think they're now only enabled with the `pni-names` distro feature.\n\nhttps://git.yoctoproject.org/poky/commit/?id=0900258689537add2dfaf1d01b71e49939020234"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "chli30@nuvoton.com",
                        "username": "timlee66"
                    },
                    "message": "Thanks for your time to review! I will test the latest code without this commit to confirm whether is this still necessary. I will udpate test result later."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "chli30@nuvoton.com",
                        "username": "timlee66"
                    },
                    "message": "Yes, after syncing the latest systemd_255.4 with this PACKAGECONFIG `pni-names` then ethernet name will keep using `ethx`, not `endx`. Thus, this is not necessary from now on. Here is `ifconfig` for referencing. Thanks for your help!\n```\nroot@evb-npcm845:~# ifconfig\neth0      Link encap:Ethernet  HWaddr 00:00:F7:A0:00:FC\neth1      Link encap:Ethernet  HWaddr 00:00:F7:A0:00:FD\neth3      Link encap:Ethernet  HWaddr 00:00:F7:A0:00:FF\n```"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Great to hear."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "chli30@nuvoton.com",
                        "username": "timlee66"
                    },
                    "message": "Hi Patrick,\n\nSorry for my mistake, I restore this commit due to I used the latest systemd v255.4 to verify, but still got network naming is using`end0`, not `eth0` symptom. After checking the codebase, I found that `85-persistent-net.rules` still be included from legacy meta-evb-nuvoton layer, we didn't remove it!\n\nThat's why previous test result is pass. Thus, this rules need for us, please help us to review this again. Sorry about my fault.\ud83d\ude1e\n\nUsing udevadm test to verify this symptom\n```\nroot@evb-npcm845:/# udevadm test /sys/class/net/eth0\nsd-device: Failed to chase symlinks in \"/sys/class/net/eth0\".\nFailed to open device '/sys/class/net/eth0': No such device\n\nroot@evb-npcm845:/# udevadm test /sys/class/net/end0\nend0: sd-device: Created db file '/run/udev/data/n2' for '/devices/platform/ahb/f0802000.eth/net/end0'\nDEVPATH=/devices/platform/ahb/f0802000.eth/net/end0\nINTERFACE=end0\nIFINDEX=2\nACTION=add\nSUBSYSTEM=net\nTAGS=:systemd:\nID_NET_DRIVER=st_gmac\nID_NET_NAMING_SCHEME=v255\nID_NET_NAME_MAC=enx0000f7a000fc\nID_NET_NAME_ONBOARD=end0\nID_PATH=platform-f0802000.eth\nID_PATH_TAG=platform-f0802000_eth\nID_NET_LINK_FILE=/usr/lib/systemd/network/99-default.link\nID_NET_NAME=end0\nCURRENT_TAGS=:systemd:\nSYSTEMD_ALIAS=/sys/subsystem/net/devices/end0\nUSEC_INITIALIZED=48075231\nrun: '/usr/lib/systemd/systemd-sysctl --prefix=/net/ipv4/conf/end0 --prefix=/net/ipv4/neigh/end0 --prefix=/net/ipv6/conf/end0 --prefix=/net/ipv6/neigh/end0'\nUnloaded link configuration context\n```"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Benjamin Fair",
                        "email": "benjaminfair@google.com",
                        "username": "BenjaminFair"
                    },
                    "message": "Just using PACKAGECONFIG may not be enough, since I see other references to it in the codebase. Please try with it as a DISTRO_FEATURE just to make sure"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "chli30@nuvoton.com",
                        "username": "timlee66"
                    },
                    "message": "Thanks for your information. I have tried with DISTRO_FEATURES, but still got `end` naming. Thus, still need to add `85-persistent-net.rules` to use `eth` naming.\n\nHere was I added for test: `DISTRO_FEATURES:append = \" pni-names\"`"
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-core/systemd/systemd_%.bbappend",
                    "line": 0,
                    "reviewer": {
                        "name": "Benjamin Fair",
                        "email": "benjaminfair@google.com",
                        "username": "BenjaminFair"
                    },
                    "message": "It might be better to ship this as its own package instead of an addition to systemd itself"
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-core/systemd/systemd_%.bbappend",
                    "line": 0,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "chli30@nuvoton.com",
                        "username": "timlee66"
                    },
                    "message": "Did you means that I need to ship this to `udev` package? If not, could you help to point which package? Thanks."
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-core/systemd/systemd_%.bbappend",
                    "line": 0,
                    "reviewer": {
                        "name": "Benjamin Fair",
                        "email": "benjaminfair@google.com",
                        "username": "BenjaminFair"
                    },
                    "message": "My suggestion was to create a new package (bb file) with just this file"
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-core/systemd/systemd_%.bbappend",
                    "line": 0,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "chli30@nuvoton.com",
                        "username": "timlee66"
                    },
                    "message": "Thanks for your suggestion, I have created a new bb file with this rule, please help to review it again. Thank you."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 24,
                    "deletions": 0
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-core/systemd/systemd/85-persistent-net.rules",
                    "type": "ADDED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-core/systemd/systemd_%.bbappend",
                    "type": "ADDED",
                    "insertions": 7,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 37,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "594f549dd4243931b4446ece6e4aaf9b3fd36604",
            "parents": [
                "2850a8adcf834b17518801e0c615a670e83de1af"
            ],
            "ref": "refs/changes/55/70755/3",
            "uploader": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "createdOn": 1718586592,
            "author": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Tim Lee",
                        "email": "chli30@nuvoton.com",
                        "username": "timlee66"
                    },
                    "message": "Hi Benjamin,\nThanks for your suggestion, I have created a new bb file with this rule, please help to review it again. Thank you so much."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 24,
                    "deletions": 0
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-phosphor/network/persistent-net-name.bb",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-phosphor/network/persistent-net-name/85-persistent-net.rules",
                    "type": "ADDED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-evb-npcm845/packagegroups/packagegroup-evb-npcm845-apps.bb",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 46,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "5c3e81ef1520e2a8dfb5bf738f310833700a161d",
            "parents": [
                "321dc71562c528d18afc431eee844984f1ea9e9a"
            ],
            "ref": "refs/changes/55/70755/4",
            "uploader": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "createdOn": 1721007905,
            "author": {
                "name": "Tim Lee",
                "email": "chli30@nuvoton.com",
                "username": "timlee66"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 24,
                    "deletions": 0
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-phosphor/network/persistent-net-name.bb",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-phosphor/network/persistent-net-name/85-persistent-net.rules",
                    "type": "ADDED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "meta-nuvoton/meta-evb-npcm845/recipes-evb-npcm845/packagegroups/packagegroup-evb-npcm845-apps.bb",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 46,
            "sizeDeletions": 0
        }
    ]
}