{
    "project": "openbmc/openpower-debug-collector",
    "branch": "master",
    "id": "I7245fef1639299bf501667eef48e275a93307c00",
    "number": 51719,
    "subject": "Request hostboot dump when Host State is 'Running'",
    "owner": {
        "name": "Shantappa Teekappanavar",
        "email": "shantappa.teekappanavar@ibm.com",
        "username": "sbteeks"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openpower-debug-collector/+/51719",
    "hashtags": [],
    "createdOn": 1646354184,
    "lastUpdated": 1667977696,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1646354184,
            "reviewer": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1646354194,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1646354194,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1646354236,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/38432/ : SUCCESS"
        },
        {
            "timestamp": 1646726699,
            "reviewer": {
                "name": "MARRI DEVENDER RAO",
                "email": "devenrao@in.ibm.com",
                "username": "devenrao"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(3 comments)"
        },
        {
            "timestamp": 1646753474,
            "reviewer": {
                "name": "Jayanth Othayoth",
                "email": "ojayanth@gmail.com",
                "username": "ojayanth"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1646757110,
            "reviewer": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1646757118,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1646757118,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1646757161,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/38654/ : SUCCESS"
        },
        {
            "timestamp": 1646757284,
            "reviewer": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "message": "Uploaded patch set 3: Commit message was updated."
        },
        {
            "timestamp": 1646757368,
            "reviewer": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "message": "Patch Set 3:\n\n(4 comments)"
        },
        {
            "timestamp": 1646841743,
            "reviewer": {
                "name": "MARRI DEVENDER RAO",
                "email": "devenrao@in.ibm.com",
                "username": "devenrao"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1665161991,
            "reviewer": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "message": "Uploaded patch set 4: Patch Set 3 was rebased."
        },
        {
            "timestamp": 1665162034,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1665162034,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1665162066,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/53168/ : SUCCESS"
        },
        {
            "timestamp": 1665162193,
            "reviewer": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1665466642,
            "reviewer": {
                "name": "Jayanth Othayoth",
                "email": "ojayanth@gmail.com",
                "username": "ojayanth"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1665509654,
            "reviewer": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1666638002,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Patch Set 4: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1667576667,
            "reviewer": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1667977683,
            "reviewer": {
                "name": "Jayanth Othayoth",
                "email": "ojayanth@gmail.com",
                "username": "ojayanth"
            },
            "message": "Patch Set 4: Code-Review+2"
        },
        {
            "timestamp": 1667977696,
            "reviewer": {
                "name": "Jayanth Othayoth",
                "email": "ojayanth@gmail.com",
                "username": "ojayanth"
            },
            "message": "Change has been successfully rebased and submitted as e6978e5be71db00f8750db30677df78851c97736"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "330e6c5027aa63dd580d49e5bde6da43fb2deb7e",
            "parents": [
                "b64983f0c1cc04a64082f6096f6a2e1e40223968"
            ],
            "ref": "refs/changes/19/51719/1",
            "uploader": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "createdOn": 1646354184,
            "author": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 16,
                    "reviewer": {
                        "name": "Jayanth Othayoth",
                        "email": "ojayanth@gmail.com",
                        "username": "ojayanth"
                    },
                    "message": "Please remove internal system names from from commit message use <xxxx>"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 16,
                    "reviewer": {
                        "name": "Shantappa Teekappanavar",
                        "email": "shantappa.teekappanavar@ibm.com",
                        "username": "sbteeks"
                    },
                    "message": "Done"
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "line": 158,
                    "reviewer": {
                        "name": "MARRI DEVENDER RAO",
                        "email": "devenrao@in.ibm.com",
                        "username": "devenrao"
                    },
                    "message": "return true;"
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "line": 158,
                    "reviewer": {
                        "name": "Shantappa Teekappanavar",
                        "email": "shantappa.teekappanavar@ibm.com",
                        "username": "sbteeks"
                    },
                    "message": "Done"
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "line": 161,
                    "reviewer": {
                        "name": "MARRI DEVENDER RAO",
                        "email": "devenrao@in.ibm.com",
                        "username": "devenrao"
                    },
                    "message": "we should be using this  const sdbusplus::exception::exception&"
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "line": 161,
                    "reviewer": {
                        "name": "Shantappa Teekappanavar",
                        "email": "shantappa.teekappanavar@ibm.com",
                        "username": "sbteeks"
                    },
                    "message": "Done"
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "line": 170,
                    "reviewer": {
                        "name": "MARRI DEVENDER RAO",
                        "email": "devenrao@in.ibm.com",
                        "username": "devenrao"
                    },
                    "message": "return false;\n\nno need to create a new variable."
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "line": 170,
                    "reviewer": {
                        "name": "Shantappa Teekappanavar",
                        "email": "shantappa.teekappanavar@ibm.com",
                        "username": "sbteeks"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 40,
                    "deletions": 0
                },
                {
                    "file": "watchdog_timeout.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "watchdog/watchdog_dbus.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "type": "MODIFIED",
                    "insertions": 41,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "2108a601dea296351e78b41c95279584f1e4625e",
            "parents": [
                "b64983f0c1cc04a64082f6096f6a2e1e40223968"
            ],
            "ref": "refs/changes/19/51719/2",
            "uploader": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "createdOn": 1646757110,
            "author": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 40,
                    "deletions": 0
                },
                {
                    "file": "watchdog_timeout.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "watchdog/watchdog_dbus.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "type": "MODIFIED",
                    "insertions": 40,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 96,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "84413282e5c54ff10cae00223982d2178e0729fc",
            "parents": [
                "b64983f0c1cc04a64082f6096f6a2e1e40223968"
            ],
            "ref": "refs/changes/19/51719/3",
            "uploader": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "createdOn": 1646757284,
            "author": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 40,
                    "deletions": 0
                },
                {
                    "file": "watchdog_timeout.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "watchdog/watchdog_dbus.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "type": "MODIFIED",
                    "insertions": 40,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 96,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "987e3b556c1c1ed8ddfa97c4059beb549e608381",
            "parents": [
                "eebcf900a23b41df24d0985240a4da83bffa8a54"
            ],
            "ref": "refs/changes/19/51719/4",
            "uploader": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "createdOn": 1665161991,
            "author": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 14,
                    "reviewer": {
                        "name": "Jayanth Othayoth",
                        "email": "ojayanth@gmail.com",
                        "username": "ojayanth"
                    },
                    "message": "I think design assumption is to start watchdog when host state moved to running and and once the boot is completed or failed, disable watchdiog right? if this design assumption is true why we need extra check here?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 14,
                    "reviewer": {
                        "name": "Shantappa Teekappanavar",
                        "email": "shantappa.teekappanavar@ibm.com",
                        "username": "sbteeks"
                    },
                    "message": "It appears that when HW dump is initiated, the current host state is very likely goes to 'Quiesced' state, and there is no need to initiate hostboot dump. This commit basically blocks creating the dump.\n\nAndrew is the one who asked me to make this change, so he can provide a better answer - hopefully he still remembers why we needed this as we are back to review here after several months \ud83d\ude0a"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 14,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "andrew@geissonator.com",
                        "username": "geissonator"
                    },
                    "message": "Yeah, there was a window of time where a host TI or crash can occur and PRD put system into Quiesce state but has not run the host-stop target to cause the host watchdog service to stop. Both the watchdog and TI paths put system in Quiesce state so we can't stop the watchdog on that (or it would be stopping itself before done) so we need a check like this to prevent the watchdog from requesting a dump in parallel with PRD."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 14,
                    "reviewer": {
                        "name": "Shantappa Teekappanavar",
                        "email": "shantappa.teekappanavar@ibm.com",
                        "username": "sbteeks"
                    },
                    "message": "Jayanth, can you please reply to Andrew's comment if you still have concerns?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Shantappa Teekappanavar",
                        "email": "shantappa.teekappanavar@ibm.com",
                        "username": "sbteeks"
                    },
                    "message": "Fixed merge conflict..."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 40,
                    "deletions": 0
                },
                {
                    "file": "watchdog_timeout.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "watchdog/watchdog_dbus.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "type": "MODIFIED",
                    "insertions": 40,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 96,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "e6978e5be71db00f8750db30677df78851c97736",
            "parents": [
                "7f3e906b4c80a7c3080f09b92c6e2842b2d58a1d"
            ],
            "ref": "refs/changes/19/51719/5",
            "uploader": {
                "name": "Jayanth Othayoth",
                "email": "ojayanth@gmail.com",
                "username": "ojayanth"
            },
            "createdOn": 1667977696,
            "author": {
                "name": "Shantappa Teekappanavar",
                "email": "shantappa.teekappanavar@ibm.com",
                "username": "sbteeks"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 40,
                    "deletions": 0
                },
                {
                    "file": "watchdog_timeout.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "watchdog/watchdog_dbus.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "watchdog/watchdog_dbus.cpp",
                    "type": "MODIFIED",
                    "insertions": 40,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 96,
            "sizeDeletions": 0
        }
    ]
}