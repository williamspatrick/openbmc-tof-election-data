{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I5d6267332b7b97c11f638850108e671d0baa26fd",
    "number": 59723,
    "subject": "Removed checking cookie in mTLS authentication",
    "owner": {
        "name": "Boles\u0142aw Ogo\u0144czyk M\u0105kowski",
        "email": "boleslawx.ogonczyk-makowski@intel.com",
        "username": "bogonczx"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/59723",
    "hashtags": [],
    "createdOn": 1671101316,
    "lastUpdated": 1673288254,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1671101316,
            "reviewer": {
                "name": "Boles\u0142aw Ogo\u0144czyk M\u0105kowski",
                "email": "boleslawx.ogonczyk-makowski@intel.com",
                "username": "bogonczx"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1671101344,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1671101344,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1671103056,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/57838/ : SUCCESS"
        },
        {
            "timestamp": 1671139419,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1671183147,
            "reviewer": {
                "name": "Boles\u0142aw Ogo\u0144czyk M\u0105kowski",
                "email": "boleslawx.ogonczyk-makowski@intel.com",
                "username": "bogonczx"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1671562444,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1671634594,
            "reviewer": {
                "name": "Boles\u0142aw Ogo\u0144czyk M\u0105kowski",
                "email": "boleslawx.ogonczyk-makowski@intel.com",
                "username": "bogonczx"
            },
            "message": "Uploaded patch set 2: Commit message was updated."
        },
        {
            "timestamp": 1671634617,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1"
        },
        {
            "timestamp": 1671634624,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1671634624,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1671634666,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/58164/ : FAILURE"
        },
        {
            "timestamp": 1671635069,
            "reviewer": {
                "name": "Boles\u0142aw Ogo\u0144czyk M\u0105kowski",
                "email": "boleslawx.ogonczyk-makowski@intel.com",
                "username": "bogonczx"
            },
            "message": "Patch Set 3: Patch Set 2 was rebased"
        },
        {
            "timestamp": 1671635099,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1671635099,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1671636723,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/58165/ : SUCCESS"
        },
        {
            "timestamp": 1673288254,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(8 comments)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "fcbe7e0a484ef8d6b1a2360f2bcc466cc9708516",
            "parents": [
                "0fb5b5051bebfe1330627a02d8f7c83195f71ed3"
            ],
            "ref": "refs/changes/23/59723/1",
            "uploader": {
                "name": "Boles\u0142aw Ogo\u0144czyk M\u0105kowski",
                "email": "boleslawx.ogonczyk-makowski@intel.com",
                "username": "bogonczx"
            },
            "createdOn": 1671101316,
            "author": {
                "name": "kniczyji",
                "email": "karol.niczyj@intel.com",
                "username": "kniczyji"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Needs more context here.  Why is this change needed?  What result are you trying to achieve?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Boles\u0142aw Ogo\u0144czyk M\u0105kowski",
                        "email": "boleslawx.ogonczyk-makowski@intel.com",
                        "username": "bogonczx"
                    },
                    "message": "It was our internal fix for a bug with these reproduction steps:\n\nCreate two users: read_only with read_only privilege and admin with administrator privilege\nGet X-Auth-Token for admin user by sending POST request to BMC:\n\ncurl -k -X POST -d '{\"UserName\": \"admin\", \"Password\": \"donotchange\"}' https://BMC_IP/redfish/v1/SessionService/Sessions -H \"Content-Type: application/json\" -D headers_file.txt\n\nX-Auth-Token is incorporated in headers_file.txt\nPrepare CA and user certificate for read_only user\nAdd CA certificate to BMC\nExecute following request to BMC:\n\ncurl -k --cert user.pem --key user_key.pem -H \"Connection: keep-alive\" -H \"Cookie: SESSION=admin_x-auth-token\" -A \"abc\" https://BMC_IP/redfish/v1/AccountService/Accounts/admin\n\nCurrent results:\nFor request from last step BMC response is success - 200 OK\nSuccessful response is possible due to adding cookie header (with valid admin user X-Auth-Token) and nonempty User-Agent header\nThis is unexpected behavior which should be fixed\n\nExpected results:\nMTLS authentication passes - it can be confirmed because session for read_only user is created.\nAccountService/Accounts/admin resource should not be accessible by user with read_only privileges, expected response here is 403 - Forbidden"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please add more details to your commit message, not in a gerrit comment.  I will respond once details are added there."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Which ones?  WHat are the tests doing?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Boles\u0142aw Ogo\u0144czyk M\u0105kowski",
                        "email": "boleslawx.ogonczyk-makowski@intel.com",
                        "username": "bogonczx"
                    },
                    "message": "The tests check various authorization scenarios and situation described in my reply above wasn't passing one without this change."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please update your commit message with which tests were run."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "include/authentication.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -16
                }
            ],
            "sizeInsertions": 25,
            "sizeDeletions": 16
        },
        {
            "number": 2,
            "revision": "43468e24ede2ca26719b6ba0252492133260ec06",
            "parents": [
                "0fb5b5051bebfe1330627a02d8f7c83195f71ed3"
            ],
            "ref": "refs/changes/23/59723/2",
            "uploader": {
                "name": "Boles\u0142aw Ogo\u0144czyk M\u0105kowski",
                "email": "boleslawx.ogonczyk-makowski@intel.com",
                "username": "bogonczx"
            },
            "createdOn": 1671634594,
            "author": {
                "name": "kniczyji",
                "email": "karol.niczyj@intel.com",
                "username": "kniczyji"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 42,
                    "deletions": 0
                },
                {
                    "file": "include/authentication.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -16
                }
            ],
            "sizeInsertions": 52,
            "sizeDeletions": 16
        },
        {
            "number": 3,
            "revision": "97e010ce5b47cff7982be36d9a7958eaebee7945",
            "parents": [
                "6dcbb8675d5c5765c3e53354b8f3b339effecd44"
            ],
            "ref": "refs/changes/23/59723/3",
            "uploader": {
                "name": "Boles\u0142aw Ogo\u0144czyk M\u0105kowski",
                "email": "boleslawx.ogonczyk-makowski@intel.com",
                "username": "bogonczx"
            },
            "createdOn": 1671635069,
            "author": {
                "name": "kniczyji",
                "email": "karol.niczyj@intel.com",
                "username": "kniczyji"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "what does \"highest priority\" mean in this context.  It's not clear."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Per the developing guide, please word wrap 50/72."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Can you convey in your commit message why this is a problem.  If the user has access to multiple credentials, is there a problem if we use the highest one they posess?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 33,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I'm not following here.  You're using the admins session, isn't it expected that you get the admins privilege level?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 37,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "If anything we should be giving bad-request if we don't allow using two different forms of valid credentials."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Based on the code, this looks fine.  Get your commit message cleaned up per the developing guide, and we'll get this on."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 42,
                    "deletions": 0
                },
                {
                    "file": "include/authentication.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -16
                }
            ],
            "sizeInsertions": 52,
            "sizeDeletions": 16
        }
    ]
}