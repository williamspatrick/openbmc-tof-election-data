{
    "project": "openbmc/openbmc-test-automation",
    "branch": "master",
    "id": "Iaf66e46f0144b35687a5c250ab66da5cf27919db",
    "number": 58926,
    "subject": "openpower: Support sensors DBUS path check at runtime",
    "owner": {
        "name": "George Keishing",
        "email": "gkeishin@gmail.com",
        "username": "gkeishin"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openbmc-test-automation/+/58926",
    "hashtags": [],
    "createdOn": 1669213666,
    "lastUpdated": 1670858548,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1669213666,
            "reviewer": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1669213697,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1669213698,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1669213719,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/56014/ : SUCCESS"
        },
        {
            "timestamp": 1669798641,
            "reviewer": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "message": "Uploaded patch set 2: Patch Set 1 was rebased."
        },
        {
            "timestamp": 1669798663,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1669798663,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1669798684,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/56351/ : SUCCESS"
        },
        {
            "timestamp": 1670319029,
            "reviewer": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "message": "Uploaded patch set 3: Patch Set 2 was rebased."
        },
        {
            "timestamp": 1670319042,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1670319042,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1670319063,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/56780/ : SUCCESS"
        },
        {
            "timestamp": 1670515694,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1670833806,
            "reviewer": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1670834034,
            "reviewer": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1670834047,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1670834047,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1670834073,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/57474/ : SUCCESS"
        },
        {
            "timestamp": 1670858001,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 4: Code-Review+1\n\n(2 comments)"
        },
        {
            "timestamp": 1670858545,
            "reviewer": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "message": "Patch Set 4: Code-Review+2"
        },
        {
            "timestamp": 1670858548,
            "reviewer": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "message": "Change has been successfully rebased and submitted as d1baad62d63e524606534a53078e6f8246c5492c"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "46d3dc2280b3172c4f803ef0ab9f132bb20656b0",
            "parents": [
                "d3b3fcd173c251be7cff633748a976cff09e267c"
            ],
            "ref": "refs/changes/26/58926/1",
            "uploader": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "createdOn": 1669213666,
            "author": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "data/sensor_dbus.json",
                    "type": "ADDED",
                    "insertions": 60,
                    "deletions": 0
                },
                {
                    "file": "lib/open_power_utils.robot",
                    "type": "MODIFIED",
                    "insertions": 93,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 172,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "9febeb7943f9a4a408bca17a9ddf420e036f1a44",
            "parents": [
                "5636ad12be3cac3f3985e78eaf2dbd7fb50c1b37"
            ],
            "ref": "refs/changes/26/58926/2",
            "uploader": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "createdOn": 1669798641,
            "author": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "data/sensor_dbus.json",
                    "type": "ADDED",
                    "insertions": 60,
                    "deletions": 0
                },
                {
                    "file": "lib/open_power_utils.robot",
                    "type": "MODIFIED",
                    "insertions": 93,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 172,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "e105695d7aabda0980e19c87515a94f1df2218b3",
            "parents": [
                "849189c9873930a4d2c00a840ad66421a17e2c9b"
            ],
            "ref": "refs/changes/26/58926/3",
            "uploader": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "createdOn": 1670319029,
            "author": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "data/sensor_dbus.json",
                    "line": 9,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "so we can get something  maybe just remove the NVMe_JBOF cards and PCIE_Cable_Card entries, since they may be different per system."
                },
                {
                    "file": "data/sensor_dbus.json",
                    "line": 9,
                    "reviewer": {
                        "name": "George Keishing",
                        "email": "gkeishin@gmail.com",
                        "username": "gkeishin"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "data/sensor_dbus.json",
                    "type": "ADDED",
                    "insertions": 60,
                    "deletions": 0
                },
                {
                    "file": "lib/open_power_utils.robot",
                    "type": "MODIFIED",
                    "insertions": 93,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 172,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "289a54d32dafffc6ac9e5b2f1ff26f4cec9025a1",
            "parents": [
                "395f880470b20f7b1a3e1f0e52b57b7e678ed8c8"
            ],
            "ref": "refs/changes/26/58926/4",
            "uploader": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "createdOn": 1670834034,
            "author": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "I don't know too much about robot, but at a high level it seems to do what we want."
                },
                {
                    "file": "lib/open_power_utils.robot",
                    "line": 317,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "If you didn't want to hardcode the possible service names, you could look them up with a call to the mapper, like:\n\n# busctl call xyz.openbmc_project.ObjectMapper /xyz/openbmc_project/object_mapper xyz.openbmc_project.ObjectMapper GetObject sas /xyz/openbmc_project/sensors/temperature/Ambient_0_Temp 1 xyz.openbmc_project.Sensor.Value  -j\n{\n\t\"type\" : \"a{sas}\",\n\t\"data\" : [\n\t\t{\n\t\t\t\"xyz.openbmc_project.HwmonTempSensor\" : [\n\t\t\t\t\"xyz.openbmc_project.Association.Definitions\",\n\t\t\t\t\"xyz.openbmc_project.Sensor.Threshold.Warning\",\n\t\t\t\t\"xyz.openbmc_project.Sensor.Value\",\n\t\t\t\t\"xyz.openbmc_project.State.Decorator.Availability\",\n\t\t\t\t\"xyz.openbmc_project.State.Decorator.OperationalStatus\"\n\t\t\t]\n\t\t}\n\t]\n}\n\n\nyou could also get back the service names of all the sensors in the system at once with:\nbusctl call xyz.openbmc_project.ObjectMapper /xyz/openbmc_project/object_mapper xyz.openbmc_project.ObjectMapper GetSubTree sias /xyz/openbmc_project/sensors 0 1 xyz.openbmc_project.Sensor.Value -j\n\nThis would entail having to read the JSON response to find what you needed though, so I'm fine with what you have.  (Though there are more sensor daemons in the system so if someone else put a sensor  in the JSON file not in any of these 3 daemons they'd have to make an update here."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "data/sensor_dbus.json",
                    "type": "ADDED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "lib/open_power_utils.robot",
                    "type": "MODIFIED",
                    "insertions": 93,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 124,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "d1baad62d63e524606534a53078e6f8246c5492c",
            "parents": [
                "789c802147ec1aa2c0519f2f0bc21b67c67224cb"
            ],
            "ref": "refs/changes/26/58926/5",
            "uploader": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "createdOn": 1670858548,
            "author": {
                "name": "George Keishing",
                "email": "gkeishin@gmail.com",
                "username": "gkeishin"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "data/sensor_dbus.json",
                    "type": "ADDED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "lib/open_power_utils.robot",
                    "type": "MODIFIED",
                    "insertions": 93,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 124,
            "sizeDeletions": 0
        }
    ]
}