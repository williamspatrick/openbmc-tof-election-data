{
    "project": "openbmc/docs",
    "branch": "master",
    "id": "I64b1ed3470b19faae131e9b2292338cf15b56502",
    "number": 53705,
    "subject": "Decrease pain in OBMC Qemu doc workflow",
    "owner": {
        "name": "Cody Smith",
        "email": "scody@google.com",
        "username": "csmith105"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/docs/+/53705",
    "hashtags": [],
    "createdOn": 1652396136,
    "lastUpdated": 1665657883,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1652396136,
            "reviewer": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1652401272,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(1 comment)"
        },
        {
            "timestamp": 1652451978,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "andrew@geissonator.com",
                "username": "geissonator"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1652726608,
            "reviewer": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1652726705,
            "reviewer": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1652726875,
            "reviewer": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1652736441,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1652736968,
            "reviewer": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1652791223,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3:\n\n(3 comments)"
        },
        {
            "timestamp": 1652805767,
            "reviewer": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "message": "Patch Set 4: Published edit on patch set 3."
        },
        {
            "timestamp": 1652806368,
            "reviewer": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "message": "Patch Set 5: Published edit on patch set 4."
        },
        {
            "timestamp": 1652806455,
            "reviewer": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "message": "Patch Set 5:\n\n(3 comments)"
        },
        {
            "timestamp": 1652829823,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1652830081,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5:\n\n(2 comments)"
        },
        {
            "timestamp": 1652835220,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1652876276,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1653264518,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1658342865,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1658372232,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1658421721,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5:\n\n(3 comments)"
        },
        {
            "timestamp": 1658450709,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1658598572,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1665657883,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Abandoned\n\nclose due to inactivity"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "2163d8014bdf820e77176340a621c767c359d9ec",
            "parents": [
                "9915e5d21d3009eab284b321fef46f9301a13206"
            ],
            "ref": "refs/changes/05/53705/1",
            "uploader": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "createdOn": 1652396136,
            "author": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "I think you're misunderstanding the point of this document? It's meant to document a development workflow, not *just* how to use qemu. Also hy are you deleting the informat on SoC-specific qemu models?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Cody Smith",
                        "email": "scody@google.com",
                        "username": "csmith105"
                    },
                    "message": "I spoke to Ed about this after attempting to legitimately use these instructions to get going with Qemu / OpenBMC development. He assured me this documentation is out of date and overly difficult, and subsequently showed me the `source oe-init-build-env build` and `runqemu nographic` workflow.\n\nTo address your comments, I have now moved the lost material to the sdk readme."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "First of all..... I told you that there were still people that used the SDK, so we probably shouldn't delete that section......  Sorry, but the \"Ed says\" thing triggered me a little \ud83d\ude04\n\nI haven't looked at these docs, but Cody is essentially documenting the improvements that Yocto has made to this workflow, and should still meet the use cases for most people, but if there are concerns about changing, we could leave the \"old\" qemu workflows around, and note that they might not be the most efficient given that yocto has first class qemu support these days, including building and running it with a minimum of boilerplate.\n\nJust thinking out loud.  FWIW, the commands cody is replacing are what I've been doing for some time, and remove a lot of the complexities out of these instructions, at least for me."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Cody Smith",
                        "email": "scody@google.com",
                        "username": "csmith105"
                    },
                    "message": "Ack"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Cody Smith",
                        "email": "scody@google.com",
                        "username": "csmith105"
                    },
                    "message": "Ack"
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 79,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "andrew@geissonator.com",
                        "username": "geissonator"
                    },
                    "message": "I'm not a big fan of the SDK, and I'd be ok if we moved this to a separate doc and encouraged people to instead utilize devtool (and provided all of the devtool steps in this doc). But yeah, I don't think we should just delete this info. A lot of people still use the SDK to build and test their code."
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 79,
                    "reviewer": {
                        "name": "Cody Smith",
                        "email": "scody@google.com",
                        "username": "csmith105"
                    },
                    "message": "Moved to sdk.md"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "development/dev-environment.md",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -134
                }
            ],
            "sizeInsertions": 35,
            "sizeDeletions": 134
        },
        {
            "number": 2,
            "revision": "a8432988e82c99cc3909e7f7a40c79e4f8f5ba45",
            "parents": [
                "9915e5d21d3009eab284b321fef46f9301a13206"
            ],
            "ref": "refs/changes/05/53705/2",
            "uploader": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "createdOn": 1652726608,
            "author": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "development/README.md",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                },
                {
                    "file": "development/sdk-hello-world.md",
                    "type": "DELETED",
                    "insertions": 0,
                    "deletions": -126
                },
                {
                    "file": "development/sdk.md",
                    "type": "ADDED",
                    "insertions": 286,
                    "deletions": 0
                },
                {
                    "file": "development/dev-environment.md",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -134
                }
            ],
            "sizeInsertions": 326,
            "sizeDeletions": 260
        },
        {
            "number": 3,
            "revision": "5304382ebcee9c8654bac06576f13f4ff3630930",
            "parents": [
                "9915e5d21d3009eab284b321fef46f9301a13206"
            ],
            "ref": "refs/changes/05/53705/3",
            "uploader": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "createdOn": 1652726875,
            "author": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "development/dev-environment.md",
                    "line": 81,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Why?"
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 81,
                    "reviewer": {
                        "name": "Cody Smith",
                        "email": "scody@google.com",
                        "username": "csmith105"
                    },
                    "message": "That's part of my workflow that leaked in, my apologies."
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 93,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "In what machines does this actually work?  I've never seen it work.\n\n```\n$ runqemu nographic\nrunqemu - INFO - Running bitbake -e ...\nls: cannot access '/home/apwillia/local/builds/lf-build-bletchley/tmp/deploy/images/bletchley/*.qemuboot.conf': No such file or directory\nrunqemu - ERROR - Command 'ls -t /home/apwillia/local/builds/lf-build-bletchley/tmp/deploy/images/bletchley/*.qemuboot.conf' returned non-zero exit status 2.\nrunqemu - INFO - Cleaning up\n```\n\nHow do you set up port forwarding?"
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 93,
                    "reviewer": {
                        "name": "Cody Smith",
                        "email": "scody@google.com",
                        "username": "csmith105"
                    },
                    "message": "```\n# Init repo\ncd /opt/bmc/\ngit clone git@github.com:openbmc/openbmc.git\n\n# Source repo openbmc\ncd /opt/bmc/openbmc && source oe-init-build-env build && umask 022\n\n# Build\nbitbake obmc-phosphor-image\n\n# Launch Qemu with a built image (Romulus)\nrunqemu nographic qemuparams=\"-m 2048\"\n```\nWorks fine for me on a vanilla OpenBMC repo. These are essentially the same instructions now in this doc."
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 93,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "I don't know of anyone who's done the integration work to make the qemu machine model match the bitbake build target. Are you sure you were running the romulus-bmc machine model? How did you check?\n\nThis has been on my todo list since I wrote the original qemu models \ud83d\ude0a"
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 93,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> I don't know of anyone who's done the integration work to make the qemu machine model match the bitbake build target.\n\nFor a lot of userspace code, the actual \"model\" doesn't really matter.  I've been running qemuarm (which admittedly, has some ipmi issues) for testing for a while.\n\n> Are you sure you were running the romulus-bmc machine model? How did you check?\n> \n> This has been on my todo list since I wrote the original qemu models \ud83d\ude0a"
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 93,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Right, so I guess it's a matter of what we're trying to achieve with this documentation? Whatever it is, it feels like we're changing it here?"
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 93,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Can we fix the runqemu configs of the platforms that have corresponding qemu machine models? For machines that don't then maybe use the corresponding EVB or failing that, the vexpress model?"
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 93,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> Can we fix the runqemu configs of the platforms that have corresponding qemu machine models?\n\nYes, we should do that, but I'm at a loss for where to even start to effect that change.  If anyone has a hint to start, it might help.\n\n> For machines that don't then maybe use the corresponding EVB or failing that, the vexpress model?\n\nSeems reasonable."
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 93,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "> Yes, we should do that, but I'm at a loss for where to even start to effect that change.  If anyone has a hint to start, it might help.\n\nThat's what this is: https://gerrit.openbmc.org/q/topic:aspeed-runqemu"
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 93,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "ACK."
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 103,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Where am I running this?  Why is it necessary?  How do you know 7.2 is \"right\"?"
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 103,
                    "reviewer": {
                        "name": "Cody Smith",
                        "email": "scody@google.com",
                        "username": "csmith105"
                    },
                    "message": "Made this section of the doc more verbose addressing your issues."
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 103,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "FWIW, in theory the runqemu script sets this NIC up for us, but some combination of our usage of systemd and/or phosphor-networkd seems to override that."
                },
                {
                    "file": "development/dev-environment.md",
                    "line": 103,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "PS, 7.2 is the default from qemu, we're just re-setting it because phosphor-network ignores the qemu configs.  In theory this could be fixed at some point."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "development/README.md",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "development/sdk-hello-world.md",
                    "type": "DELETED",
                    "insertions": 0,
                    "deletions": -126
                },
                {
                    "file": "development/sdk.md",
                    "type": "ADDED",
                    "insertions": 286,
                    "deletions": 0
                },
                {
                    "file": "development/dev-environment.md",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -134
                }
            ],
            "sizeInsertions": 325,
            "sizeDeletions": 264
        },
        {
            "number": 4,
            "revision": "2cc2847274d5a1ec9f1da5fa6d64efe267868d70",
            "parents": [
                "9915e5d21d3009eab284b321fef46f9301a13206"
            ],
            "ref": "refs/changes/05/53705/4",
            "uploader": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "createdOn": 1652805767,
            "author": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "development/README.md",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "development/sdk-hello-world.md",
                    "type": "DELETED",
                    "insertions": 0,
                    "deletions": -126
                },
                {
                    "file": "development/sdk.md",
                    "type": "ADDED",
                    "insertions": 286,
                    "deletions": 0
                },
                {
                    "file": "development/dev-environment.md",
                    "type": "MODIFIED",
                    "insertions": 27,
                    "deletions": -134
                }
            ],
            "sizeInsertions": 331,
            "sizeDeletions": 264
        },
        {
            "number": 5,
            "revision": "56400541e1c179c10e42403cea33ec239d86be18",
            "parents": [
                "9915e5d21d3009eab284b321fef46f9301a13206"
            ],
            "ref": "refs/changes/05/53705/5",
            "uploader": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "createdOn": 1652806368,
            "author": {
                "name": "Cody Smith",
                "email": "scody@google.com",
                "username": "csmith105"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Comment removed by: Andrew Jeffery; Reason: Should have replied to the thread"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Is there work to be done on this or should it be abandoned?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "It at least needs to be reworked given we now have this series: https://gerrit.openbmc.org/q/topic:aspeed-runqemu \ud83c\udf89"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "WOOT!"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "development/README.md",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "development/sdk-hello-world.md",
                    "type": "DELETED",
                    "insertions": 0,
                    "deletions": -126
                },
                {
                    "file": "development/sdk.md",
                    "type": "ADDED",
                    "insertions": 286,
                    "deletions": 0
                },
                {
                    "file": "development/dev-environment.md",
                    "type": "MODIFIED",
                    "insertions": 28,
                    "deletions": -134
                }
            ],
            "sizeInsertions": 332,
            "sizeDeletions": 264
        }
    ]
}