{
    "project": "openbmc/docs",
    "branch": "master",
    "topic": "gpio-naming-x86",
    "id": "Ia2a85ae1dee4f9821a6dff1c5bff654e271af6f3",
    "number": 49863,
    "subject": "gpio-naming: add x86 power control pins",
    "owner": {
        "name": "Andrei Kartashev",
        "email": "a.kartashev@yadro.com",
        "username": "alatarum"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/docs/+/49863",
    "hashtags": [],
    "createdOn": 1640081527,
    "lastUpdated": 1665657886,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1640081527,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1640082611,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Topic set to gpio-naming-x86"
        },
        {
            "timestamp": 1640093960,
            "reviewer": {
                "name": "Alexander Filippov",
                "email": "a.filippov@yadro.com",
                "username": "nest1ing"
            },
            "message": "Patch Set 1: Code-Review+1"
        },
        {
            "timestamp": 1640096240,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "miltonm@us.ibm.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(4 comments)"
        },
        {
            "timestamp": 1640098909,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Patch Set 1:\n\n(4 comments)"
        },
        {
            "timestamp": 1641801531,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1641855081,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(5 comments)"
        },
        {
            "timestamp": 1641880840,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Patch Set 1:\n\n(5 comments)"
        },
        {
            "timestamp": 1641883043,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1641883100,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Patch Set 2:\n\n(5 comments)"
        },
        {
            "timestamp": 1642030282,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1642061007,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1644079626,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1655237644,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1655727623,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1655727658,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1655753255,
            "reviewer": {
                "name": "Zev Weiss",
                "email": "zev@bewilderbeest.net",
                "username": "zevweiss"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1655973996,
            "reviewer": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1658605880,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1665657886,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Abandoned\n\nclose due to inactivity"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "2baaa97c6184a70c5fecf86ba446470d7b18ae12",
            "parents": [
                "9de2f4eea01d7daa6ccff3c7615e6954a36900fc"
            ],
            "ref": "refs/changes/63/49863/1",
            "uploader": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "createdOn": 1640081527,
            "author": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "miltonm@us.ibm.com",
                        "username": "mdmillerii"
                    },
                    "message": "The discussion elsewhere was these were industry standard names.   Please include that context where appropriate, and which names"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Sorry, not clearly understand your point: isn't you were asking me to set common names for x86 GPIOs to the doc?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Done"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Hello.\nIs there any other inputs here? Are we going to proceed with making x86 gpio naming to be compliant with existing rules or we going to just document here what Intel actually bring to us?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 67,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "miltonm@us.ibm.com",
                        "username": "mdmillerii"
                    },
                    "message": "Why should this be special?   Needs a separate commit and justification."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 67,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "IMHO, we should not add index on the single-host systems. Otherwise, we need to add indexes everywhere else."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 67,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Yes, we should add indexes for the single-host systems.\n\n> Otherwise, we need to add indexes everywhere else.\n\nWe do so we don't screw up and have code that just supports \"Host\" and then doesn't work on multi-hosts designs."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 67,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Ack"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 67,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 72,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "What does \"reset control\" mean?"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 72,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "This is the line, that BMC control, so pulling it from BMC will trigger PCH to system reset,\n\nGenerally, I use \"*-control\" for the lines that BMC can use to change host state.\nYou welcome to propose better naming for such things."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 72,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Description added"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 92,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "miltonm@us.ibm.com",
                        "username": "mdmillerii"
                    },
                    "message": "Please put these cleanups in a separate commit for proper review."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 92,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "ok"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 92,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 172,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Are these actually x86 specific?  Or are they Xeon specific?  Or are they \"generation X of Xeon\" specific?  Or do they apply for Ampere's design?\n\nEven the use of the 'x86-power-control' repository isn't exactly obvious anymore."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 172,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Actually, I don't know also... Likely NMI is common for everything and should be moved to common section, but I know nothing about SIO usage.\nProbably someone from Intel can tell."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 172,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 178,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "miltonm@us.ibm.com",
                        "username": "mdmillerii"
                    },
                    "message": "Comment on how it triggered.  High low pulse?"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 178,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Is it important here? No other lines in this document have such descriptions (except host-ready/host-ready-n).\nI think the behavior is software/hardware responsibility."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 178,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "> Is it important here? No other lines in this document have such descriptions (except host-ready/host-ready-n).\n\nMost lines are, unless otherwise specified, implied to be level/high.  If they are still \"implementation specific\" then it is pointless to even document them."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 178,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "ok, will document this"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 178,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 185,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Can we document what these mean?  Especially \"s*\"?  That is pretty meaningless to me.\n\nAlso, SIO isn't exactly x86 specific, is it?  I don't really know what \"Super I/O related GPIOs\" means.  The BMC _is_ the SIO in the system.  Are these magic signals to tell the processor state of the SIO logic?  Please document."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 185,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Sorry, but I only know that this lines somehow used by x86-power-control to get the state. And also there should be in-kernel support which is only exists it Intel-BMC kernel.\nI would be happy if Intel guys could explain how it is actually works and why this is needed in power-control."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 185,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "The SIO GPIOs are the pins on the ASPEED AST2500/AST2600 that are used for the ACPI Power state machine.  In particular we track SIOONCTRL, SIOPWRGD, SIOS3, and SIOS5.  These pins are specific to the BMC and not to x86."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 185,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Could you be more specific on how this logic works or give a link to documentation?\nAST2500 datasheet doesn't actually explains this lines operation, only define their location.\nBTW, I didn't saw you use SIOS3 in software, and it connected to S5 in hardware, right?"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 185,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Jason?"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 185,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "Sorry, I missed this somehow.  I'm not aware of any documentation, but I can share how the pins are used in x86-power-control:\nSIOONCTRL: Output from the BMC that tells when to enable the power supplies.  On our systems, this is combined with the PCH input to determine when to assert PS_EN.\nSIOPWRGD: Input to the BMC from CPU Power good to indicate when the hardware has finished powering on.\nSIOS3/SIOS5: Input to the BMC from the PCH SLP_S4/SLP_S5 signals.  On our systems we only support S5.  This pin is used to know when the system has started the hardware power-down sequence."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 185,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 185,
                    "reviewer": {
                        "name": "Zev Weiss",
                        "email": "zev@bewilderbeest.net",
                        "username": "zevweiss"
                    },
                    "message": "Just for the sake of completeness I'd also add that there exist systems (such as ASRock Rack boards) that do use a separate dedicated SIO chip instead of the Aspeed built-in SIO functionality.\n\nAlso, while certainly it seems possible to put a Super-I/O chip in an arbitrary system, in practice are there non-x86 machines that actually do so?  (Mostly just out of curiosity.)"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 185,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "Could you propose wording that I should place here regarding this notes? Taking in account that this document has intention to only define naming scheme, I'm not sure we want explain all the details about SIO here.\n\nRegarding your question: I have no answer for you? I don't know."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "type": "MODIFIED",
                    "insertions": 26,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 39,
            "sizeDeletions": 1
        },
        {
            "number": 2,
            "revision": "294e67e9190d4b85fa427f6587d61a8ddd902e62",
            "parents": [
                "9de2f4eea01d7daa6ccff3c7615e6954a36900fc"
            ],
            "ref": "refs/changes/63/49863/2",
            "uploader": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "createdOn": 1641883043,
            "author": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "type": "MODIFIED",
                    "insertions": 33,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 47,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "93a40c181b8fccd3983ee75a9fdc0f088b2f8a35",
            "parents": [
                "f65ecc5bab523c72cf45e3b8069c782f4e8190b3"
            ],
            "ref": "refs/changes/63/49863/3",
            "uploader": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "createdOn": 1655727623,
            "author": {
                "name": "Andrei Kartashev",
                "email": "a.kartashev@yadro.com",
                "username": "alatarum"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Overall I think this patch is a good start, but we need to figure out some conflicting goals:\n\n1. It's desirable for a DTS file GPIO naming to match the schematic of the board.\n2. It's desirable for GPIO in openbmc to have consistent naming between systems.\n\nThese two requirements seem mutually exclusive to me, and IMHO #1 is more important.  x86-power-control has already gone down the #1 path of letting gpio names be free-form to the schematic, by allowing the mapping to be named in a config file.\n\nIf we're going to continue this design, it would mean that we should remove the config file capability from x86-power-control, and make the existing users DTS files consistent.  Is that what we want here?  IMO, no, it's more useful for a GPIO name to match a schematic, even if it causes some inconsistencies in software implementations.\n\nRegardless of which we choose, we should answer the question before we continue with this patchset, and if the answer is #2 (for which, I'm not a maintainer for any priority GPIO facing daemons, so I really have no say in the matter) then we need to correct the DTS files, upstream then to the kernel, and remove the GPIO naming capability from the daemons that use it."
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 65,
                    "reviewer": {
                        "name": "Zev Weiss",
                        "email": "zev@bewilderbeest.net",
                        "username": "zevweiss"
                    },
                    "message": "AFAICS we don't have a post-complete GPIO mentioned anywhere else in this document at the moment though; should we add it as part of this change?  And given the naming style encouraged by this document, is there a reason we're referencing names like this in ALLCAPS_CAMEL_CASE instead of lower-kebab-case style?\n\nAlso, grammar-wise there should be an \"is\" before \"typically\". and I think it'd read a little more naturally with an article (\"a\" or \"the\") before the signal name (e.g. \"a POST_COMPLETE line\" or \"the POST_COMPLETE line\") -- or perhaps alternately just drop \"line\".  (And likewise elsewhere where similar sentences appear.)"
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "line": 65,
                    "reviewer": {
                        "name": "Andrei Kartashev",
                        "email": "a.kartashev@yadro.com",
                        "username": "alatarum"
                    },
                    "message": "I think, I really should just drop these lines. My initial intention was to refer \"common line names\" that came from reference board schematics and now appeared in most Intel-based DTS files."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/device-tree-gpio-naming.md",
                    "type": "MODIFIED",
                    "insertions": 46,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 60,
            "sizeDeletions": 0
        }
    ]
}