{
    "project": "openbmc/obmc-ikvm",
    "branch": "master",
    "id": "Iee0f0b7763534ab076491a6c98379e9fc564bbfe",
    "number": 56007,
    "subject": "Add a KVM service and a method for screenshot",
    "owner": {
        "name": "Xie Ning",
        "email": "xiening.xll@bytedance.com",
        "username": "XieNingll"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/obmc-ikvm/+/56007",
    "hashtags": [],
    "createdOn": 1659089353,
    "lastUpdated": 1660193966,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1659089353,
            "reviewer": {
                "name": "Xie Ning",
                "email": "xiening.xll@bytedance.com",
                "username": "XieNingll"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1659089387,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1659089388,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1659089401,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/48004/ : FAILURE"
        },
        {
            "timestamp": 1659089973,
            "reviewer": {
                "name": "Xie Ning",
                "email": "xiening.xll@bytedance.com",
                "username": "XieNingll"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1659090018,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1659090018,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1659090058,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/48006/ : SUCCESS"
        },
        {
            "timestamp": 1659154295,
            "reviewer": {
                "name": "Zev Weiss",
                "email": "zev@bewilderbeest.net",
                "username": "zevweiss"
            },
            "message": "Patch Set 2: Code-Review-1\n\n(7 comments)"
        },
        {
            "timestamp": 1659564316,
            "reviewer": {
                "name": "Zev Weiss",
                "email": "zev@bewilderbeest.net",
                "username": "zevweiss"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "ef527035a48ec2fe45b17531ec4fc3942bef4611",
            "parents": [
                "9febc78124c7eb8702934970eb58842526a1ff3f"
            ],
            "ref": "refs/changes/07/56007/1",
            "uploader": {
                "name": "Xie Ning",
                "email": "xiening.xll@bytedance.com",
                "username": "XieNingll"
            },
            "createdOn": 1659089353,
            "author": {
                "name": "Xie Ning",
                "email": "xiening.xll@bytedance.com",
                "username": "XieNingll"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "ikvm_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "ikvm_video.cpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "ikvm_video.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "obmc-ikvm.cpp",
                    "type": "MODIFIED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "ikvm_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 47,
                    "deletions": -29
                }
            ],
            "sizeInsertions": 117,
            "sizeDeletions": 29
        },
        {
            "number": 2,
            "revision": "e070395829efc8367c4ade1bafc92a0a70b62f5c",
            "parents": [
                "9febc78124c7eb8702934970eb58842526a1ff3f"
            ],
            "ref": "refs/changes/07/56007/2",
            "uploader": {
                "name": "Xie Ning",
                "email": "xiening.xll@bytedance.com",
                "username": "XieNingll"
            },
            "createdOn": 1659089973,
            "author": {
                "name": "Xie Ning",
                "email": "xiening.xll@bytedance.com",
                "username": "XieNingll"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Zev Weiss",
                        "email": "zev@bewilderbeest.net",
                        "username": "zevweiss"
                    },
                    "message": "It would be good to have a more detailed description of your approach here.  This patch is making some non-trivial structural changes (adding a new thread); please provide some high-level description of how it all works in the commit message."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "Zev Weiss",
                        "email": "zev@bewilderbeest.net",
                        "username": "zevweiss"
                    },
                    "message": "Typo -- \"screeShot\" missing an \"n\" (twice)."
                },
                {
                    "file": "ikvm_manager.hpp",
                    "line": 37,
                    "reviewer": {
                        "name": "Zev Weiss",
                        "email": "zev@bewilderbeest.net",
                        "username": "zevweiss"
                    },
                    "message": "It'd be nice not to insert this in between the existing `run()` method and the comment describing it -- maybe put it with the bool and string below?"
                },
                {
                    "file": "ikvm_manager.hpp",
                    "line": 41,
                    "reviewer": {
                        "name": "Zev Weiss",
                        "email": "zev@bewilderbeest.net",
                        "username": "zevweiss"
                    },
                    "message": "`shot` seems like a slightly cryptic name prefix to me; `screenshot` would be significantly clearer IMO.  Also, it would be nice if the name of the flag member reflected more about what its meaning is -- as it stands the only thing you can tell about it is that it has something to do with the screenshot mechanism, but that's it (from its usage it looks like it's a \"busy\" flag).  Continuing with the existing pattern of having a comment describing each member could also help with that."
                },
                {
                    "file": "obmc-ikvm.cpp",
                    "line": 12,
                    "reviewer": {
                        "name": "Zev Weiss",
                        "email": "zev@bewilderbeest.net",
                        "username": "zevweiss"
                    },
                    "message": "Having a single hard-coded path for this file doesn't seem like a good design -- if two clients request screenshots one after the other, the second one is going to clobber the first one's data."
                },
                {
                    "file": "obmc-ikvm.cpp",
                    "line": 18,
                    "reviewer": {
                        "name": "Zev Weiss",
                        "email": "zev@bewilderbeest.net",
                        "username": "zevweiss"
                    },
                    "message": "Is this interface described in phosphor-dbus-interfaces?  I'm guessing not, since it doesn't seem to follow existing naming conventions."
                },
                {
                    "file": "obmc-ikvm.cpp",
                    "line": 18,
                    "reviewer": {
                        "name": "Zev Weiss",
                        "email": "zev@bewilderbeest.net",
                        "username": "zevweiss"
                    },
                    "message": "PDI patch now in review here: https://gerrit.openbmc.org/c/openbmc/phosphor-dbus-interfaces/+/56073"
                },
                {
                    "file": "obmc-ikvm.cpp",
                    "line": 27,
                    "reviewer": {
                        "name": "Zev Weiss",
                        "email": "zev@bewilderbeest.net",
                        "username": "zevweiss"
                    },
                    "message": "This doesn't look like a great API design -- there's no good way to distinguish the \"busy\" error case from a successful return (it's a string either way; hard-coding clients to check for \"Screenshot busy\" is ugly).\n\nRather than returning the path of a screenshot file as a string, I think it would be a lot nicer to create a temporary file via O_TMPFILE and return a file descriptor to the client instead (which I'm pretty sure dbus allows)."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 18,
                    "deletions": 0
                },
                {
                    "file": "ikvm_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": 0
                },
                {
                    "file": "ikvm_video.cpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "ikvm_video.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "obmc-ikvm.cpp",
                    "type": "MODIFIED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "ikvm_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 46,
                    "deletions": -28
                }
            ],
            "sizeInsertions": 115,
            "sizeDeletions": 28
        }
    ]
}