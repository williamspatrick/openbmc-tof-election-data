{
    "project": "openbmc/libmctp",
    "branch": "master",
    "topic": "routing",
    "id": "Ia3a7ffd2b696dee603fa4c3a7846327e195fa575",
    "number": 33865,
    "subject": "core: Peform bridging and routing via the route table",
    "owner": {
        "name": "Andrew Jeffery",
        "email": "andrew@aj.id.au",
        "username": "amboar"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/libmctp/+/33865",
    "hashtags": [],
    "createdOn": 1592556256,
    "lastUpdated": 1658709911,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1592556256,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1592556385,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1592556396,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 1:\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/52370/"
        },
        {
            "timestamp": 1592556596,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://openpower.xyz/job/openbmc-repository-ci/52370/ : FAILURE"
        },
        {
            "timestamp": 1592564933,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 2: Patch Set 1 was rebased."
        },
        {
            "timestamp": 1592565032,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1592565052,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 2:\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/52391/"
        },
        {
            "timestamp": 1592565171,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://openpower.xyz/job/openbmc-repository-ci/52391/ : SUCCESS"
        },
        {
            "timestamp": 1592812697,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 3: Patch Set 2 was rebased."
        },
        {
            "timestamp": 1592812883,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1592812906,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 3:\n\nBuild Started https://openpower.xyz/job/openbmc-repository-ci/52618/"
        },
        {
            "timestamp": 1592813138,
            "reviewer": {
                "name": "Jenkins",
                "email": "openbmc-ci-admin@ozlabs.org",
                "username": "jenkins-openbmc"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://openpower.xyz/job/openbmc-repository-ci/52618/ : SUCCESS"
        },
        {
            "timestamp": 1593431901,
            "reviewer": {
                "name": "Sumanth Bhat",
                "email": "sumanth.bhat@linux.intel.com",
                "username": "sumbhat90"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1593474631,
            "reviewer": {
                "name": "Iwona Winiarska",
                "email": "iwona.winiarska@intel.com",
                "username": "iklm"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1593619971,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1593619987,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1593619994,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4:\n\nBuild Started https://jenkins.openbmc.org/job/ci-repository/308/"
        },
        {
            "timestamp": 1593620586,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/308/ : SUCCESS"
        },
        {
            "timestamp": 1593656888,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1593656904,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1593656910,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5:\n\nBuild Started https://jenkins.openbmc.org/job/ci-repository/352/"
        },
        {
            "timestamp": 1593657401,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/352/ : SUCCESS"
        },
        {
            "timestamp": 1594019608,
            "reviewer": {
                "name": "Jeremy Kerr",
                "email": "jk@ozlabs.org",
                "username": "jk-ozlabs"
            },
            "message": "Patch Set 5:\n\n(5 comments)\n\nIn line with my comments on 33865; just a few specific things here."
        },
        {
            "timestamp": 1594101861,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(7 comments)"
        },
        {
            "timestamp": 1594102255,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(4 comments)"
        },
        {
            "timestamp": 1594805577,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 5:\n\n(6 comments)"
        },
        {
            "timestamp": 1595822208,
            "reviewer": {
                "name": "Richard Marian Thomaiyar",
                "email": "richard.marian.thomaiyar@linux.intel.com",
                "username": "rthomaiy"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1604892480,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(7 comments)"
        },
        {
            "timestamp": 1604901947,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1604920370,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(6 comments)"
        },
        {
            "timestamp": 1605067417,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1605067456,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1605067518,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/7646/ : FAILURE"
        },
        {
            "timestamp": 1605068670,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1605068687,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1605068750,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/7656/ : SUCCESS"
        },
        {
            "timestamp": 1611016056,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 8."
        },
        {
            "timestamp": 1611016084,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1611016144,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/11062/ : SUCCESS"
        },
        {
            "timestamp": 1658709911,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Abandoned\n\nSeries captured here for posterity: https://github.com/amboar/libmctp/tree/routing"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "85f049b655a23972faeb465776bd6b6282bee98a",
            "parents": [
                "96ac6415b08e1f35c9fef5640b19f848b8b9aba2"
            ],
            "ref": "refs/changes/65/33865/1",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1592556256,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -2
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 219,
                    "deletions": -102
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -9
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": 0
                },
                {
                    "file": "libmctp.h",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -4
                }
            ],
            "sizeInsertions": 327,
            "sizeDeletions": 117
        },
        {
            "number": 2,
            "revision": "fe421412ce4b52a6112b6940d4dcf22f5d82e0c5",
            "parents": [
                "025d34d9da23b9438fe76b93b30016565c409f5b"
            ],
            "ref": "refs/changes/65/33865/2",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1592564933,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -2
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 219,
                    "deletions": -102
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -9
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": 0
                },
                {
                    "file": "libmctp.h",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -4
                }
            ],
            "sizeInsertions": 327,
            "sizeDeletions": 117
        },
        {
            "number": 3,
            "revision": "e96d6a38b2cf037961ba61ef664952798ffe105d",
            "parents": [
                "aaf60312cf8dda74a4092e4dab6459deddc65596"
            ],
            "ref": "refs/changes/65/33865/3",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1592812697,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Jeremy Kerr",
                        "email": "jk@ozlabs.org",
                        "username": "jk-ozlabs"
                    },
                    "message": "*Perform"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Ack"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Jeremy Kerr",
                        "email": "jk@ozlabs.org",
                        "username": "jk-ozlabs"
                    },
                    "message": "s/true/truth/ ?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Ack"
                },
                {
                    "file": "core.c",
                    "line": 349,
                    "reviewer": {
                        "name": "Iwona Winiarska",
                        "email": "iwona.winiarska@intel.com",
                        "username": "iklm"
                    },
                    "message": "I guess it should be:\n if (match->bus >= mctp->n_busses)"
                },
                {
                    "file": "core.c",
                    "line": 349,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Ack!"
                },
                {
                    "file": "core.c",
                    "line": 404,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "Technically, we can have multiple buses right? what's the reason, in specifying only 2 buses here?"
                },
                {
                    "file": "core.c",
                    "line": 615,
                    "reviewer": {
                        "name": "Sumanth Bhat",
                        "email": "sumanth.bhat@linux.intel.com",
                        "username": "sumbhat90"
                    },
                    "message": "As discussed in the call, if each binding is being handled by a separate process (ex:multiple instances of mctp daemon with each instance managing a binding), then mctp_send_tx_queue might not be an appropriate thing to do. We will have to consider whether the EID in the route table is being handled by current process or by a third party process and make the decision about who transmits the packet."
                },
                {
                    "file": "core.c",
                    "line": 615,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "I've given this some more thought below:\n\nhttps://lists.ozlabs.org/pipermail/openbmc/2020-July/022186.html"
                },
                {
                    "file": "core.c",
                    "line": 778,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Need to check that the EID is routable, and if not do something else. I need to think about what that something else is though; in the case of a bridge it's not obvious where to send a broadcast message besides all attached busses?"
                },
                {
                    "file": "core.c",
                    "line": 904,
                    "reviewer": {
                        "name": "Sumanth Bhat",
                        "email": "sumanth.bhat@linux.intel.com",
                        "username": "sumbhat90"
                    },
                    "message": "This is debatable. We can still get a MCTP packet with destination EID 0, and the match should occur for the bus we received the packet on. This can happen if two devices on the same bus decide to talk only using physical addressing OR we received packets before bus owner assigns EIDs.\n\nFor broadcast messages, all routes should be a match."
                },
                {
                    "file": "core.c",
                    "line": 904,
                    "reviewer": {
                        "name": "Iwona Winiarska",
                        "email": "iwona.winiarska@intel.com",
                        "username": "iklm"
                    },
                    "message": "This is true for a bridge. According to 9.1.1 Routing/bridging restrictions: \"A bridge shall not route or forward packets with a broadcast destination ID.\"\n\nBut since this function impacts mctp_message_tx(), the bridge / bus owner endpoint will not be able to send broadcast messages."
                },
                {
                    "file": "core.c",
                    "line": 904,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "> But since this function impacts mctp_message_tx(), the bridge / bus owner endpoint will not be able to send broadcast messages.\n\nThis is a good point. I think we need some extra logic before the find_bus_by_eid() call to handle broadcasts in mctp_message_tx()."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -2
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 219,
                    "deletions": -102
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 7,
                    "deletions": -9
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": 0
                },
                {
                    "file": "libmctp.h",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -4
                }
            ],
            "sizeInsertions": 327,
            "sizeDeletions": 117
        },
        {
            "number": 4,
            "revision": "c568355807ad9408edf60f7c9d98da1fdeda8c72",
            "parents": [
                "281ee5d6d720429f03947616d8e9d91d3407e08d"
            ],
            "ref": "refs/changes/65/33865/4",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1593619971,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": -2
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 210,
                    "deletions": -105
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -6
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 33,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 299,
            "sizeDeletions": 115
        },
        {
            "number": 5,
            "revision": "3a19db4edc0034ac193014f364d63b7374b8f1ed",
            "parents": [
                "281ee5d6d720429f03947616d8e9d91d3407e08d"
            ],
            "ref": "refs/changes/65/33865/5",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1593656888,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 20,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "I ended up fixing this, so note to self to remove it."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 20,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Done"
                },
                {
                    "file": "core.c",
                    "line": 27,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "where is this getting moved now ?\nor going to use only routing table for this ? \nQuestion is how we will track the EID (self) for the particular binding? \nNote: \nNote: Either we are using same EID for all the binding / different EID (self) for different binding."
                },
                {
                    "file": "core.c",
                    "line": 27,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "> where is this getting moved now ?\n\nIt's not moved, it's removed. This is tracked via MCTP_ROUTE_TYPE_ENDPOINT entries in the context's route table.\n\n> or going to use only routing table for this ? \n\nRight.\n\n> Question is how we will track the EID (self) for the particular binding? \n\nThe MCTP_ROUTE_TYPE_ENDPOINT entry is associated with a particular port in the route table via its struct mctp_device."
                },
                {
                    "file": "core.c",
                    "line": 27,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Done"
                },
                {
                    "file": "core.c",
                    "line": 1179,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "we still need this to understand whether it is special EID's request?"
                },
                {
                    "file": "core.c",
                    "line": 1179,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Let me check what I've done here."
                },
                {
                    "file": "core.c",
                    "line": 1179,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "I think this ended up unused. I think we need to do a fair bit more to completely meet the requirements of the base spec - we need to pass the message terminus components to the receiver (source endpoint ID, tag owner bit and message tag value). I think you're hinting at that we need to reply with the source set to the destination EID of the request. I've concluded that we need to track the outstanding requests in order to do this.\n\nWe'll need a follow-up series to deal with that."
                },
                {
                    "file": "core.c",
                    "line": 26,
                    "reviewer": {
                        "name": "Jeremy Kerr",
                        "email": "jk@ozlabs.org",
                        "username": "jk-ozlabs"
                    },
                    "message": "So we used to use struct mctp_bus to represent attaching an EID to a binding (essentially, just a (binding, eid) pair). Now that we're using the route table, is that separation of binding and bus still needed? ie., should we move all of this into struct mctp_binding perhaps?\n\n[This may help with future confusion - you have mctp_bus_* functions below that operate on a binding, not a bus]"
                },
                {
                    "file": "core.c",
                    "line": 26,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Right, yeah, I think you're onto something there. Though the naming of the mctp_bus_* functions was pretty loosely done, I just needed a name and didn't really consider your distinction above :)"
                },
                {
                    "file": "core.c",
                    "line": 26,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Actually, it might pay to keep `struct mctp_bus` to hold at least the bus ID, as this isn't really something that's of direct concern to the binding implementation (it's bridge-configuration-dependent). I think we can discuss shifting the other members out of `struct mctp_bus` outside of this series.\n\nI'll fix up the function names though."
                },
                {
                    "file": "core.c",
                    "line": 26,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Done. I've renamed mctp_bus_rx() as well (as a separate patch), given it took a binding pointer as a parameter."
                },
                {
                    "file": "core.c",
                    "line": 1020,
                    "reviewer": {
                        "name": "Jeremy Kerr",
                        "email": "jk@ozlabs.org",
                        "username": "jk-ozlabs"
                    },
                    "message": "Should we provide a low-level bus_register function that does not pass an EID? This current function would then be a helper to do that registration and create the route."
                },
                {
                    "file": "core.c",
                    "line": 1020,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Right! And that would get rid of the caveat in the docs in the header. I like it."
                },
                {
                    "file": "core.c",
                    "line": 1020,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Done"
                },
                {
                    "file": "core.c",
                    "line": 1024,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "this must be LOCAL right?\nThis ENDPOINT is kind of confusing with the usage. I visualize only 3 routing types,\nUPSTREAM, DOWNSTREAM & LOCAL. We will provide routing table update accordingly based on the bus in which the request came in right? that's the plan right?\n\nSay Figure 11 in the base spec DSP0236 1.3.1\nBridge X has 2 ports, and it will not advertise EID8 to the bridge y through routing table, instead it will indicate EID 11(Self), EID12,13 (Device A & B), EID 17(Bridge + EID18-EID19 through Bridge z), EID 9to 10 (through Bridge self - through bus 1). itself."
                },
                {
                    "file": "core.c",
                    "line": 1024,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "Ignore the comment regarding LOCAL. As discussed in WG, ENDPOINT usage is correct here."
                },
                {
                    "file": "core.c",
                    "line": 1024,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Done"
                },
                {
                    "file": "core.c",
                    "line": 1070,
                    "reviewer": {
                        "name": "Jeremy Kerr",
                        "email": "jk@ozlabs.org",
                        "username": "jk-ozlabs"
                    },
                    "message": "This might be neater to just assign to route.range / route.type / route.device directly."
                },
                {
                    "file": "core.c",
                    "line": 1070,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Yeah, I experimented with this approach to avoid the visual redundancy, but I'm not sure it's any clearer with the extra line noise. However, we'd have an extra two lines then to assign to the range and device members:\n\n route.range.first = eid1;\n route.range.last = eid1;\n route.type = MCTP_ROUTE_TYPE_LOCAL;\n route.device.bus = 0;\n route.device.address = 0;\n\nPerhaps your suggestion is less surprising and that's a readability win its own right..."
                },
                {
                    "file": "core.c",
                    "line": 1070,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Leaving it as is to avoid more patch churn. We can replace it later if the pattern irritates enough people."
                },
                {
                    "file": "core.c",
                    "line": 1233,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "this brings another perspective, that the pkt header pad must be the largest of binding medium supported. \nLet me know if you disagree, if you agree, then this can be of separate commit"
                },
                {
                    "file": "core.c",
                    "line": 1233,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "I think this is addressed by my series to better exploit the packet padding. Let me follow up."
                },
                {
                    "file": "core.c",
                    "line": 1233,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "As it stands at this patch the two upstream binding implementations don't pack the medium-specific header into the packet (they do kinda ad-hoc packing of the data instead), so this isn't a concern *yet*. This changes with the patches later in the series to better exploit the packet padding as I noted above, but the issue you identified here also gets fixed."
                },
                {
                    "file": "core.c",
                    "line": 1354,
                    "reviewer": {
                        "name": "Richard Marian Thomaiyar",
                        "email": "richard.marian.thomaiyar@linux.intel.com",
                        "username": "rthomaiy"
                    },
                    "message": "when we support multiple bus registration in single bridge, then EID match will happen for the port EID (self) of different bus too. Do we allow it ?"
                },
                {
                    "file": "core.c",
                    "line": 1354,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Yes, this is handled by the lookup. It will find the entry in the route table that matches `dest`. Below we test if the result is of route type MCTP_ROUTE_TYPE_ENDPOINT, and if it is we deliver it locally."
                },
                {
                    "file": "core.c",
                    "line": 1444,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Can pull this call out along with the call on 1455 and put it before the return."
                },
                {
                    "file": "core.c",
                    "line": 1444,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": -2
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 211,
                    "deletions": -105
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -6
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 33,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 300,
            "sizeDeletions": 115
        },
        {
            "number": 6,
            "revision": "9ed3e9c0705f5e834645574a6b55d9b4891bb998",
            "parents": [
                "2a76e5a5a521e5884dd9b36555746b0899fbb540"
            ],
            "ref": "refs/changes/65/33865/6",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1605067417,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -2
                },
                {
                    "file": "tests/test-utils.c",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "utils/mctp-demux-daemon.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "tests/test_cmds.c",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 241,
                    "deletions": -112
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -6
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 53,
                    "deletions": -5
                },
                {
                    "file": "libmctp.h",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -9
                }
            ],
            "sizeInsertions": 362,
            "sizeDeletions": 138
        },
        {
            "number": 7,
            "revision": "fb1885d5654562823a75efd1a6d650d9673e269a",
            "parents": [
                "2a76e5a5a521e5884dd9b36555746b0899fbb540"
            ],
            "ref": "refs/changes/65/33865/7",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1605068670,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -2
                },
                {
                    "file": "tests/test-utils.c",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "utils/mctp-demux-daemon.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "tests/test_cmds.c",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 243,
                    "deletions": -113
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -6
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 53,
                    "deletions": -5
                },
                {
                    "file": "libmctp.h",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -9
                }
            ],
            "sizeInsertions": 364,
            "sizeDeletions": 139
        },
        {
            "number": 8,
            "revision": "2b3ee6ef5bc7f86119ffc43c98227caaa909c678",
            "parents": [
                "ba767b6f96d8180e5a5697ae28ab2ab21094ae3e"
            ],
            "ref": "refs/changes/65/33865/8",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "createdOn": 1611016056,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 28,
                    "deletions": 0
                },
                {
                    "file": "tests/test_serial.c",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": -2
                },
                {
                    "file": "tests/test-utils.c",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "utils/mctp-demux-daemon.c",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "tests/test_cmds.c",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "core.c",
                    "type": "MODIFIED",
                    "insertions": 240,
                    "deletions": -111
                },
                {
                    "file": "tests/test_bridge.c",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -6
                },
                {
                    "file": "tests/test_astlpc.c",
                    "type": "MODIFIED",
                    "insertions": 50,
                    "deletions": -5
                },
                {
                    "file": "libmctp.h",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -8
                }
            ],
            "sizeInsertions": 355,
            "sizeDeletions": 136
        }
    ]
}