{
    "project": "openbmc/docs",
    "branch": "master",
    "id": "I10239d01be0c40c4937a97378ae2e26e9643c20d",
    "number": 47256,
    "subject": "Design for discrete sensor framework",
    "owner": {
        "name": "vinodhinij",
        "email": "vinodhinij@ami.com",
        "username": "vinodhinij"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/docs/+/47256",
    "hashtags": [],
    "createdOn": 1632769952,
    "lastUpdated": 1665657944,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1632769952,
            "reviewer": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1632772263,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(9 comments)"
        },
        {
            "timestamp": 1632773320,
            "reviewer": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "message": "Uploaded patch set 2: New patch set was added with same tree, parent, and commit message as Patch Set 1."
        },
        {
            "timestamp": 1632774158,
            "reviewer": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1632774446,
            "reviewer": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "message": "Patch Set 3:\n\nPlease download as patch or Right content to review."
        },
        {
            "timestamp": 1633960680,
            "reviewer": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "message": "Patch Set 3:\n\n(5 comments)\n\nHi Patrick,\nPlease find the comments updated below."
        },
        {
            "timestamp": 1633962742,
            "reviewer": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1633965732,
            "reviewer": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1633965905,
            "reviewer": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "message": "Patch Set 5:\n\n(3 comments)"
        },
        {
            "timestamp": 1635951908,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 5: Code-Review-1\n\n(7 comments)"
        },
        {
            "timestamp": 1665657944,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Abandoned\n\nclose due to inactivity"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "eca0c1d70bece07d997c539e75cf8a02afbbe1f2",
            "parents": [
                "ae4104dd1b510d2edbeb39d792a2935e453c1917"
            ],
            "ref": "refs/changes/56/47256/1",
            "uploader": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "createdOn": 1632769952,
            "author": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Please set git-config to match a legal name similar to that in your company's CCLA."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "This is still unresolved as of PS5."
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 1,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "The filename \"designs/Design-\" is redundant.  Please remove the second \"design\".\n\nConvention in this folder is that the file name would be something like \"design/discrete-sensor-framework.md\".  All lowercase and with dashes as a word-separator."
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 1,
                    "reviewer": {
                        "name": "vinodhinij",
                        "email": "vinodhinij@ami.com",
                        "username": "vinodhinij"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 3,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Please fix trailing whitespace."
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 3,
                    "reviewer": {
                        "name": "vinodhinij",
                        "email": "vinodhinij@ami.com",
                        "username": "vinodhinij"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 5,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Please use spaces for indentation.  That is our general formatting guideline across the entire codebase."
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 5,
                    "reviewer": {
                        "name": "vinodhinij",
                        "email": "vinodhinij@ami.com",
                        "username": "vinodhinij"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "What is a \"discrete sensor\"?  That sounds like something from IPMI, but not something which would be modeled in our dbus interface.  Can you give an example of one and tell why it should be considered \"sensor\" and not another object?  How does it translate into Redfish?"
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 11,
                    "reviewer": {
                        "name": "vinodhinij",
                        "email": "vinodhinij@ami.com",
                        "username": "vinodhinij"
                    },
                    "message": "Yes, discrete sensor is mentioned in IPMI spec. [Section 42 - Sensor and Event Code Tables]. The current implementation of d-bus sensors supports only threshold based sensors. This proposed design gives a framework to handle discrete sensors. Each discrete sensor is \nconfigured in json similar to that of threshold based sensors. It will have an inventory object in entity manager. In d-bus sensors, different services will be created based on different sensor types of discrete sensors. A sensor object is created for a particular sensor based on its type in the discrete sensor service. These objects can be used by Redfish for further \nprocessing."
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 17,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I don't know what this means."
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 17,
                    "reviewer": {
                        "name": "vinodhinij",
                        "email": "vinodhinij@ami.com",
                        "username": "vinodhinij"
                    },
                    "message": "The sensor d-bus objects which are exposed can be used in the hardware layer for accessing/updating sensor info."
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 18,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Monitored in what way?"
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 18,
                    "reviewer": {
                        "name": "vinodhinij",
                        "email": "vinodhinij@ami.com",
                        "username": "vinodhinij"
                    },
                    "message": "When an event occurs due to any change with the sensor readings/state, it should be captured and logged, so monitoring is required. This is done with the objects properties and d-bus interfaces"
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 19,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I don't know what this means.  Why is this a requirement?"
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 19,
                    "reviewer": {
                        "name": "vinodhinij",
                        "email": "vinodhinij@ami.com",
                        "username": "vinodhinij"
                    },
                    "message": "Create a log when an event occurs based on IPMI spec. [Section 32 - SEL Record formats]"
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 244,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Why wasn't this chosen?"
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "line": 244,
                    "reviewer": {
                        "name": "vinodhinij",
                        "email": "vinodhinij@ami.com",
                        "username": "vinodhinij"
                    },
                    "message": "The framework can be modified by creating services in d-bus sensors based on different hardware interfacing layers, but, by creating services based on sensor type, we remain in sync with the existing threshold based sensors implementation."
                },
                {
                    "file": "designs/discrete-sensor-framework.md",
                    "line": 1,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I don't see any other file that starts with \"Design -\" in the title.\n\nPlease use markdown formatting of section headers as the other templates do."
                },
                {
                    "file": "designs/discrete-sensor-framework.md",
                    "line": 11,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Having something in a spec somewhere doesn't mean this is how we should implement it internally.  We purposefully did not create discrete sensors as a dbus concept, but instead chose to make *specific* dbus objects to encapsulate the concept attempting to be exposed by the sensor.  \n\nFor example, see 'gpio-based-cable-presence.md' as a design which was added recently.  The cable presence IS exposed as a Discrete Sensor over IPMI, but we do not have a generic \"Discrete Sensor\" object in dbus.\n\nThe problem with a generic discrete sensor is the same problem with why we try to limit free-form strings in dbus properties: it is entirely unmaintainable.  Two different systems will come up with different names of the \"discrete sensor\" and you'll end up with system-specific code that tries to match up on some arbitrary (and undocumented) sensor name.\n\nUsing well-formed dbus objects/interfaces, we can use Mapper to find \"all the objects of type X\" and translate them nicely into a specific kind of IPMI discrete sensor, just like we are doing for the cable detection.\n\nAt an architecture level, this proposal seems to conflict with our overall design."
                },
                {
                    "file": "designs/discrete-sensor-framework.md",
                    "line": 17,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "In many cases when someone leaves a comment on your design document it means that the document is likely not clear.  Rather than responding in Gerrit (or in addition to responding in Gerrit), you need to update the document.\n\nYour response here has not improved my understanding of what \"platform porting developer to invoke\" means."
                },
                {
                    "file": "designs/discrete-sensor-framework.md",
                    "line": 18,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Needs documentation."
                },
                {
                    "file": "designs/discrete-sensor-framework.md",
                    "line": 19,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Needs documentation."
                },
                {
                    "file": "designs/discrete-sensor-framework.md",
                    "line": 244,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Again, spell out the why *in* your document.  If you have an alternative that you didn't choose, you have reasons why you didn't choose it, so others need to be able to read those.  We can't guess at the thoughts in your head."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "type": "ADDED",
                    "insertions": 254,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 266,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "af8d7dcfbac4a870e9557f4e8a3162e76d78d382",
            "parents": [
                "ae4104dd1b510d2edbeb39d792a2935e453c1917"
            ],
            "ref": "refs/changes/56/47256/2",
            "uploader": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "createdOn": 1632773320,
            "author": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "kind": "NO_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "type": "ADDED",
                    "insertions": 254,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 266,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "02f2c27ce50bd147d1a7736aa40816457188fa8b",
            "parents": [
                "ae4104dd1b510d2edbeb39d792a2935e453c1917"
            ],
            "ref": "refs/changes/56/47256/3",
            "uploader": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "createdOn": 1632774158,
            "author": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "designs/Design-DiscreteSensorFramework.md",
                    "type": "ADDED",
                    "insertions": 260,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 272,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "6bb73f5f74310e437f5657fea0ee4275ccc12baf",
            "parents": [
                "ae4104dd1b510d2edbeb39d792a2935e453c1917"
            ],
            "ref": "refs/changes/56/47256/4",
            "uploader": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "createdOn": 1633962742,
            "author": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "designs/DiscreteSensorFramework.md",
                    "type": "ADDED",
                    "insertions": 260,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 272,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "06d07a0158a6323763de5dddb6b83fa2301be5ad",
            "parents": [
                "ae4104dd1b510d2edbeb39d792a2935e453c1917"
            ],
            "ref": "refs/changes/56/47256/5",
            "uploader": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "createdOn": 1633965732,
            "author": {
                "name": "vinodhinij",
                "email": "vinodhinij@ami.com",
                "username": "vinodhinij"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 12,
                    "deletions": 0
                },
                {
                    "file": "designs/discrete-sensor-framework.md",
                    "type": "ADDED",
                    "insertions": 260,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 272,
            "sizeDeletions": 0
        }
    ]
}