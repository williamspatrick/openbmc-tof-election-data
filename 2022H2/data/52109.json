{
    "project": "openbmc/docs",
    "branch": "master",
    "id": "Id76029a9f5c869a5e2a77fd53843c926b438b67d",
    "number": 52109,
    "subject": "design: Add bios-bmc-smm-error-logging.md",
    "owner": {
        "name": "Brandon Kim",
        "email": "brandonkim@google.com",
        "username": "brandonkimbk"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/docs/+/52109",
    "hashtags": [],
    "createdOn": 1647577252,
    "lastUpdated": 1659972551,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1647577252,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1647577575,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1647580579,
            "reviewer": {
                "name": "Jeremy Kerr",
                "email": "jk@ozlabs.org",
                "username": "jk-ozlabs"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1647580725,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1647623345,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1647624611,
            "reviewer": {
                "name": "William A. Kennington III",
                "email": "wak@google.com",
                "username": "wak-google"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1647624969,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1647641900,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1647642073,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1647811645,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1647923783,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(5 comments)"
        },
        {
            "timestamp": 1647997775,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1647997781,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 3:\n\n(4 comments)"
        },
        {
            "timestamp": 1647998005,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1647998242,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1648082201,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1648084408,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1648101128,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1648695250,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1648695527,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 4:\n\n(2 comments)"
        },
        {
            "timestamp": 1648695769,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 5."
        },
        {
            "timestamp": 1648695899,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1648778622,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1648786259,
            "reviewer": {
                "name": "Sui Chen",
                "email": "suichen@google.com",
                "username": "quadpixels"
            },
            "message": "Patch Set 7: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1648797197,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 7:\n\n(1 comment)"
        },
        {
            "timestamp": 1648835692,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 7:\n\n(2 comments)"
        },
        {
            "timestamp": 1648835999,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 8."
        },
        {
            "timestamp": 1648836127,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 9."
        },
        {
            "timestamp": 1648837279,
            "reviewer": {
                "name": "Claire Weinan",
                "email": "cweinan@google.com",
                "username": "daylight22"
            },
            "message": "Patch Set 9:\n\n(8 comments)"
        },
        {
            "timestamp": 1648860803,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 9:\n\n(9 comments)"
        },
        {
            "timestamp": 1648860830,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 10."
        },
        {
            "timestamp": 1648863378,
            "reviewer": {
                "name": "Claire Weinan",
                "email": "cweinan@google.com",
                "username": "daylight22"
            },
            "message": "Patch Set 10:\n\n(4 comments)"
        },
        {
            "timestamp": 1649019595,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 11."
        },
        {
            "timestamp": 1649019598,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 10:\n\n(4 comments)"
        },
        {
            "timestamp": 1649094350,
            "reviewer": {
                "name": "Claire Weinan",
                "email": "cweinan@google.com",
                "username": "daylight22"
            },
            "message": "Patch Set 11: Code-Review+1\n\n(2 comments)"
        },
        {
            "timestamp": 1649096113,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1649096741,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 12."
        },
        {
            "timestamp": 1649099033,
            "reviewer": {
                "name": "Claire Weinan",
                "email": "cweinan@google.com",
                "username": "daylight22"
            },
            "message": "Patch Set 12: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1649159561,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1649705964,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1649951481,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1651628996,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 12: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1651631615,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1651691940,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 12:\n\n(6 comments)"
        },
        {
            "timestamp": 1651702798,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 12:\n\n(6 comments)"
        },
        {
            "timestamp": 1651704030,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 12:\n\n(4 comments)"
        },
        {
            "timestamp": 1651710002,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 12:\n\n(3 comments)"
        },
        {
            "timestamp": 1651868042,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 12:\n\n(3 comments)"
        },
        {
            "timestamp": 1651868079,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 13."
        },
        {
            "timestamp": 1651868188,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1651868471,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 14."
        },
        {
            "timestamp": 1652308469,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 14:\n\n(2 comments)"
        },
        {
            "timestamp": 1652739080,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 15: Patch Set 14 was rebased"
        },
        {
            "timestamp": 1652739101,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 15:\n\n(1 comment)"
        },
        {
            "timestamp": 1653017890,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 15:\n\n(1 comment)"
        },
        {
            "timestamp": 1654101109,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Uploaded patch set 16."
        },
        {
            "timestamp": 1659733105,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 16: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1659735841,
            "reviewer": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "message": "Patch Set 16:\n\n(1 comment)"
        },
        {
            "timestamp": 1659972342,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 16: Code-Review+2"
        },
        {
            "timestamp": 1659972344,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 17: Patch Set 16 was rebased"
        },
        {
            "timestamp": 1659972381,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 17: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1659972381,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 17: -Ok-To-Test"
        },
        {
            "timestamp": 1659972396,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 17: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/48743/ : SUCCESS"
        },
        {
            "timestamp": 1659972551,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Change has been successfully merged\n\n16 is the latest approved patch-set.\nNo files were changed between the latest approved patch-set and the submitted one.\n"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "16182ec1c0cbf883d35df4d05eb350974b217bd4",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/1",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1647577252,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "The table is very hard to read and the bullets are only rendered on markdown + html viewer (visual studio or atom supports it) so please review it from a markdown viewer!"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Jeremy Kerr",
                        "email": "jk@ozlabs.org",
                        "username": "jk-ozlabs"
                    },
                    "message": "Have you seen the existing solutions for this? Things like hiomap and the astlpc MCTP channel, which use a shared-memory area plus some synchronisation. I feel like most of the complexities have already been handled by those.\n\n(those currently use LPC to share the memory region, but there's no reason that can't be extended to PCIe instead...)"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Have you thought about using this: https://github.com/openbmc/libmctp/blob/master/docs/bindings/vendor-ibm-astlpc.md ? This would give you a compliant DMTF stack for doing RDE as well.\n\nIt can be extended to use a ring buffer to queue packets."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Hi Jeremy, I didn't look through MCTP channel too thoroughly and it looks like Andrew also commented on it - looking into it, it does seem like it currently uses LPC shared memory region, which for Nuvoton is 4KB and is too small for our usecase which is why it was discounted.\n\nBut yes, if we were to extend this to use PCI Mailbox, perhaps this is something we could consider.. let me look into how that would look like, thanks for the suggestion."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Hi Andrew, it looks like Jeremy and you had the same thoughts. As mentioned in Jeremy's comment, we discounted LPC shared memory methods due to Nuvotn's LPC shared memory buffer being only 4KB (for NPCM 7xx generation at least) which was not big enough for our usecase.\n\nI'll look into whether we can extend it to use PCI Mailbox instead, similar to how phosphor-ipmi-flash currently supports both LPC and PCI Mailbox / P2A."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "William A. Kennington III",
                        "email": "wak@google.com",
                        "username": "wak-google"
                    },
                    "message": "Jeremy, doesn't this require an ACK from the BMC to set up the buffer initially? I assume the goal isn't to hog the buffer from the host side in perpetuity in the event that we need the asynchronous fast access.\n\nOur requirement for this is a memory window the host can write to with no waiting on software BMC side. If we have to ask MCTP for some memory right before using it, then it does not meet this requirement."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Initial set up requiring ack is fine (as our circular buffer header requires BMC and host side acks), however yes, if an ack is required for each memory access then that doesn't meet our requirement.\n\nI realize I didn't note that explicitly in the requirement of this doc (I noted it in some other parts of the doc), I'll add that in."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "It looks like from https://github.com/openbmc/libmctp/blob/master/docs/bindings/vendor-ibm-astlpc.md#host-packet-transmission-sequence the TX, RX ownership transfers mean that the host won't be able to \"fire and forget\" unfortunately so I do not believe this is suitable for our usecase."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "I think it's possible to introduce new features to the LPC MCTP binding such that a) it provides a ring-buffer and b) uses a polling behaviour rather than interrupt driven. I haven't given it deep thought, but it should just be the addition of head/tail offset members to the control region. The final question is whether we can observe value tearing for those members. This might happen if the LPC logic performs byte-wise reads/writes of the underlying memory words. There might be other ways to mitigate that though."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Problem with Nuvoton LPC is that the shared memory buffer is only 4KB which we have identified as not being enough for our usecase (we expect each payload to up to ~1KB and 4KB will overflow with 4 messages, which we're not comfortable with).\n\nAlso, another concern that was brought up was - would there be a lot of overhead in getting the host to talk MCTP? Again, I'm not too familiar with MCTP and I'll have to consult the BIOS folks, but there may be limitation on what the BIOS can perform."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "I guess, if we're adding to MCTP to allow PCI, AND make it polling, then wouldn't it just be a completely different transport protocol?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Yeah, fair enough"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Actually, I'll be working with the BIOS folks internally to figure out if perhaps MCTP is the way we want to go. I'll update this thread once we have this discussion by tomorrow (or end of the week)."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "\ud83d\udc4d"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Apologies for the delayed response.\n\nWe investigated libmctp and MCTP PCIe VDM (thank you so much for the suggestion, Andrew and Jeremy) but we unfortunately don't think it's possible for the current platform we are currently supporting (and possibly the next generation platform).\n\nHowever, now that we're aware of this protocol and how good it is, we are investing our resources in bringing it up for the future platforms \ud83d\ude0a"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "type": "ADDED",
                    "insertions": 111,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 125,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "394ed3680dae13b41788b25690c28015bc9a0464",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/2",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1647642073,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Proofread. The design is very clear to me."
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "line": 16,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "is this a word?"
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "line": 16,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Good catch, will make it use cases"
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "line": 28,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "utilizes"
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "line": 28,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "line": 48,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "is"
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "line": 48,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "line": 58,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "as separate libraries"
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "line": 58,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "type": "ADDED",
                    "insertions": 113,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 127,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "0db6fdbd7da47cd267c7d6d9343d065417bdf5e5",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/3",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1647997775,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bmc-bios-shared-buffer.md",
                    "type": "ADDED",
                    "insertions": 113,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 127,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "128c3d75fbaa8a20cac23db7dd31174efc55fc54",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/4",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1648695250,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "I've been advised that it may be better to limit the scope of this project design for our exact use case (error logging from BIOS SMM), so I've rewritten it with that in mind for clarity.\n\nThank you in advance for taking the time to review the design."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 99,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "What is the expected performance of the proposed design. I am guessing at least whatever the requirement listed or is that implementation dependent?"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 99,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Let me update this since the requirement was changed to 1KB entry in 50 microseconds.\n\nIt is implementation dependent but a quick performance measurement using PCI mailbox that we're going to use initially showed us hitting roughly 1KB entry in 10 microseconds. Admittedly, IPMI was not tested, but was assured by other engineers within the team that it wouldn't performa as well."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 120,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 134,
            "sizeDeletions": 0
        },
        {
            "number": 5,
            "revision": "73e001b515e405b186026ae0bd6485315e751c46",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/5",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1648695769,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 120,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 134,
            "sizeDeletions": 0
        },
        {
            "number": 6,
            "revision": "11ee9eb541f9be7c2dc7dbfa6ec9c16fbc0d5971",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/6",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1648695899,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 120,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 134,
            "sizeDeletions": 0
        },
        {
            "number": 7,
            "revision": "d02560a9e0ee5ce8f00e5346615496461a3c71ce",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/7",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1648778622,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Sui Chen",
                        "email": "suichen@google.com",
                        "username": "quadpixels"
                    },
                    "message": "Some comments from the perspective of someone with only a little background on CPU<->BMC interaction:\n\nI first thought SMM refers to a hardware module but after searching a bit I learned it refers to the System Management Mode.\n\nBased on what I read, SMM is entered by a system management interrupt, and it runs transparently to the OS. From this, it seems the timeframe the CPU spends in SMM is usually very short, and if I understand correctly, this necessitates the \"fire and forget\" requirement.\n\nThe ring buffer is a good design as this has been widely used in various scenarios. The control data (specifically \"BMC read address and overflow flag\") seem to be adequate for addressing the cases when the CPU writes data too quickly and allows a flexible range of polling rates.\n\nI'm not super familiar with related protocols but I can see the benefit of not requiring handshakes and doing batch processing based on the flags on either side.\n\nOverall this document clearly describes the issue it addresses, and has solutions to some of the concerns I had initially (such as when the CPU writes too fast)."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Thank you Sui for the thorough review. I realize that SMM may not be familiar to everyone and I should probably have it written out for the first time the Acronym is used. I'll update that.\n\nYes, we want to minimize the time spent in SMM as much as possible as it interrupts the whole CPU - leading to the other requirements."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 74,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "nit: Lets (same below)"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 74,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 76,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "I was a little confused when reading this line. Does this capture the meaning? \"May need to leave some reserved bytes to ensure BMC doesn't accidentally write into the field below that's only supposed to be written by BIOS.\" Or maybe the line can be removed and alignment is good enough justification for the reserved bytes."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 76,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "Change to \"Reserved\" to be consistent with line 76?"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 76,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Good point, I'll just have it the same as below - as padding"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 76,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 79,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "Change to \"Reserved\" to be consistent with line 76?"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 79,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "nit: 2 bytes"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 79,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 79,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 80,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "Perhaps it's worth stating explicitly in the description below this table that UE logs contain critical information that we don't want to lose (i.e. which is the reason for having a special field dedicated for them). And adding a few lines about what happens in the overflow case could be helpful for the reader."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 80,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Great point - will do."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 90,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "suggestion: \"processing time and performance of different platforms\""
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 90,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Thanks, suggestion taken."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 95,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "RDE decoder?"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 95,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 125,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 139,
            "sizeDeletions": 0
        },
        {
            "number": 8,
            "revision": "c441fa13f85c998ea5cd0274e02a8329d21025a2",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/8",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1648835999,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 126,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 140,
            "sizeDeletions": 0
        },
        {
            "number": 9,
            "revision": "fcdb72a39256494358d120fe23fc13aef59f836e",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/9",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1648836127,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Thanks for the thorough review Claire. We had a few more discussions and the details were added in to the latest patch."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 128,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 142,
            "sizeDeletions": 0
        },
        {
            "number": 10,
            "revision": "de211b4522867111627a7aed2dd00f63f5fce6a2",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/10",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1648860830,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 103,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "nit: extra start-of-line space in lines 103-110"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 103,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Good catch - not sure how those got in here."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 106,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "\"region\" would be clearer? As I understand, it can only hold one UE log based on line 81 \"no unread UE log already in the region\""
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 106,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Good point, will fix."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 109,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "Is this a typo? For the field \"Uncorrectable Error reserved region\" the table says \"Reserved region only for UE logs\", so my understanding is that BIOS can never store \"normal\" (i.e. non-UE) logs in it."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 109,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Yes, upon my second reading of Marco's internal doc, that is correct and I had a misunderstanding. Great catch and I will revise this."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 110,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "nit: imminent"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 110,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Thanks!"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 145,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 159,
            "sizeDeletions": 0
        },
        {
            "number": 11,
            "revision": "c67036674867ef4d3470fc0c758248f7d29eb770",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/11",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1649019595,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "Thanks for making the updates."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 110,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "My understanding is that an existing UE log in the region can be overwritten after the BIOS sees an ack from BMC indicating that BMC has read the UE log (\"BMC flags\" BIT 0), per line 81 \"no unread UE log\". In other words, the region can be used again in the next separate overflow situation after the current one is dealt with."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 110,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Ugh yes you're right. That was my intent / understanding but my wording definitely botched it - I'll update this, thanks for the thorough review Claire!"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 145,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 159,
            "sizeDeletions": 0
        },
        {
            "number": 12,
            "revision": "897612067381687b1476635846883ccc5bbf560b",
            "parents": [
                "fd0ec1f9212f127bf302dd4ceb8f4fa2e29a5f1d"
            ],
            "ref": "refs/changes/09/52109/12",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1649096741,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Claire Weinan",
                        "email": "cweinan@google.com",
                        "username": "daylight22"
                    },
                    "message": "Looks good to me. Thanks for all the updates Brandon and sorry for all the back and forth!"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "@AndrewJ - Can you review this before we merge it?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "gentle ping on this review - would like to request a repo creation by EOW if possible."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Started pushing some basic code that we have to the docs repo as we need a place to push the code: https://gerrit.openbmc-project.xyz/c/openbmc/docs/+/52876/1"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Mild concern about the scope of usefulness beyond Google's BIOS, but let's see how it goes. Looks okay to me."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Agreed, this might turn out that it's only useful to Google and there was an internal discussion on whether we should chuck it in openbmc/google-misc (which is for Google specific things). In the end, we wanted to push things to upstream-upstream and not just google-misc, as others may find use for it - especially the RDE decoding and BEJ decoding (which we're proposing to be in a separate repo)"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 7,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Lets remove this now."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 7,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Oh, is this removed from the template now? Will do."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 7,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 74,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "These sizes feel a little small.  Is this premature optimization?  Does it limit us in the future?  Only 16k?"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 74,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "16K is unfortunately what is available in Nuvoton's chip for PCIe MMIO.\n\nHmm, that's fair points about future-proofing - let me ask internally if we should increase the normal queue size to 3 (but uncorrectable error region size will probably still remain 2)"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 74,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "How about 4 for both?  3 is kind of awkward.  You have 6 bytes of padding at the end anyhow."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 74,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "I think we would probably keep the UE size to 2 as they are meant to be emergency and we are meant to have 1 log (with each logs supposed to be 500B ~ 1KB, 16KB should be plenty).\n\nAgreed, we can just make 4 byte for normal log size"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 74,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Kept UE size to 2, moved queue size to 4"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 74,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Oh, this will require the read and write pointers to also increase to 4. Making those changes too"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 75,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Is there a reason for this embedded HTML in markdown?"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 75,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "This allows us to have multiline / bullet points within the tables. From my understanding, git processes these properly so we should hopefully see this displayed as intended when pushed."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 75,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "That's too bad that markdown doesn't have a better approach, only because of how ugly it looks in Gerrit / plaintext."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 81,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Is this really \"reserved\"?  Isn't it BIOS?"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 81,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Yeah that's a good point, will change to BIOS."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 81,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 87,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "How do you handle daemon restarts and/or BMC soft-reboots?  Aren't there cases where the physical memory space is already initialized before you start?  How do you avoid potential race conditions and/or deleting content from the SMM that came while you were away?"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 87,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "The assumption is that if the daemon restarted or the BMC soft-rebooted (which should be rare), we should not trust what is on the shared buffer and that we shall reinitialize.\n\nThe logs that were captured before, should have propagated to our databases through Redfish at this point as they are regularly polled for our use cases so the most logs we can lose would be whatever came in between the polling rate into the database."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 87,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Are you going to be able to safely indicate to the BIOS that the re-initialization happened?  Do you care to?\n\nWhat happens if the BMC soft-reboot is to install a new firmware version, which contains a change to the protocol?"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 87,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "The BIOS will have to respect that the BMC reset the buffer and will have to start the initialization again - so they care (that they have to reinitialze), but they do not care beyond that.\n\nWe do have the BMC and BIOS version embedded in the header for that purpose in case we need to update versions."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 87,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 94,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "There is some sequencing required here that may require something like std::memory_order.  I'm not sure if we need to document this in the design but it is a potential flaw I want to make sure the authors are thinking about.  There's probably a lot of memory_order issues in a memory FIFO between the two devices."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 94,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "First time reading through std::memory_order documentation - it seems like it's useful for inter-thread synchronization but this would be for inter-device synchronization right?"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 94,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "The memory operations you're doing in this device are, effectively, an MMIO.  You'll need to ensure that the writes are ordered from the observation of the external device and in some cases you'll want reads ordered based on status you're seeing in the buffer.  I think without the memory_order constraints the compiler would be free to reorder operations in an unexpected way.  Hopefully memory_order is sufficient..."
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 94,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Hmm, I see your point. Let me take a look at how to make use of std::memory_order and definitely consider adding them to the accesses. This would be some detailed implementation details so perhaps not fitting for this design doc but definitely appreciate the detailed design review \ud83d\ude0a"
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "line": 94,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 146,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 160,
            "sizeDeletions": 0
        },
        {
            "number": 13,
            "revision": "871157097a16e00c098e4749b18577ea3a55a5f3",
            "parents": [
                "68d46d3983386a6e194921e5054679d69d4dd80c"
            ],
            "ref": "refs/changes/09/52109/13",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1651868079,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 143,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 157,
            "sizeDeletions": 0
        },
        {
            "number": 14,
            "revision": "4c255873c2e63ba377bb4cc5f10f7d990db0a02f",
            "parents": [
                "68d46d3983386a6e194921e5054679d69d4dd80c"
            ],
            "ref": "refs/changes/09/52109/14",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1651868471,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 142,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 156,
            "sizeDeletions": 0
        },
        {
            "number": 15,
            "revision": "5f85b6398e7c26b7334ced35bae1f33d79ff7ffc",
            "parents": [
                "9915e5d21d3009eab284b321fef46f9301a13206"
            ],
            "ref": "refs/changes/09/52109/15",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1652739080,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "Friendly ping for this review."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "My only concern was whether you'd tried to exploit existing mechanisms such as the LPC MCTP binding and I think we've established that you need something bespoke here. I didn't have concerns beyond that. I haven't reviewed the details of the proposal beyond that and it seems like Patrick was taking a closer look, so I'll defer to him."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 142,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 156,
            "sizeDeletions": 0
        },
        {
            "number": 16,
            "revision": "c97500ebc887d5a562c9bbc454ec351c8575a06b",
            "parents": [
                "ac5d544553934f8083c61c5986a1420261bc8a4c"
            ],
            "ref": "refs/changes/09/52109/16",
            "uploader": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "createdOn": 1654101109,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Is this ready to merge?  I've lost track of it."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Brandon Kim",
                        "email": "brandonkim@google.com",
                        "username": "brandonkimbk"
                    },
                    "message": "In my opinion yes as the work is already underway with the repo that was created - but I'm open to any more suggestions."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 154,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 168,
            "sizeDeletions": 0
        },
        {
            "number": 17,
            "revision": "0b7780b5af82300012e6141a0b3614e6c84029e0",
            "parents": [
                "610a7b8fd2d1f89c79f15886e48627c7937695d8"
            ],
            "ref": "refs/changes/09/52109/17",
            "uploader": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "createdOn": 1659972344,
            "author": {
                "name": "Brandon Kim",
                "email": "brandonkim@google.com",
                "username": "brandonkimbk"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "designs/bios-bmc-smm-error-logging.md",
                    "type": "ADDED",
                    "insertions": 154,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 168,
            "sizeDeletions": 0
        }
    ]
}