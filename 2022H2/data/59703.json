{
    "project": "openbmc/phosphor-dbus-interfaces",
    "branch": "master",
    "id": "Ic94bbb304d5774efc48cf77e18d92c2285cdd0a2",
    "number": 59703,
    "subject": "button: add longer-press behavior",
    "owner": {
        "name": "DelphineCCChiu",
        "email": "Delphine_CC_Chiu@wiwynn.com",
        "username": "DelphineCCChiu"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/phosphor-dbus-interfaces/+/59703",
    "hashtags": [],
    "createdOn": 1671094988,
    "lastUpdated": 1672484207,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1671094988,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1671099810,
            "reviewer": {
                "name": "Meghan Saitwal",
                "username": "msaitwal"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1671108153,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(4 comments)"
        },
        {
            "timestamp": 1671116880,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1671118265,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1671120783,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1671184754,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1671185692,
            "reviewer": {
                "name": "Kuiying Wang",
                "email": "wangkuiying.wky@alibaba-inc.com",
                "username": "kuiyingw"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1671200261,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1671208093,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1671530089,
            "reviewer": {
                "name": "Kuiying Wang",
                "email": "wangkuiying.wky@alibaba-inc.com",
                "username": "kuiyingw"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1672278162,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Uploaded patch set 2: New patch set was added with same tree, parent tree, and commit message as Patch Set 1.\n\nCopied Votes:\n* Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n"
        },
        {
            "timestamp": 1672304373,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1672371372,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1672371945,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1672378089,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Uploaded patch set 3: New patch set was added with same tree, parent tree, and commit message as Patch Set 2.\n\nCopied Votes:\n* Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n"
        },
        {
            "timestamp": 1672378387,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Uploaded patch set 4: Commit message was updated.\n\nCopied Votes:\n* Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n"
        },
        {
            "timestamp": 1672378421,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1672378421,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1672378487,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Patch Set 2:\n\n(3 comments)\n\nThis change is ready for review."
        },
        {
            "timestamp": 1672378825,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/58406/ : SUCCESS"
        },
        {
            "timestamp": 1672385006,
            "reviewer": {
                "name": "Meghan Saitwal",
                "username": "msaitwal"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "d8ca76778773532170e9a57a0eed23a590328294",
            "parents": [
                "a1347418307d31a94bd21f22897aa508df938dcf"
            ],
            "ref": "refs/changes/03/59703/1",
            "uploader": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "createdOn": 1671094988,
            "author": {
                "name": "Delphine CC Chiu",
                "email": "delphine_cc_chiu@wiwynn.com",
                "username": ""
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 0,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "I assume most companies have their own specific requirements on what the power button should do, and this is yours...\n\nI know we do, and ours is different.  In fact we did our final implementation downstream so we didn't force it on every other user of this repo.\n\nWhat if another user shipping systems is already happy with the current implementation and changing it would lead to angry customers?\n\nI don't know what to do about these issues...  Provide a way to select which handler to run?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 0,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "First of all, I agree that behaviors of button should be customized"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 0,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "The behaviors we defined now are just used for new instances of multiple power button, which is independent from former design (single power button),\nSo there are no worries about the impacts to former projects, I'll state clearer on commit by following revision, thank you."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "This is the name of this repository, so this is redundant.\n\nSomething like is sufficient:\n\n    button: add longer-press behavior"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "Commit corrected, thank you for reviewing."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "This header is something we do inside Meta but not generally accepted in the LF community.  They prefer to only have the \"Tested:\" (not Test Plan)."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "Commit corrected, thank you for reviewing."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "Meghan Saitwal",
                        "username": "msaitwal"
                    },
                    "message": "do you mean press power button? or is it combination of multiple buttons?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "In platform we developing, there are 5 power buttons that 1 for whole chassis and each slot also has 1 power button"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 13,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "I'll correct it after discussing below was done, thank you."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 14,
                    "reviewer": {
                        "name": "Kuiying Wang",
                        "email": "wangkuiying.wky@alibaba-inc.com",
                        "username": "kuiyingw"
                    },
                    "message": "Such scenario is not common for all the customers. For example, there is a dedicate reset button for power cycle on some platform.\nMuch better to keep it for personal patch."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 14,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "> Much better to keep it for personal patch.\n\nPlease stop recommending people hold patches.  This is not conducive to community-based development."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 14,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Maybe it's time we figured out a way to have the button behavior be configurable so that the latest person to put up a patch based on their requirements doesn't break everyone else.  That way we it would be more likely for people to keep things upstream."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 14,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "I think that would be appropriate to change the action from calling targets of instead of phosphor-state-manager behaviors directly,\nIf there's any customized needs, just overwrite the target files under projects.\nPlease to reply if there's any concerned or agreement, thank you."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "Meghan Saitwal",
                        "username": "msaitwal"
                    },
                    "message": "I think you need to consider <= or >= conditions in scenarios. For ex, if power button pressed exactly for 4 secs, then will it \"12V power on\" or \"12V power cycle\"?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "I'll correct it after discussing below was done, thank you."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "Meghan Saitwal",
                        "username": "msaitwal"
                    },
                    "message": "Ack"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Adding maintainers of phosphor-buttons for further feedback.  \n\nI'm not really a fan of the proposed signals.  Pretty soon we're going to have PressedEvenLonger, PressedReallyLong, and PressedSuperLong."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "Commit corrected, thank you for reviewing."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "line": 55,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "This seems to be getting out of hand.\n\nShould we refactor this to include the length of the press in the \"Pressed\"?  Does the code send out a Pressed signal immediately and then send a PressedLonger later?  When is the Released signal sent?"
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "line": 55,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "For whatever reason, it is:\n* pressed() - when button is pressed down()\n* released() - when button is released, unless it was over the 'long' limit, in which case it is:\n* pressedLong() - actually when the power button is released after a long press.\n\n\nI guess the handler could be changed to watch for pressed() to get its timestamp, and then also get the timestamp of released() to do what is wanted accordingly."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "line": 55,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "> I guess the handler could be changed to watch for pressed() to get its timestamp, and then also get the timestamp of released() to do what is wanted accordingly.\n\nWe can add the length of the press to the Released signal then, right?"
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "line": 55,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Yea that works"
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "line": 55,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "I ll reconsider that with button handler's design, thank you for your suggestions."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "line": 55,
                    "reviewer": {
                        "name": "Kuiying Wang",
                        "email": "wangkuiying.wky@alibaba-inc.com",
                        "username": "kuiyingw"
                    },
                    "message": "I do think it is better to define different scenario for different platform in the daemon. No need to define the special property in the common interface."
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "line": 55,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "So far, most button handler in phosphor-buttons was triggered by property change"
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "line": 55,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "Due to power button is pressed/released by user, it may not be too complex to operate. In reality, is there any existed cases that designs power button behavior to over 4, 5 or more levels? if not we think there's no urgent concern about changing the current button handler design that cannot bring the pressing timestamp into signal."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/README.md",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Power.interface.yaml",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 40,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "172660fc3616e4e3fa91babee08591676964e27c",
            "parents": [
                "a1347418307d31a94bd21f22897aa508df938dcf"
            ],
            "ref": "refs/changes/03/59703/2",
            "uploader": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "createdOn": 1672278162,
            "author": {
                "name": "Delphine CC Chiu",
                "email": "delphine_cc_chiu@wiwynn.com",
                "username": ""
            },
            "kind": "NO_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/README.md",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Power.interface.yaml",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 40,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "f684189528ba308687a06ac0deddbf311172d507",
            "parents": [
                "a1347418307d31a94bd21f22897aa508df938dcf"
            ],
            "ref": "refs/changes/03/59703/3",
            "uploader": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "createdOn": 1672378089,
            "author": {
                "name": "Delphine CC Chiu",
                "email": "delphine_cc_chiu@wiwynn.com",
                "username": ""
            },
            "kind": "NO_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/README.md",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Power.interface.yaml",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 40,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "9323fb50c7417a946ef72c393aee1c3120b7a23f",
            "parents": [
                "a1347418307d31a94bd21f22897aa508df938dcf"
            ],
            "ref": "refs/changes/03/59703/4",
            "uploader": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "createdOn": 1672378387,
            "author": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/README.md",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Power.interface.yaml",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/Chassis/Buttons/Button.interface.yaml",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 39,
            "sizeDeletions": 0
        }
    ]
}