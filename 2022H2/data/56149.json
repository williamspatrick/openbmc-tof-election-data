{
    "project": "openbmc/entity-manager",
    "branch": "master",
    "id": "I6dd74cf449def18e627a8089468c5bca8de33784",
    "number": 56149,
    "subject": "Add name to InventoryAdded/Removed journal entries",
    "owner": {
        "name": "Matt Spinler",
        "email": "spinler@us.ibm.com",
        "username": "spinler"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/entity-manager/+/56149",
    "hashtags": [],
    "createdOn": 1659625245,
    "lastUpdated": 1664041795,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1659625245,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1659625258,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1659625258,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1659625472,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/48419/ : SUCCESS"
        },
        {
            "timestamp": 1659706150,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1659706438,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1659706970,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1659707584,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1659707616,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1659709311,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1659709311,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1659709360,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1659709360,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1659709536,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@aj.id.au",
                "username": "amboar"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1659709611,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/48616/ : SUCCESS"
        },
        {
            "timestamp": 1660884689,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1660941568,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1660942868,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1661457337,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1663806415,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1663806484,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1663873104,
            "reviewer": {
                "name": "Jason Bills",
                "email": "jason.m.bills@linux.intel.com",
                "username": "jmbills"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(3 comments)"
        },
        {
            "timestamp": 1664041775,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2: Code-Review+2\n\n(1 comment)"
        },
        {
            "timestamp": 1664041795,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as 200bf40ee9f03d715500b41b6128a61991f9243e"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "051e2c9f68c45cf4ee78f44f95fc6f8aa859a7e7",
            "parents": [
                "67003d6e89e4b1acbefedd533a564e343e8f628d"
            ],
            "ref": "refs/changes/49/56149/1",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1659625245,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "include/entity_manager.hpp",
                    "line": 150,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Can we please interpolate it here too?"
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 150,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Good idea, I can do something like:\n\n\"Inventory Added: Nisqually Backplane\"\n\nand then just remove it from the metadata."
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 150,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "I'd still do both to be honest. It enables us to script manipulation of the logs by extracting the metadata without having to parse the log message (just like lg2)."
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 150,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Ack"
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 150,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Unresolving..."
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 150,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Done"
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 203,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@aj.id.au",
                        "username": "amboar"
                    },
                    "message": "Again here."
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 203,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Ack"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "include/entity_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 16,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 52,
            "sizeDeletions": 2
        },
        {
            "number": 2,
            "revision": "b49ebdd3829b8198bcc7a0a884ba5e18042e9d54",
            "parents": [
                "67003d6e89e4b1acbefedd533a564e343e8f628d"
            ],
            "ref": "refs/changes/49/56149/2",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1659709311,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "Looks good to me if we only need the name in the journal logs.  If we want the name in Redfish, we'll need to add it in the MessageRegistry (https://github.com/openbmc/bmcweb/blob/master/redfish-core/include/registries/openbmc_message_registry.hpp#L590)."
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 154,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "If we want the name to show up in Redfish, we will need to add another parameter in the registry (https://github.com/openbmc/bmcweb/blob/master/redfish-core/include/registries/openbmc_message_registry.hpp#L590) and include name in the `REDFISH_MESSAGE_ARGS` list here."
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I'm pretty sure this is going to cause Redfish to show the wrong thing.\n\n@jason?"
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "We don't use that method of Redfish event logs so that could be.\n\nI could go back to my first patch set  that leaves the message alone.  Or I guess I could make a new entry that does include the name."
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Actually here https://github.com/openbmc/bmcweb/blob/master/redfish-core/include/registries/openbmc_message_registry.hpp#L587 it looks like it gets the message registry key from the \"OpenBMC.0.1.InventoryRemoved\" string, so I don't think the journal MESSAGE field matters."
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Yep, I realize you guys don't use it, so no worries not catching this in testing.  Still would like to see Jason weigh in."
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> it looks like it gets the message registry key from the \"OpenBMC.0.1.InventoryRemoved\" string, so I don't think the journal MESSAGE field matters.\n\nRight, but now we have logging where the message no longer matches the redfish-built message.  Maybe that's ok?"
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Jason Bills",
                        "email": "jason.m.bills@linux.intel.com",
                        "username": "jmbills"
                    },
                    "message": "The Redfish Message contents come directly from the MessageRegistry based on the `REDFISH_MESSAGE_ID` metadata.  The MESSAGE metadata is for what we want to see in the journal and doesn't need to match what is in Redfish."
                },
                {
                    "file": "include/entity_manager.hpp",
                    "line": 204,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Ack"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "include/entity_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -6
                }
            ],
            "sizeInsertions": 42,
            "sizeDeletions": 6
        },
        {
            "number": 3,
            "revision": "200bf40ee9f03d715500b41b6128a61991f9243e",
            "parents": [
                "e5323ef96ac7c3235ca929860f4c6369bb26cd59"
            ],
            "ref": "refs/changes/49/56149/3",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1664041795,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "include/entity_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -6
                }
            ],
            "sizeInsertions": 42,
            "sizeDeletions": 6
        }
    ]
}