{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I542177a94a33f8df7afbb68837f3a53b86140c86",
    "number": 63695,
    "subject": "query: Fix default expand level with delegated",
    "owner": {
        "name": "Willy Tu",
        "email": "wltu@google.com",
        "username": "wltu"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/63695",
    "hashtags": [],
    "createdOn": 1684865373,
    "lastUpdated": 1686584002,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1684865373,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1684865402,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1684865402,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1684865475,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 2: Commit message was updated."
        },
        {
            "timestamp": 1684865508,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1684865508,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1684865509,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/67235/ : ABORTED"
        },
        {
            "timestamp": 1684865674,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/67236/ : FAILURE"
        },
        {
            "timestamp": 1684866419,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1684866436,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 4: Commit message was updated."
        },
        {
            "timestamp": 1684866480,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1684866480,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1684867957,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/67237/ : SUCCESS"
        },
        {
            "timestamp": 1684871420,
            "reviewer": {
                "name": "Nancy Yuen",
                "email": "yuenn@google.com",
                "username": "yuennancy"
            },
            "message": "Patch Set 4: Code-Review+1"
        },
        {
            "timestamp": 1684874108,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 5: Commit message was updated.\n\nCopied Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1684874148,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1684874148,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1684875384,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5:\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/67240/ : SUCCESS"
        },
        {
            "timestamp": 1684880334,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1684880768,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1684880993,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1684883120,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 6.\n\nOutdated Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1684883154,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1684883154,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1684883188,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/67261/ : FAILURE"
        },
        {
            "timestamp": 1684887990,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 7.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1684888024,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1684888024,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: -Ok-To-Test"
        },
        {
            "timestamp": 1684889267,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/67263/ : SUCCESS"
        },
        {
            "timestamp": 1684906908,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 8: Published edit on patch set 7.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1684906913,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 8:\n\n(2 comments)"
        },
        {
            "timestamp": 1684906946,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1684906946,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: -Ok-To-Test"
        },
        {
            "timestamp": 1684906975,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/67281/ : FAILURE"
        },
        {
            "timestamp": 1684942342,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 9.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1684942404,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1684942404,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: -Ok-To-Test"
        },
        {
            "timestamp": 1684944344,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 9:\n\n(1 comment)"
        },
        {
            "timestamp": 1684944347,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/67334/ : SUCCESS"
        },
        {
            "timestamp": 1684944643,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 10: Commit message was updated.\n\nCopied Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1684944688,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1684944688,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: -Ok-To-Test"
        },
        {
            "timestamp": 1684946065,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10:\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/67342/ : SUCCESS"
        },
        {
            "timestamp": 1684962072,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 10:\n\n(1 comment)"
        },
        {
            "timestamp": 1684968644,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 10:\n\n(1 comment)"
        },
        {
            "timestamp": 1685047298,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 11.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1685047349,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1685047349,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: -Ok-To-Test"
        },
        {
            "timestamp": 1685047373,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 11:\n\n(3 comments)"
        },
        {
            "timestamp": 1685048470,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/67485/ : SUCCESS"
        },
        {
            "timestamp": 1685067633,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1685129477,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1685467958,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1685751830,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1685755873,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1685757671,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1685997093,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1685997223,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1685997380,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1685997907,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1685998717,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1686002208,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1686004483,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1686007115,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 11:\n\n(4 comments)"
        },
        {
            "timestamp": 1686008576,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1686154407,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1686175851,
            "reviewer": {
                "name": "Carson",
                "email": "clabrado@google.com",
                "username": "carsonlab"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1686177804,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1686178232,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Uploaded patch set 12.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1686178261,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1686178261,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: -Ok-To-Test"
        },
        {
            "timestamp": 1686178327,
            "reviewer": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1686179348,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/68235/ : SUCCESS"
        },
        {
            "timestamp": 1686256119,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 12:\n\n(1 comment)"
        },
        {
            "timestamp": 1686583990,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 12: Code-Review+2"
        },
        {
            "timestamp": 1686584002,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as 32cdb4a78399fec17442dc2cd36b2e57382475a3"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "5302d4d6df72ffe17fe89b674ea161c88f489a2d",
            "parents": [
                "479e899d5f57a67647f83b7f615d2c8565290bcf"
            ],
            "ref": "refs/changes/95/63695/1",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1684865373,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 36,
            "sizeDeletions": 1
        },
        {
            "number": 2,
            "revision": "a156c4cc4ad77603a7ce3010e7abc3681a7f7032",
            "parents": [
                "479e899d5f57a67647f83b7f615d2c8565290bcf"
            ],
            "ref": "refs/changes/95/63695/2",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1684865475,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 36,
            "sizeDeletions": 1
        },
        {
            "number": 3,
            "revision": "934c2db12a47326af62e4af963ed78ed5e884d27",
            "parents": [
                "479e899d5f57a67647f83b7f615d2c8565290bcf"
            ],
            "ref": "refs/changes/95/63695/3",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1684866419,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -1
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 37,
            "sizeDeletions": 2
        },
        {
            "number": 4,
            "revision": "62b5ada63e2152ff4f7f9aaefe803dc5c999daa6",
            "parents": [
                "479e899d5f57a67647f83b7f615d2c8565290bcf"
            ],
            "ref": "refs/changes/95/63695/4",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1684866436,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -1
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 37,
            "sizeDeletions": 2
        },
        {
            "number": 5,
            "revision": "09fce01a8cc69b4cdc3470b330166882f82c581b",
            "parents": [
                "479e899d5f57a67647f83b7f615d2c8565290bcf"
            ],
            "ref": "refs/changes/95/63695/5",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1684874108,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "Do you have an example of what the response is for one of the sensors `/redfish/v1/Chassis/BMC/Sensors/{SomeSensorId}`?\n\nIt sounds like the response has an array has already been pre-expanded outside of the query handling flow.  If that's the case then I think the code is working as intended."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "added, PTAL."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "ACK, I understand now and I agree it wasn't working as intended.  Let me try some $expands combined with aggregation and make sure this doesn't break any of that"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "thanks. \ud83d\udc4d\n\nI have updated to a new version. PTAL if you get the chance."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "ACK.  This patch looks like a complete revert of https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60727.  That was needed because the previous assumption that we should always expand does not work correctly with Redfish Aggregation.\n\nThrough aggregation we may offload expand to the satellite.  In that case the response when first seen by the normal expand flow will have already been partially expanded.  We just need to expand the parts of the response which came from the aggregating bmc and thus haven't been expanded.\n\nThat was the purpose of the test sections you removed in this patchset.  I'll test on an actual machine, but my hunch is for a query like `/redfish/v1/Chassis?$expand=.($levels=1)` in the response you'll see the local Chassis resources have been expanded one level and the satellite Chassis resources have been expanded two levels."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "I see why I don't have impression where we need to care about levels in |findNavigationReferences|.\n\nhttps://gerrit.openbmc.org/c/openbmc/bmcweb/+/60727 seems the root cause why \"/redfish/v1/Chassis/BMC/Sensors?$expand=.($levels=2)\" is broken.\n\n> Through aggregation we may offload expand to the satellite. In that case the response when first seen by the normal expand flow will have already been partially expanded. We just need to expand the parts of the response which came from the aggregating bmc and thus haven't been expanded.\n\nIs there really a use case where there are leftover information from the satellite bmc? What will break if the assumption is satellite is responsible to expand all the levels."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "We can't assume the satellite will expand all the levels because there is no guarantee the satellite supports expand.  It's unlikely we'd have a situation where we expected something like levels=3 and instead only got levels=1.  It is very possible to expect levels=n and we received levels=0.\n\nReverting https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60727 will break all aggregated $expands when the satellite supports $expand.  I think the root issue is we shouldn't be assuming expand depths since that is incompatible with aggregation.  That commit removed the assumption from the base expand flow, but it did not consider assumptions in the efficient sensors expand flow."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "I tested Patchset 9 with aggregation and did not see any issues.  From my testing, the following queries involving aggregated resources are all expanded correctly:\n\nredfish/v1/Chassis?$expand=.($levels=1)\nredfish/v1/Chassis/5B247A_AggChassis?$expand=.($levels=1)\nredfish/v1/Chassis/5B247A_AggChassis?$expand=.($levels=2)\nredfish/v1/Chassis/5B247A_AggChassis/Sensors?$expand=.($levels=1)\nredfish/v1/Systems?$expand=.($levels=1)\nredfish/v1/UpdateService?$expand=.($levels=1)\nredfish/v1/UpdateService?$expand=.($levels=2)\n\nI think Patchset 9 is the correct approach.  I don't have a setup where a Sensor resource contains a navigation link, but I'm assuming Patchset 9 still fixes the original issue of /redfish/v1/Chassis/BMC/Sensors?$expand=.($levels=2) not being expanded correctly."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "Actually it looks like the change introduces a new issue in aggregated sensor expansion.  If I query an aggregated sensor on my system I do see a navigation link\n\ncurl -s 'localhost/redfish/v1/Chassis/5B247A_AggChassis/Sensors/temp'\n{\n  ...\n  \"RelatedItem\": [\n    {\n      \"@odata.id\": \"/redfish/v1/Systems/5B247A_system\"\n    }\n  ],\n  ...\n}\n\nHowever, that property is missing from the output of:\n\ncurl -s 'localhost/redfish/v1/Chassis/5B247A_AggChassis/Sensors?$expand=.($levels=1)'\n\nas well as some downstream properties under Status.  If do\n\ncurl -s 'localhost/redfish/v1/Chassis/5B247A_AggChassis/Sensors/temp?$expand=.($levels=1)'\n\nthen RelatedItem gets expanded like it should.  If I instead call \n\ncurl -s 'localhost/redfish/v1/Chassis/5B247A_AggChassis/Sensors?$expand=.($levels=2)'\n\nthen you don't see RelatedItem in the output and the output is the same as if I did a level 1 expand.\n\nI don't know if this issue was also present in Patchset 5 or if it was introduced by the cleanup that took place after that patch"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "Disregard my last message.  The issue was with the satellite BMC's expand handling and my test setup. It only looked like it was working \"correctly\" without your patch because $expand was not being offloaded to the satellite.  Instead the aggregator made individual queries and thus those properties weren't missing from the final result."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 30,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "thanks for verifying it with Patch 9 on satellite BMC. and yeah, I would expect that to be working properly since it will just remove the overlap depths."
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "line": 224,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "Wait, why is this correct?\n\nThe default expand handler runs after dedicated ones, so minus is correct to me"
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "line": 224,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "The issue is when it start paring the json to find odata.id with https://github.com/openbmc/bmcweb/blob/479e899d5f57a67647f83b7f615d2c8565290bcf/redfish-core/include/utils/query_param.hpp#.\n\n`findNavigationReferencesRecursive` only parse 1 level of odata.id since it doesn't skip the one that is delegated. \n\nAnother potential that's more clear on the intention would be...\n\nPass delegated to processAllParams -> startQuery\n\nhttps://github.com/openbmc/bmcweb/blob/479e899d5f57a67647f83b7f615d2c8565290bcf/redfish-core/include/utils/query_param.hpp#L962-L1003\n\nSo we do\n\n```\nstd::vector<ExpandNode> nodes = findNavigationReferences(\n            query.expandType, query.expandLevel + delegated.expandLevel, finalRes->res.jsonValue);\n```\ninstead. Or something like skip first `delegated.expandLevel` level."
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "line": 224,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "updated with the approach that's more self-explanatory."
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "line": 224,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "discussed with Nan offline and seems like my understand of the issue is wrong and that there is a different bug instead.\n\nMy assumption is that is is DFS, but it should be BFS instead. I believe the change should be https://gerrit.openbmc.org/c/openbmc/bmcweb/+/53228.\n\nThe change should just be not remove the depth and just go find all of the odata.id at the current json output. It is assumed that efficient expand will get to the point where is only expose one more level of odata.id.\n\nfix WIP."
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "line": 224,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -1
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 37,
            "sizeDeletions": 2
        },
        {
            "number": 6,
            "revision": "cd6b150cc8b0f1e9c1419d19a389f67d20d4719b",
            "parents": [
                "479e899d5f57a67647f83b7f615d2c8565290bcf"
            ],
            "ref": "refs/changes/95/63695/6",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1684883120,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 78,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/query.hpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 21,
                    "deletions": -13
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 102,
            "sizeDeletions": 16
        },
        {
            "number": 7,
            "revision": "5fc085aa614840f196bf06e4826ac3d24299e793",
            "parents": [
                "479e899d5f57a67647f83b7f615d2c8565290bcf"
            ],
            "ref": "refs/changes/95/63695/7",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1684887990,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 78,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/query.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": -15
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 65,
                    "deletions": -28
                }
            ],
            "sizeInsertions": 176,
            "sizeDeletions": 46
        },
        {
            "number": 8,
            "revision": "750be43fe420011e0c6c2a39d8f8dd3189be3670",
            "parents": [
                "479e899d5f57a67647f83b7f615d2c8565290bcf"
            ],
            "ref": "refs/changes/95/63695/8",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1684906908,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 78,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/query.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 30,
                    "deletions": -15
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 65,
                    "deletions": -28
                }
            ],
            "sizeInsertions": 176,
            "sizeDeletions": 46
        },
        {
            "number": 9,
            "revision": "0fe24e86d782325e3ced6253881557135d58163d",
            "parents": [
                "479e899d5f57a67647f83b7f615d2c8565290bcf"
            ],
            "ref": "refs/changes/95/63695/9",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1684942342,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 80,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/query.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -16
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 65,
                    "deletions": -28
                }
            ],
            "sizeInsertions": 180,
            "sizeDeletions": 47
        },
        {
            "number": 10,
            "revision": "2267f797d995643193a0c059bf54690f46b58789",
            "parents": [
                "479e899d5f57a67647f83b7f615d2c8565290bcf"
            ],
            "ref": "refs/changes/95/63695/10",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1684944643,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 18,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "This is something I don't understand. Efficient expand should run first, and then default expand, that's why we have 2 = 1 + 1"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 18,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "updated."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 80,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/query.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -16
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 65,
                    "deletions": -28
                }
            ],
            "sizeInsertions": 180,
            "sizeDeletions": 47
        },
        {
            "number": 11,
            "revision": "f578f33d469cec5469113f049d6a1388d0440436",
            "parents": [
                "08d81adaa729a59ad98ba295320252410324decc"
            ],
            "ref": "refs/changes/95/63695/11",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1685047298,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 57,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Ok, I think I see the confusion here (and I'm not sure I know the right behavior here, but I have a guess).\n\nLevel 1 expands each object in the sensor collection\nRelatedItem is a collection, and at a property level it has AutoExpandReferences set, which means that L2 has already been expanded.  This DOESN'T mean that the expansion doesn't count against the depth, because it was already expanded, just automatically in the standard.\n\nWe should get the experts looking at this, but to my eye, this looks correct.  You would need expand level 3 to expand\n\nSensorCollection.Members\nSensor.RelatedItem\nRelatedItem[0]\n\nand get the result you want.  Does depth=3 get you what you're looking for?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 57,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "I don't think we should have auto expand count as a level of depth.  We don't do that anywhere else from what I can tell.  For example, Members in a Chassis collection is also AutoExpandReferences https://github.com/openbmc/bmcweb/blob/master/static/redfish/v1/schema/ChassisCollection_v1.xml#L63\n\nIf I'm understanding it correctly then with what you're describing we should be doing /redfish/v1/Chassis?$expand=.($levels=2) in order to get the individual Chassis objects.\n\nI think the issue is efficient sensor expand is not completely compatible with the updated expand (https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60727).  The efficient version makes assumptions which have been removed from the overall expand approach"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 57,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> I don't think we should have auto expand count as a level of depth.\n\nWe shouldn't guess here.  Either it's written in the spec, in which case we should do what it says, or it's not, and we should get the behavior called out.\n\n> in order to get the individual Chassis objects.\n\nNo, because Chassis has ContainsTarget=True, so when you navitage the thing, it's actually the thing, not an expanded reference.\n\n> I think the issue is efficient sensor expand is not completely compatible with the updated expand\n\nYep, that could be."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 57,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "> Does depth=3 get you what you're looking for?\n\nyeah, depth=3 does get the expected output.\n\n---\n\num. That would make sense, however, this is only an issue with delegated expand + default.\n\nFor example,\n\n```\nroot@yscbj4-nfd01:~# wget -qO- 'http://localhost:80/redfish/v1/Systems/system/Storage/storage'\n{\n  \"@odata.id\": \"/redfish/v1/Systems/system/Storage/storage\",\n  \"@odata.type\": \"#Storage.v1_9_1.Storage\",\n  \"Drives\": [\n    {\n      \"@odata.id\": \"/redfish/v1/Chassis/storage/Drives/drive\"\n    }\n  ],\n  ...\n}\n```\n\n> 'http://localhost:80/redfish/v1/Systems/system/Storage/storage?$expand=.($levels=1)'\n\nsould expand the Drive.\n\nSo the behavior is different between only default handler and delegated + default.\n\nMy issue on this is that the default handler is counting the levels that has already been expected by delegated handler.\n\nWith\nquery.expandLevel = 2 ->\n  query.expandLevel = 1 and delegated.expandLevel = 1.\n\nThe query.expandLevel just looks at the thing already expanded by delegated.expandLevel and does nothing.\n\nWith query.expandLevel = 3 ->\n  query.expandLevel = 2 and delegated.expandLevel = 1.\nThis would work since we still have 1 level of expand left."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 57,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "> We shouldn't guess here. Either it's written in the spec, in which case we should do what it says, or it's not, and we should get the behavior called out.\n\nThe spec seems to suggest that it's actually AutoExpand and not AutoExpandReferences that count as a level https://www.dmtf.org/sites/default/files/standards/documents/DSP0266_1.18.0.pdf#page=48\n\n```\nThe $expand query parameter has a set of possible options that determine which hyperlinks in a\nresource are included in the expanded response. Some resources may already be expanded due to the\nresource's schema annotation AutoExpand , such as the Temperature object in the Thermal resource.\n```\n\nThe Temperatures array has AutoExpand unlike the other resources we've mentioned https://github.com/openbmc/bmcweb/blob/master/static/redfish/v1/schema/Thermal_v1.xml#L94\n\nThe response from /redfish/v1/Chassis/{ChassisId}/Thermal actually has the Temperature resources expanded\n\n```\ncurl -s 'localhost/redfish/v1/Chassis/chassis/Thermal'\n{\n  \"@odata.id\": \"/redfish/v1/Chassis/chassis/Thermal\",\n  \"@odata.type\": \"#Thermal.v1_4_0.Thermal\",\n  \"Fans\": [],\n  \"Id\": \"Thermal\",\n  \"Name\": \"Thermal\",\n  \"Redundancy\": [],\n  \"Temperatures\": [\n    {\n      \"@odata.id\": \"/redfish/v1/Chassis/chassis/Thermal#/Temperatures/0\",\n      \"@odata.type\": \"#Thermal.v1_3_0.Temperature\",\n      \"MaxReadingRangeTemp\": 125.0,\n      \"MemberId\": \"sensor\",\n      \"MinReadingRangeTemp\": 0.0,\n      \"Name\": \"Sensor\",\n      \"ReadingCelsius\": 47.0,\n      \"Status\": {\n        \"Health\": \"OK\",\n        \"State\": \"Enabled\"\n      }\n    },\n    ...\n}\n```\n\nThat type of auto expand will get correctly counted as a level by the existing expand implementation."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 57,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> > We shouldn't guess here. Either it's written in the spec, in which case we should do what it says, or it's not, and we should get the behavior called out.\n> \n> The spec seems to suggest that it's actually AutoExpand and not AutoExpandReferences that count as a level https://www.dmtf.org/sites/default/files/standards/documents/DSP0266_1.18.0.pdf#page=48\n> \n> ```\n> The $expand query parameter has a set of possible options that determine which hyperlinks in a\n> resource are included in the expanded response. Some resources may already be expanded due to the\n> resource's schema annotation AutoExpand , such as the Temperature object in the Thermal resource.\n\nI buy that interpretation.\n\n> ```\n> \n> The Temperatures array has AutoExpand unlike the other resources we've mentioned https://github.com/openbmc/bmcweb/blob/master/static/redfish/v1/schema/Thermal_v1.xml#L94\n> \n> The response from /redfish/v1/Chassis/{ChassisId}/Thermal actually has the Temperature resources expanded\n> \n> ```\n> curl -s 'localhost/redfish/v1/Chassis/chassis/Thermal'\n> {\n>   \"@odata.id\": \"/redfish/v1/Chassis/chassis/Thermal\",\n>   \"@odata.type\": \"#Thermal.v1_4_0.Thermal\",\n>   \"Fans\": [],\n>   \"Id\": \"Thermal\",\n>   \"Name\": \"Thermal\",\n>   \"Redundancy\": [],\n>   \"Temperatures\": [\n>     {\n>       \"@odata.id\": \"/redfish/v1/Chassis/chassis/Thermal#/Temperatures/0\",\n>       \"@odata.type\": \"#Thermal.v1_3_0.Temperature\",\n>       \"MaxReadingRangeTemp\": 125.0,\n>       \"MemberId\": \"sensor\",\n>       \"MinReadingRangeTemp\": 0.0,\n>       \"Name\": \"Sensor\",\n>       \"ReadingCelsius\": 47.0,\n>       \"Status\": {\n>         \"Health\": \"OK\",\n>         \"State\": \"Enabled\"\n>       }\n>     },\n>     ...\n> }\n> ```\n> \n> That type of auto expand will get correctly counted as a level by the existing expand implementation."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 57,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "> I buy that interpretation\n\nIn that case are there any concerns with reverting to the approach used in Patchset 9?  It's compatible with that interpretation and plays well with aggregation.  If we don't use a depth-based method (e.g. Patchset 11) then serious additional work would be required to support both of those."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 57,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Sounds fine to me so long as willy is ok with it."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 57,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "I am fine with it. I have reverted back to PATCH 9/10 for now.\n\nIt was moved away from it due to Nan's concern, so would want to check to see if that understanding is aligned."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 57,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Works for me;  Waiting on response from Nan."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "@carson, I'm having trouble parsing your replies;  Are you cool with this as written, or does it still need some iteration to support aggregation properly?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Carson",
                        "email": "clabrado@google.com",
                        "username": "carsonlab"
                    },
                    "message": "Sorry about that.  I'm not cool with it as written (Patchset 11).  It effectively reverts https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60727 and thus reintroduces the original aggregated $expand issue that was fixed by that patch.\n\nI tested Patchset 9 and I'm good with that one.  It makes considerations for depth expanded so we won't get burned by assuming whether or not aggregated resources have been expanded."
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "line": 537,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This is really confusing to me, doesn't this mean that we will now just expand everything, regardless of depth?"
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "line": 537,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "it will just always go one level deeper every time. No matter how much the level of delegated expand."
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "line": 585,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "????  Without this check, this is now going to expand non-resources (like array elements), which doesn't seem correct?"
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "line": 585,
                    "reviewer": {
                        "name": "Willy Tu",
                        "email": "wltu@google.com",
                        "username": "wltu"
                    },
                    "message": "oh.\n\nDoes this mean that in the example\n```\n    {\n      \"@odata.id\": \"/redfish/v1/Chassis/BMC/Sensors/temperature_DIMMXX\",\n      \"@odata.type\": \"#Sensor.v1_2_0.Sensor\",\n      \"Id\": \"temperature_DIMMXX\",\n      \"Name\": \"DIMMXX\",\n      \"Reading\": 30.0,\n      \"ReadingRangeMax\": 127.0,\n      \"ReadingRangeMin\": -128.0,\n      \"ReadingType\": \"Temperature\",\n      \"ReadingUnits\": \"Cel\",\n      \"RelatedItem\": [\n        {\n          \"@odata.id\": \"/redfish/v1/Systems/system/Memory/dimmXX\"\n        }\n      ],\n      \"Status\": {\n        \"Health\": \"OK\",\n        \"State\": \"Enabled\"\n      },\n      \"Thresholds\": {\n        \"LowerCaution\": {\n          \"Reading\": null\n        },\n        \"LowerCritical\": {\n          \"Reading\": null\n        },\n        \"UpperCaution\": {\n          \"Reading\": 93.0\n        },\n        \"UpperCritical\": {\n          \"Reading\": 95.0\n        }\n      }\n    }\n  ],\n  \"Members@odata.count\": 242,\n  \"Name\": \"Sensors\"\n}\n```\n\nThe stuff in `RelatedItem` shouldn't be expanded?\n\n-----\n\nAll we are doing is finding all odata id.\n\nSo things in\n\n```\n[\n  {\n    \"@odata.id\": \"/redfish/v1/0\"\n  },\n  {\n    \"@odata.id\": \"/redfish/v1/1\"\n  },\n  ,,,\n]\n```\n\nwill all get expanded,"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 87,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -26
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 23,
                    "deletions": -51
                }
            ],
            "sizeInsertions": 121,
            "sizeDeletions": 77
        },
        {
            "number": 12,
            "revision": "d790c530f52d17e5e284499eb7aff2aa50a2712c",
            "parents": [
                "9ba73934501fc4bfe8edf74b8a0211701b6d58ca"
            ],
            "ref": "refs/changes/95/63695/12",
            "uploader": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "createdOn": 1686178232,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 80,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/query.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -16
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 65,
                    "deletions": -28
                }
            ],
            "sizeInsertions": 180,
            "sizeDeletions": 47
        },
        {
            "number": 13,
            "revision": "32cdb4a78399fec17442dc2cd36b2e57382475a3",
            "parents": [
                "994fd86a3f6649a820f66313765e85e762ad105a"
            ],
            "ref": "refs/changes/95/63695/13",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1686584002,
            "author": {
                "name": "Willy Tu",
                "email": "wltu@google.com",
                "username": "wltu"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 80,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/query.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                },
                {
                    "file": "redfish-core/include/utils/query_param.hpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": -16
                },
                {
                    "file": "test/redfish-core/include/utils/query_param_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 65,
                    "deletions": -28
                }
            ],
            "sizeInsertions": 180,
            "sizeDeletions": 47
        }
    ]
}