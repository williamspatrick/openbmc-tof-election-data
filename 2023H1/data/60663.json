{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I841f1eec680db07d9957e2ac34718225bcd4e892",
    "number": 60663,
    "subject": "Correct Processor and Memory Summary state",
    "owner": {
        "name": "Ninad Palsule",
        "email": "ninad@linux.ibm.com",
        "username": "ninadpalsule"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60663",
    "hashtags": [],
    "createdOn": 1675738247,
    "lastUpdated": 1682365943,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1675738247,
            "reviewer": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1675738266,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1675738267,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1675739167,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/60255/ : SUCCESS"
        },
        {
            "timestamp": 1675785905,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1675787747,
            "reviewer": {
                "name": "Lakshmi Yadlapati",
                "email": "lakshmiy@us.ibm.com",
                "username": "Lakshmi-y"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1675798479,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1675863496,
            "reviewer": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1675872745,
            "reviewer": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1675872775,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1675872775,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1675872899,
            "reviewer": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1675873579,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/60508/ : SUCCESS"
        },
        {
            "timestamp": 1675969461,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1675971431,
            "reviewer": {
                "name": "Lakshmi Yadlapati",
                "email": "lakshmiy@us.ibm.com",
                "username": "Lakshmi-y"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1675980115,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1676045002,
            "reviewer": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1676307366,
            "reviewer": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1676307395,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1676307400,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1676307427,
            "reviewer": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1676308196,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/60823/ : SUCCESS"
        },
        {
            "timestamp": 1676381372,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1680883690,
            "reviewer": {
                "name": "Lakshmi Yadlapati",
                "email": "lakshmiy@us.ibm.com",
                "username": "Lakshmi-y"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1680884343,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1680886374,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gmills@us.ibm.com",
                "username": "gtmills"
            },
            "message": "Patch Set 3: Code-Review-1\n\n(1 comment)"
        },
        {
            "timestamp": 1682365943,
            "reviewer": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "message": "Abandoned\n\nIt was decided to deprecate these option. The new commit https://gerrit.openbmc.org/c/openbmc/bmcweb/+/62731 replaces this commit."
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "2a2b053e8099499ea9882d59c9e27f3ab1b696d8",
            "parents": [
                "72fff0a87162a166a7d7ea721dbfeeaf567d8670"
            ],
            "ref": "refs/changes/63/60663/1",
            "uploader": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "createdOn": 1675738247,
            "author": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 69,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "It looks like the HeathState is updated only if previous HealthState is not \"OK\".\n\nWhat if the current HealthState is \"OK\" but isDimmFunctional is changed?\n\nFor example, should we do like this?\n\n```\nif (prevMemSummary != \"OK\" && isDimmFunctional)\n{\n     aResp->res.jsonValue[\"MemorySummary\"][\"Status\"][\"Health\"] = \"OK\";\n}\nelse if(prevMemSummary == \"OK\" && !isDimmFunctional)\n{\n     aResp->res.jsonValue[\"MemorySummary\"][\"Status\"][\"Health\"] = \"Critical\";\n}\n```"
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 69,
                    "reviewer": {
                        "name": "Lakshmi Yadlapati",
                        "email": "lakshmiy@us.ibm.com",
                        "username": "Lakshmi-y"
                    },
                    "message": "May be similar to FabricAdapter, initialize the State and Health with \"Enabled\" and \"OK\"\nhttps://gerrit.openbmc.org/c/openbmc/bmcweb/+/60515/5"
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 69,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "In FabricAdapter, it seems okay because it is initialized as \"OK\" first.\n\nSimilar logic can be done here by setting as something not\"OK\" first like in \n\n```\n#2923        asyncResp->res.jsonValue[\"MemorySummary\"][\"Status\"][\"State\"] =\n#2924            \"Disabled\";\n      ADD> asyncResp->res.jsonValue[\"MemorySummary\"][\"Status\"][\"Health\"] = \"Critical\"; \n\n```\n\nOR \nreverse the logic like - initialized as \"OK\" and then detect \"Critical\" state?"
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 69,
                    "reviewer": {
                        "name": "Ninad Palsule",
                        "email": "ninad@linux.ibm.com",
                        "username": "ninadpalsule"
                    },
                    "message": "These are summary states across multiple CPU and memory. Hence we can not mark them critical based on single memory or CPU state. Summary state is initialized before we start processing. Looks like \"State\"\"Health\" is not initialized. I could do that."
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 69,
                    "reviewer": {
                        "name": "Ninad Palsule",
                        "email": "ninad@linux.ibm.com",
                        "username": "ninadpalsule"
                    },
                    "message": "Added initialization for \"state\"\"health\". Also talked to Lakshmi and Myung about it and they are fine with how states are set."
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 129,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "Similar to the above Memory status, it looks like the HeathState is updated only if previous HealthState is not \"OK\".\n\nWhat if the current HealthState is \"OK\" but isDimmFunctional is changed?\n\nFor example, should we do like this?\n\n```\nif (prevProcState != \"OK\" && isCpuFunctional)\n{\n    aResp->res.jsonValue[\"ProcessorSummary\"][\"Status\"][\"Health\"] = \"OK\";\n}\nelse if(prevProcState == \"OK\" && !isCpuFunctional)\n{\n    aResp->res.jsonValue[\"ProcessorSummary\"][\"Status\"][\"Health\"]  = \"Critical\";\n}\n```"
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 129,
                    "reviewer": {
                        "name": "Ninad Palsule",
                        "email": "ninad@linux.ibm.com",
                        "username": "ninadpalsule"
                    },
                    "message": "These are summary states across multiple CPU and memory. Hence we can not mark them critical based on single memory or CPU state."
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 129,
                    "reviewer": {
                        "name": "Ninad Palsule",
                        "email": "ninad@linux.ibm.com",
                        "username": "ninadpalsule"
                    },
                    "message": "I talked to Myung and he is fine with it."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 72,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": -13
                }
            ],
            "sizeInsertions": 85,
            "sizeDeletions": 13
        },
        {
            "number": 2,
            "revision": "c67574a554acbdab428d494592f511b4ca05343b",
            "parents": [
                "72fff0a87162a166a7d7ea721dbfeeaf567d8670"
            ],
            "ref": "refs/changes/63/60663/2",
            "uploader": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "createdOn": 1675872745,
            "author": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 28,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "What is the impact to clients, and will they need to adapt their code?  Please answer in your commit message."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 28,
                    "reviewer": {
                        "name": "Ninad Palsule",
                        "email": "ninad@linux.ibm.com",
                        "username": "ninadpalsule"
                    },
                    "message": "Is this regarding the changes on the output of summary due to my changes and how it is affecting someone trying to parse the output from client side?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 28,
                    "reviewer": {
                        "name": "Ninad Palsule",
                        "email": "ninad@linux.ibm.com",
                        "username": "ninadpalsule"
                    },
                    "message": "Updated comment section."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 72,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": -13
                }
            ],
            "sizeInsertions": 89,
            "sizeDeletions": 13
        },
        {
            "number": 3,
            "revision": "9ec2f9f269267999a09b62281abc856a841991a8",
            "parents": [
                "0af78d5a61687d999d7ec68b003137db1201b225"
            ],
            "ref": "refs/changes/63/60663/3",
            "uploader": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "createdOn": 1676307366,
            "author": {
                "name": "Ninad Palsule",
                "email": "ninad@linux.ibm.com",
                "username": "ninadpalsule"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "Redfish deprecated the Processor/Memory Summary Status (state, health, healthrollup)\n\nWould it just be better to remove these?\n\n\n\n                 \"Status\": {\n                    \"$ref\": \"http://redfish.dmtf.org/schemas/v1/Resource.json#/definitions/Status\",\n                    \"deprecated\": \"This property has been deprecated in favor of the Conditions property within Status in the root of this resource.\",\n                    \"description\": \"The status and health of the resource and its subordinate or dependent resources.\",\n                    \"longDescription\": \"This property shall contain any status or health properties of the resource.\",\n                    \"versionDeprecated\": \"v1_16_0\"\n                },"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "After discussing on discord, can we just remove these with a meson option ? \nThe meson option can be defaulted to these are remvoed. \nIn 6 months 4Q23, we could remove this property and the meson option \nhttps://discord.com/channels/775381525260664832/855566794994221117/1093939076710793296"
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "line": 374,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gmills@us.ibm.com",
                        "username": "gtmills"
                    },
                    "message": "Should you also move this?"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 80,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/systems.hpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": -13
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 13
        }
    ]
}