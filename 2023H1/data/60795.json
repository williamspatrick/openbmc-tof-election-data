{
    "project": "openbmc/openbmc",
    "branch": "master",
    "id": "Iead978ef3651448f4c32936402607fbb3267ee18",
    "number": 60795,
    "subject": "meta-ethanolx: Add service to transfer BMC IP to FPGA",
    "owner": {
        "name": "Konstantin Aladyshev",
        "email": "aladyshev22@gmail.com",
        "username": "Kostr"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openbmc/+/60795",
    "hashtags": [],
    "createdOn": 1675935009,
    "lastUpdated": 1676052123,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1675935009,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1675935039,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1675935039,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1675935047,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/15897/"
        },
        {
            "timestamp": 1675936127,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/15897/ : SUCCESS"
        },
        {
            "timestamp": 1675936138,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 1:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1675937331,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 1:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1675956905,
            "reviewer": {
                "name": "Supreeth Venkatesh",
                "email": "supreeth.venkatesh@amd.com",
                "username": "supven01"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(1 comment)"
        },
        {
            "timestamp": 1675958764,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1675959207,
            "reviewer": {
                "name": "Supreeth Venkatesh",
                "email": "supreeth.venkatesh@amd.com",
                "username": "supven01"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1675962348,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1675982664,
            "reviewer": {
                "name": "Supreeth Venkatesh",
                "email": "supreeth.venkatesh@amd.com",
                "username": "supven01"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1676018187,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1676018244,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1676018244,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1676018253,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/15928/"
        },
        {
            "timestamp": 1676018915,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/15928/ : SUCCESS"
        },
        {
            "timestamp": 1676018928,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1676020137,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1676023813,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1676023845,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1676023845,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1676023853,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/15931/"
        },
        {
            "timestamp": 1676024466,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/15931/ : SUCCESS"
        },
        {
            "timestamp": 1676024478,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1676025693,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1676029622,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1676045074,
            "reviewer": {
                "name": "Supreeth Venkatesh",
                "email": "supreeth.venkatesh@amd.com",
                "username": "supven01"
            },
            "message": "Patch Set 3: Code-Review+2\n\n(1 comment)"
        },
        {
            "timestamp": 1676052123,
            "reviewer": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "message": "Change has been successfully rebased and submitted as 19abd9609891f016e7b86fc72a203c0b0369a927"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "8fe7d15e890a1a00e1ac43e21e32ea40d22389ba",
            "parents": [
                "b800b14a0fd5f0c80f301232dbc8e34873b784b5"
            ],
            "ref": "refs/changes/95/60795/1",
            "uploader": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "createdOn": 1675935009,
            "author": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Supreeth Venkatesh",
                        "email": "supreeth.venkatesh@amd.com",
                        "username": "supven01"
                    },
                    "message": "This service should check for SW2-7 switch first. Also, this service can be enhanced to include FPGA register dump capability."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Konstantin Aladyshev",
                        "email": "aladyshev22@gmail.com",
                        "username": "Kostr"
                    },
                    "message": "Hi, Supreeth! Thanks for the review!\n\nWhat exactly do you have in mind for the enhancement of this service?\nBecause there is already a script for the FPGA content dump in the repository: \nhttps://github.com/openbmc/openbmc/blob/master/meta-amd/recipes-amd/amd-fpga/files/ethanolx/fpgardu.sh\n\nAlso why do you think we need to check `SW2-7` first? To read this pin we need to access FPGA over I2C (https://github.com/openbmc/openbmc/blob/1c0ad56ce6422742cc84bf9116b38f4e4548758f/meta-amd/recipes-amd/amd-fpga/files/ethanolx/fpgardu.sh#L270).\nThis is a time/resource consuming operation that we would need to do in a loop in this case.\nBut in the current solution we only access I2C when IP is changed, which sounds to me more relaxing on the processor time and resources.\nAlso the BMC can write FPGA registers regardless of the switch. Switch position only affects how FPGA uses its 7-segment displays, and doesn't affect the FPGA register usage."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Supreeth Venkatesh",
                        "email": "supreeth.venkatesh@amd.com",
                        "username": "supven01"
                    },
                    "message": "https://github.com/openbmc/openbmc/blob/master/meta-amd/recipes-amd/amd-fpga/files/ethanolx/fpgardu.sh can be made part of this recipe or all things fpga can be concatenated in the meta-amd/recipes-amd/amd-fpga folder.\n\nif SW2-7 is not \"on\", will this service need to run at all?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Konstantin Aladyshev",
                        "email": "aladyshev22@gmail.com",
                        "username": "Kostr"
                    },
                    "message": "As this recipe is purely for the EthanolX board and nothing else, I thought that it would be best to put it the `meta-ethanolx/recipes-ethanolx` folder.\nDoes it really needed to be placed in the common `meta-amd/recipes-amd` folder? In this case do you want it as another recipe in the `meta-amd/recipes-amd/amd-fpga` folder? Or do you want it as some option in the current `meta-amd/recipes-amd/amd-fpga/amd-fpga.bb` recipe?\n\nThe thing is that SW2-7 can be switched \"on\" and \"off\" at any time by the user on the running system. So in your design we will still need some service that would constantly check SW2-7 state via `i2cget`."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Supreeth Venkatesh",
                        "email": "supreeth.venkatesh@amd.com",
                        "username": "supven01"
                    },
                    "message": "Please keep it in meta-amd/recipes-amd/amd-fpga folder.\n\nFor the time being, We can skip SW2-7 check."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Konstantin Aladyshev",
                        "email": "aladyshev22@gmail.com",
                        "username": "Kostr"
                    },
                    "message": "I've moved `ip-to-fpga.bb` recipe and its files to the `meta-amd/recipes-amd/amd-fpga/` folder. Is this solution ok?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Supreeth Venkatesh",
                        "email": "supreeth.venkatesh@amd.com",
                        "username": "supven01"
                    },
                    "message": "Ack"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/meta-ethanolx/recipes-ethanolx/ip-to-fpga/ip-to-fpga.bb",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/meta-ethanolx/recipes-ethanolx/ip-to-fpga/files/ip-to-fpga.service",
                    "type": "ADDED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/meta-ethanolx/recipes-ethanolx/ip-to-fpga/files/ip-to-fpga.sh",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/meta-ethanolx/recipes-phosphor/images/obmc-phosphor-image.bbappend",
                    "type": "ADDED",
                    "insertions": 3,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 87,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "bb5f14d797347a828980c560d214d8048fa7e330",
            "parents": [
                "4483df75f10555067520b5265a219c98d5d38b0b"
            ],
            "ref": "refs/changes/95/60795/2",
            "uploader": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "createdOn": 1676018187,
            "author": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/recipes-amd/amd-fpga/files/ip-to-fpga.sh",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/recipes-amd/amd-fpga/ip-to-fpga.bb",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/recipes-amd/amd-fpga/files/ip-to-fpga.service",
                    "type": "ADDED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/meta-ethanolx/recipes-amd/packagegroups/packagegroup-amd-apps.bbappend",
                    "type": "ADDED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 85,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "6e025a6e0073c35e5e63702ebd0a9649dac24b16",
            "parents": [
                "4483df75f10555067520b5265a219c98d5d38b0b"
            ],
            "ref": "refs/changes/95/60795/3",
            "uploader": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "createdOn": 1676023813,
            "author": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/recipes-amd/amd-fpga/files/ip-to-fpga.sh",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/recipes-amd/amd-fpga/ip-to-fpga.bb",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/recipes-amd/amd-fpga/files/ip-to-fpga.service",
                    "type": "ADDED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/meta-ethanolx/recipes-amd/packagegroups/packagegroup-amd-apps.bbappend",
                    "type": "ADDED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 85,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "19abd9609891f016e7b86fc72a203c0b0369a927",
            "parents": [
                "679df8aee342c26ef7f7e9e96ddf3cfed94cf526"
            ],
            "ref": "refs/changes/95/60795/4",
            "uploader": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "createdOn": 1676052123,
            "author": {
                "name": "Konstantin Aladyshev",
                "email": "aladyshev22@gmail.com",
                "username": "Kostr"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/recipes-amd/amd-fpga/files/ip-to-fpga.sh",
                    "type": "ADDED",
                    "insertions": 33,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/recipes-amd/amd-fpga/ip-to-fpga.bb",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/recipes-amd/amd-fpga/files/ip-to-fpga.service",
                    "type": "ADDED",
                    "insertions": 11,
                    "deletions": 0
                },
                {
                    "file": "meta-amd/meta-ethanolx/recipes-amd/packagegroups/packagegroup-amd-apps.bbappend",
                    "type": "ADDED",
                    "insertions": 1,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 85,
            "sizeDeletions": 0
        }
    ]
}