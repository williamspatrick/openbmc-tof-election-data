{
    "project": "openbmc/openbmc",
    "branch": "master",
    "id": "I6737e208b59830262f51a8e30c78a97fc698e4fd",
    "number": 60238,
    "subject": "meta-ibm:ncsi: ensure eth speeds set to 1 gigabit",
    "owner": {
        "name": "Andrew Geissler",
        "email": "geissonator@yahoo.com",
        "username": "geissonator"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openbmc/+/60238",
    "hashtags": [],
    "createdOn": 1673463607,
    "lastUpdated": 1673643922,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1673463607,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1673463632,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1673463632,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1673463640,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/15523/"
        },
        {
            "timestamp": 1673463909,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1673464610,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/15523/ : FAILURE"
        },
        {
            "timestamp": 1673466968,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1673467014,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1673467014,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1673467020,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/15525/"
        },
        {
            "timestamp": 1673467783,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/15525/ : SUCCESS"
        },
        {
            "timestamp": 1673467792,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1673468018,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 2:\n\nThis change is ready for review."
        },
        {
            "timestamp": 1673468984,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1673470777,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 2: Code-Review-1\n\n(4 comments)"
        },
        {
            "timestamp": 1673472976,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1673472976,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 3:\n\n(3 comments)"
        },
        {
            "timestamp": 1673473029,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1673473029,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1673473036,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/15527/"
        },
        {
            "timestamp": 1673473955,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/15527/ : SUCCESS"
        },
        {
            "timestamp": 1673473967,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1673474591,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1673475157,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1673497434,
            "reviewer": {
                "name": "Sunitha Harish",
                "email": "sunithaharish04@gmail.com",
                "username": "sunharis"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1673500010,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1673533963,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1673534178,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1673534985,
            "reviewer": {
                "name": "Milton D. Miller II",
                "email": "mdmii@outlook.com",
                "username": "mdmillerii"
            },
            "message": "Patch Set 3: Code-Review+1\n\n(2 comments)"
        },
        {
            "timestamp": 1673542700,
            "reviewer": {
                "name": "Sunitha Harish",
                "email": "sunithaharish04@gmail.com",
                "username": "sunharis"
            },
            "message": "Patch Set 3: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1673643920,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 3: Code-Review+2\n\n(1 comment)"
        },
        {
            "timestamp": 1673643922,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Change has been successfully rebased and submitted as 3da13b3a39f123f81094675f0802c4578f8b7a84"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "836ee5d88c1883a5cb2e0fc86ec4909ade9dbd88",
            "parents": [
                "73965e1d84fb42c4a73902d506fce96da2ee3c13"
            ],
            "ref": "refs/changes/38/60238/1",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1673463607,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-linkspeed@.service",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/phosphor-network_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 71,
            "sizeDeletions": 2
        },
        {
            "number": 2,
            "revision": "4cb9531dea8ffd652cb6b600282b1e8e49c885e4",
            "parents": [
                "73965e1d84fb42c4a73902d506fce96da2ee3c13"
            ],
            "ref": "refs/changes/38/60238/2",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1673466968,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "shell check.net was happy.  \n\nsome comments for the next update documentation"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-linkspeed@.service",
                    "line": 8,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "(part of) this comment is describing the -p0 -c0 arguments but us disconnected"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-linkspeed@.service",
                    "line": 8,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Moved the details into the new script"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "line": 19,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "this is the OEM command sent over netlink.   calling it netparam can be misleading"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "line": 19,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Removed and just hard coded it in this script"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "line": 25,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "because the package and channel are hard coded in this line although another theoretical system can have multiple packages and,4port packages"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "line": 25,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Move the whole hard code into the new script so it's all in once place if it needs to be changed some day"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-linkspeed@.service",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/phosphor-network_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 71,
            "sizeDeletions": 2
        },
        {
            "number": 3,
            "revision": "1e30d05ecde67f188eafc453e641b53f3a19f0a3",
            "parents": [
                "73965e1d84fb42c4a73902d506fce96da2ee3c13"
            ],
            "ref": "refs/changes/38/60238/3",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1673472976,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-linkspeed@.service",
                    "line": 6,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "What is this timeout used for ?"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-linkspeed@.service",
                    "line": 6,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "it's the overall timeout before systemd declared the task broken and aborts it.   it should be above the expected time for the unit to exhaust internal retries by some margin of safety.   I didn't check the math (nor the documentation that it's the intended valuebi just specified the intended setting function)"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-linkspeed@.service",
                    "line": 6,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Yep, script should take a max of 60s (12 retries * 5s). So this 90s is just a safety buffer in case something goes wrong with the script."
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-linkspeed@.service",
                    "line": 6,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "also it gives some time between the sleeps"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "line": 5,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "This will need the admin to set the static IP on the eth1 interface within this max retry time. If admin delays the network setup, issue will surface back.\n\nIs there a way to run this script when eth1 interface moves from inactive->active ? and avoid running these attempt loops?"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "line": 5,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "My understanding from Milton is that the IP address being assigned to the interface is unrelated to when we can send this command to program the NCSI interface speed. But will need Milton to comment."
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "line": 5,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "Yes the NCSI protocol is Ethernet not IP"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "line": 5,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "Ack"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "line": 5,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Ack"
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/phosphor-network_%.bbappend",
                    "line": 30,
                    "reviewer": {
                        "name": "Milton D. Miller II",
                        "email": "mdmii@outlook.com",
                        "username": "mdmillerii"
                    },
                    "message": "as remaining comment - we change which template based on the system but install this new script and add bash for all systems vs just those using linkspeed template.\n\nthe additional script is tiny and bash is probably pervasive but..."
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/phosphor-network_%.bbappend",
                    "line": 30,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Yeah, I basically just copy/pasted what we did with ncsi-netlink-ifindex. It wont hurt anything so let me take a separate TODO to clean both up in a later commit (and all our other IBM systems def bring in bash in some way)."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-linkspeed@.service",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -3
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/phosphor-network_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 74,
            "sizeDeletions": 3
        },
        {
            "number": 4,
            "revision": "3da13b3a39f123f81094675f0802c4578f8b7a84",
            "parents": [
                "517393d903089f921915530ffa689a7a1d113420"
            ],
            "ref": "refs/changes/38/60238/4",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1673643922,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 30,
                    "deletions": 0
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-linkspeed@.service",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -3
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/network/ncsi-wait-and-set-speed",
                    "type": "ADDED",
                    "insertions": 37,
                    "deletions": 0
                },
                {
                    "file": "meta-ibm/recipes-phosphor/network/phosphor-network_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 74,
            "sizeDeletions": 3
        }
    ]
}