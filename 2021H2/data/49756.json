{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I1e9cf03ebdcdeff490478f364de10a7c58fea197",
    "number": 49756,
    "subject": "bmcweb: New feature ExternalStorer",
    "owner": {
        "name": "Josh Lehan",
        "email": "krellan@google.com",
        "username": "Krellan"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/bmcweb/+/49756",
    "commitMessage": "bmcweb: New feature ExternalStorer\n\nThis is my first draft of a new feature, ExternalStorer.\nIt will be described in a forthcoming document.\n\nThis is WIP, just to make sure I'm on the right track.\n\nChange-Id: I1e9cf03ebdcdeff490478f364de10a7c58fea197\nSigned-off-by: Josh Lehan <krellan@google.com>\n",
    "createdOn": 1639651653,
    "lastUpdated": 1641415729,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1639651653,
            "reviewer": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1639651687,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1639651864,
            "reviewer": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "message": "Patch Set 1:\n\nThis is a WIP and is an example of 2 instances at various URL's. There's no user data yet, everything is read-only."
        },
        {
            "timestamp": 1639652144,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/32137/ : SUCCESS"
        },
        {
            "timestamp": 1639735713,
            "reviewer": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1639735730,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1639735771,
            "reviewer": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "message": "Patch Set 2:\n\nGetting farther along, you can POST data now, and GET it back later."
        },
        {
            "timestamp": 1639736193,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/32203/ : SUCCESS"
        },
        {
            "timestamp": 1641286889,
            "reviewer": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1641286904,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1641286904,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1641286994,
            "reviewer": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1641287361,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/34852/ : SUCCESS"
        },
        {
            "timestamp": 1641409411,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(4 comments)"
        },
        {
            "timestamp": 1641415729,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(20 comments)"
        }
    ],
    "wip": true,
    "patchSets": [
        {
            "number": 1,
            "revision": "212e01072eb53e364c9b278a075aca0dd4261a0d",
            "parents": [
                "6fbdbcabc3ae43dc372459c6c5ae4d53657267f5"
            ],
            "ref": "refs/changes/56/49756/1",
            "uploader": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "createdOn": 1639651653,
            "author": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/registries/privilege_registry.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/external_storer.hpp",
                    "type": "ADDED",
                    "insertions": 146,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/external_storer_entry.hpp",
                    "type": "ADDED",
                    "insertions": 22,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "type": "ADDED",
                    "insertions": 99,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 281,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "40d2eb6aa4af3ce9d664c4a4588c1d1bac6f03e7",
            "parents": [
                "f451bec02f7ec14b18c5df7065aff90e67637107"
            ],
            "ref": "refs/changes/56/49756/2",
            "uploader": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "createdOn": 1639735713,
            "author": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "redfish-core/include/registries/privilege_registry.hpp",
                    "line": 2,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "You seem to have ignored this comment."
                },
                {
                    "file": "redfish-core/lib/external_storer.hpp",
                    "line": 20,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This is on purpose.  See COMMON_ERRORS.md for why.\n\nConstexpr strings can work though."
                },
                {
                    "file": "redfish-core/lib/service_root.hpp",
                    "line": 66,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This isn't in the Redfish schema, and will fail the validator.  Please follow the redfish spec."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/registries/privilege_registry.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/external_storer.hpp",
                    "type": "ADDED",
                    "insertions": 199,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "type": "ADDED",
                    "insertions": 315,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 528,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "5dbca30654472b4d0f440cccb42c1e3075be3a6a",
            "parents": [
                "85ffe86a60f50ce9ad5728caf384a0dd0c8cc6a5"
            ],
            "ref": "refs/changes/56/49756/3",
            "uploader": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "createdOn": 1641286889,
            "author": {
                "name": "Josh Lehan",
                "email": "krellan@google.com",
                "username": "Krellan"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Josh Lehan",
                        "email": "krellan@google.com",
                        "username": "Krellan"
                    },
                    "message": "Added PUT and DELETE methods. Query parameters for GET are the only feature still missing.\n"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I had some comments from a while back.  Might not apply to latest patchset."
                },
                {
                    "file": "redfish-core/lib/external_storer.hpp",
                    "line": 23,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This is explicitly called out in COMMON_ERRORS.md why we don't \"minimize duplication\""
                },
                {
                    "file": "redfish-core/lib/external_storer.hpp",
                    "line": 24,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Definitely not the right values, but I get this is WIP."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 11,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Lets add limits in another patch."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 24,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please just inline this."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 30,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Maybe a better class name here?  \"Instance\" isn't very descriptive."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 34,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "no need to explicitly construct things with no arguments."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 52,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "These are pretty important todos.  As written, this won't really have the intended behavior (ie, type and all fields are provided by user)."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 56,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This makes the assumption that all resources are collections, which doesn't seem right to me."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 58,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This is just iterating all entries?  Doesn't there need to be some matching on URL?"
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 60,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Remove.  Expand is handled at a higher level, and wouldn't be storer specific."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 65,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Again, not all resources are collections."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 249,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Lets add round trip parsing in another patchset to keep this patchset simple."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 259,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This is expclicitly called out in COMMON_ERRORS.md.  Please read and understand that doc and do as it asks."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 261,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Empty dictionary might be valid."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 262,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "You probably want is_object() here.  this will return a valid value if the user writes an array."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 293,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This makes the assumption that all collections are sequenced by numbers, which isn't true."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 295,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "String copy."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 304,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Seems odd we would need to special case this at this level.  Should we validate the input earlier?"
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 340,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "lets worry about oldest invalidation in a future patch to keep this patchset simple.  Getting storage correct will be difficult enough without adding everything in a single patch."
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "line": 361,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "no need for mutexes in single threaded code."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/redfish.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/include/registries/privilege_registry.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/external_storer.hpp",
                    "type": "ADDED",
                    "insertions": 201,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/external_storer_instance.hpp",
                    "type": "ADDED",
                    "insertions": 368,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/service_root.hpp",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 583,
            "sizeDeletions": 0
        }
    ]
}