{
    "project": "openbmc/entity-manager",
    "branch": "master",
    "id": "Ic852e10b3515fbb5567f80a9922373fa84ff08b1",
    "number": 47902,
    "subject": "Support pre-defined 16bit EEPROM bus and address",
    "owner": {
        "name": "FranHsu",
        "email": "fran.hsu@quantatw.com",
        "username": "Fran-Hsu"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/entity-manager/+/47902",
    "commitMessage": "Support pre-defined 16bit EEPROM bus and address\n\nThere are two issues report the isDevice16bit function is not\nworking on every 16bits addressing EEPROM when the EEPROM\nis not listed in the DTS.\nhttps://github.com/openbmc/entity-manager/issues/14\nhttps://github.com/openbmc/entity-manager/issues/15\n\nSo this patchset introduces a pre-defined 16bit EEPROM setting to let\nthe fru-device works on pre-defined 16bit EEPROMs.\nThe user could set a set of buses and addresses for the known 16bit\naddressing EEPROMs. The fru-device will check the list first than\nusing isDevice16bit function to detect the type of the EEPROM.\n\nFor eeprom16Bitlist json file, it supports two variables, bus and\naddress, which means the 16 bit EEPROM's bus and address, and only\nsupports integers currently.\n\nIf there are two 16 bit EEPROMs in bus 0 address 45(0x2d) and 50(0x32)\n(the address is 7 bit), eeprom16Bitlist.json will like below:\n{\n    \"device16Bitlist\":[\n        {\n            \"bus\" : 0,\n            \"address\" : [\n                45,\n                50\n            ]\n        }\n    ]\n}\nIf there is empty in \"address\" list like default json, FruDevice will\ndetect EEPROM is 16 bit or not via original function \"isDevice16Bit\".\n\nTested: a M24C64 EERPOM on bus45 and addr 0x55:\n\neeprom16Bitlist.json :\n{\n    \"device16Bitlist\":[\n        {\n            \"bus\" : 45,\n            \"address\" : [\n                85\n            ]\n        }\n    ]\n}\n\nbusctl tree xyz.openbmc_project.FruDevice\n /xyz\n  /xyz/openbmc_project\n    /xyz/openbmc_project/FruDevice\n      /xyz/openbmc_project/FruDevice/M24C64\n\nxyz.openbmc_project.FruDevice    interface -       -            -\n.ADDRESS               property  u 85                 emits-change\n.BOARD_LANGUAGE_CODE   property  s \"25\"               emits-change\n.BOARD_MANUFACTURER    property  s \"Quanta\"           emits-change\n.BOARD_PART_NUMBER     property  s \"1234567-01\"       emits-change\n.BOARD_PRODUCT_NAME    property  s \"M24C64\"           emits-change\n.BOARD_SERIAL_NUMBER   property  s \"M24C64TEST123456\" emits-change\n.BUS                   property  u 45                 emits-change\n.Common_Format_Version property  s \"1\"                emits-change\n\nSigned-off-by: Fran Hsu <fran.hsu@quantatw.com>\nChange-Id: Ic852e10b3515fbb5567f80a9922373fa84ff08b1\nSigned-off-by: Harvey.Wu <Harvey.Wu@quantatw.com>\n",
    "createdOn": 1634558730,
    "lastUpdated": 1640050044,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1634558730,
            "reviewer": {
                "name": "FranHsu",
                "email": "fran.hsu@quantatw.com",
                "username": "Fran-Hsu"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1634560042,
            "reviewer": {
                "name": "FranHsu",
                "email": "fran.hsu@quantatw.com",
                "username": "Fran-Hsu"
            },
            "message": "Patch Set 2: Commit message was updated."
        },
        {
            "timestamp": 1634605981,
            "reviewer": {
                "name": "FranHsu",
                "email": "fran.hsu@quantatw.com",
                "username": "Fran-Hsu"
            },
            "message": "Removed reviewer OpenBMC CI."
        },
        {
            "timestamp": 1634606069,
            "reviewer": {
                "name": "FranHsu",
                "email": "fran.hsu@quantatw.com",
                "username": "Fran-Hsu"
            },
            "message": "Patch Set 3: Commit message was updated."
        },
        {
            "timestamp": 1634607063,
            "reviewer": {
                "name": "Nan Zhou",
                "email": "nanzhoumails@gmail.com",
                "username": "FighterNan"
            },
            "message": "Patch Set 3: Code-Review+1\n\n(3 comments)\n\nLGTM. It is mostly a decision we need to make."
        },
        {
            "timestamp": 1634610453,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(17 comments)"
        },
        {
            "timestamp": 1635846594,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 4."
        },
        {
            "timestamp": 1635846609,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1635846793,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/29496/ : FAILURE"
        },
        {
            "timestamp": 1635846902,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Patch Set 5: Patch Set 4 was rebased"
        },
        {
            "timestamp": 1635846914,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1635847094,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 6."
        },
        {
            "timestamp": 1635847102,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/29497/ : FAILURE"
        },
        {
            "timestamp": 1635847109,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1635847365,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/29498/ : SUCCESS"
        },
        {
            "timestamp": 1635924281,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 7."
        },
        {
            "timestamp": 1635924302,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1635924561,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/29671/ : SUCCESS"
        },
        {
            "timestamp": 1635926843,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 8: Commit message was updated."
        },
        {
            "timestamp": 1635926872,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Patch Set 8:\n\n(18 comments)"
        },
        {
            "timestamp": 1636761529,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 8:\n\n(5 comments)"
        },
        {
            "timestamp": 1636762392,
            "reviewer": {
                "name": "Benjamin Fair",
                "email": "benjaminfair@google.com",
                "username": "BenjaminFair"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1636960826,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 9."
        },
        {
            "timestamp": 1636960838,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1636961068,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 10."
        },
        {
            "timestamp": 1636961098,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1636961099,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 9: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/30243/ : SUCCESS"
        },
        {
            "timestamp": 1636961357,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 10: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/30245/ : SUCCESS"
        },
        {
            "timestamp": 1636962154,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Patch Set 10:\n\n(5 comments)"
        },
        {
            "timestamp": 1637112965,
            "reviewer": {
                "name": "Benjamin Fair",
                "email": "benjaminfair@google.com",
                "username": "BenjaminFair"
            },
            "message": "Patch Set 10: Code-Review+1\n\n(2 comments)"
        },
        {
            "timestamp": 1637163043,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 10:\n\n(2 comments)"
        },
        {
            "timestamp": 1637801423,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Uploaded patch set 11."
        },
        {
            "timestamp": 1637801434,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1637801724,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 11: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/30784/ : SUCCESS"
        },
        {
            "timestamp": 1637827039,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Patch Set 11:\n\n(4 comments)"
        },
        {
            "timestamp": 1638492530,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 11:\n\n(1 comment)"
        },
        {
            "timestamp": 1640049691,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Patch Set 12: Patch Set 11 was rebased"
        },
        {
            "timestamp": 1640049707,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1640049992,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 12: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/32297/ : SUCCESS"
        },
        {
            "timestamp": 1640050044,
            "reviewer": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "message": "Patch Set 12:\n\nFriendly ping"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "40d07980af97af09d786919489dc77348a3db7ba",
            "parents": [
                "32aa4dda124aeec491eb612acfa00d3ccf939d21"
            ],
            "ref": "refs/changes/02/47902/1",
            "uploader": {
                "name": "FranHsu",
                "email": "fran.hsu@quantatw.com",
                "username": "Fran-Hsu"
            },
            "createdOn": 1634558730,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 41,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 89,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 99,
            "sizeDeletions": 1
        },
        {
            "number": 2,
            "revision": "cd8d3cf532577c47fb4d030e9d11fa6c029acc7d",
            "parents": [
                "32aa4dda124aeec491eb612acfa00d3ccf939d21"
            ],
            "ref": "refs/changes/02/47902/2",
            "uploader": {
                "name": "FranHsu",
                "email": "fran.hsu@quantatw.com",
                "username": "Fran-Hsu"
            },
            "createdOn": 1634560042,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 41,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 89,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 99,
            "sizeDeletions": 1
        },
        {
            "number": 3,
            "revision": "a193c1d859b47ef735c6a867af5dcefe26ca0bdb",
            "parents": [
                "32aa4dda124aeec491eb612acfa00d3ccf939d21"
            ],
            "ref": "refs/changes/02/47902/3",
            "uploader": {
                "name": "FranHsu",
                "email": "fran.hsu@quantatw.com",
                "username": "Fran-Hsu"
            },
            "createdOn": 1634606069,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "50/72 please."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 11,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 20,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "More details here;  What are the parameters in the config file?  What do they control?  How do they relate to the other config files?  How is the dynamic selection obeyed?  Are the addresses 7 bit or 8 bit?  Does the config file accept hex strings or integers?  How does one declare a 16 bit address in an entity config file?\n\nPlease answer in your commit message."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 20,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "line": 6,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Should this list be flatter?  Something like\n\n\"device16bitlist\":[\n        {\n            \"bus\" : 0,\n            \"address\" : 65\n        },\n        {\n            \"bus\" : 42,\n            \"address\" : 102\n        },\n]"
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "line": 6,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "This config is a default file like blacklist.json, so I think the address list should be empty that could ignore this config when user doesn't want to use this feature."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 430,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I realize this was here before, but \"flag\" is a pretty bad name for this variable.  Maybe we should call it \"deviceIs16Bit\"?"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 430,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 89,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Can this be done without yet another global?\n\nAlso, I realize the struct above does it, but mixing flat_map with std::set kinda defeats the purpose of using flattened structures in the first place.  I'd recommend flat_map<size_t, flat_set<size_t>>\n\nAlso, please add a comment of what this map is.  Having two integer types is not very descriptive of what this contains.\n\nCould this be combined with the failedAddresses map, by creating something like\n\nstruct AddressStatus {\n    bool is16Bit;\n    size_t failureCount;\n}\nthen having\n\nflat_map<size_t, flat_set<AddressStatus>>?\n\nConsidering the only lookup to this structure is directly above failed addresses that seems like it would solve both problems at the same time."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 89,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "I use two layers flat_map to save bus, address index, and use struct to save failed address and is16bit status. This can use map.find() function to find address status easily."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 371,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Why does this need to be promoted to this scope?  Where it was previously defined looks like it should be fine?"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 371,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Move to original location."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 549,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "nit: should be \"*BitList\"?"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 549,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Prefer std::filesystem::path here."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 549,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 549,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 572,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This looks largely copied from elsewhere in this codebase.  Please make an attempt to abstract instead of copy/pasting."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 572,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Hi Ed, I removed an if condition, added more detect key functions below, and modified some error logs. Does this change look better?"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 574,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "operator[] creates if this key doesn't exist, which is almost definitely not your intent.  Maybe you meant to loop over the keys?"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 574,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Hi Ed, I'm not very understanding about your means. I add an if condition to detect the key \"device16bitlist\" exist or not."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 575,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "is `(auto& listConfigs : data[\"device16bitlist\"])` working?"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 575,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I prefer the explicit type here."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 575,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "const please."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 575,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 577,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Considering that bus is generally assigned dynamically, doesn't this need to have a second indirection against the actual bus list?  Otherwise, it will lead to hardcoding bus numbers, which is generally an anti-pattern, especially for add in cards."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 577,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "According issue #14, #15 in entity-manager, there are some EEPROM that couldn't be detected via \"isDevice16Bit\" function, so we add this optional feature that could fix this problem if EEPROM is pre-defined in device tree."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 581,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "this is essentially inventing nlohmann::json::find in a less efficient way, please just use find."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 581,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 588,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Please replace this with get_ptr<int64_t> and do appropriate range checks."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 588,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 589,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This will throw if the key doesn't exist.  Again, please use find and get_ptr."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 589,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Maybe I make some mistake when I tested. \"address\" is a list array, so I couldn't use get_ptr to get value to input for loop(for (const auto& addr : dev16BitAddresses))"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 602,
                    "reviewer": {
                        "name": "Nan Zhou",
                        "email": "nanzhoumails@gmail.com",
                        "username": "FighterNan"
                    },
                    "message": "ditto: `for (const auto& addr : dev16BitAddresses[bus])`"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 602,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done. Modified to another meaningful name."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 611,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Does this need to propagate the error code further?"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 611,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Modified to use std::exit(EXIT_FAILURE)"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 611,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "I think the error log is enough."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 614,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This statement does nothing.  Please remove."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 614,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 40,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 89,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 99,
            "sizeDeletions": 1
        },
        {
            "number": 4,
            "revision": "c053e62ecd6098a336f1a2a585ed880a87e234a0",
            "parents": [
                "32aa4dda124aeec491eb612acfa00d3ccf939d21"
            ],
            "ref": "refs/changes/02/47902/4",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1635846594,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 155,
                    "deletions": -15
                }
            ],
            "sizeInsertions": 165,
            "sizeDeletions": 15
        },
        {
            "number": 5,
            "revision": "04a67c340ff8411588e46bc255a406c5338ec783",
            "parents": [
                "6bf41588abf5048da5764f2a809f3841bcbef761"
            ],
            "ref": "refs/changes/02/47902/5",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1635846902,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 155,
                    "deletions": -15
                }
            ],
            "sizeInsertions": 165,
            "sizeDeletions": 15
        },
        {
            "number": 6,
            "revision": "ac6169ab1408dc5600e73fd0e0a0e72bf2140d98",
            "parents": [
                "6bf41588abf5048da5764f2a809f3841bcbef761"
            ],
            "ref": "refs/changes/02/47902/6",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1635847094,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 155,
                    "deletions": -15
                }
            ],
            "sizeInsertions": 165,
            "sizeDeletions": 15
        },
        {
            "number": 7,
            "revision": "ab8dcd3e4a7585ebe22cfeccac2f48b8d8c38feb",
            "parents": [
                "6bf41588abf5048da5764f2a809f3841bcbef761"
            ],
            "ref": "refs/changes/02/47902/7",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1635924281,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 149,
                    "deletions": -15
                }
            ],
            "sizeInsertions": 159,
            "sizeDeletions": 15
        },
        {
            "number": 8,
            "revision": "5346a9d414472cb2468ccfc0593ad17ecb688789",
            "parents": [
                "6bf41588abf5048da5764f2a809f3841bcbef761"
            ],
            "ref": "refs/changes/02/47902/8",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1635926843,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Why isDevice16bit fails to detecting these 16bit EEPROM? Can the function be updated so it works for these devices also?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Umm...I still couldn't find the root cause for detecting 16bit EEPROM failed and the better way for the detecting function. Do you have any suggestions?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "I don't have the issue in my system. But looking at the code it depends on reading different values for 16bit eeprom. Just wondering why that would fail for certain parts. Just thought if that can be understood, make the auto detection work seems a bit cleaner solution."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "I have a question about detecting 16bit eeprom.\nAccording comments(https://github.com/openbmc/entity-manager/blob/master/src/FruDevice.cpp#L205), if is 16bit, it will move to the next byte automatically after reading byte.\nIf isDevice16Bit function is fixed and there is a 16bit eeprom, but this eeprom is already read 256 or more times by another daemon before FruDevice, this means FruDevice cannot detect this 16bit eeprom possibly, right?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 19,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "If the bus and address for these 16bit EEPROM is already known, why not just add them to DTS?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 19,
                    "reviewer": {
                        "name": "Benjamin Fair",
                        "email": "benjaminfair@google.com",
                        "username": "BenjaminFair"
                    },
                    "message": "Different boards with the same image may have EEPROMs in different locations. If they're all listed in the device tree, then the missing ones will fail to probe, delaying boot and printing extra error messages.\n\nWe can list all the possible 16 bit EEPROM locations here and have one image that supports boards with EEPROMs in any of those locations"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 19,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "That is fair. One more question though, theoretically, if this file is intend to have all possible locations listed, there is a risk on collision, i.e. a possible 16bit location actually has a 8bit part. Is that a concern in reality?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 19,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "That's a good point. But I don't have that situation in my system.\nI think it can be solved via modifying json file by user?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 19,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Ack, I am ok with the assumption that the collision can be resolved with a different json, i.e. no collision among the systems supported by same build image."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 648,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "AddressStatus status = {1, 0};"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 648,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 649,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "prefer emplace"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 649,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 658,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "I don't think we want exit here"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 658,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done. Adding more logs and using return."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 74,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 149,
                    "deletions": -15
                }
            ],
            "sizeInsertions": 159,
            "sizeDeletions": 15
        },
        {
            "number": 9,
            "revision": "6172bca0ad5fe0591627d5dd4b8e6bc3a64e648d",
            "parents": [
                "6bf41588abf5048da5764f2a809f3841bcbef761"
            ],
            "ref": "refs/changes/02/47902/9",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1636960826,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 144,
                    "deletions": -15
                }
            ],
            "sizeInsertions": 154,
            "sizeDeletions": 15
        },
        {
            "number": 10,
            "revision": "220f8446fdf617e387361025785bff6b2d5068fe",
            "parents": [
                "6bf41588abf5048da5764f2a809f3841bcbef761"
            ],
            "ref": "refs/changes/02/47902/10",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1636961068,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "eeprom16Bitlist.json",
                    "line": 2,
                    "reviewer": {
                        "name": "Benjamin Fair",
                        "email": "benjaminfair@google.com",
                        "username": "BenjaminFair"
                    },
                    "message": "Capitalization should be consistent with the filename"
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "line": 2,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done. Modified the capitalization to same as filename."
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 445,
                    "reviewer": {
                        "name": "Benjamin Fair",
                        "email": "benjaminfair@google.com",
                        "username": "BenjaminFair"
                    },
                    "message": "just combine these two checks together with short-circuit &&"
                },
                {
                    "file": "src/FruDevice.cpp",
                    "line": 445,
                    "reviewer": {
                        "name": "Harvey Wu",
                        "email": "Harvey.Wu@quantatw.com",
                        "username": "harveyquta"
                    },
                    "message": "Done. Thanks for the reminder."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 145,
                    "deletions": -15
                }
            ],
            "sizeInsertions": 155,
            "sizeDeletions": 15
        },
        {
            "number": 11,
            "revision": "454216c057214af34437be6c656f47dd1af28b27",
            "parents": [
                "7939a765cb6f6e128c87ab61e2bd86d2cae0f9da"
            ],
            "ref": "refs/changes/02/47902/11",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1637801423,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 138,
                    "deletions": -15
                }
            ],
            "sizeInsertions": 148,
            "sizeDeletions": 15
        },
        {
            "number": 12,
            "revision": "b8b9a17469dc0dfcf53c128af97a45be38742994",
            "parents": [
                "f466ccece5c08a028b173a017f7894aecfccdcde"
            ],
            "ref": "refs/changes/02/47902/12",
            "uploader": {
                "name": "Harvey Wu",
                "email": "Harvey.Wu@quantatw.com",
                "username": "harveyquta"
            },
            "createdOn": 1640049691,
            "author": {
                "name": "Fran Hsu",
                "email": "Fran.Hsu@quantatw.com",
                "username": ""
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 73,
                    "deletions": 0
                },
                {
                    "file": "eeprom16Bitlist.json",
                    "type": "ADDED",
                    "insertions": 9,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/FruDevice.cpp",
                    "type": "MODIFIED",
                    "insertions": 138,
                    "deletions": -15
                }
            ],
            "sizeInsertions": 148,
            "sizeDeletions": 15
        }
    ]
}