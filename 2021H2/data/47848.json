{
    "project": "openbmc/openpower-occ-control",
    "branch": "master",
    "id": "I30d8f9de1914d9808ddb7b547cc57085a5e5779e",
    "number": 47848,
    "subject": "Add SBE timeout handling",
    "owner": {
        "name": "Edward A. James",
        "email": "eajames@us.ibm.com",
        "username": "eddiejames"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/openpower-occ-control/+/47848",
    "commitMessage": "Add SBE timeout handling\n\nAdd an Error instance to detect SBE timeouts in the driver.\nRefactor the PLDM code to handle another requeset type (the HRESET) and\nanother type of sensor event (success or failure of the HRESET).\nHandle the timeout and the PLDM event state change in the Manager by\nchanging the SBE state and requesting an SBE dump if necessary.\n\nSigned-off-by: Eddie James <eajames@linux.ibm.com>\nChange-Id: I30d8f9de1914d9808ddb7b547cc57085a5e5779e\n",
    "createdOn": 1634249532,
    "lastUpdated": 1635179571,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1634249532,
            "reviewer": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1634249549,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1634249576,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/28313/ : FAILURE"
        },
        {
            "timestamp": 1634302129,
            "reviewer": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "message": "Patch Set 2: Patch Set 1 was rebased"
        },
        {
            "timestamp": 1634302142,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1634302200,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/28341/ : SUCCESS"
        },
        {
            "timestamp": 1634333600,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2: Code-Review+1\n\nlooks good to me, nice work!"
        },
        {
            "timestamp": 1634657073,
            "reviewer": {
                "name": "Jayanth Othayoth",
                "email": "ojayanth@gmail.com",
                "username": "ojayanth"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1634678605,
            "reviewer": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1634753568,
            "reviewer": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "message": "Uploaded patch set 3."
        },
        {
            "timestamp": 1634753583,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1634754178,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/28642/ : SUCCESS"
        },
        {
            "timestamp": 1634755350,
            "reviewer": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "message": "Uploaded patch set 4: Patch Set 3 was rebased."
        },
        {
            "timestamp": 1634755363,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1634755518,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/28645/ : SUCCESS"
        },
        {
            "timestamp": 1634765855,
            "reviewer": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "message": "Uploaded patch set 5: Patch Set 4 was rebased."
        },
        {
            "timestamp": 1634765870,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1634765997,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/28667/ : SUCCESS"
        },
        {
            "timestamp": 1635175876,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 5: Code-Review+1"
        },
        {
            "timestamp": 1635176543,
            "reviewer": {
                "name": "Chris Cain",
                "email": "cjcain@us.ibm.com",
                "username": "cjcain"
            },
            "message": "Patch Set 5: Code-Review+1"
        },
        {
            "timestamp": 1635179550,
            "reviewer": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "message": "Patch Set 5: Code-Review+2"
        },
        {
            "timestamp": 1635179571,
            "reviewer": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "message": "Change has been successfully rebased and submitted as cbad219e4f92f1087e372b4ce108bce3534d786e by Edward A. James"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "26a4bec5b4526d6e5012e487c27a04a9ff6dbca3",
            "parents": [
                "1353cb4b711f94a4500a6343f2e6cd172b5d094d"
            ],
            "ref": "refs/changes/48/47848/1",
            "uploader": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "createdOn": 1634249532,
            "author": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "configure.ac",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "occ_device.cpp",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "occ_device.hpp",
                    "type": "MODIFIED",
                    "insertions": 54,
                    "deletions": -7
                },
                {
                    "file": "occ_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 102,
                    "deletions": -1
                },
                {
                    "file": "occ_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "occ_status.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -9
                },
                {
                    "file": "occ_status.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -10
                },
                {
                    "file": "pldm.cpp",
                    "type": "MODIFIED",
                    "insertions": 200,
                    "deletions": -109
                },
                {
                    "file": "pldm.hpp",
                    "type": "MODIFIED",
                    "insertions": 81,
                    "deletions": -31
                },
                {
                    "file": "pldm.mk",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "test/Makefile.am",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 514,
            "sizeDeletions": 169
        },
        {
            "number": 2,
            "revision": "e73a4d95a26434192a6cc47514d01b4a5220d9b3",
            "parents": [
                "3685f581ccf0768b81c2deb6a0be5cc9f09e9cf2"
            ],
            "ref": "refs/changes/48/47848/2",
            "uploader": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "createdOn": 1634302129,
            "author": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "configure.ac",
                    "line": 97,
                    "reviewer": {
                        "name": "Jayanth Othayoth",
                        "email": "ojayanth@gmail.com",
                        "username": "ojayanth"
                    },
                    "message": "Need to include libphal lib."
                },
                {
                    "file": "configure.ac",
                    "line": 97,
                    "reviewer": {
                        "name": "Edward A. James",
                        "email": "eajames@us.ibm.com",
                        "username": "eddiejames"
                    },
                    "message": "Ack"
                },
                {
                    "file": "occ_manager.cpp",
                    "line": 267,
                    "reviewer": {
                        "name": "Jayanth Othayoth",
                        "email": "ojayanth@gmail.com",
                        "username": "ojayanth"
                    },
                    "message": "Need to check another dump collection is in progress or any SVE vital attn is active  before trieggering dump. need skip dump collection in both cases.\n\nbool isDumpAllowed(struct pdbg_target *proc);\nbool isSbeVitalAttnActive(struct pdbg_target *proc);"
                },
                {
                    "file": "occ_manager.cpp",
                    "line": 267,
                    "reviewer": {
                        "name": "Edward A. James",
                        "email": "eajames@us.ibm.com",
                        "username": "eddiejames"
                    },
                    "message": "OK, will do. Do I need to check for SBE vital attn before triggering HRESET too?"
                },
                {
                    "file": "occ_manager.cpp",
                    "line": 347,
                    "reviewer": {
                        "name": "Jayanth Othayoth",
                        "email": "ojayanth@gmail.com",
                        "username": "ojayanth"
                    },
                    "message": "setState  throws exception for failure case , like any cfam write failure. are you exeptcing application crash here , your want catch execption and create error log and continue?"
                },
                {
                    "file": "occ_manager.cpp",
                    "line": 347,
                    "reviewer": {
                        "name": "Edward A. James",
                        "email": "eajames@us.ibm.com",
                        "username": "eddiejames"
                    },
                    "message": "Ack"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "configure.ac",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "occ_device.cpp",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "occ_device.hpp",
                    "type": "MODIFIED",
                    "insertions": 54,
                    "deletions": -7
                },
                {
                    "file": "occ_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 102,
                    "deletions": -1
                },
                {
                    "file": "occ_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "occ_status.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -9
                },
                {
                    "file": "occ_status.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -10
                },
                {
                    "file": "pldm.cpp",
                    "type": "MODIFIED",
                    "insertions": 200,
                    "deletions": -109
                },
                {
                    "file": "pldm.hpp",
                    "type": "MODIFIED",
                    "insertions": 81,
                    "deletions": -31
                },
                {
                    "file": "pldm.mk",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "test/Makefile.am",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 514,
            "sizeDeletions": 169
        },
        {
            "number": 3,
            "revision": "bc2f68b9a5cabbdedd988ac14e010d651c685601",
            "parents": [
                "9d682af52774da4815bc6515987efcde8c6fdcee"
            ],
            "ref": "refs/changes/48/47848/3",
            "uploader": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "createdOn": 1634753568,
            "author": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "occ_device.cpp",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "occ_device.hpp",
                    "type": "MODIFIED",
                    "insertions": 54,
                    "deletions": -7
                },
                {
                    "file": "occ_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 153,
                    "deletions": -1
                },
                {
                    "file": "occ_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": 0
                },
                {
                    "file": "occ_status.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -9
                },
                {
                    "file": "occ_status.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -10
                },
                {
                    "file": "pldm.cpp",
                    "type": "MODIFIED",
                    "insertions": 200,
                    "deletions": -109
                },
                {
                    "file": "pldm.hpp",
                    "type": "MODIFIED",
                    "insertions": 81,
                    "deletions": -31
                }
            ],
            "sizeInsertions": 570,
            "sizeDeletions": 167
        },
        {
            "number": 4,
            "revision": "20e6ee89f9028fa5096a11ba2f8f50d2b2366d5c",
            "parents": [
                "ed0b2c3be573919e5c70371534fafdc7f5b61122"
            ],
            "ref": "refs/changes/48/47848/4",
            "uploader": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "createdOn": 1634755350,
            "author": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "occ_device.cpp",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "occ_device.hpp",
                    "type": "MODIFIED",
                    "insertions": 54,
                    "deletions": -7
                },
                {
                    "file": "occ_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 153,
                    "deletions": -1
                },
                {
                    "file": "occ_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": 0
                },
                {
                    "file": "occ_status.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -9
                },
                {
                    "file": "occ_status.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -10
                },
                {
                    "file": "pldm.cpp",
                    "type": "MODIFIED",
                    "insertions": 200,
                    "deletions": -109
                },
                {
                    "file": "pldm.hpp",
                    "type": "MODIFIED",
                    "insertions": 81,
                    "deletions": -31
                }
            ],
            "sizeInsertions": 570,
            "sizeDeletions": 167
        },
        {
            "number": 5,
            "revision": "c04b0821f86bd66202682aff74236504565c1db6",
            "parents": [
                "5b7c4adfc1ddff46ba47577108eeb9a5e704dc61"
            ],
            "ref": "refs/changes/48/47848/5",
            "uploader": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "createdOn": 1634765855,
            "author": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "occ_device.cpp",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "occ_device.hpp",
                    "type": "MODIFIED",
                    "insertions": 54,
                    "deletions": -7
                },
                {
                    "file": "occ_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 153,
                    "deletions": -1
                },
                {
                    "file": "occ_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": 0
                },
                {
                    "file": "occ_status.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -9
                },
                {
                    "file": "occ_status.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -10
                },
                {
                    "file": "pldm.cpp",
                    "type": "MODIFIED",
                    "insertions": 200,
                    "deletions": -109
                },
                {
                    "file": "pldm.hpp",
                    "type": "MODIFIED",
                    "insertions": 81,
                    "deletions": -31
                }
            ],
            "sizeInsertions": 570,
            "sizeDeletions": 167
        },
        {
            "number": 6,
            "revision": "cbad219e4f92f1087e372b4ce108bce3534d786e",
            "parents": [
                "2f9f9bba661dcae2f0dd05ea6ddae9eb11a909d9"
            ],
            "ref": "refs/changes/48/47848/6",
            "uploader": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "createdOn": 1635179571,
            "author": {
                "name": "Edward A. James",
                "email": "eajames@us.ibm.com",
                "username": "eddiejames"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "occ_device.cpp",
                    "type": "MODIFIED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "occ_device.hpp",
                    "type": "MODIFIED",
                    "insertions": 54,
                    "deletions": -7
                },
                {
                    "file": "occ_manager.cpp",
                    "type": "MODIFIED",
                    "insertions": 153,
                    "deletions": -1
                },
                {
                    "file": "occ_manager.hpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": 0
                },
                {
                    "file": "occ_status.cpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -9
                },
                {
                    "file": "occ_status.hpp",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": -10
                },
                {
                    "file": "pldm.cpp",
                    "type": "MODIFIED",
                    "insertions": 200,
                    "deletions": -109
                },
                {
                    "file": "pldm.hpp",
                    "type": "MODIFIED",
                    "insertions": 81,
                    "deletions": -31
                }
            ],
            "sizeInsertions": 570,
            "sizeDeletions": 167
        }
    ]
}