{
    "project": "openbmc/openbmc",
    "branch": "master",
    "topic": "ibm3131",
    "id": "Ib782d9013c5ad0cfc1b283563ef07dc812fb12f2",
    "number": 46095,
    "subject": "meta-phosphor:fans:presence: Enable JSON config install from repo",
    "owner": {
        "name": "Matthew Barth",
        "email": "msbarth@linux.ibm.com",
        "username": "msbarth"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/openbmc/+/46095",
    "commitMessage": "meta-phosphor:fans:presence: Enable JSON config install from repo\n\nAdd setting the `MACHINE` name to the recipe and pass it to the fan\npresence package to use in installing its JSON config files for that\nmachine into the image from the repository.\n\nChange-Id: Ib782d9013c5ad0cfc1b283563ef07dc812fb12f2\nSigned-off-by: Matthew Barth <msbarth@us.ibm.com>\n",
    "createdOn": 1629478400,
    "lastUpdated": 1629811603,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1629478400,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1629478441,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1629478450,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/6199/"
        },
        {
            "timestamp": 1629479622,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/6199/ : SUCCESS"
        },
        {
            "timestamp": 1629480188,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 1:\n\nThis change is ready for review."
        },
        {
            "timestamp": 1629484638,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1629491574,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 1:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1629726865,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1629731745,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1629731896,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1629742667,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1629742700,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1629742709,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/6217/"
        },
        {
            "timestamp": 1629742722,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1629743675,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/6217/ : SUCCESS"
        },
        {
            "timestamp": 1629744881,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1629753829,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2: Code-Review+2"
        },
        {
            "timestamp": 1629811603,
            "reviewer": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "message": "Change has been successfully rebased and submitted as 2073f7ddadd1e6a0a02908ab34f97fdc39bb104c by Matthew Barth"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "b3e92c48892ef22c3aa35d45486f71b7e5b32542",
            "parents": [
                "20f26daab753da1a01d8b1a680c2c365d0c5537f"
            ],
            "ref": "refs/changes/95/46095/1",
            "uploader": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "createdOn": 1629478400,
            "author": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "line": 38,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "If we're going to use ${MACHINE} here, we should also set in the recipe:\n\nPACKAGE_ARCH = \"${MACHINE_ARCH}\""
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "line": 38,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "What is the purpose of adding this?\n\nIt appears ${MACHINE_ARCH} is automatically set based on ${MACHINE} and this recipe has no specific requirement to use `PACKAGE_ARCH`."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "line": 38,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "The PACKAGE_ARCH determines install restrictions on a package to ensure it is never installed on the wrong kind of machine.  This has two visible impacts:\n1. In your tmp/work/ directory you'll see subdirectories like `witherspoon` and `arm1176jzs`.  This is determined by the PACKAGE_ARCH.\n2. The rpm/ipk files generated by Yocto have the PACKAGE_ARCH in them, and checking is done at install time (if you allow side-loaded packages) to ensure that only packages for the appropriate machine are installed.\n\nTo be honest, we have a lot of packages that are currently having a default PACKAGE_ARCH (and thus based on the arm architecture), but that is incorrect because the package has had machine-specific alterations done to it (and thus should be MACHINE_ARCH).  This one is one where we're clearly using the MACHINE variable, so we should do it right while we're thinking of it."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "line": 38,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Ah, ok. I did see the location change in tmp/work/ after this update. Will add"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "line": 38,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "Done"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "line": 70,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Any idea why we named the package 'presence-tach' if everything in the repository points at it simply being 'presence'?  Should we follow up with a commit to make them match?"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "line": 70,
                    "reviewer": {
                        "name": "Matthew Barth",
                        "email": "msbarth@linux.ibm.com",
                        "username": "msbarth"
                    },
                    "message": "The repository name is `phosphor-fan-presence` which, if I recall, was named since at the time the thought was 1 app per repo(where there would have been a `phosphor-fan-monitor` repo for fan monitoring, etc...). That idea changed mid-flight after the creation of this repo so the fan presence application was named `phosphor-fan-presence-tach` but the repo name was never updated.\n\nThe plan is to deprecate(and rename) the `phosphor-fan-presence` repository to `phosphor-fan` when dropping YAML based config support is ready."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "line": 70,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Ack"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -6
                }
            ],
            "sizeInsertions": 11,
            "sizeDeletions": 6
        },
        {
            "number": 2,
            "revision": "69997aca449555f4f81b5651c108a743888cfda6",
            "parents": [
                "7d637776938c77d69752a72a09edc90ebde93164"
            ],
            "ref": "refs/changes/95/46095/2",
            "uploader": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "createdOn": 1629742667,
            "author": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": -6
                }
            ],
            "sizeInsertions": 12,
            "sizeDeletions": 6
        },
        {
            "number": 3,
            "revision": "2073f7ddadd1e6a0a02908ab34f97fdc39bb104c",
            "parents": [
                "ce1426257525128c9c8f17e91afc6a60d1cb6244"
            ],
            "ref": "refs/changes/95/46095/3",
            "uploader": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "createdOn": 1629811603,
            "author": {
                "name": "Matthew Barth",
                "email": "msbarth@linux.ibm.com",
                "username": "msbarth"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/fans/phosphor-fan_git.bb",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": -6
                }
            ],
            "sizeInsertions": 12,
            "sizeDeletions": 6
        }
    ]
}