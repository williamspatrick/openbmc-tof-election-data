{
    "project": "openbmc/phosphor-power",
    "branch": "master",
    "id": "I9548823fb286fc886cc2c073206ce78f264092b6",
    "number": 48670,
    "subject": "psu-ng: Refactor PMBus expectations helper",
    "owner": {
        "name": "B. J. Wyman",
        "email": "bjwyman@gmail.com",
        "username": "bjwyman"
    },
    "url": "https://gerrit.openbmc-project.xyz/c/openbmc/phosphor-power/+/48670",
    "commitMessage": "psu-ng: Refactor PMBus expectations helper\n\nThe long list of parameters with a default of 0 is getting a bit\nunwieldy to deal with. Refactor this code to use a struct that\ninitializes the values to 0.\n\nUse scoping to allow for defaults of 0, when that is the desired value.\n\nChange-Id: I9548823fb286fc886cc2c073206ce78f264092b6\nSigned-off-by: Brandon Wyman <bjwyman@gmail.com>\n",
    "createdOn": 1636155002,
    "lastUpdated": 1636993943,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1636155002,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1636155018,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1636155555,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/29855/ : SUCCESS"
        },
        {
            "timestamp": 1636156140,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 1:\n\nThis change is ready for review."
        },
        {
            "timestamp": 1636493345,
            "reviewer": {
                "name": "Adriana Kobylak",
                "email": "anoo@linux.ibm.com",
                "username": "anoo1"
            },
            "message": "Patch Set 1: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1636494251,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1636495580,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Patch Set 1:\n\n(2 comments)\n\nLooks good ... some minor comments."
        },
        {
            "timestamp": 1636499690,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1636502474,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Uploaded patch set 2."
        },
        {
            "timestamp": 1636502488,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1636502536,
            "reviewer": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1636503102,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/29989/ : SUCCESS"
        },
        {
            "timestamp": 1636563815,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1636585447,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2: Code-Review+1"
        },
        {
            "timestamp": 1636993908,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Patch Set 2: Code-Review+2"
        },
        {
            "timestamp": 1636993943,
            "reviewer": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "message": "Change has been successfully rebased and submitted as b654c619cafcc6fd77c064a4390e987cc26649a0 by Shawn McCarney"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "4ef6f64e8249902d7b4cbf85515a565d256a1931",
            "parents": [
                "9ddc622e3ad7c9355042275de89ee4422b790186"
            ],
            "ref": "refs/changes/70/48670/1",
            "uploader": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "createdOn": 1636155002,
            "author": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "Adriana Kobylak",
                        "email": "anoo@linux.ibm.com",
                        "username": "anoo1"
                    },
                    "message": "nit: Refactor"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "\ud83d\ude04"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 10,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "Done"
                },
                {
                    "file": "phosphor-power-supply/test/power_supply_tests.cpp",
                    "line": 207,
                    "reviewer": {
                        "name": "Shawn McCarney",
                        "email": "shawnmm@us.ibm.com",
                        "username": "smccarney"
                    },
                    "message": "Using blocks like this to create separate PMBusExpectations objects is a great idea.  No accidental carry-over values from a previous test.\n\nI think it might help with readability if you moved the first comment to the line preceding the block.\n\nThen you have a nice high level overview of what test variation the block is covering.\n\ne.g.\n  // STATUS_WORD 0x0000 is powered on, no faults.\n  {\n    ...\n  }\n  \n  // STATUS_WORD INPUT/UV fault.\n  {\n    ...\n  }\n    \n  // STATUS_WORD MFR fault.\n  {\n    ...\n  }"
                },
                {
                    "file": "phosphor-power-supply/test/power_supply_tests.cpp",
                    "line": 207,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "Ah, yeah, that might be a bit easier to read."
                },
                {
                    "file": "phosphor-power-supply/test/power_supply_tests.cpp",
                    "line": 207,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "Done"
                },
                {
                    "file": "phosphor-power-supply/test/power_supply_tests.cpp",
                    "line": 223,
                    "reviewer": {
                        "name": "Shawn McCarney",
                        "email": "shawnmm@us.ibm.com",
                        "username": "smccarney"
                    },
                    "message": "I don't know if these comments are necessary any more here and in the other test variations.  The helper function and struct make things pretty self-describing IMO.  The reader can tell that fields not set in the struct will be 0.  This eliminates the need to update the list of fields that didn't need to be set when you add new fields."
                },
                {
                    "file": "phosphor-power-supply/test/power_supply_tests.cpp",
                    "line": 223,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "Yeah, good idea, in retrospect. \ud83d\ude1e I am working on a commit where I just had to update a boatload of those comments."
                },
                {
                    "file": "phosphor-power-supply/test/power_supply_tests.cpp",
                    "line": 223,
                    "reviewer": {
                        "name": "B. J. Wyman",
                        "email": "bjwyman@gmail.com",
                        "username": "bjwyman"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/test/power_supply_tests.cpp",
                    "type": "MODIFIED",
                    "insertions": 241,
                    "deletions": -237
                }
            ],
            "sizeInsertions": 241,
            "sizeDeletions": 237
        },
        {
            "number": 2,
            "revision": "03b93319e4e8eeae13ce44b0c0562144e3af13c8",
            "parents": [
                "5d23d9d6805b33423fc9a839980deec8e42b7404"
            ],
            "ref": "refs/changes/70/48670/2",
            "uploader": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "createdOn": 1636502474,
            "author": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/test/power_supply_tests.cpp",
                    "type": "MODIFIED",
                    "insertions": 221,
                    "deletions": -235
                }
            ],
            "sizeInsertions": 221,
            "sizeDeletions": 235
        },
        {
            "number": 3,
            "revision": "b654c619cafcc6fd77c064a4390e987cc26649a0",
            "parents": [
                "209690b532a9a2a6d5f64f3eabbaef5567c1c07d"
            ],
            "ref": "refs/changes/70/48670/3",
            "uploader": {
                "name": "Shawn McCarney",
                "email": "shawnmm@us.ibm.com",
                "username": "smccarney"
            },
            "createdOn": 1636993943,
            "author": {
                "name": "B. J. Wyman",
                "email": "bjwyman@gmail.com",
                "username": "bjwyman"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 16,
                    "deletions": 0
                },
                {
                    "file": "phosphor-power-supply/test/power_supply_tests.cpp",
                    "type": "MODIFIED",
                    "insertions": 221,
                    "deletions": -235
                }
            ],
            "sizeInsertions": 221,
            "sizeDeletions": 235
        }
    ]
}