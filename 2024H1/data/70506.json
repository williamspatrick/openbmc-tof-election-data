{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I982d682481fe0d32b04e879055290295dc457492",
    "number": 70506,
    "subject": "Fix structural issues in ibm locks",
    "owner": {
        "name": "Ed Tanous",
        "email": "ed@tanous.net",
        "username": "edtanous"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/70506",
    "hashtags": [],
    "createdOn": 1712083589,
    "lastUpdated": 1713453400,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1712083589,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1712083649,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1712083649,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1712083728,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/81756/ : FAILURE"
        },
        {
            "timestamp": 1712086073,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1712097409,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3: Commit message was updated."
        },
        {
            "timestamp": 1712097449,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1712097449,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1712097478,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/81766/ : FAILURE"
        },
        {
            "timestamp": 1712121614,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4: Published edit on patch set 3.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1712121631,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1712121631,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1712121661,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/81788/ : FAILURE"
        },
        {
            "timestamp": 1712160617,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 5.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1712160628,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1712160628,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1712160850,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/81820/ : FAILURE"
        },
        {
            "timestamp": 1712161091,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 6: Patch Set 5 was rebased\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1712161108,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1712161108,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1712161824,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/81826/ : SUCCESS"
        },
        {
            "timestamp": 1712391888,
            "reviewer": {
                "name": "Sunitha Harish",
                "email": "sunithaharish04@gmail.com",
                "username": "sunharis"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1712419853,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1712497217,
            "reviewer": {
                "name": "Sunitha Harish",
                "email": "sunithaharish04@gmail.com",
                "username": "sunharis"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1712567160,
            "reviewer": {
                "name": "Ravi Teja",
                "email": "raviteja28031990@gmail.com",
                "username": "raviteja-b"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1712595123,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1712635488,
            "reviewer": {
                "name": "Ravi Teja",
                "email": "raviteja28031990@gmail.com",
                "username": "raviteja-b"
            },
            "message": "Patch Set 6: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1713453400,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Abandoned\n\nwe\u2019re just removing this."
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "f5e381b0c5da5f8264b22c6ada4d859c168faef0",
            "parents": [
                "5575efb61318a29b810b841390dce5b80cbeacfb"
            ],
            "ref": "refs/changes/06/70506/1",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1712083589,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/ibm/locks.hpp",
                    "type": "MODIFIED",
                    "insertions": 75,
                    "deletions": -40
                },
                {
                    "file": "test/include/ibm/configfile_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "test/include/ibm/lock_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -34
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": -43
                }
            ],
            "sizeInsertions": 152,
            "sizeDeletions": 119
        },
        {
            "number": 2,
            "revision": "bb7955215608595be5ad99a5050f177fb955b4f4",
            "parents": [
                "5575efb61318a29b810b841390dce5b80cbeacfb"
            ],
            "ref": "refs/changes/06/70506/2",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1712086073,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/ibm/locks.hpp",
                    "type": "MODIFIED",
                    "insertions": 76,
                    "deletions": -41
                },
                {
                    "file": "test/include/ibm/configfile_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "test/include/ibm/lock_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -34
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": -43
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 120
        },
        {
            "number": 3,
            "revision": "92b9b146fcca370e7bfc8650a13ecbb1b6e31092",
            "parents": [
                "5575efb61318a29b810b841390dce5b80cbeacfb"
            ],
            "ref": "refs/changes/06/70506/3",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1712097409,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/ibm/locks.hpp",
                    "type": "MODIFIED",
                    "insertions": 76,
                    "deletions": -41
                },
                {
                    "file": "test/include/ibm/configfile_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "test/include/ibm/lock_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -34
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": -43
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 120
        },
        {
            "number": 4,
            "revision": "232177ed58b51007b301d720793625bd67e373d1",
            "parents": [
                "5575efb61318a29b810b841390dce5b80cbeacfb"
            ],
            "ref": "refs/changes/06/70506/4",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1712121614,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/ibm/locks.hpp",
                    "type": "MODIFIED",
                    "insertions": 76,
                    "deletions": -41
                },
                {
                    "file": "test/include/ibm/configfile_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "test/include/ibm/lock_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -34
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": -43
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 120
        },
        {
            "number": 5,
            "revision": "83f6d64aefd138ab6edc4fac76d3f9f9493cb908",
            "parents": [
                "5575efb61318a29b810b841390dce5b80cbeacfb"
            ],
            "ref": "refs/changes/06/70506/5",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1712160617,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/ibm/locks.hpp",
                    "type": "MODIFIED",
                    "insertions": 76,
                    "deletions": -41
                },
                {
                    "file": "test/include/ibm/configfile_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "test/include/ibm/lock_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -34
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": -43
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 120
        },
        {
            "number": 6,
            "revision": "5ea59b25ddf13a15bfd422e6472bc0e0eaeee1c6",
            "parents": [
                "60e299bde06288ae01a1dace54039ad7646c3e85"
            ],
            "ref": "refs/changes/06/70506/6",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1712161091,
            "author": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Ravi Teja",
                        "email": "raviteja28031990@gmail.com",
                        "username": "raviteja-b"
                    },
                    "message": "Thank you for fix Ed Tanous\nI have this general question, locks code is under ibm-management-console flag\nand by default this flag will be disabled right? should not have hit any issues with this code unless this oem flag enabled explicitly right?\n\nAs Sunitha mentioned, we will continue to work on re-design this locks."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> Thank you for fix Ed Tanous\n> I have this general question, locks code is under ibm-management-console flag\n> and by default this flag will be disabled right? should not have hit any issues with this code unless this oem flag enabled explicitly right?\n\nFunctionally no, but the problem is that static analyzers can still see this code, and score it or flag issues with it, and those analyzers don't know that these code paths are disabled.  Because it wasn't built to the same coding style that the rest of bmcweb was (using defined dbus interfaces, not relying on undefined behavior, etc) there are lots of issues flagged in these files that need resolved if one wants a clean static analysis run.\n\nIn theory we could go back to not compiling this code in all cases, but then someone would need to maintain it against breakages when people change APIs that it relies on.\n\nI agree with you, these don't have any on-bmc functional impact if the option is disabled.\n\n> \n> As Sunitha mentioned, we will continue to work on re-design this locks."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 7,
                    "reviewer": {
                        "name": "Ravi Teja",
                        "email": "raviteja28031990@gmail.com",
                        "username": "raviteja-b"
                    },
                    "message": "ok got it. since you have fixed it for now, we can merge this fix and wait some more time (~3 months) to remove whole locks feature so that mean while we can get this new re-design & implementation of locks."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "I am currently working on removing the locks feature upstream. ConfigFiles is the feature which will move to its own Dbus app (IBM app)."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> I am currently working on removing the locks feature upstream.\n\nWhen should I expect to see a patch to remove it?\n\n> ConfigFiles is the feature which will move to its own Dbus app (IBM app)."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "I pushed the base commit today - WIP. https://gerrit.openbmc.org/c/openbmc/bmcweb/+/70652\n\nThe re-design of ConfigFile is not complete yet. I will push those changes on top of this commit in this month.\n\nI am OK if the removal of locks feature gets in before the re-design is complete - to get the covert failures fixed. @Gunnar - please share your views."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 19,
                    "deletions": 0
                },
                {
                    "file": "include/ibm/locks.hpp",
                    "type": "MODIFIED",
                    "insertions": 76,
                    "deletions": -41
                },
                {
                    "file": "test/include/ibm/configfile_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "test/include/ibm/lock_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 22,
                    "deletions": -34
                },
                {
                    "file": "include/ibm/management_console_rest.hpp",
                    "type": "MODIFIED",
                    "insertions": 34,
                    "deletions": -43
                }
            ],
            "sizeInsertions": 153,
            "sizeDeletions": 120
        }
    ]
}