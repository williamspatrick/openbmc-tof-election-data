{
    "project": "openbmc/phosphor-user-manager",
    "branch": "master",
    "id": "I053095763c65963ff865b487ab08f05039d2fc3a",
    "number": 73053,
    "subject": "MFA feature: Enable google authenticator",
    "owner": {
        "name": "Abhilash Raju",
        "email": "abhilash.kollam@gmail.com",
        "username": "abhilashraju"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/phosphor-user-manager/+/73053",
    "hashtags": [],
    "createdOn": 1721904836,
    "lastUpdated": 1723477239,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1721904836,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1721904860,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1721904902,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1721904903,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1721904927,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/88616/ : FAILURE"
        },
        {
            "timestamp": 1722266471,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1722266499,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1722266499,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1722266524,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/88778/ : FAILURE"
        },
        {
            "timestamp": 1722833828,
            "reviewer": {
                "name": "Ravi Teja",
                "email": "raviteja28031990@gmail.com",
                "username": "raviteja-b"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1722837623,
            "reviewer": {
                "name": "Ravi Teja",
                "email": "raviteja28031990@gmail.com",
                "username": "raviteja-b"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1722842799,
            "reviewer": {
                "name": "Sunitha Harish",
                "email": "sunithaharish04@gmail.com",
                "username": "sunharis"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1722843475,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 2:\n\n(4 comments)\n\nThis change is ready for review."
        },
        {
            "timestamp": 1722849799,
            "reviewer": {
                "name": "Ravi Teja",
                "email": "raviteja28031990@gmail.com",
                "username": "raviteja-b"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1722858597,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1722858983,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1722958985,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1722959018,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1722959018,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1722959041,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/89278/ : FAILURE"
        },
        {
            "timestamp": 1723182624,
            "reviewer": {
                "name": "Ravi Teja",
                "email": "raviteja28031990@gmail.com",
                "username": "raviteja-b"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1723477239,
            "reviewer": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "8bafe61feeaba1559f3dfa669c22400ad26f14a2",
            "parents": [
                "af1594c90627b78d1a92bb16a0d826b12a0d182c"
            ],
            "ref": "refs/changes/53/73053/1",
            "uploader": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "createdOn": 1721904836,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "user_mgr.hpp",
                    "line": 54,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "re-declaration?"
                },
                {
                    "file": "user_mgr.hpp",
                    "line": 54,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "Acknowledged"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "user_mgr.hpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": -1
                },
                {
                    "file": "users.cpp",
                    "type": "MODIFIED",
                    "insertions": 63,
                    "deletions": 0
                },
                {
                    "file": "users.hpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 101,
            "sizeDeletions": 3
        },
        {
            "number": 2,
            "revision": "51dda8133eb8eb89c28286996ac565303e16b67f",
            "parents": [
                "af1594c90627b78d1a92bb16a0d826b12a0d182c"
            ],
            "ref": "refs/changes/53/73053/2",
            "uploader": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "createdOn": 1722266471,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ravi Teja",
                        "email": "raviteja28031990@gmail.com",
                        "username": "raviteja-b"
                    },
                    "message": "Please fix CI failure and update unit test cases"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ravi Teja",
                        "email": "raviteja28031990@gmail.com",
                        "username": "raviteja-b"
                    },
                    "message": "please make sure this D-bus configuration  persists across reboot"
                },
                {
                    "file": "user_mgr.cpp",
                    "line": 1548,
                    "reviewer": {
                        "name": "Ravi Teja",
                        "email": "raviteja28031990@gmail.com",
                        "username": "raviteja-b"
                    },
                    "message": "why do we need to iterate through userList and set user config??"
                },
                {
                    "file": "user_mgr.cpp",
                    "line": 1548,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "because we need to do certain things like clearing of google_authenticator files belonging to the user. User manager need not worry about those details. Done for encapsulation."
                },
                {
                    "file": "user_mgr.cpp",
                    "line": 1548,
                    "reviewer": {
                        "name": "Ravi Teja",
                        "email": "raviteja28031990@gmail.com",
                        "username": "raviteja-b"
                    },
                    "message": "can't we directly call clearGoogleAuthenticator() for each user from here based on value??\nif (!value)\n{\n    u.second.clearGoogleAuthenticator();\n}"
                },
                {
                    "file": "user_mgr.cpp",
                    "line": 1548,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "This method was not present when I did this patch set. Did you add this to Dbus interface?"
                },
                {
                    "file": "user_mgr.cpp",
                    "line": 1548,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "Also we may have to pass the value flag to the user in case of value is true. We may not have any implementation in googleauthenticator for value true. But in general and in future that may not be true."
                },
                {
                    "file": "user_mgr.cpp",
                    "line": 1548,
                    "reviewer": {
                        "name": "Ravi Teja",
                        "email": "raviteja28031990@gmail.com",
                        "username": "raviteja-b"
                    },
                    "message": "There are no D-bus interfaces changes"
                },
                {
                    "file": "users.cpp",
                    "line": 208,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "Please add an inline comment here saying that this uses the google authenticator app to execute this."
                },
                {
                    "file": "users.cpp",
                    "line": 222,
                    "reviewer": {
                        "name": "Sunitha Harish",
                        "email": "sunithaharish04@gmail.com",
                        "username": "sunharis"
                    },
                    "message": "Set this to false after the remove is successful."
                },
                {
                    "file": "users.cpp",
                    "line": 222,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "I am going to remove the call itself. First of all this need not be property. It can be a method instead. It can be implemented by checking presence of authenticator files. It at all it needs to be property then we will mark it as read only property. Then this set call is un necessary . We will only implement get call that return bool that indicates presence of file."
                },
                {
                    "file": "users.cpp",
                    "line": 222,
                    "reviewer": {
                        "name": "Ravi Teja",
                        "email": "raviteja28031990@gmail.com",
                        "username": "raviteja-b"
                    },
                    "message": "are you saying isSecretKeySetup D-bus method which take username at User-Manager instead of D-bus property at user object?"
                },
                {
                    "file": "users.cpp",
                    "line": 222,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "Nope . I am suggesting isSecretKeySetup as method in User object. We don't have to keep track of property just to check if secret key is setup or not. It will always corresponds to presence of .google_athenticator file in home dir. So make it a method and return value based on the presence of the file will do the job."
                },
                {
                    "file": "users.hpp",
                    "line": 138,
                    "reviewer": {
                        "name": "Ravi Teja",
                        "email": "raviteja28031990@gmail.com",
                        "username": "raviteja-b"
                    },
                    "message": "googleAuthenticatorEnabled is at User-Manager property\ndont need to implement for each user"
                },
                {
                    "file": "users.hpp",
                    "line": 138,
                    "reviewer": {
                        "name": "Abhilash Raju",
                        "email": "abhilash.kollam@gmail.com",
                        "username": "abhilashraju"
                    },
                    "message": "Look at answer above"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "user_mgr.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -1
                },
                {
                    "file": "users.cpp",
                    "type": "MODIFIED",
                    "insertions": 71,
                    "deletions": 0
                },
                {
                    "file": "user_mgr.cpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "users.hpp",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 125,
            "sizeDeletions": 3
        },
        {
            "number": 3,
            "revision": "258533a892548f6d2404cd7d9566ba9a79122466",
            "parents": [
                "af1594c90627b78d1a92bb16a0d826b12a0d182c"
            ],
            "ref": "refs/changes/53/73053/3",
            "uploader": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "createdOn": 1722958985,
            "author": {
                "name": "Abhilash Raju",
                "email": "abhilash.kollam@gmail.com",
                "username": "abhilashraju"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "user_mgr.hpp",
                    "type": "MODIFIED",
                    "insertions": 10,
                    "deletions": -1
                },
                {
                    "file": "users.cpp",
                    "type": "MODIFIED",
                    "insertions": 78,
                    "deletions": 0
                },
                {
                    "file": "user_mgr.cpp",
                    "type": "MODIFIED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "users.hpp",
                    "type": "MODIFIED",
                    "insertions": 18,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 132,
            "sizeDeletions": 3
        }
    ]
}