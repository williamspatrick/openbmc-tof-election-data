{
    "project": "openbmc/dbus-sensors",
    "branch": "master",
    "id": "I6ec34fa9e818a8eba043f9d18e55915b66ee7f89",
    "number": 71090,
    "subject": "Add CPU presence check for I2C devices",
    "owner": {
        "name": "Jan Sowinski",
        "email": "jan.sowinski@intel.com",
        "username": "jansow"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/dbus-sensors/+/71090",
    "hashtags": [],
    "createdOn": 1714053493,
    "lastUpdated": 1715963547,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1714053493,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1714053547,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1714053547,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1714053561,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/83432/ : FAILURE"
        },
        {
            "timestamp": 1714054522,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Uploaded patch set 2: Commit message was updated.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1714054564,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1714054564,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1714054804,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/83435/ : FAILURE"
        },
        {
            "timestamp": 1714055876,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1714055904,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1714055904,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1714056161,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/83436/ : FAILURE"
        },
        {
            "timestamp": 1714163293,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Uploaded patch set 4.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1714163337,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1714163337,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1714163637,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/83477/ : SUCCESS"
        },
        {
            "timestamp": 1714169056,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 4:\n\n(3 comments)"
        },
        {
            "timestamp": 1714380564,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Patch Set 4:\n\n(4 comments)"
        },
        {
            "timestamp": 1714623394,
            "reviewer": {
                "name": "Thang Tran",
                "email": "thuutran@amperecomputing.com",
                "username": "thangtran-ampere"
            },
            "message": "Patch Set 4:\n\n(10 comments)"
        },
        {
            "timestamp": 1715002446,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Uploaded patch set 5.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1715002494,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1715002494,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1715002800,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/83857/ : SUCCESS"
        },
        {
            "timestamp": 1715004547,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Patch Set 5:\n\n(9 comments)"
        },
        {
            "timestamp": 1715018038,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1715021450,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 5:\n\n(4 comments)"
        },
        {
            "timestamp": 1715090233,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Patch Set 5:\n\n(2 comments)"
        },
        {
            "timestamp": 1715136768,
            "reviewer": {
                "name": "Thang Tran",
                "email": "thuutran@amperecomputing.com",
                "username": "thangtran-ampere"
            },
            "message": "Patch Set 5:\n\n(4 comments)"
        },
        {
            "timestamp": 1715253365,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Patch Set 5:\n\n(2 comments)"
        },
        {
            "timestamp": 1715257965,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Uploaded patch set 6.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1715258006,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1715258006,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1715258327,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/84074/ : SUCCESS"
        },
        {
            "timestamp": 1715310167,
            "reviewer": {
                "name": "Thang Tran",
                "email": "thuutran@amperecomputing.com",
                "username": "thangtran-ampere"
            },
            "message": "Patch Set 6: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1715384818,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1715786733,
            "reviewer": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1715963547,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "7d63eeb5090920038cec9b273a8ebaba50439f2b",
            "parents": [
                "ef85e0bb4559d9162b58f2102f867d5c9cce160a"
            ],
            "ref": "refs/changes/90/71090/1",
            "uploader": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "createdOn": 1714053493,
            "author": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 159,
                    "deletions": 0
                },
                {
                    "file": "src/IntelCPUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/DeviceMgmt.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -70
                },
                {
                    "file": "src/PSUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -139
                }
            ],
            "sizeInsertions": 223,
            "sizeDeletions": 209
        },
        {
            "number": 2,
            "revision": "56e529b1e908658c9d2dd58a4eca721d2f0ae473",
            "parents": [
                "ef85e0bb4559d9162b58f2102f867d5c9cce160a"
            ],
            "ref": "refs/changes/90/71090/2",
            "uploader": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "createdOn": 1714054522,
            "author": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 159,
                    "deletions": 0
                },
                {
                    "file": "src/IntelCPUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/DeviceMgmt.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -70
                },
                {
                    "file": "src/PSUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -139
                }
            ],
            "sizeInsertions": 223,
            "sizeDeletions": 209
        },
        {
            "number": 3,
            "revision": "888a99fe114f91b5de4731bd4aa87294378d834f",
            "parents": [
                "ef85e0bb4559d9162b58f2102f867d5c9cce160a"
            ],
            "ref": "refs/changes/90/71090/3",
            "uploader": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "createdOn": 1714055876,
            "author": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 161,
                    "deletions": 0
                },
                {
                    "file": "src/IntelCPUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/DeviceMgmt.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -74
                },
                {
                    "file": "src/PSUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -144
                }
            ],
            "sizeInsertions": 225,
            "sizeDeletions": 218
        },
        {
            "number": 4,
            "revision": "0eeffc070ca81cc2a4c0e68d72526a062858a326",
            "parents": [
                "a9c1bec4de191352b9c681bb60c6439ac50a483b"
            ],
            "ref": "refs/changes/90/71090/4",
            "uploader": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "createdOn": 1714163293,
            "author": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Are both 0-based now? It is still not clear to me how we can make ensure the index base is consistent for all providers of this interface"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "I believe we shall not try to ensure consistent CPU indexing at dbus-sensor level.  As it was clarified in other review intelcpusensor uses indexes from json configurations. Hence I believe consistent CPU indexing shall be ensured at configuration level.\n\nWhat dbus-sensors apps can do is consistently parse Present property by not adding +1 to be compliant with smbios-mdrv2 which hardcodes index from 0.\n\nWith this change CpuID and Name property shall be updated across platform json configs."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Ideally we don't want break any existing json configs and/or force any future json configs to use 1 base index without a clear documentation. \n\nMy thought was within platform json config, the index needs to be self-consistent, e.g. CPURequired matches the CpuID in the same json file\nhttps://github.com/openbmc/entity-manager/blob/master/configurations/wft_baseboard.json#L1599\n\nAll dbus-sensors services should work correctly whether the system json config uses one based or zero based index. This may mean dbus-sensor services all use intelcpusensor's present interface, not smbios interface"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "I believe we are saying the same thing. I was asking to update the comment here to say it is NOT matching smbios-mdrv2, but matching CPU_X, which is created by intelcpusensor and follows the index used in json config. And add JSON config needs to be self consistent."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "For sure having CpuID and CPURequired within single json file would help to prevent indexes mismatches. However there are cases when sensors are defined in separate file than CPU.\n\nDon't want to drop CPU presence signals from smbios-mdrv2.\nI'm assuming not everybody is using intelcpusensor service.\nIf identified correctly examples of platforms not using intelcpusensor are:\nhttps://github.com/openbmc/entity-manager/blob/master/configurations/mtmitchell_mb.json\nhttps://github.com/openbmc/entity-manager/blob/master/configurations/mtjade.json\nMaybe Thang Tran can help to demystify these platforms."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "In the old configuration, we are setting CPU presence via phosphor-multi-gpio-presence, and we configured CPU_1/2, but we updated to cpu0/1. https://github.com/openbmc/openbmc/commit/fda17ca3b11c191946d824623321bef8f820fe71#diff-5fe483251692b94a7b12ab3997ebc92932530f603f598f1a61317d926f28308aR6"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Thanks for explanation how it works on Ampere platforms.\nI had noticed that with above change phosphor-multi-gpio-presence is exposing CPU objects under the same path as smbios-mdrv2. Shouldn't objects path be unique to avoid issue with object mapper?\nAFAIK many services won't iterate over all entries in response from object mapper GetSubTree call and will use first entry, which could be smbios-mdrv2 or phosphor-multi-gpio-presence depending on boot/runtime flow.\nConfiguring phosphor-multi-gpio-presence to expose ...cpu_0 and cpu_1 sound safer to me. What do you think?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Thank you for bring in all existing examples. I don't see an easy and robust fix for all existing and future use cases. A new interface suggested in the other comment seems promising and I agree it is better to save that for a future patch.\nFocusing on the existing bug this patch is trying to fix, what about: 1) make the intelcpusensor also use cpu_0 and cpu_1 (0 based, same as smbios-mdrv2 and  phosphor-multi-gpio-presence) 2)assume CPURequired in json is one based?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "ad 1) intelcpusensor take index from json, so it can be made 0-based by updating configs. Zhikui, do you have different solution in mind, without altering configs? If yes then we would need to firstly check all the sensors' CpuID (to assess if config is 0 or 1 based) and then expose objects on dbus. Sounds complex.\n\nad 2) there are json configs where CPURequired is 0 based.\n\nSimplest solution would be to update CPURequired and CpuID to be 0-based across all json configs in openbmc/openbmc repo. Being aware it could cause momentary regression though."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 17,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "> Simplest solution would be to update CPURequired and CpuID to be 0-based across all json configs in openbmc/openbmc repo. Being aware it could cause momentary regression though.\n\nAgree, we should first go with the easiest and most straight forward way.\nI would like to see other peoples weigh in on this."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Appreciate feedback, added my comments.\n\nNote: will be on vacations this week, can resume work on this review staring ww19.1"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "I just have some minor comments for this commit. Please take a look."
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "line": 214,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "nit: use same style like https://gerrit.openbmc.org/c/openbmc/dbus-sensors/+/71090/4/src/DeviceMgmt.hpp#115"
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "line": 214,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "That would change logic. Current implementation skips sensor creation when:\n1. CPU is not required and createSensors is triggered by CPU presence event.\n2. CPU is required but not present\n\nIf would change condition to be the same as in DeviveMgmt.hpp#115 then sensor creation would be incorrectly skipped when:\n1. CPU is required and present and createSensors is triggered by CPU presence event."
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "line": 214,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Got it.\n\nMaybe the following is more clear. I am ok with leave as is\n\n            auto cpuRequired = getCpuRequired(cfg);\n            if ((cpuRequired && !isCpuPresent(*cpuRequired)) || \n               (!cpuRequired && updateType == UpdateType::cpuPresenceChange))\n            {\n                continue;\n            }"
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "line": 214,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "auto cpuRequired = getCpuRequired(cfg);\n            if (cpuRequired && !isCpuPresent(*cpuRequired))\n            {\n                continue;\n            }"
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "line": 214,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "ACK, will change as suggested since intention is more readable."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 343,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "I saw that you did not modify this variable, Could you update this variable to `const auto& presenceFind`?"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 343,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 890,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "Could you update the value of `depth` variable to 0? We can not ensure that all of services create CPU object path as `/xyz/openbmc_project/inventory/system/chassis/motherboard/cpu<Idx>`, they can create /xyz/openbmc_project/inventory/system/chassis/motherboard/**<subpath>**/cpu<idx>"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 890,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Are you aware of any configuration where it would be required?\nIntentionally used depth = 1 to limit number of matches, it shall work well with smbios-mdrv2 and intelcpusensor."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 890,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "Currently, the phosphor-multi-gpio-presence is supporting to create object paths that detect the Items's status base on GPIOs. Users can define any the object path, therefore, I think we should set the depth=0 to avoid unexpected issues. Please refer to https://github.com/openbmc/openbmc/commit/fda17ca3b11c191946d824623321bef8f820fe71#diff-5fe483251692b94a7b12ab3997ebc92932530f603f598f1a61317d926f28308aR6 for more information."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 890,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Will change depth to 0 since with proposed here regex we shall not have issue with decoding CPU index from incorrect objects, as it was done previously.\n\nAnyway I do think that it's not bullet proof to detect CPU presence based on object name and Present property in xyz.openbmc_project.Inventory.Item interface.\n\nBetter approach would be to add Present property to xyz.openbmc_project.Inventory.Item.Cpu interface which shall be implemented only by CPU objects. Additionally we would match only signals from CPU objects, not from DIMMs, etc. However that would require bigger refactor, also outside this repo."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 915,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "I think you can define those variables to global `static` variables, I saw that they are used in another function."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 915,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Made cpuRegex const global to be reused between setupCpuMatchCallback and getPresentCpus functions. I would leave indexMatch local to avoid possible issues of using matches from previous calls."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 916,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "I saw that you did not modify this variable, Could you update this variable to `const auto& obj`?"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 916,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 976,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "I saw that you did not modify this variable, Could you update this variable to `const string& path`?"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 976,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 979,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "Using global `static` variables that I mentioned above."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 985,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "This block can be moved to line 995 (after test at line 991)"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 985,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "There is a lot of objects at inventory path (/xyz/openbmc_project/inventory/system/chassis/motherboard) implementing xyz.openbmc_project.Inventory.Item interface (e.g.: DIMMs). Idea was to continue parsing only objects starting with CPU.\n\nWon't insist on current approach if you believe it wastes more cycles.\n\nBest would be to add Present property, or equivalent, to xyz.openbmc_project.Inventory.Item.Cpu interface to match only signals from CPU objects."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 985,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Acknowledged"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 990,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "It seems that you did not modify this variable, I suggest to update it to `const auto& findPresence`."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 990,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 997,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "I think `const auto& present` is enough, we don't have to define this is a pointer while using `auto`"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 997,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Made it const.\nRegarding removing '*' from auto, I'm following style of dbus-sensors and I do think it has better readability."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 997,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/Utils.hpp",
                    "line": 85,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "Could you update the input parameters of `callback` from `(void)` to `(size_t idx, bool state)` to indicate which CPU has been updated?"
                },
                {
                    "file": "src/Utils.hpp",
                    "line": 85,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Cannot do it with current implementation, callback is not being called for every matched CPU presence signal. There is 1 second 'filtering' timer, i.e.: it's possible (and common) to have single callback for multiple CPU presence signal matches."
                },
                {
                    "file": "src/Utils.hpp",
                    "line": 85,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 168,
                    "deletions": 0
                },
                {
                    "file": "src/IntelCPUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/DeviceMgmt.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -74
                },
                {
                    "file": "src/PSUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -144
                }
            ],
            "sizeInsertions": 235,
            "sizeDeletions": 218
        },
        {
            "number": 5,
            "revision": "9912b11714cc3fb3c3a239235b4e3ab57870ddc8",
            "parents": [
                "a9c1bec4de191352b9c681bb60c6439ac50a483b"
            ],
            "ref": "refs/changes/90/71090/5",
            "uploader": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "createdOn": 1715002446,
            "author": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Jan Sowinski",
                        "email": "jan.sowinski@intel.com",
                        "username": "jansow"
                    },
                    "message": "Thanks for review, pushed update and added comments."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 166,
                    "deletions": 0
                },
                {
                    "file": "src/IntelCPUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/DeviceMgmt.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -74
                },
                {
                    "file": "src/PSUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -144
                }
            ],
            "sizeInsertions": 233,
            "sizeDeletions": 218
        },
        {
            "number": 6,
            "revision": "120688056e9cca990004016f7ce78ea4e274762b",
            "parents": [
                "a9c1bec4de191352b9c681bb60c6439ac50a483b"
            ],
            "ref": "refs/changes/90/71090/6",
            "uploader": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "createdOn": 1715257965,
            "author": {
                "name": "Jan Sowinski",
                "email": "jan.sowinski@intel.com",
                "username": "jansow"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Thang Tran",
                        "email": "thuutran@amperecomputing.com",
                        "username": "thangtran-ampere"
                    },
                    "message": "LGTM"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 25,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 166,
                    "deletions": 0
                },
                {
                    "file": "src/IntelCPUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "src/DeviceMgmt.hpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "src/ADCSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": -79
                },
                {
                    "file": "src/PSUSensorMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -144
                }
            ],
            "sizeInsertions": 232,
            "sizeDeletions": 223
        }
    ]
}