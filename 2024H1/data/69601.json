{
    "project": "openbmc/entity-manager",
    "branch": "master",
    "topic": "mctpreactor",
    "id": "I9ac63f605f3d4321faf9c77804d93184c3ef36aa",
    "number": 69601,
    "subject": "configurations: Convert Yosemite4 to MCTPDevice schema",
    "owner": {
        "name": "Andrew Jeffery",
        "email": "andrew@codeconstruct.com.au",
        "username": "amboar"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/entity-manager/+/69601",
    "hashtags": [],
    "createdOn": 1708670750,
    "lastUpdated": 1710811327,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1708670750,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1708670782,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1708670783,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1708670801,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/79713/ : FAILURE"
        },
        {
            "timestamp": 1708906176,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1708906206,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1708906206,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1708906802,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/79791/ : SUCCESS"
        },
        {
            "timestamp": 1708910846,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 3: Patch Set 2 was rebased.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1708910890,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1708910890,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1708911153,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/79795/ : SUCCESS"
        },
        {
            "timestamp": 1708948762,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1709654053,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1709655413,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1709692691,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1710811327,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Abandoned\n\nSquashing this into https://gerrit.openbmc.org/c/openbmc/entity-manager/+/69600 for clarity"
        }
    ],
    "wip": true,
    "patchSets": [
        {
            "number": 1,
            "revision": "274ff4a88e313ae0c3ecf748fc52964690b41b03",
            "parents": [
                "4e2db81766cf28c6abadd0c309c45ed37dadd366"
            ],
            "ref": "refs/changes/01/69601/1",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1708670750,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "configurations/yosemite4_floatingfalls.json",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": -6
                },
                {
                    "file": "configurations/yosemite4_wailuafalls.json",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": -9
                },
                {
                    "file": "configurations/yosemite4_sentineldome.json",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 37,
            "sizeDeletions": 18
        },
        {
            "number": 2,
            "revision": "ac6ca68eb96dc81d6e45cff3e00f58b1b13230ee",
            "parents": [
                "82d9a20c8d52bc4ca5919dae503acecfe587f001"
            ],
            "ref": "refs/changes/01/69601/2",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1708906176,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "configurations/yosemite4_floatingfalls.json",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -6
                },
                {
                    "file": "configurations/yosemite4.json",
                    "type": "MODIFIED",
                    "insertions": 45,
                    "deletions": 0
                },
                {
                    "file": "configurations/yosemite4_wailuafalls.json",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -9
                },
                {
                    "file": "configurations/yosemite4_sentineldome.json",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 76,
            "sizeDeletions": 18
        },
        {
            "number": 3,
            "revision": "82b0f95f41089e442b41ac4ca4efd109103308ee",
            "parents": [
                "8116de14089785f9cd933068a5752cdfd2680319"
            ],
            "ref": "refs/changes/01/69601/3",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1708910846,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "TRIVIAL_REBASE",
            "comments": [
                {
                    "file": "configurations/yosemite4.json",
                    "line": 407,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I'm not really understanding why this is useful?  There are MCTP interfaces 0-15, but there's nothing here that actually maps them to an i2c lane?\n\nAsked another way, if we deleted these, what use case isn't possible anymore?"
                },
                {
                    "file": "configurations/yosemite4.json",
                    "line": 407,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "As it stands this is used to associate the the `Transport` value to the interface name, so that the reactor implementation knows how to encode the `Address` value from the `MCTPDevice` schema for the call to `mctpd`'s `SetupEndpoint`. That was a rationalisation to avoid specifying `Transport` in the `MCTPDevice` schema, as it's implied by the interface the device can be reached through. However, in the future the `MCTPInterface` schema could specify properties such as `MTU` and `BusOwner` to define behaviours for management of the associated MCTP networks, along with their instantiation. At the moment we still rely on the `mctp-local` systemd target for both. Generally a script is run in that target to configure the interfaces, but it has no tie-in to the platform configuration logic of EM."
                },
                {
                    "file": "configurations/yosemite4_wailuafalls.json",
                    "line": 21,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Why \"StaticEndpointId\" instead of \"EndpointId\"?  Does adding \"Static\" convey something useful in the name?\n\nNot that I'm against the change;  I'm not sure one is better than the other, just curious why it's changing."
                },
                {
                    "file": "configurations/yosemite4_wailuafalls.json",
                    "line": 21,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "It felt more meaningful at the time, but I'm not too fussed. There's probably a discussion to be had about whether static endpoint IDs should be assigned or assumed configured into the device, and whether we need `mctpd`'s `AssignEndpointStatic` vs just `LearnEndpoint`. Some indication needs to be given to the reactor though - it needs to pick whether to issue `SetupEndpoint` or `LearnEndpoint` (or `AssignEndpointStatic`).\n\nThose D-Bus methods are documented here:\n\nhttps://github.com/CodeConstruct/mctp/blob/main/docs/mctpd.md"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "configurations/yosemite4_floatingfalls.json",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -6
                },
                {
                    "file": "configurations/yosemite4.json",
                    "type": "MODIFIED",
                    "insertions": 45,
                    "deletions": 0
                },
                {
                    "file": "configurations/yosemite4_wailuafalls.json",
                    "type": "MODIFIED",
                    "insertions": 9,
                    "deletions": -9
                },
                {
                    "file": "configurations/yosemite4_sentineldome.json",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 76,
            "sizeDeletions": 18
        }
    ]
}