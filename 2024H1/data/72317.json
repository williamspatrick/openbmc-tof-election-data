{
    "project": "openbmc/entity-manager",
    "branch": "master",
    "id": "I008bd344f57fd5106ba5cec58fcbc75afbf4a8a8",
    "number": 72317,
    "subject": "meson: Add option to not install github config",
    "owner": {
        "name": "Jeff Lin",
        "email": "JeffLin2@quantatw.com",
        "username": "JinFuLin"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/entity-manager/+/72317",
    "hashtags": [],
    "createdOn": 1719216648,
    "lastUpdated": 1719368846,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1719216648,
            "reviewer": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1719216703,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1719216703,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1719216802,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/86641/ : FAILURE"
        },
        {
            "timestamp": 1719216869,
            "reviewer": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1719216925,
            "reviewer": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "message": "Uploaded patch set 2: Commit message was updated.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1719216961,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1719216961,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1719217278,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/86642/ : SUCCESS"
        },
        {
            "timestamp": 1719217301,
            "reviewer": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1719254739,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1719256138,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1719284847,
            "reviewer": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1719284877,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1719284877,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1719284901,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/86687/ : FAILURE"
        },
        {
            "timestamp": 1719285231,
            "reviewer": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1719285294,
            "reviewer": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "message": "Uploaded patch set 4: Commit message was updated.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1719285341,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1719285341,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1719285796,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/86688/ : SUCCESS"
        },
        {
            "timestamp": 1719295222,
            "reviewer": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "message": "Patch Set 4:\n\n(5 comments)\n\nThis change is ready for review."
        },
        {
            "timestamp": 1719295229,
            "reviewer": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "message": "Abandoned"
        },
        {
            "timestamp": 1719333218,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1719368846,
            "reviewer": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "d2b5a90a0bc5294e61cdb23e9524cdbaa34763ca",
            "parents": [
                "0a78b90d2fce79b205a18da80d2a10998599ff15"
            ],
            "ref": "refs/changes/17/72317/1",
            "uploader": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "createdOn": 1719216648,
            "author": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 44,
            "sizeDeletions": 7
        },
        {
            "number": 2,
            "revision": "cc40bb91883a047daa2c191cfba26c5013e2023d",
            "parents": [
                "0a78b90d2fce79b205a18da80d2a10998599ff15"
            ],
            "ref": "refs/changes/17/72317/2",
            "uploader": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "createdOn": 1719216925,
            "author": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 8,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This commit message needs a large section dedicated to \"why\" we would want this upstream.  It seems like a significant step backwards in terms of maintenance."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 8,
                    "reviewer": {
                        "name": "Jeff Lin",
                        "email": "JeffLin2@quantatw.com",
                        "username": "JinFuLin"
                    },
                    "message": "Updated in new patchset."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 16,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "?  This is OpenBMC, there are no customers, and the intent of EM is that config files that aren't used don't have any effect."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 16,
                    "reviewer": {
                        "name": "Jeff Lin",
                        "email": "JeffLin2@quantatw.com",
                        "username": "JinFuLin"
                    },
                    "message": "Remove this line in new commit message."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 19,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "So where you keep the config files you do want to install, in your meta layer?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 19,
                    "reviewer": {
                        "name": "Jeff Lin",
                        "email": "JeffLin2@quantatw.com",
                        "username": "JinFuLin"
                    },
                    "message": "Yes, I prefer to put the config files in meta layer, so that we can place them platform by platform and then the config files which may be used will be installed base on bblayer's setting."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Probably don't want to put the name of the site it happens to be hosted on in the option name.  Maybe just:  install-configuration-files."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Jeff Lin",
                        "email": "JeffLin2@quantatw.com",
                        "username": "JinFuLin"
                    },
                    "message": "Thanks for the advice. Done."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Would like to see what the community thinks about this."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Overall, I don't really understand why we would want this in upstream.  I can hypothesize a reason, because the commit message doesn't list it:  There are conflicts in the probe statements in the config files between platforms.  We should just fix these conflicts.  Config files should be based on a fixed fru, and if there are conflicting probe statements, we should fix them.\n\nBeyond that, the config files don't take up much binary space, and are ensured at compile time that they parse, so in theory there should be no problem with the json files themselves causing issues.\n\nI could certainly see a downstream fork of entity-manager wanting to do this, to provide a completely different set of EM config files, but in that case they should be maintaining it as a fork, not pushing the complexity on upstream.\n\nOverall, even though this change doesn't seem large, I'm not in support.  It encourages users to not get the upstream config files correct, because with this patch they can be trivially disabled.  In addition, there are optimizations we might do in the future, like generating c structures instead of parsing the json itself, that would no longer be possible if we explicitly supported install-time json, rather than requiring it be in the build."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Jeff Lin",
                        "email": "JeffLin2@quantatw.com",
                        "username": "JinFuLin"
                    },
                    "message": "> Overall, I don't really understand why we would want this in upstream.  I can hypothesize a reason, because the commit message doesn't list it:  There are conflicts in the probe statements in the config files between platforms.  We should just fix these conflicts.  Config files should be based on a fixed fru, and if there are conflicting probe statements, we should fix them.\n> \n> Beyond that, the config files don't take up much binary space, and are ensured at compile time that they parse, so in theory there should be no problem with the json files themselves causing issues.\n> \nActually, our machine is facing the issue that there is no space for a new feature, so we are working on cleaning up the useless files on machine.\n> I could certainly see a downstream fork of entity-manager wanting to do this, to provide a completely different set of EM config files, but in that case they should be maintaining it as a fork, not pushing the complexity on upstream.\n> \n> Overall, even though this change doesn't seem large, I'm not in support.  It encourages users to not get the upstream config files correct, because with this patch they can be trivially disabled.  In addition, there are optimizations we might do in the future, like generating c structures instead of parsing the json itself, that would no longer be possible if we explicitly supported install-time json, rather than requiring it be in the build.\n\nGot it. Thanks for the comment, I will leave it in downstream."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> Actually, our machine is facing the issue that there is no space for a new feature, so we are working on cleaning up the useless files on machine.\n\nThen put that in your commit message: How much space is saved by not including them?\n\nA quick look on my system shows that once compressed, the entire payload of json files is about 40kB\n\n```\ned in tv entity-manager.bak/configurations on \ue0a0 master [$?\u21e1]\n\u276f ls -alh archive.tar.xz\n-rw-rw-r-- 1 ed ed 40K Jun 25 09:31 archive.tar.xz\n```\n\nThis is such a minor change, I really doubt it's going to help with binary size much, and isn't worth the complexity of trying to maintain multiple sets of EM configs."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Jeff Lin",
                        "email": "JeffLin2@quantatw.com",
                        "username": "JinFuLin"
                    },
                    "message": "Yeah, it only save 56kB in our image which is a small change, so we are also going to find out other unused thing to remove.\n\nI think this saving size might not be a fix number due to the JSON file might be added/removed/modified by people, so I have not add this in commit message.\n\nIt is a small change and will not have any change to entity-manager itself, so I think it might be fine to be upstreamed. However, you're right, my reasons aren't strong enough."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 44,
            "sizeDeletions": 7
        },
        {
            "number": 3,
            "revision": "c1875dbecf2784b9ac91756e8905ca8fa251fd48",
            "parents": [
                "0a78b90d2fce79b205a18da80d2a10998599ff15"
            ],
            "ref": "refs/changes/17/72317/3",
            "uploader": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "createdOn": 1719284847,
            "author": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 50,
            "sizeDeletions": 7
        },
        {
            "number": 4,
            "revision": "7d45805b52d7b986b09d25c0e9cf11aebe77625f",
            "parents": [
                "0a78b90d2fce79b205a18da80d2a10998599ff15"
            ],
            "ref": "refs/changes/17/72317/4",
            "uploader": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "createdOn": 1719285294,
            "author": {
                "name": "Jeff Lin",
                "email": "JeffLin2@quantatw.com",
                "username": "JinFuLin"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "meson_options.txt",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": 0
                },
                {
                    "file": "meson.build",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": -7
                }
            ],
            "sizeInsertions": 50,
            "sizeDeletions": 7
        }
    ]
}