{
    "project": "openbmc/libpldm",
    "branch": "main",
    "id": "Iadabcacc8c1286259095bd86b148fc39e901ad3c",
    "number": 71660,
    "subject": "base: Add `MESSAGE_SIZE_BYTES_INCREASE_EACH_<DataType>` const",
    "owner": {
        "name": "Thu Nguyen",
        "email": "thu@os.amperecomputing.com",
        "username": "ThuBaNguyen"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/libpldm/+/71660",
    "hashtags": [],
    "createdOn": 1716895410,
    "lastUpdated": 1717034852,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1716895410,
            "reviewer": {
                "name": "Thu Nguyen",
                "email": "thu@os.amperecomputing.com",
                "username": "ThuBaNguyen"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1716895475,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1716895480,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1716895727,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/85029/ : SUCCESS"
        },
        {
            "timestamp": 1716896515,
            "reviewer": {
                "name": "Thu Nguyen",
                "email": "thu@os.amperecomputing.com",
                "username": "ThuBaNguyen"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1716945041,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(4 comments)"
        },
        {
            "timestamp": 1716953856,
            "reviewer": {
                "name": "Thu Nguyen",
                "email": "thu@os.amperecomputing.com",
                "username": "ThuBaNguyen"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1717033525,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 1:\n\n(2 comments)"
        },
        {
            "timestamp": 1717034852,
            "reviewer": {
                "name": "Thu Nguyen",
                "email": "thu@os.amperecomputing.com",
                "username": "ThuBaNguyen"
            },
            "message": "Abandoned\n\nThe generic solution is required."
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "819f4f4242e6f5e143d708ae943d6a8ff830b555",
            "parents": [
                "8c0e7a3150e246960e4680cacae6692a272cd326"
            ],
            "ref": "refs/changes/60/71660/1",
            "uploader": {
                "name": "Thu Nguyen",
                "email": "thu@os.amperecomputing.com",
                "username": "ThuBaNguyen"
            },
            "createdOn": 1716895410,
            "author": {
                "name": "Thu Nguyen",
                "email": "thu@os.amperecomputing.com",
                "username": "ThuBaNguyen"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 16,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Please add a link to the code in question."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 22,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Please add a link to the code in question."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Thu Nguyen",
                        "email": "thu@os.amperecomputing.com",
                        "username": "ThuBaNguyen"
                    },
                    "message": "The patch set will help to remove those magic number in the pldm code\nhttps://github.com/openbmc/pldm/blob/087a751fbae04142d7c95a39b4fd4a37b95a83e5/pldmtool/pldm_platform_cmd.cpp#L1691"
                },
                {
                    "file": "include/libpldm/base.h",
                    "line": 120,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Should this not be `4`?"
                },
                {
                    "file": "include/libpldm/base.h",
                    "line": 120,
                    "reviewer": {
                        "name": "Thu Nguyen",
                        "email": "thu@os.amperecomputing.com",
                        "username": "ThuBaNguyen"
                    },
                    "message": "The constant is increased by when compare with the 8 bits data type.\nSo it should be 3."
                },
                {
                    "file": "include/libpldm/base.h",
                    "line": 120,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "I don't feel that's very intuitive \ud83d\ude1e"
                },
                {
                    "file": "include/libpldm/base.h",
                    "line": 121,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "I'd much prefer we find a more ergonomic way to do this than contribute to error-prone calculations by library users.\n\nThe users should be allowed to specify what types they need to encode in the message, and then query libpldm for the appropriate buffer size.\n\nAlternatively, we need to provide an API that returns the maximum possible size of an encoded message."
                },
                {
                    "file": "include/libpldm/base.h",
                    "line": 121,
                    "reviewer": {
                        "name": "Thu Nguyen",
                        "email": "thu@os.amperecomputing.com",
                        "username": "ThuBaNguyen"
                    },
                    "message": "The message buffer size is depend on the command type, the data size of the  value, min/max, thresholds fields in PDRs, and number of those fields.\nIn the current implementation, the caller of message_encode/decode API will allocate the request message/response message buffer. Change that behavior can take much effort.\n\nhttps://github.com/openbmc/libpldm/blob/8c0e7a3150e246960e4680cacae6692a272cd326/tests/libpldm_bios_test.cpp#L33\nhttps://github.com/openbmc/libpldm/blob/8c0e7a3150e246960e4680cacae6692a272cd326/tests/libpldm_fru_test.cpp#L500\nhttps://github.com/openbmc/pldm/blob/087a751fbae04142d7c95a39b4fd4a37b95a83e5/host-bmc/host_pdr_handler.cpp#L384"
                },
                {
                    "file": "include/libpldm/base.h",
                    "line": 121,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "But you're proposing to change it anyway by introducing these macros to remove the magic numbers. I think we need a conversation about how this should be done in a way that eliminates or significantly reduces the chance of user error."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "CHANGELOG.md",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "tests/libpldm_platform_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 17,
                    "deletions": -10
                },
                {
                    "file": "src/platform.c",
                    "type": "MODIFIED",
                    "insertions": 8,
                    "deletions": -4
                },
                {
                    "file": "tests/libpldm_firmware_update_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -4
                },
                {
                    "file": "tests/oem/ibm/libpldm_host_test.cpp",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -2
                },
                {
                    "file": "include/libpldm/base.h",
                    "type": "MODIFIED",
                    "insertions": 5,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 72,
            "sizeDeletions": 20
        }
    ]
}