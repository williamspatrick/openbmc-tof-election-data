{
    "project": "openbmc/openbmc",
    "branch": "master",
    "id": "Ifb906f0b0d81b97265b6b6a79104408161bded7e",
    "number": 69760,
    "subject": "state-manager: remove no-warm-reboot default",
    "owner": {
        "name": "Andrew Geissler",
        "email": "geissonator@yahoo.com",
        "username": "geissonator"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/openbmc/+/69760",
    "hashtags": [],
    "createdOn": 1709157517,
    "lastUpdated": 1712161438,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1709157517,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1709157611,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1709157611,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1709157964,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(1 comment)"
        },
        {
            "timestamp": 1709158053,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/21943/"
        },
        {
            "timestamp": 1709159457,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/21943/ : FAILURE"
        },
        {
            "timestamp": 1709216647,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1709224298,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1709224298,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1709224473,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1709224473,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1709225742,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/21959/"
        },
        {
            "timestamp": 1709226935,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/21959/ : SUCCESS"
        },
        {
            "timestamp": 1709226944,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1709227890,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 2:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1709307488,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 2:\n\n(4 comments)"
        },
        {
            "timestamp": 1711130354,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1711130354,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 3:\n\n(3 comments)"
        },
        {
            "timestamp": 1711130432,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1711130432,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1711130438,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3:\n\nBuild Started https://jenkins.openbmc.org/job/ci-openbmc/22216/"
        },
        {
            "timestamp": 1711130887,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1711130937,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1711131424,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-openbmc/22216/ : SUCCESS"
        },
        {
            "timestamp": 1711131433,
            "reviewer": {
                "name": "Jenkins OpenBMC Google",
                "email": "haojenkinsg00gle@gmail.com",
                "username": "jenkins-openbmc-g00gle"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nGoogle Internal CI : Google internal tests successfully started"
        },
        {
            "timestamp": 1711132373,
            "reviewer": {
                "name": "Jenkins OpenBMC IBM",
                "email": "geissonator+jenkinsibm@gmail.com",
                "username": "jenkins-openbmc-ibm"
            },
            "message": "Patch Set 3:\n\nBuild Successful \n\nIBM Hardware CI : witherspoon hardware tests passed"
        },
        {
            "timestamp": 1712161417,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1712161438,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Change has been successfully rebased and submitted as 41983bfe24d3e43c791d7cb2838934725b810bb0"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "0e4e3eb44dc11ce65c7fe078fff2265920cc03b3",
            "parents": [
                "6f267072acd73e7e756b27691543162356586bf5"
            ],
            "ref": "refs/changes/60/69760/1",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1709157517,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Uh... what?  By default anything that has a PACKAGECONFIG is going to override what is in Meson no matter if it is enabled or disabled.  If you delete all of these you're going to get a bunch of \"-D...=disabled\" in the meson calls."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Hmm, proof that I still don't understand PACKAGECONFIG. ok, I'll setup things with PACKAGECONFIG so it matches what I expect based on meson.options. And I'll merge the commit after this into this one so we can view it all in once place."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "ok, so I wasn't too far off. The defaults for PACKAGECONFIG match the meson file defaults. So I'm going to remove my incorrect overrides of those defaults here and then ensure bbappend files have the features I was setting accidentally by default prior."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -4
                }
            ],
            "sizeInsertions": 13,
            "sizeDeletions": 4
        },
        {
            "number": 2,
            "revision": "926e002ef0299dfdcd832e2a890188cd56f111bb",
            "parents": [
                "2fc7c545a32272708ecea129f7a336e1ca008e08"
            ],
            "ref": "refs/changes/60/69760/2",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1709224298,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "My opinion is we should leave a PACKAGECONFIG that is expected to be the \"typical design\" and only require people to add a PACKAGECONFIG when they absolutely have to deviate from those defaults.  That appears to be \"only-allow-boot-when-bmc-ready\" and probably \"only-run-apr-on-power-loss\"."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "line": 38,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "I'm fine with removing the `no-warm-reboot`."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "line": 38,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "Acknowledged"
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "line": 39,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Doesn't it seem like almost everyone leaves this set, except currently `meta-facebook` (which I'm not convinced is right).  I think we should leave this as a default."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "line": 39,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "ok, I'll try and make things match with how they are now, and then you can follow on with another commit if you want to change your current behavior."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "line": 40,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Is there really anyone that _doesn't_ want `only-allow-boot-when-bmc-ready`?  My opinion is we should leave this in as the default."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "line": 40,
                    "reviewer": {
                        "name": "Andrew Geissler",
                        "email": "geissonator@yahoo.com",
                        "username": "geissonator"
                    },
                    "message": "I've always heard rumors that x86 servers like to boot both their BMC and BIOS at the same time in order to optimize overall boot time. But I've never seen this in practice and there's a good chance they're using x86-power-control anyway."
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "line": 40,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "This is usually accomplished by having u-boot trigger a GPIO to the CPLD to release the host boot process.  I don't think the `only-allow-boot-when-bmc-ready` matters to that kind of flow."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 32,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-bletchley/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -4
                },
                {
                    "file": "meta-ampere/meta-jade/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                },
                {
                    "file": "meta-facebook/meta-harma/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -1
                }
            ],
            "sizeInsertions": 36,
            "sizeDeletions": 8
        },
        {
            "number": 3,
            "revision": "ca319f66ed92b2cbd158af3cb90c41ed8b52b22c",
            "parents": [
                "b01c92d43884b50faa7aa41bea331e9d9fa2275f"
            ],
            "ref": "refs/changes/60/69760/3",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1711130354,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-bletchley/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "meta-ampere/meta-jade/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "DELETED",
                    "insertions": 0,
                    "deletions": -1
                },
                {
                    "file": "meta-facebook/meta-harma/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 18,
            "sizeDeletions": 5
        },
        {
            "number": 4,
            "revision": "41983bfe24d3e43c791d7cb2838934725b810bb0",
            "parents": [
                "1846331f9771994d54c5d2828330ff15c2bfb640"
            ],
            "ref": "refs/changes/60/69760/4",
            "uploader": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "createdOn": 1712161438,
            "author": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 13,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-bletchley/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "meta-facebook/meta-yosemite4/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": 0
                },
                {
                    "file": "meta-phosphor/recipes-phosphor/state/phosphor-state-manager_git.bb",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                },
                {
                    "file": "meta-ampere/meta-jade/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "DELETED",
                    "insertions": 0,
                    "deletions": -1
                },
                {
                    "file": "meta-facebook/meta-harma/recipes-phosphor/state/phosphor-state-manager_%.bbappend",
                    "type": "MODIFIED",
                    "insertions": 1,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 18,
            "sizeDeletions": 5
        }
    ]
}