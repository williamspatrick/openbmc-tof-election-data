{
    "project": "openbmc/phosphor-dbus-interfaces",
    "branch": "master",
    "topic": "rbmc",
    "id": "I6415175bbee03f6c07b14e1db1ee0082bd1724ed",
    "number": 70765,
    "subject": "State: Add BMC redundancy interface",
    "owner": {
        "name": "Matt Spinler",
        "email": "spinler@us.ibm.com",
        "username": "spinler"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/phosphor-dbus-interfaces/+/70765",
    "hashtags": [],
    "createdOn": 1712862980,
    "lastUpdated": 1723831043,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1712862980,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1712863037,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1712863037,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1712863125,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1712863438,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/82471/ : SUCCESS"
        },
        {
            "timestamp": 1713256610,
            "reviewer": {
                "name": "Ramesh Iyyar",
                "email": "rameshi1@in.ibm.com",
                "username": "RameshIyyar"
            },
            "message": "Patch Set 1:\n\n(4 comments)"
        },
        {
            "timestamp": 1713556082,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 1:\n\n(3 comments)"
        },
        {
            "timestamp": 1713820057,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Topic set to rbmc"
        },
        {
            "timestamp": 1714017786,
            "reviewer": {
                "name": "Ramesh Iyyar",
                "email": "rameshi1@in.ibm.com",
                "username": "RameshIyyar"
            },
            "message": "Patch Set 1: Code-Review+1\n\n(3 comments)"
        },
        {
            "timestamp": 1714163716,
            "reviewer": {
                "name": "Andrew Geissler",
                "email": "geissonator@yahoo.com",
                "username": "geissonator"
            },
            "message": "Patch Set 1: Code-Review+1"
        },
        {
            "timestamp": 1721340663,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 1:\n\n(3 comments)"
        },
        {
            "timestamp": 1721415900,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1721415900,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 2:\n\n(3 comments)"
        },
        {
            "timestamp": 1721415953,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1721415953,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1721416106,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/88367/ : FAILURE"
        },
        {
            "timestamp": 1721417941,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Uploaded patch set 3: Patch Set 2 was rebased.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1721417941,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1721417986,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1721417998,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1721417998,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1721418332,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/88368/ : SUCCESS"
        },
        {
            "timestamp": 1723831043,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3: Code-Review+1"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "70be3b8e61c897b983c2fb43cdb824eb03f9bd66",
            "parents": [
                "9012243e543abdc5851b7e878c17c991b2a2a8b7"
            ],
            "ref": "refs/changes/65/70765/1",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1712862980,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 18,
                    "reviewer": {
                        "name": "Ramesh Iyyar",
                        "email": "rameshi1@in.ibm.com",
                        "username": "RameshIyyar"
                    },
                    "message": "I feel, we could extend that interface rather than adding some new interface but, you could wait for others.\n\nI don't have preference on this."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 18,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "reading that commit message, it sounds like a whole different type of redundancy so I'd rather not mix uses."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 18,
                    "reviewer": {
                        "name": "Ramesh Iyyar",
                        "email": "rameshi1@in.ibm.com",
                        "username": "RameshIyyar"
                    },
                    "message": "Acknowledged"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "The interface name doesn't quite match what I have in the design.  After the final name is decided on I can update each as necessary."
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 13,
                    "reviewer": {
                        "name": "Ramesh Iyyar",
                        "email": "rameshi1@in.ibm.com",
                        "username": "RameshIyyar"
                    },
                    "message": "Is there a particular reason why you're not utilizing https://github.com/openbmc/phosphor-dbus-interfaces/blob/master/yaml/xyz/openbmc_project/Object/Enable.interface.yaml?\n\nI believe it's essential to set it as readonly to prevent a DBus client from enabling/disabling redundancy, as the implementer of this interface will have a method to control the redundancy feature. Is this the rationale behind your decision?"
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 13,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Two reasons not to use enable\n1. It isn't a unique interface in the system, so any code wanting to see if redundancy was enabled what have to know to look at some hard coded object path just for that interface.  The typical way to find an interface is to use the mapper to tell you the object path.\n2. I think these properties belong on the same interface anyway.\n\n\nCorrect, only the application that implements this interface will be able to modify its value.\n\nI believe eventually we'll need a 'redundancyDisabledReason' property that contains an enum of why system can't be redundant, so the app would also handle that."
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 13,
                    "reviewer": {
                        "name": "Ramesh Iyyar",
                        "email": "rameshi1@in.ibm.com",
                        "username": "RameshIyyar"
                    },
                    "message": ">It isn't a unique interface in the system, so any code wanting to see if redundancy was enabled what have to know to look at some hard coded object path just for that interface. The typical way to find an interface is to use the mapper to tell you the object path.\n\nAgree\n\n>I believe eventually we'll need a 'redundancyDisabledReason' property that contains an enum of why system can't be redundant, so the app would also handle that.\n\nYeah we need that details anyway to understand why the redundancy is disabled."
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 28,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "nit: Do we want \"Unknown\" here?  That tends to be the keyword we use elsewhere."
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 28,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "Done"
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 42,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Do we need a default service name?  Everyone should use mapper to find this, right?"
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 42,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "I thought it was so we have a constant that even the server could use when it claims the bus name.  If it's rather for clients I will remove."
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 45,
                    "reviewer": {
                        "name": "Ramesh Iyyar",
                        "email": "rameshi1@in.ibm.com",
                        "username": "RameshIyyar"
                    },
                    "message": "It appears that it doesn't align with the proposed object path outlined in the design document:\n\nhttps://gerrit.openbmc.org/c/openbmc/docs/+/70233/3/designs/redundant-bmc.md#328\n\nI feel, this interface path more readable, shall we update the design doc if you agreed?"
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 45,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "I also have a comment up above about how they don't match, but I like this one better. After everyone  agrees on which one is best I will update the other use."
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 45,
                    "reviewer": {
                        "name": "Ramesh Iyyar",
                        "email": "rameshi1@in.ibm.com",
                        "username": "RameshIyyar"
                    },
                    "message": "Ok"
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 48,
                    "reviewer": {
                        "name": "Ramesh Iyyar",
                        "email": "rameshi1@in.ibm.com",
                        "username": "RameshIyyar"
                    },
                    "message": "Same as mentioned above"
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 48,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Why'd you end up with both (instance and namespace)?  I'd think you only need a single string.  Usually namespace is used for cases where there is something under it (path segments) but it seems like you just have a singular instance?"
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "line": 48,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "I think I just misunderstood the documentation. Will remove the namespace.\n\nAlso, do you think it would be better to put this on /xyz/openbmc_project/state/bmc0 (where bmc state manager is) or have it be on a unique path?"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 23,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "type": "ADDED",
                    "insertions": 50,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/State/BMC/meson.build",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/State/BMC/Redundancy/meson.build",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 103,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "a905915d1fc6e29b71fb6b7563dee840de87d58d",
            "parents": [
                "9012243e543abdc5851b7e878c17c991b2a2a8b7"
            ],
            "ref": "refs/changes/65/70765/2",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1721415900,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "huh, I guess markdownlint changed again?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "or maybe i just needed to rebase"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 23,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "type": "ADDED",
                    "insertions": 44,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/State/BMC/meson.build",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/State/BMC/Redundancy/meson.build",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "4062be2a22a99d81c97645e7cc599e915b4b62a7",
            "parents": [
                "85bc3395196a9348a6e3530102c18326e02f37f6"
            ],
            "ref": "refs/changes/65/70765/3",
            "uploader": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "createdOn": 1721417941,
            "author": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 23,
                    "deletions": 0
                },
                {
                    "file": "yaml/xyz/openbmc_project/State/BMC/Redundancy.interface.yaml",
                    "type": "ADDED",
                    "insertions": 44,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/State/BMC/meson.build",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "gen/xyz/openbmc_project/State/BMC/Redundancy/meson.build",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 97,
            "sizeDeletions": 0
        }
    ]
}