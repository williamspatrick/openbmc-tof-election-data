{
    "project": "openbmc/dbus-sensors",
    "branch": "master",
    "id": "Ie9439435730886a4279fe465c385d3536804f10a",
    "number": 69026,
    "subject": "utils: add async method for setting post match and init status",
    "owner": {
        "name": "PL",
        "email": "potin.lai@quantatw.com",
        "username": "potinlai"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/dbus-sensors/+/69026",
    "hashtags": [],
    "createdOn": 1706151890,
    "lastUpdated": 1708661931,
    "open": false,
    "status": "ABANDONED",
    "comments": [
        {
            "timestamp": 1706151890,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1706151918,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1706151918,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1706152141,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/78366/ : FAILURE"
        },
        {
            "timestamp": 1706156043,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1706156068,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1706156068,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1706156314,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/78368/ : SUCCESS"
        },
        {
            "timestamp": 1706160500,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Patch Set 2:\n\nThis change is ready for review."
        },
        {
            "timestamp": 1706504743,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 2: Code-Review-1\n\n(2 comments)"
        },
        {
            "timestamp": 1706510641,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Patch Set 2:\n\n(2 comments)"
        },
        {
            "timestamp": 1706574326,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1706583174,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1706583212,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1706583212,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1706583223,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/78510/ : FAILURE"
        },
        {
            "timestamp": 1706583741,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1706583841,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Uploaded patch set 4: New patch set was added with same tree, parent tree, and commit message as Patch Set 3.\n\nCopied Votes:\n* Verified-1 (copy condition: \"**changekind:NO_CHANGE**\")\n"
        },
        {
            "timestamp": 1706583868,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1706583868,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1706584128,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/78511/ : SUCCESS"
        },
        {
            "timestamp": 1706584263,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Patch Set 4:\n\n(2 comments)\n\nThis change is ready for review."
        },
        {
            "timestamp": 1706656378,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 4: Code-Review-1\n\n(2 comments)"
        },
        {
            "timestamp": 1706662473,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4: Code-Review-1\n\n(3 comments)"
        },
        {
            "timestamp": 1706675485,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1706675595,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1706853531,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Uploaded patch set 5.\n\nOutdated Votes:\n* Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1706853553,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1706853553,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1706853571,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/78712/ : FAILURE"
        },
        {
            "timestamp": 1706855386,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1706855493,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Uploaded patch set 6: Commit message was updated.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1706855523,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1706855523,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1706855794,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/78713/ : SUCCESS"
        },
        {
            "timestamp": 1706856806,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Patch Set 6:\n\n(2 comments)\n\nThis change is ready for review."
        },
        {
            "timestamp": 1707110448,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 6: Code-Review-1\n\n(3 comments)"
        },
        {
            "timestamp": 1707142708,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        },
        {
            "timestamp": 1707268827,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Set Work In Progress"
        },
        {
            "timestamp": 1707268880,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Uploaded patch set 7.\n\nOutdated Votes:\n* Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1707268910,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1707268910,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: -Ok-To-Test"
        },
        {
            "timestamp": 1707268967,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 7: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/78876/ : FAILURE"
        },
        {
            "timestamp": 1707269463,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Uploaded patch set 8.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1707269500,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1707269500,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: -Ok-To-Test"
        },
        {
            "timestamp": 1707269810,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 8: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/78877/ : SUCCESS"
        },
        {
            "timestamp": 1707272202,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Patch Set 8:\n\n(3 comments)\n\nThis change is ready for review."
        },
        {
            "timestamp": 1707273150,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1707287734,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1707307596,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1707321567,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1707324200,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1707347626,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1707349606,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 8:\n\n(3 comments)"
        },
        {
            "timestamp": 1707349928,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1708661716,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Patch Set 8:\n\n(1 comment)"
        },
        {
            "timestamp": 1708661931,
            "reviewer": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "message": "Abandoned\n\nfinal decision is to make x86-power-control & phosphor-state-manager to have consistent busname & objpath for OS state."
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "b791e726b689b02a0338f247d65ae6f543a845fa",
            "parents": [
                "be53d6b95dce7a6c42c94d833242cd0ea9e6f116"
            ],
            "ref": "refs/changes/26/69026/1",
            "uploader": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "createdOn": 1706151890,
            "author": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 43,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 79,
            "sizeDeletions": 3
        },
        {
            "number": 2,
            "revision": "00a6efa53f79ad3e9d2b7a0a749c87840664685b",
            "parents": [
                "be53d6b95dce7a6c42c94d833242cd0ea9e6f116"
            ],
            "ref": "refs/changes/26/69026/2",
            "uploader": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "createdOn": 1706156043,
            "author": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 33,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "I'm not sure how this is all related? It's looking at a different interface to `xyz.openbmc_project.State.OperatingSystem.Status`."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 33,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "When sensor update value, it will also update the Available property in xyz.openbmc_project.State.Decorator.Availability based on the result of readingStateGood().\nhttps://github.com/openbmc/dbus-sensors/blob/master/src/sensor.hpp#L482-L516\nhttps://github.com/openbmc/dbus-sensors/blob/master/src/Utils.cpp#L320-L336\n\nSo the Available property will set to true if the OS status is \"Standby\" (BIOS Post completed), and set to false if OS status is \"Inactive\"."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 33,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Then shouldn't you demonstrate the state of the `xyz.openbmc_project.State.OperatingSystem.Status` as well in the examples?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 33,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "Sorry, I was using \"obmcutil\" command to get OS status, but there are few lines missing in log and causing the confusion.\n\nCommit log updated again with busctl command."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 51,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Can we please not add yet more globals? Perhaps make a class with methods instead?"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 51,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "Got it, I will check the source code and update it in next version."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 51,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "Done"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 36,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 43,
                    "deletions": -3
                }
            ],
            "sizeInsertions": 79,
            "sizeDeletions": 3
        },
        {
            "number": 3,
            "revision": "49dc5d4dde971d465d896ac813242f0865d644a2",
            "parents": [
                "be53d6b95dce7a6c42c94d833242cd0ea9e6f116"
            ],
            "ref": "refs/changes/26/69026/3",
            "uploader": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "createdOn": 1706583174,
            "author": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 39,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 54,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 104,
            "sizeDeletions": 10
        },
        {
            "number": 4,
            "revision": "d315f04292fee9e3f7f468c7ca5062e931f72480",
            "parents": [
                "be53d6b95dce7a6c42c94d833242cd0ea9e6f116"
            ],
            "ref": "refs/changes/26/69026/4",
            "uploader": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "createdOn": 1706583841,
            "author": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "kind": "NO_CHANGE",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "What is the behavior if there are multiple OperatingSystem interfaces?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "I assign busname & objpath by the first result we get from GetSubTree command.\nThe implementation in this commit does not consider if there are multiple OperatingSystem interfaces.\n\nThis commit will work with single host system if sensors have PowerState set to biosPost, but not for multi-host system.\n\nFor multi-host system, there is no rule to define sensor belong to which host, so I think it needs more discussion at design level."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> I assign busname & objpath by the first result we get from GetSubTree command.\n\nHow do you know the first result is the correct one?  We have this same problem in bmcweb, and we explicitly check that there is only 1 implementation, and error out if there isn't (size() == 1).  I suspect we need to do the same thing here.\n\n> The implementation in this commit does not consider if there are multiple OperatingSystem interfaces.\n\nit needs to at least log an error if that happens.  \"does not consider\" doesn't really help when we're relying on undefined behavior from the mapper.\n\n> \n> This commit will work with single host system if sensors have PowerState set to biosPost, but not for multi-host system.\n> \n> For multi-host system, there is no rule to define sensor belong to which host, so I think it needs more discussion at design level.\n\nWhat do sensors have to do with it?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Hi Potin, thanks for updating the commit message. I have another concern about mixing asynchronous and synchronous calls. I've left a comment inline."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Blocking calls in an async context should be something we just disallow at some point, but for the moment, this code will definitely need reworked."
                },
                {
                    "file": "src/Utils.hpp",
                    "line": 437,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "dbus-sensors is written around the sdbusplus::asio bindings, which are async. However, you have a synchronous call here. There's some concern that combining asynchronous and synchronous calls leads to unpredictable behaviour:\n\n[asio: Add async match](https://gerrit.openbmc.org/c/openbmc/sdbusplus/+/68860)\n\nI expect we need this to be async."
                },
                {
                    "file": "src/Utils.hpp",
                    "line": 437,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "FWIW, the discussion you linked is specifically about async matches, which are less of a concern (but still somewhat of a concern).\n\nThis is an async CALL, which has been known to cause deadlocking and performance issues, and has been disallowed since basically the beginning of the asio extensions.."
                },
                {
                    "file": "src/Utils.hpp",
                    "line": 437,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "I'm aware of the contrast, I was just using the match situation as an example of the subtleties of mixing sync and async."
                },
                {
                    "file": "src/Utils.hpp",
                    "line": 437,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "\ud83d\udc4d"
                },
                {
                    "file": "src/Utils.hpp",
                    "line": 437,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "Done, change post related setup to async mothod call."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 39,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 54,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -10
                }
            ],
            "sizeInsertions": 104,
            "sizeDeletions": 10
        },
        {
            "number": 5,
            "revision": "26337cec05669e769c1ce321ff65b9a1fbe2d54e",
            "parents": [
                "16d6f17bec38b6c095dfb6bed224f17d941fb9b3"
            ],
            "ref": "refs/changes/26/69026/5",
            "uploader": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "createdOn": 1706853531,
            "author": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 39,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 81,
                    "deletions": -29
                }
            ],
            "sizeInsertions": 120,
            "sizeDeletions": 29
        },
        {
            "number": 6,
            "revision": "2a1ebb116bb8371c4cbc3a4c4557dee67378b199",
            "parents": [
                "16d6f17bec38b6c095dfb6bed224f17d941fb9b3"
            ],
            "ref": "refs/changes/26/69026/6",
            "uploader": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "createdOn": 1706855493,
            "author": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "I'd prefer the lambda be fixed, and would like a follow-up patch to clean up the signal match."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 370,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "I realise that it's the norm in dbus-sensors to just hack the signal constraints together, but can we instead make use of the helpers in `sdbusplus::bus::match::rules`?\n\nThis could be `sdbusplus::bus::match::rules::propertiesChanged(path, post::interface)`\n\nThough I've also just realised that you've moved the existing code, so ... I dunno. I'd prefer you don't _change_ it in this patch as that makes code motion harder to comprehend. But a follow-up patch would be nice."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 370,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "Please have a look with the link below for follow-up patch.\nhttps://gerrit.openbmc.org/c/openbmc/dbus-sensors/+/69235"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 462,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "The lambda isn't monstrous, but we do have an anti-pattern that covers it:\n\nhttps://github.com/openbmc/docs/blob/master/anti-patterns.md#very-long-lambda-callbacks"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 462,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "Done"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 464,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "How do you know that the service hosting this has started already?  Previously we hard-coded listening to a particular path, so dependency didn't matter, but now we're trying to do a look up in Mapper, which means the interface must already be there.  Right?"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 464,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "Yes, your are correct. To avoid interface not ready yet, I added 2 times retry (total 20 seconds) in getPostDbusInfo(). If we still can not get busname and objpath at the end, then we use default setting (post::busname & post::path) to register postMatch.\nPlease let me know if any concerns or enhancement required, thank you."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 464,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Hmm, I'm not enamored with that solution \ud83d\ude1e"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 464,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "Hi Andrew & Patrick, would you share more idea for enhance current method?\n\nBTW, I am also thinking go back to original method with pre-defined post::busname & post::path and then use meson.options to make hard-caded part can be modified by machine layer. Do you think this will be a possibile option for you?"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 464,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "You could do what the `mapper wait` command does:\n\nhttps://github.com/openbmc/phosphor-objmgr/blob/master/libmapper/mapper.c#L319\n\nBasically, add a match on `InterfacesAdded` for the mapper and call `GetObject` to test the path of interest.\n\nOtherwise, I'm not sure."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 464,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "lets just call a fixed path, and makes the paths correct, then this problem go away."
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 464,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "SGTM!"
                },
                {
                    "file": "src/Utils.cpp",
                    "line": 464,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "@Ed, @Andrew & @Patrick,\nI submit a commit to make x86-power-control's os state consistent with phosphor-state-manager.\nhttps://gerrit.openbmc.org/c/openbmc/x86-power-control/+/69589\n\nAlso a new commit for updating the busname & objpath of OS state (postcode) only.\nhttps://gerrit.openbmc.org/c/openbmc/dbus-sensors/+/69595\n\nPlease kindly have review over there, and I will abandon this one."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 39,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 81,
                    "deletions": -29
                }
            ],
            "sizeInsertions": 120,
            "sizeDeletions": 29
        },
        {
            "number": 7,
            "revision": "c94449815cf4a4e7c8ba913a9cd04c71e51781d3",
            "parents": [
                "16d6f17bec38b6c095dfb6bed224f17d941fb9b3"
            ],
            "ref": "refs/changes/26/69026/7",
            "uploader": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "createdOn": 1707268880,
            "author": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 39,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 92,
                    "deletions": -30
                }
            ],
            "sizeInsertions": 145,
            "sizeDeletions": 30
        },
        {
            "number": 8,
            "revision": "b3285ba84e5cd1cd30d77c8f8a7ef70e8c2c92ea",
            "parents": [
                "16d6f17bec38b6c095dfb6bed224f17d941fb9b3"
            ],
            "ref": "refs/changes/26/69026/8",
            "uploader": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "createdOn": 1707269463,
            "author": {
                "name": "PL",
                "email": "potin.lai@quantatw.com",
                "username": "potinlai"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "Can you elaborate what the different paths are?  Maybe this is as simple as making them consistent?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "PL",
                        "email": "potin.lai@quantatw.com",
                        "username": "potinlai"
                    },
                    "message": "Both \"busname\" and \"objpath\" are different between x86-power-control & phosphor-state-manager.\n\n- x86-power-control\n - busname: xyz.openbmc_project.State.OperatingSystem\n - objpath: /xyz/openbmc_project/state/os\n\n\n- phosphor-state-manager (for single host)\n - busname: xyz.openbmc_project.State.Host\n - objpath: /xyz/openbmc_project/state/host0"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Patrick Williams",
                        "email": "patrick@stwcx.xyz",
                        "username": "williamspatrick"
                    },
                    "message": "x86-power-control takes multiple busnames (for some odd reason).  The Host0 should already be exposed.\n\nphosphor-state-manager is also claiming Host0 as a busname.  That should be the preferred way going forward.\n\nWe should, for the time being, get x86-power-control to also expose the interface at state/host0 instead of state/os.  Most of the code using state/os is Intel specific and we can then port them to use the preferred one.\n\n\"state/os\" was never documented anywhere.  I don't think it should be preserved."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 9,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> x86-power-control takes multiple busnames (for some odd reason).  The Host0 should already be exposed.\n> \n> phosphor-state-manager is also claiming Host0 as a busname.  That should be the preferred way going forward.\n> \n> We should, for the time being, get x86-power-control to also expose the interface at state/host0 instead of state/os.  Most of the code using state/os is Intel specific and we can then port them to use the preferred one.\n> \n> \"state/os\" was never documented anywhere.  I don't think it should be preserved.\n\nI'm not even sure where state/os is used.  It was added after the initial x86-power-control was created.\n\n+1 to your intent.  Lets just fix x86-power-control to be consistent."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 39,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.hpp",
                    "type": "MODIFIED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "src/Utils.cpp",
                    "type": "MODIFIED",
                    "insertions": 90,
                    "deletions": -30
                }
            ],
            "sizeInsertions": 144,
            "sizeDeletions": 30
        }
    ]
}