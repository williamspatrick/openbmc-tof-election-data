{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "Ice5f62dca26fb46b35c3b26843fa25d3c6666258",
    "number": 73505,
    "subject": "refactor log_services.hpp, separate handlers",
    "owner": {
        "name": "Alexander",
        "email": "alexander.hansen@9elements.com",
        "username": "pointbazaar"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/73505",
    "hashtags": [],
    "createdOn": 1723045145,
    "lastUpdated": 1723131853,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1723045145,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1723045184,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1723045184,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1723045899,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(4 comments)"
        },
        {
            "timestamp": 1723046465,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/89351/ : SUCCESS"
        },
        {
            "timestamp": 1723047151,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Patch Set 1:\n\n(4 comments)"
        },
        {
            "timestamp": 1723047515,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(3 comments)"
        },
        {
            "timestamp": 1723052792,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1723052846,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1723052846,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1723052919,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(4 comments)"
        },
        {
            "timestamp": 1723053233,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1723054129,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/89353/ : SUCCESS"
        },
        {
            "timestamp": 1723055265,
            "reviewer": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1723056960,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1723060454,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1723060498,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1723060498,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1723062457,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/89362/ : SUCCESS"
        },
        {
            "timestamp": 1723131851,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3: Code-Review+2"
        },
        {
            "timestamp": 1723131853,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as 599b9af3d862325f173c467ba15ff2bcdc22d2e6"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "ae9faa26c7e18efa6b9f0366f098d7eb4ab40b00",
            "parents": [
                "6d0b80be1b79122de60ade0b80460510696954e0"
            ],
            "ref": "refs/changes/05/73505/1",
            "uploader": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "createdOn": 1723045145,
            "author": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This is arguably better, but doesn't really follow the convention we've been doing, where the whole handler is abstracted out.  I'd like to see that happen, but also, if that's not something you're willing to do, this can probably merge with just the name changes and still be an improvement.  Please let me know what you'd like to do."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Alexander",
                        "email": "alexander.hansen@9elements.com",
                        "username": "pointbazaar"
                    },
                    "message": "The function names for the additional functions are meant to be descriptive and unrelated to the URL. They are just helper functions and do not need to follow any specific naming patterns."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Right, but I would like them to follow the conventions we've been using elsewhere, rather than leaving the inline lambda, which we know causes issues."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Changed to follow conventions."
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 1980,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "See below for naming convention."
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 1980,
                    "reviewer": {
                        "name": "Alexander",
                        "email": "alexander.hansen@9elements.com",
                        "username": "pointbazaar"
                    },
                    "message": "Acknowledged"
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 3525,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Generally we would extract the handler to a method.  All this should go into dBusLogServiceActionsClear\n\nThe same needs to happen for the rest of the handlers."
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 3525,
                    "reviewer": {
                        "name": "Alexander",
                        "email": "alexander.hansen@9elements.com",
                        "username": "pointbazaar"
                    },
                    "message": "I do not aspire to rewrite all of log_services.hpp. I just want to do some cleanup, extract some functions and leave the place better than i found it."
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 3525,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I didn't ask you to rewrite all of log_services.hpp, I asked you to follow the convention of having a complete callback in the BMCWEB_ROUTE handler."
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 3525,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Changed to follow conventions."
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 3526,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This should be\n\nhandleSystemsLogServicesEventLogClearPost\n\nOr something similar.  Deriving the name from the URI itself reduces ambiguity, as there are several entrypoints that could be named dBusLogServiceActionsClear"
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 3526,
                    "reviewer": {
                        "name": "Alexander",
                        "email": "alexander.hansen@9elements.com",
                        "username": "pointbazaar"
                    },
                    "message": "The function is not handling the request on its own, the request handler is declared inline.\nThe function is a helper function.\nSo we need not derive the name from the URI."
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 3526,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "That doesn't change my point.  The name is ambiguous."
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 3526,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Changed to follow conventions."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 20,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "type": "MODIFIED",
                    "insertions": 477,
                    "deletions": -438
                }
            ],
            "sizeInsertions": 497,
            "sizeDeletions": 438
        },
        {
            "number": 2,
            "revision": "50d792b147b3fb3963ef31f014eabb3db86d99b8",
            "parents": [
                "6d0b80be1b79122de60ade0b80460510696954e0"
            ],
            "ref": "refs/changes/05/73505/2",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1723052792,
            "author": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Because I didn't want to burden you further, and you didn't seem to want to \"rewrite all of log_services.hpp\" I've updated this patchset with what I asked for to help you out.\n\nPlease review, and ensure that it does the refactor that you intended.  If it looks good to you, it can merge assuming nobody else has any comments."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Alexander",
                        "email": "alexander.hansen@9elements.com",
                        "username": "pointbazaar"
                    },
                    "message": "Looks good. Based on this i can try to extract more functions and rebase my other patch or just write it again.\n\nBut i will have much less diff now since you already did the get rid of the inline lambdas. \n\nThanks!"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Sounds good.  Let me know if you need any questions answered."
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "line": 1618,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This is another lambda that looks prime for refactoring."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "type": "MODIFIED",
                    "insertions": 541,
                    "deletions": -509
                }
            ],
            "sizeInsertions": 562,
            "sizeDeletions": 509
        },
        {
            "number": 3,
            "revision": "622365f2cba22d8fae2960533529f11607fae552",
            "parents": [
                "b0a7b571b5130ef298fbd9c6e9cb57858f6df4c6"
            ],
            "ref": "refs/changes/05/73505/3",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1723060454,
            "author": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "type": "MODIFIED",
                    "insertions": 545,
                    "deletions": -512
                }
            ],
            "sizeInsertions": 566,
            "sizeDeletions": 512
        },
        {
            "number": 4,
            "revision": "599b9af3d862325f173c467ba15ff2bcdc22d2e6",
            "parents": [
                "99da8c8ef1579a38dc8934792eaae4a5a977dfbd"
            ],
            "ref": "refs/changes/05/73505/4",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1723131853,
            "author": {
                "name": "Alexander",
                "email": "alexander.hansen@9elements.com",
                "username": "pointbazaar"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 21,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/log_services.hpp",
                    "type": "MODIFIED",
                    "insertions": 545,
                    "deletions": -512
                }
            ],
            "sizeInsertions": 566,
            "sizeDeletions": 512
        }
    ]
}