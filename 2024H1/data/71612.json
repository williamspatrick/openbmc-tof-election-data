{
    "project": "openbmc/bmcweb",
    "branch": "master",
    "id": "I472fc12379694acc35055965400141dbb1b33bfc",
    "number": 71612,
    "subject": "Fix Chassis Topology Links Handling",
    "owner": {
        "name": "Myung Bae",
        "email": "myungbae@us.ibm.com",
        "username": "baemyung"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/71612",
    "hashtags": [],
    "createdOn": 1716576720,
    "lastUpdated": 1719990915,
    "open": false,
    "status": "MERGED",
    "comments": [
        {
            "timestamp": 1716576720,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1716576785,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1716576785,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1716577918,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/84855/ : SUCCESS"
        },
        {
            "timestamp": 1716578158,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1716579895,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1: Code-Review-1\n\n(1 comment)"
        },
        {
            "timestamp": 1716580943,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1716581304,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1716585286,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1717091857,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1717182839,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1718028937,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1718642996,
            "reviewer": {
                "name": "Benjamin Fair",
                "email": "benjaminfair@google.com",
                "username": "BenjaminFair"
            },
            "message": "Patch Set 1: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1718672268,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "message": "Patch Set 1: Code-Review+1\n\n(2 comments)"
        },
        {
            "timestamp": 1718673914,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1718673998,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 1:\n\n(1 comment)"
        },
        {
            "timestamp": 1718724505,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Code-Review+1, Code-Review-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1718724540,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1718724540,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1718724561,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 2:\n\n(1 comment)"
        },
        {
            "timestamp": 1718726302,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/86369/ : SUCCESS"
        },
        {
            "timestamp": 1718804064,
            "reviewer": {
                "name": "Gunnar Mills",
                "email": "gunnar@gmills.xyz",
                "username": "gtmills"
            },
            "message": "Patch Set 2: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1718807226,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 3: Commit message was updated.\n\nCopied Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR **changekind:NO_CODE_CHANGE** OR changekind:TRIVIAL_REBASE OR is:MIN\")\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1718807251,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1718807251,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1718807280,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/86473/ : FAILURE"
        },
        {
            "timestamp": 1718807340,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1718807414,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 4: Commit message was updated.\n\nCopied Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR **changekind:NO_CODE_CHANGE** OR changekind:TRIVIAL_REBASE OR is:MIN\")\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1718807433,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1718807433,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1718809488,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/86478/ : SUCCESS"
        },
        {
            "timestamp": 1718810712,
            "reviewer": {
                "name": "Janet Adkins",
                "email": "janeta@us.ibm.com",
                "username": "jeaaustx"
            },
            "message": "Patch Set 4: Code-Review+1\n\n(2 comments)"
        },
        {
            "timestamp": 1718814462,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1719008580,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1719384416,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1719425607,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Uploaded patch set 5: Commit message was updated.\n\nCopied Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR **changekind:NO_CODE_CHANGE** OR changekind:TRIVIAL_REBASE OR is:MIN\")\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1719425644,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1719425644,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1719426787,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/86838/ : SUCCESS"
        },
        {
            "timestamp": 1719427450,
            "reviewer": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1719990912,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5: Code-Review+2"
        },
        {
            "timestamp": 1719990915,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Change has been successfully rebased and submitted as 28ee563e3d37a89100a903bd971bd9df443c5771"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "dd5d6cc238b7066d4949cfe7b2927b7d0b3a60a2",
            "parents": [
                "bdbfae2a0108de443fba5871c2fa21a4528b1f09"
            ],
            "ref": "refs/changes/12/71612/1",
            "uploader": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "createdOn": 1716576720,
            "author": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This points to several commits which is good, but doesn't answer the question of what this is changing in terms of path handling.\n\nLets start by getting added to the commit message:\n1. An example dbus interface that works, and produces the expected output.\n2. An example that doesn't work, what it produces instead, and why we believe that this other association is correct, and how it's different than the original.\n\nI looked at one of the commits, the meta-ibm layer looks like it hardcoded a bunch of Phosphor-inventory-manager associations that look incorrect to me.\n\n/xyz/openbmc_project/inventory/system/chassis/motherboard/dasd_backplane/panel1\n\nThe motherboard does not \"contain\" a backplane.  The chassis contains both the backplane and the front panel.\n\nThe \"system\" is contained within the chassis, not the other way around.\n\nThis looks like a case of the associations getting added incorrectly, and given the extreme complexity of the config file, I really can't help you debug it more than that.  Looking at the code, it looks like the association is getting added to the parent object, instead of the object itself, and that's why using subtree instead of object fixes the bug?\n\nThat subtree call is also doing a depth lookup based on path, not associations, so even if the paths were correct, it flies in opposition to: https://github.com/openbmc/technical-oversight-forum/issues/6\n\nThe code as written looks like it will have the problem of adding ALL objects to the ContainedBy, not just those that are at the next depth level.  For example\n\nChassis -> baseboard -> Add in card\n\n\nChassis Contained by would return ONLY the baseboard\nAdd in card Contained by would return ONLY the add in card\n\nAs written, this code would return the Baseboard and the Add in card under the chassis. which isn't really correct to the standard."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "Ok, I agree that https://gerrit.openbmc.org/c/openbmc/openbmc/+/70372 has the incorrect associations (e.g. between chassis & connector4 etc) with `containing`.\nSo that json file would need to be fixed.\n\nI mis-read the goal of https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60914 to get the other nested chassis....\nThanks"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "So perhaps, should we rethink to use `getSubTree()` to get the contained resources as you may suggested?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Sorry, I linked the wrong decision:\nhttps://github.com/openbmc/technical-oversight-forum/issues/18\n\n> Ok, I agree that https://gerrit.openbmc.org/c/openbmc/openbmc/+/70372 has the incorrect associations.\n\n\n> So perhaps, should we rethink to use getSubTree() to get the contained resources as you may suggested?\n\nIf I were you, I would start by getting some example \"fake\" EM configs set up, and start looking at the current behavior in the system that was developed against entity-manager.  I know you've decided to not use entity-manager, and you have your own reasons for that, which are fine, but you're modifying code that was built to EM behavior, so we need to make sure we don't regress that, and we can't just be arbitrarily changing things in a way that might break other people without understanding the differences, and understanding what the intent is of the interface."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "Besides the example to make working, it looks like the implementation of https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60914 seems improper in bmcweb.\n\nThe design https://gerrit.openbmc.org/c/openbmc/docs/+/54205 seems to show Items (not necessarily only Chassis item) that are contained by Chassis.\n\nHowever,  https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60914 is implementing sub-chassis under Chassis, as it assumes the containing resources are under Chassis without checking the contained items a Chassis.\n https://github.com/openbmc/bmcweb/blob/de0c960c4262169ea92a4b852dd5ebbe3810bf00/redfish-core/lib/chassis.hpp#L279\n\n```\n        link[\"@odata.id\"] = boost::urls::format(\"/redfish/v1/Chassis/{}\",\n                                                downstreamChassis);\n```\n\nSince the code is assuming the associated resources are chassis, its result is shown as chassis\n```\n    /redfish/v1/Chassis/<subchassis>/\n```\n\nAs the result, by following the design https://gerrit.openbmc.org/c/openbmc/openbmc/+/70372 & https://gerrit.openbmc.org/c/openbmc/phosphor-dbus-interfaces/+/58441/3/yaml/xyz/openbmc_project/Inventory/Item.interface.yaml, https://gerrit.openbmc.org/c/openbmc/openbmc/+/70372 adds the resources between chassis and other items with associations (containing/contained_by).\n\nIf so, https://gerrit.openbmc.org/c/openbmc/bmcweb/+/6091 implementation will result in the improper consequences, i.e. the contained resources are shown as chassis item in redfish api.  This will cause the redfish service validator failures for p10bmc.\n\n----\nI think there are a few directions to go.\n1) Revert https://gerrit.openbmc.org/c/openbmc/bmcweb/+/6091 as it does not fully handle the use of the associations only for sub-chassis.\n\n2) Fix https://gerrit.openbmc.org/c/openbmc/bmcweb/+/6091 to limit the implementation only between the chassis.  If so, use `getAssociatedSubTreePaths()` to search only sub-chassis.\n\n3) Ideally, translate all associated endpoints to the appropriate resources. For example, a connector is also contained in a chassis, map the connector as `/redish/v1/Cables/dp0_connector1` (may not be acurate, but it may be something like that) rather than showing it as `/redfish/v1/Chassis/dp0_connector1` (in today's code).  I think this approach may become complex and difficult."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> Besides the example to make working, it looks like the implementation of https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60914 seems improper in bmcweb.\n\nThat is certainly something you could discuss with Benjamin (not in this commit). That patch has been on master for over a year, through several releases.\n\n> \n> The design https://gerrit.openbmc.org/c/openbmc/docs/+/54205 seems to show Items (not necessarily only Chassis item) that are contained by Chassis.\n> \n> However,  https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60914 is implementing sub-chassis under Chassis, as it assumes the containing resources are under Chassis without checking the contained items a Chassis.\n>  https://github.com/openbmc/bmcweb/blob/de0c960c4262169ea92a4b852dd5ebbe3810bf00/redfish-core/lib/chassis.hpp#L279\n> \n> ```\n>         link[\"@odata.id\"] = boost::urls::format(\"/redfish/v1/Chassis/{}\",\n>                                                 downstreamChassis);\n> ```\n> \n> Since the code is assuming the associated resources are chassis, its result is shown as chassis\n> ```\n>     /redfish/v1/Chassis/<subchassis>/\n> ```\n> \n> As the result, by following the design https://gerrit.openbmc.org/c/openbmc/openbmc/+/70372 & https://gerrit.openbmc.org/c/openbmc/phosphor-dbus-interfaces/+/58441/3/yaml/xyz/openbmc_project/Inventory/Item.interface.yaml, https://gerrit.openbmc.org/c/openbmc/openbmc/+/70372 adds the resources between chassis and other items with associations (containing/contained_by).\n> \n> If so, https://gerrit.openbmc.org/c/openbmc/bmcweb/+/6091 implementation will result in the improper consequences, i.e. the contained resources are shown as chassis item in redfish api.  This will cause the redfish service validator failures for p10bmc.\n\nFrom earlier: \"If I were you, I would start by getting some example \"fake\" EM configs set up\"\n\nHave you done this yet?  We're talking in hypotheticals at this point, we need to talk in concrete \"here is a system I'm trying to model\" and \"Here's the specific case that bmcweb gets wrong\".  Talking in the abstract in terms of arbitrary items and paths doesn't help here.\n\nYes, it is very possible that what got implemented doesn't match the design;  That doesn't mean that it doesn't work correctly as far as the user is concerned.\n\n> \n> ----\n> I think there are a few directions to go.\n> 1) Revert https://gerrit.openbmc.org/c/openbmc/bmcweb/+/6091 as it does not fully handle the use of the associations only for sub-chassis.\n> \n> 2) Fix https://gerrit.openbmc.org/c/openbmc/bmcweb/+/6091 to limit the implementation only between the chassis.  If so, use `getAssociatedSubTreePaths()` to search only sub-chassis.\n> \n> 3) Ideally, translate all associated endpoints to the appropriate resources. For example, a connector is also contained in a chassis, map the connector as `/redish/v1/Cables/dp0_connector1` (may not be acurate, but it may be something like that) rather than showing it as `/redfish/v1/Chassis/dp0_connector1` (in today's code).  I think this approach may become complex and difficult.\n\n#1/#2, yes, these are the options we have for literally any patch or design.\n\n#3 Connectors+cables are a completely different discussion than Chassis ContainedBy because ContainedBy is an association to a chassis.  Lets keep our discussion on contained by, until we have concrete examples where Cable overlaps."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gunnar@gmills.xyz",
                        "username": "gtmills"
                    },
                    "message": "> The \"system\" is contained within the chassis, not the other way around.\n\nYou can have a multiple chassis system."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> You can have a multiple chassis system.\n\nFair."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "Can we now merge this?"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "To quote myself \"Lets start by getting added to the commit message: ....\"\n\nThat still hasn't happened."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 21,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "I updated the commit message to show the examples"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "Benjamin, Zhenwei, Jie Yang,\n\nPlease take a look at this commit.\n\nYour previous commit - https://gerrit.openbmc.org/c/openbmc/bmcweb/+/60914 for  `getChassisContains()` & `getChassisContainedBy()` is showing the sub-chassis, using `getAssociationEndPoints()` with the associations `containing/contained_by`.\n\nHowever, if the same associations are used for the other than chassis, it may also fail by showing the other than sub-chassis as `/redfish/v1/Chassis/chassis/<other-rsrc>/`.\n\nFor example, https://gerrit.openbmc.org/c/openbmc/openbmc/+/70372 adds the non-chassis resources via the associations. \n\nAs the result, we are getting this \n```\n % curl -k -X GET https://${bmc}/redfish/v1/Chassis/chassis\n {\n ...\n   \"Contains\": [\n      {\n        \"@odata.id\": \"/redfish/v1/Chassis/pcieslot0\"\n      },\n      {\n        \"@odata.id\": \"/redfish/v1/Chassis/pcieslot1\"\n      },\n   ...\n\n }\n```\n   \nI think this needs to be fixed by checking the end-points whether they are `Chassis` or not.\nThis commit is to do it by using `getAssociatedSubTreePaths()`.\n\nPlease review and provide your inputs."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Benjamin Fair",
                        "email": "benjaminfair@google.com",
                        "username": "BenjaminFair"
                    },
                    "message": "This approach seems fine to me, since we're assuming that the objects are Chassis when constructing the links"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gunnar@gmills.xyz",
                        "username": "gtmills"
                    },
                    "message": "This seems reasonable to me. \nThis is moving the code to only search for \n\"xyz.openbmc_project.Inventory.Item.Chassis\" to fill out [\"Links\"][\"ContainedBy\"][\"@odata.id\"] and [\"Links\"][\"Contains\"][\"@odata.id\"] \n\n\nInitially, I didn't think that was correct but looking at https://redfish.dmtf.org/schemas/v1/Chassis.v1_25_1.json. That is what Redfish wants. An argument could be made this array of interfaces should also include  \"xyz.openbmc_project.Inventory.Item.Board\" because bmcweb is using that for a Chassis today but I really think we should move away from modeling most/all of our \"xyz.openbmc_project.Inventory.Item.Board\" as Redfish Chassis. contained_by / containing is such a generic association,they could be reused, yeah I think only looking for Redfish Chassis makes sense  \n\n                \"ContainedBy\": {\n                    \"$ref\": \"http://redfish.dmtf.org/schemas/v1/Chassis.json#/definitions/Chassis\",\n                    \"description\": \"The link to the chassis that contains this chassis.\",\n                    \"longDescription\": \"This property shall contain a link to a resource of type `Chassis` that represents the chassis that contains this chassis.\",\n                    \"readonly\": false\n                },\n                \"Contains\": {\n                    \"description\": \"An array of links to any other chassis that this chassis has in it.\",\n                    \"items\": {\n                        \"$ref\": \"http://redfish.dmtf.org/schemas/v1/Chassis.json#/definitions/Chassis\"\n                    },\n                    \"longDescription\": \"This property shall contain an array of links to resources of type `Chassis` that represent the chassis instances that this chassis contains.\",\n                    \"readonly\": false,\n                    \"type\": \"array\"\n                },"
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "line": 294,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Need Board here as well.  Dbus Board and Chassis resolve to a Redfish chassis"
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "line": 294,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "Added"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 44,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 11,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 55,
            "sizeDeletions": 5
        },
        {
            "number": 2,
            "revision": "3fea7d17ed1f01a83640770ed258c1c473862a24",
            "parents": [
                "8f5df132a70b47c2f299cb216812ec83d4fc1197"
            ],
            "ref": "refs/changes/12/71612/2",
            "uploader": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "createdOn": 1718724505,
            "author": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "Gunnar Mills",
                        "email": "gunnar@gmills.xyz",
                        "username": "gtmills"
                    },
                    "message": "You could add a sentence about that we use both the inventory.item.board/chassis for Redfish Chassis but oh well, your call."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "I clarify more in the commit message by adding a statement like\n\n\"This commit is to limit to get the chassis/board resources for Chassis `Contains` collection\""
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 38,
                    "reviewer": {
                        "name": "Janet Adkins",
                        "email": "janeta@us.ibm.com",
                        "username": "jeaaustx"
                    },
                    "message": "nit: typo: \"Chassi\""
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 38,
                    "reviewer": {
                        "name": "Myung Bae",
                        "email": "myungbae@us.ibm.com",
                        "username": "baemyung"
                    },
                    "message": "Updated in the latest push"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 44,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 56,
            "sizeDeletions": 5
        },
        {
            "number": 3,
            "revision": "41bd8d50123ecb128755f852127f7e9e670fd336",
            "parents": [
                "8f5df132a70b47c2f299cb216812ec83d4fc1197"
            ],
            "ref": "refs/changes/12/71612/3",
            "uploader": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "createdOn": 1718807226,
            "author": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 45,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 57,
            "sizeDeletions": 5
        },
        {
            "number": 4,
            "revision": "4464f21a25767c08ce41030c765b2a633cc86f99",
            "parents": [
                "8f5df132a70b47c2f299cb216812ec83d4fc1197"
            ],
            "ref": "refs/changes/12/71612/4",
            "uploader": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "createdOn": 1718807414,
            "author": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "kind": "NO_CODE_CHANGE",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Janet Adkins",
                        "email": "janeta@us.ibm.com",
                        "username": "jeaaustx"
                    },
                    "message": "One minor nit comment, but looks good to me."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 48,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 60,
            "sizeDeletions": 5
        },
        {
            "number": 5,
            "revision": "987463dc2e12fdb0747976adc76cd49f3b8a2d97",
            "parents": [
                "8f5df132a70b47c2f299cb216812ec83d4fc1197"
            ],
            "ref": "refs/changes/12/71612/5",
            "uploader": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "createdOn": 1719425607,
            "author": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 88,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 100,
            "sizeDeletions": 5
        },
        {
            "number": 6,
            "revision": "28ee563e3d37a89100a903bd971bd9df443c5771",
            "parents": [
                "478c5a57ac1143d689f3d3670092c2eb75e0f0c4"
            ],
            "ref": "refs/changes/12/71612/6",
            "uploader": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "createdOn": 1719990915,
            "author": {
                "name": "Myung Bae",
                "email": "myungbae@us.ibm.com",
                "username": "baemyung"
            },
            "kind": "TRIVIAL_REBASE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 88,
                    "deletions": 0
                },
                {
                    "file": "redfish-core/lib/chassis.hpp",
                    "type": "MODIFIED",
                    "insertions": 12,
                    "deletions": -5
                }
            ],
            "sizeInsertions": 100,
            "sizeDeletions": 5
        }
    ]
}