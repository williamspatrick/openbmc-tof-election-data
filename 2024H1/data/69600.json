{
    "project": "openbmc/entity-manager",
    "branch": "master",
    "topic": "mctpreactor",
    "id": "I9d3f328262e99d405fc6e6dbdadff2306c254fa3",
    "number": 69600,
    "subject": "schemas: Specify descriptions of MCTP I2C targets",
    "owner": {
        "name": "Andrew Jeffery",
        "email": "andrew@codeconstruct.com.au",
        "username": "amboar"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/entity-manager/+/69600",
    "hashtags": [],
    "createdOn": 1708670750,
    "lastUpdated": 1712288218,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1708670750,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1708670782,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1708670782,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1708670812,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/79712/ : FAILURE"
        },
        {
            "timestamp": 1708906176,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1708906212,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1708906212,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1708906845,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/79793/ : SUCCESS"
        },
        {
            "timestamp": 1708910846,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1708910890,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1708910890,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1708911150,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/79796/ : SUCCESS"
        },
        {
            "timestamp": 1708912320,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1708948756,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 3: Code-Review+1"
        },
        {
            "timestamp": 1709623949,
            "reviewer": {
                "name": "Matt Spinler",
                "email": "spinler@us.ibm.com",
                "username": "spinler"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1709653884,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(4 comments)"
        },
        {
            "timestamp": 1709654740,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1709675048,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1709687376,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 3:\n\n(4 comments)"
        },
        {
            "timestamp": 1709789052,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1709789218,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1709916670,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1710434371,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 3:\n\n(3 comments)"
        },
        {
            "timestamp": 1710460427,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 3:\n\n(3 comments)"
        },
        {
            "timestamp": 1711425197,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 4.\n\nOutdated Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1711425222,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1711425222,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1711425477,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/81251/ : SUCCESS"
        },
        {
            "timestamp": 1711425608,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 4:\n\n(3 comments)"
        },
        {
            "timestamp": 1712025336,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 5: New patch set was added with same tree, parent tree, and commit message as Patch Set 4.\n\nCopied Votes:\n* Verified+1 (copy condition: \"**changekind:NO_CHANGE**\")\n"
        },
        {
            "timestamp": 1712025369,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1712025369,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5: -Ok-To-Test"
        },
        {
            "timestamp": 1712025627,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 5:\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/81687/ : SUCCESS"
        },
        {
            "timestamp": 1712084314,
            "reviewer": {
                "name": "Patrick Williams",
                "email": "patrick@stwcx.xyz",
                "username": "williamspatrick"
            },
            "message": "Patch Set 5: Code-Review+1"
        },
        {
            "timestamp": 1712162780,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5:\n\n(3 comments)"
        },
        {
            "timestamp": 1712163131,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1712163148,
            "reviewer": {
                "name": "Ed Tanous",
                "email": "ed@tanous.net",
                "username": "edtanous"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1712209409,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(2 comments)"
        },
        {
            "timestamp": 1712285880,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1712286385,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 5:\n\n(1 comment)"
        },
        {
            "timestamp": 1712287707,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Uploaded patch set 6.\n\nOutdated Votes:\n* Code-Review+1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE OR changekind:TRIVIAL_REBASE OR is:MIN\")\n* Verified+1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1712287742,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1712287742,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: -Ok-To-Test"
        },
        {
            "timestamp": 1712287994,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 6: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/81966/ : SUCCESS"
        },
        {
            "timestamp": 1712288218,
            "reviewer": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "message": "Patch Set 6:\n\n(1 comment)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "4e2db81766cf28c6abadd0c309c45ed37dadd366",
            "parents": [
                "80a49edc1611e981d5558b9f06fea3d67b2140a6"
            ],
            "ref": "refs/changes/00/69600/1",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1708670750,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 10,
                    "deletions": 0
                },
                {
                    "file": "schemas/global.json",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "schemas/mctp.json",
                    "type": "ADDED",
                    "insertions": 89,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 105,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "82d9a20c8d52bc4ca5919dae503acecfe587f001",
            "parents": [
                "80a49edc1611e981d5558b9f06fea3d67b2140a6"
            ],
            "ref": "refs/changes/00/69600/2",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1708906176,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 41,
                    "deletions": 0
                },
                {
                    "file": "schemas/global.json",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "schemas/mctp.json",
                    "type": "ADDED",
                    "insertions": 89,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 136,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "8116de14089785f9cd933068a5752cdfd2680319",
            "parents": [
                "80a49edc1611e981d5558b9f06fea3d67b2140a6"
            ],
            "ref": "refs/changes/00/69600/3",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1708910846,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 22,
                    "reviewer": {
                        "name": "Matt Spinler",
                        "email": "spinler@us.ibm.com",
                        "username": "spinler"
                    },
                    "message": "If this is the reactor that is hardcoded to look at EM, why isn't it under openbmc? (I'm sure there's a reason, I've just been out of the loop)"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 22,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Last I heard the EM->mctpd reactor was going in dbus-sensors.  This is just the generic MCTPd"
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 22,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Right, `mctpd` is not OpenBMC-specific. Additionally, we don't want `mctpd`-specifics in Entity Manager. So the plan is for an intermediate reactor. The reactor is proposed for dbus-sensors:\n\n[Add mctpreactor for dynamic configuration of MCTP networks](https://gerrit.openbmc.org/c/openbmc/dbus-sensors/+/69111)"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 16,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "This would go into the Type field.\n\nType: \"SmbusMCTPInterface\"\nType: \"SerialMCTPInterface\""
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 16,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "I looked at more examples, and I'm very confused.\n\nTo support a piece of mctp hardware, you should write an EM config file for it, and that single EM config should contain all information required to instantiate the device.  This interface seems to require an author write BOTH an MCTPInterface on their baseboard definition, AND and MCTPDevice definition in the EM file, and that they have to match.\nThe Micron drive example in later patches shows the issue with this approach, in that it requires mapping an MCTPInterface name to a baseboard with a specific name.  That micron device could show up on essentially any baseboard in EM with an M.2 slot.  It doesn't seem like adding MCTPInterface definitions to every baseboard with an M.2 slot is worthwhile or wise."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 16,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": ">  It doesn't seem like adding MCTPInterface definitions to every baseboard with an M.2 slot is worthwhile or wise.\n\nIt's not required that we do, but the consequence is that you can't talk MCTP to that device in the current schema. The current implementation of the reactor only configures the device if it has both the configuration for the device and the interface it's connected through. It's not an error to not provide one or both pieces (unless you require the MCTP functionality).\n\nAnyway, see the conversation below for how we might be able to avoid coupling `MCTPInterface` and `MCTPDevice` in the configs."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 16,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> >  It doesn't seem like adding MCTPInterface definitions to every baseboard with an M.2 slot is worthwhile or wise.\n> \n> It's not required that we do, but the consequence is that you can't talk MCTP to that device in the current schema. The current implementation of the reactor only configures the device if it has both the configuration for the device and the interface it's connected through.\n\nBut.... that's something that's implemented, and can be changed?  I'm not really following the above;  Is there a reason it REQUIRES both pieces of information?\n\n> It's not an error to not provide one or both pieces (unless you require the MCTP functionality).\n> \n> Anyway, see the conversation below for how we might be able to avoid coupling `MCTPInterface` and `MCTPDevice` in the configs."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 16,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "> But.... that's something that's implemented, and can be changed? I'm not really following the above; Is there a reason it REQUIRES both pieces of information?\n\nIt doesn't - at the end of my reply above I wrote:\n\n> Anyway, see the conversation below for how we might be able to avoid coupling MCTPInterface and MCTPDevice in the configs.\n\nSo it was coupled in the original patch, but I made some alternative proposals that don't require both pieces of information. I'm not sure how else to communicate that.\n\nI want to go ahead with the (`\"Type\": \"SMBusMCTPDevice\"`) alternative where it's not coupled, but I'm looking to tie up the loose ends of the conversation before doing so."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 16,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Done"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 19,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Are there other transport should be included here like pcie etc?"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 19,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Yeah, absolutely. However, I was planning to add them as required rather than up-front. They might imply other the presence of other properties and I didn't want to expose myself to specifying the schema for all of them."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 19,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "I am OK will adding more later"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 19,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Done"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 39,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Kernel specific parameters don't go in EM.  As an example, if I handed you a GPU, with all the specs for what its interfaces supported, there'd be no way to fill this out without knowing what BMC it was being loaded on.\n\nTherefore, this kind of information goes in the reactor app, not in an EM config.\n\nIn addition, including it here has a huge potential for conflicts.  What if two devices put mctp0 here?  Which one do we merge?"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 39,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "> In addition, including it here has a huge potential for conflicts. What if two devices put mctp0 here? Which one do we merge?\n\nDoes your change in understanding in your comments on line 60 address your question?\n\n> Therefore, this kind of information goes in the reactor app, not in an EM config.\n\nPerhaps there's an opportunity for that.\n\n>  As an example, if I handed you a GPU, with all the specs for what its interfaces supported, there'd be no way to fill this out without knowing what BMC it was being loaded on.\n\nWell, yes and no. For example, the kernel will name all I2C/SMBus MCTP interfaces as `mctpi2cX` where `X` is the bus index. So configs can specify `Interface: \"mctpi2c$bus\"` and mostly expect correct behaviour. However, it does get murky with interface renaming via udev. I'm not aware of anyone doing that yet.\n\nThe reactor needs to know the interface name, as specifying this [is a requirement for invoking `SetupEndpoint`](https://github.com/CodeConstruct/mctp/blob/main/docs/mctpd.md#setupendpoint) on `mctpd`'s `/xyz/openbmc_project/mctp` object via the `au.com.CodeConstruct.MCTP` interface. Further, it needs to know the transport backing the interface as we need to encode the address into the byte array required by the `hwaddr` parameter of `SetupEndpoint`.\n\nPerhaps a different approach is to specify the bus index and the transport type. For instance, we could specify this instead:\n\n```\n{\n    \"Address\": \"0x1d\",\n    \"Bus\": \"$bus\",\n    \"Transport\": \"SMBus\",\n    \"Type\": \"MCTPDevice\"\n}\n```\n\n\nFor example, using the `Bus` value of `14` the reactor can construct a sysfs path to map to a netdev interface name associated with the bus:\n\n```\n# ls /sys/bus/i2c/devices/i2c-14/net/\nmctpi2c14\n```\nor\n```\n# ( . /sys/bus/i2c/devices/i2c-14/net/*/uevent ; echo $INTERFACE )\nmctpi2c14\n```\n\nAccounting for your feedback on the `MCTPInterface` schema above, we could perhaps merge `Transport` into the `Type` value:\n\n```\n{\n    \"Address\": \"0x1d\"\n    \"Bus\": \"$bus\"\n    \"Type\": \"SMBusMCTPDevice\"\n}\n```\n\nPerhaps this would allow us to do away with `MCTPInterface` for now, but MCTP netdev interfaces do need explicit setup. Child busses of I2C muxes on detected cards for instance: The i2c-dev for each mux leg must be configured as its own MCTP netdev interface."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 39,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> > In addition, including it here has a huge potential for conflicts. What if two devices put mctp0 here? Which one do we merge?\n> \n> Does your change in understanding in your comments on line 60 address your question?\n\n\nI'm assuming you meant 50?  It doesn't quite help, but it starts to add context.\n\n> \n> > Therefore, this kind of information goes in the reactor app, not in an EM config.\n> \n> Perhaps there's an opportunity for that.\n> \n> >  As an example, if I handed you a GPU, with all the specs for what its interfaces supported, there'd be no way to fill this out without knowing what BMC it was being loaded on.\n> \n> Well, yes and no. For example, the kernel will name all I2C/SMBus MCTP interfaces as `mctpi2cX` where `X` is the bus index. So configs can specify `Interface: \"mctpi2c$bus\"` and mostly expect correct behaviour.\n\nIf the kernel defines a naming scheme, why do we need \"mctpi2c\" in the config file?  Just expose the bus number as the bus (Like I think we already do in the existing interface), and we're done.\n\nI think my above point still stands.  There's no physical/software property of the Card that specifies \"MCTPi2c\", so it doesn't belong in a config file.\n\n> However, it does get murky with interface renaming via udev. I'm not aware of anyone doing that yet.\n> \n> The reactor needs to know the interface name,\n\nCan it not go look it up based on the bus using sysfs?\n\n> as specifying this [is a requirement for invoking `SetupEndpoint`](https://github.com/CodeConstruct/mctp/blob/main/docs/mctpd.md#setupendpoint) on `mctpd`'s `/xyz/openbmc_project/mctp` object via the `au.com.CodeConstruct.MCTP` interface. \n\nRight, so just have the daemon assign them mctpi2c(1-N) as the devices detect?\n\n>Further, it needs to know the transport backing the interface as we need to encode the address into the byte array required by the `hwaddr` parameter of `SetupEndpoint`.\n\n\"Type\": \"SMBusMCTPDevice\"\n\nIt think would support that still?  SMBusMCTPDevice maps to the smbus type?\n\n> \n> Perhaps a different approach is to specify the bus index and the transport type. For instance, we could specify this instead:\n> \n> ```\n> {\n>     \"Address\": \"0x1d\",\n>     \"Bus\": \"$bus\",\n>     \"Transport\": \"SMBus\",\n>     \"Type\": \"MCTPDevice\"\n> }\n> ```\n\n\nThe problem with the above is that defining say, a serial port would look like:\n\n {\n    \"ID\": // Something to identify the port\n    \"Transport\": \"Serial\",\n     \"Type\": \"MCTPDevice\"\n }\n \n and now Address and bus have to be optional in schema.  If we separate out SMBusMCTPDevice and SerialMCTPDevice, we can make the required properties for each interface actually required.\n\n> \n> \n> For example, using the `Bus` value of `14` the reactor can construct a sysfs path to map to a netdev interface name associated with the bus:\n> \n> ```\n> # ls /sys/bus/i2c/devices/i2c-14/net/\n> mctpi2c14\n> ```\n> or\n> ```\n> # ( . /sys/bus/i2c/devices/i2c-14/net/*/uevent ; echo $INTERFACE )\n> mctpi2c14\n> ```\n> \n> Accounting for your feedback on the `MCTPInterface` schema above, we could perhaps merge `Transport` into the `Type` value:\n> \n> ```\n> {\n>     \"Address\": \"0x1d\"\n>     \"Bus\": \"$bus\"\n>     \"Type\": \"SMBusMCTPDevice\"\n> }\n> ```\n> \n> Perhaps this would allow us to do away with `MCTPInterface` for now, but MCTP netdev interfaces do need explicit setup. Child busses of I2C muxes on detected cards for instance: The i2c-dev for each mux leg must be configured as its own MCTP netdev interface.\n\nRight, but what I don't understand is why we can't do logic of:\n\nif (mctp device detected):\n   set up mctp lane on that bus\n   \nin the reactor."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 39,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "I'm largely going to draw a line under this thread with consensus on the `\"Type\": \"SMBusMCTPDevice\"` approach from my alternatives above.\n\n> why we can't do logic of:\n>\n> if (mctp device detected):\n> set up mctp lane on that bus\n>\n> in the reactor.\n\nYes, we can do that. However it's still necessary to specify necessary additional details for the interface (\"mctp lane on that bus\"), such as the link MTU (separate from the device MTU), whether or not the BMC should consider itself the bus owner for the interface or act as a peripheral or a bridge, and the network in which the interface participates. They can't be inferred so I think they motivate an `MCTPInterface` config node or some equivalent. We can correlate this on the bus index (I2C) or device index (serial) to locate the appropriate interface config without specifying the kernel's interface name in the configs. I will make an new patchset that defines this approach.\n\nCurrently mctpd assumes it's the top-most bus owner and the bus owner for all interfaces, though Ampere have the motivation for the BMC to support peripheral cases."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 39,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Done.\n\nOne note though: I've decided to switch the name of the schema to `MCTPI2CTarget`.\n\nSeveral motivations here:\n\n1. In v7 of the I2C spec \"master\" and \"slave\" are replaced by \"controller\" and \"target\" respectively. The updated language aligns with v7.\n\n2. The language more closely aligns with the hardware, as SMBus is largely a protocol built atop I2C\n\n3. The in-kernel implementation of DSP0237 refers to the capability as I2C rather than SMBus, so increase alignment there also."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 39,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> I'm largely going to draw a line under this thread with consensus on the `\"Type\": \"SMBusMCTPDevice\"` approach from my alternatives above.\n> \n> > why we can't do logic of:\n> >\n> > if (mctp device detected):\n> > set up mctp lane on that bus\n> >\n> > in the reactor.\n> \n> Yes, we can do that. However it's still necessary to specify necessary additional details for the interface (\"mctp lane on that bus\"), such as the link MTU (separate from the device MTU), \n\nI'm a little surprised that there isn't a default MTU that works for all systems.  Does the spec not say anything about how MTUs should work?  I would assume you request the device MTU with a small MTU size, and increase if the device supports a larger transmission unit?\n\n> whether or not the BMC should consider itself the bus owner for the interface or act as a peripheral or a bridge, and the network in which the interface participates.\n\nThere was no mention of \"is BMC is a bus owner on this bus\" on the original patch.  That makes significantly more sense.  Is that something that can be infered from the device itself?  If the device isn't a bus owner, presumably the BMC has to be the bus owner?\n\n> They can't be inferred so I think they motivate an `MCTPInterface` config node or some equivalent. We can correlate this on the bus index (I2C) or device index (serial) to locate the appropriate interface config without specifying the kernel's interface name in the configs. I will make an new patchset that defines this approach.\n> \n> Currently mctpd assumes it's the top-most bus owner and the bus owner for all interfaces, though Ampere have the motivation for the BMC to support peripheral cases.\n\nACK"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 39,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "> I'm a little surprised that there isn't a default MTU that works for all systems.\n\nMCTP specifies a \"Baseline Transmission Unit\" (BTU, minimum MTU) of 64 bytes. All MCTP-compliant devices must support the BTU, and all MCTP control messages fit inside the BTU. That's necessary so we can perform path MTU discovery. However, the BTU causes a lot of overhead (NVMe-MI gives some experience here).\n\n> Does the spec not say anything about how MTUs should work? I would assume you request the device MTU with a small MTU size, and increase if the device supports a larger transmission unit?\n\nIt says an awful lot about MTUs and path MTU discovery. It also says that configuring the MTU for a given message type on a given device is a problem left to the message-type protocol. See DSP0236 v1.3.1, Section 9.5.1 Path Transmission Unit Negotiation:\n\n> The MCTP control protocol only specifies how to discover what the path transmission unit size is for the path between endpoints. The MCTP control protocol does not specify a generic mechanism for discovering what transmission unit sizes a particular endpoint supports for a given message type. Discovery and negotiation of transmission unit sizes for endpoints, if supported, is specified by the definition of the particular message type."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 39,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "> It says an awful lot about MTUs and path MTU discovery. It also says that configuring the MTU for a given message type on a given device is a problem left to the message-type protocol.\n\nThat said, we could probably set the interface MTU to the maximum known for its underlying transport by default to remove it as an obvious constraint from the path MTU."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 39,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "... but that needs some more thought (it's not necessarily so easy due to query bootstrapping)."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 50,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "How would this work in practice?  This seems like an interface that would just allow people to hardcode addresses/IDs for every possible device, and not have to support dynamic detection at all?  Why use EM then?"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 50,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "I think there's a middle ground. Using it for hot-pluggable devices is questionable. However, it could be used to provide deterministic addresses for devices on the BMC card or the main planar. Essentially, in the tree of the MCTP bus topology, things that are closer to the root (BMC) could exploit it. EM is used to dynamically detect all the cards including main planar. Encoding some platform policy in the main planar config file doesn't feel unreasonable to me. But as mentioned it's way more questionable to do something like that in the config for e.g. the Micron drive."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 50,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> I think there's a middle ground. Using it for hot-pluggable devices is questionable.\n\nI made no mention of hot plug (Plugging in a device while the system is on).  What I'm worried about are devices that you didn't explicitly expect to be plugged in, which is really the whole point of entity-manager.  Devices that might:\n1. Have multiple devices that plug into the same port.\n2. Have multiple ports on multiple boards that accept the same class of device\n3. Have the same device that plugs into multiple baseboards (ie, a normal PCIe card).\n\n> However, it could be used to provide deterministic addresses for devices on the BMC card or the main planar.\n\nWhat is a \"Deterministic address\"?  A physical card doesn't have a deterministic address, and attempting to put it into a config file doesn't make sense.  For things like dynamic-sensors in ipmi, we get semi-determinism by allocating lanes based on hashes, and only moving them in the case of collisions (which would have been non-deterministic anyway).  Could we do something similar here?\n\n> Essentially, in the tree of the MCTP bus topology, things that are closer to the root (BMC) could exploit it. EM is used to dynamically detect all the cards including main planar. Encoding some platform policy in the main planar config file doesn't feel unreasonable to me.  But as mentioned it's way more questionable to do something like that in the config for e.g. the Micron drive.\n\nI'm really not understanding what's being encoded in the main planar?"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 50,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "I'm going to back up a bit.\n\nIf you're going take issue with `StaticEndpointID` in this patch, can you unpack your reasons for giving a CR+1 to [Add mctp eids configuration for Yosemite 4](https://gerrit.openbmc.org/c/openbmc/entity-manager/+/66750)? `StaticEndpointID` in my patch `EndpointId` in Meta's patch. We can change the name back if that helps. Part of what I'm trying to do in my patch is remove assumptions we have to make in the reactor implementation about the transport type based on the lack of metadata in that schema definition.\n\n> What is a \"Deterministic address\"?\n\nBy address I mean EID, and by deterministic I mean one that can be derived from physical addressing properties of the MCTP-capable device. EM supports evaluation of an expression language in its configuration values. A value for `StaticEndpointID` (an address) can be derived from e.g. the bus index and physical address for the device, _if that's desired and appropriate for the board/device config_.\n\n`StaticEndpointID` is _optional_, and it must not be provided in configs where it's not appropriate.\n\n> I'm really not understanding what's being encoded in the main planar?\n\nThe use of `StaticEndpointID` in the main planar _config_, for example for MCTP devices that are integrated into the main planar and are not pluggable.\n\nAssigning a static EID to a device excludes it from the pool of dynamic EIDs that are allocated out on demand. Addressing will remain coherent. Use of a static (not dynamic) constant (not derived) value for `StaticEndpointID` in the config of a pluggable device is inappropriate use `StaticEndpointID`."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 50,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "> If you're going take issue with StaticEndpointID\n\nEndpointID is the endpoint of the MCTP; node within the device, correct?  That seems reasonable to have in a config file describing the device, similar to having an Address parameter.  But given your comment above, it's possible I misunderstood something about what that parameter was doing functionally, and it's quite possible that stuff needs reverted.  Ideally it never would've merged without working backends in place, but I had a misunderstanding about how much work had actually been upstreamed in this space, and arguably made a mistake letting something as incomplete as it was in.  This seems something that we can fix pretty easily.\n\nBacking out the MCTP parts of that change seems reasonable until a backend actually exists.\n\n> EM supports evaluation of an expression language in its configuration values.\n\nI realize some people have used it as such in their downstream EM forks, but based on lots of feedback, doing it that way is error prone at best, and defeats a lot of the reason the parser was built in the first place, to not have to duplicate the configs for the same device that might take on different modes in different locations.  I suspect we need a better solution in that space than the parser (That doesn't even implement parsing order properly) for static addressing.\n\n\nWhat I'm not quite understanding is why EID, something that seems like internal bookkeeping that only the BMC needs to be aware of, needs to be static?  Can we walk through that a little bit?\n\nI'd really like to see us break this support up into pieces, one that doesn't include the idea of static addressing, and just uses assignment (as I think would be the default in any implementation if StaticEndpointID is optional?), then lets try to tackle static assignment, ideally with user-facing descriptions for why a static assignment is required.  What I suspect is that we're trying to hardcode an EID table somewhere else that isn't EM enabled, and we want the two to match.;"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 50,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "> Backing out the MCTP parts of that change seems reasonable until a backend actually exists.\n\nSure.\n\n> What I'm not quite understanding is why EID, something that seems like internal bookkeeping that only the BMC needs to be aware of, needs to be static? Can we walk through that a little bit?\n\nAs a note, there's a bunch of discussion on this topic on Discord:\n\nhttps://discord.com/channels/775381525260664832/819741065531359263/1225127654743871600\n\n> I'd really like to see us break this support up into pieces, one that doesn't include the idea of static addressing, and just uses assignment (as I think would be the default in any implementation if StaticEndpointID is optional?)\n\nYep, I'll do that so we can make some progress with the rest of it.\n\nI'll also rebase it on top of https://gerrit.openbmc.org/c/openbmc/entity-manager/+/70572"
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 60,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "What is the difference between an \"MCTPDevice\" and an \"MCTPInterface\"?\n\nAren't all things Devices that just happen to have an interface?  I'm not sure I understand the distinction."
                },
                {
                    "file": "schemas/mctp.json",
                    "line": 60,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Closing. I answered my own question by looking at later patches."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 41,
                    "deletions": 0
                },
                {
                    "file": "schemas/global.json",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": 0
                },
                {
                    "file": "schemas/mctp.json",
                    "type": "ADDED",
                    "insertions": 67,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 114,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "579a1d8f9c46fbfd5b4819d549ba147ad58531e9",
            "parents": [
                "8a51133ee88e3e9dfce3c72b79bd10cb5ce95863"
            ],
            "ref": "refs/changes/00/69600/4",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1711425197,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 23,
                    "deletions": 0
                },
                {
                    "file": "configurations/yosemite4_floatingfalls.json",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "schemas/global.json",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "schemas/legacy.json",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -6
                },
                {
                    "file": "schemas/mctp.json",
                    "type": "ADDED",
                    "insertions": 31,
                    "deletions": 0
                },
                {
                    "file": "configurations/yosemite4_wailuafalls.json",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -6
                },
                {
                    "file": "configurations/yosemite4_sentineldome.json",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 69,
            "sizeDeletions": 18
        },
        {
            "number": 5,
            "revision": "fa09a35219bc7739711296b785c8e4b2d538f606",
            "parents": [
                "d2f7ba1c6251f482f3431ab51cf2d2b42486a8a0"
            ],
            "ref": "refs/changes/00/69600/5",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1712025336,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "NO_CHANGE",
            "comments": [
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "j"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "https://gerrit.openbmc.org/c/openbmc/entity-manager/+/70572"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Ed Tanous",
                        "email": "ed@tanous.net",
                        "username": "edtanous"
                    },
                    "message": "Whoops. Ignore."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 23,
                    "deletions": 0
                },
                {
                    "file": "configurations/yosemite4_floatingfalls.json",
                    "type": "MODIFIED",
                    "insertions": 4,
                    "deletions": -4
                },
                {
                    "file": "schemas/global.json",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "schemas/legacy.json",
                    "type": "MODIFIED",
                    "insertions": 0,
                    "deletions": -6
                },
                {
                    "file": "schemas/mctp.json",
                    "type": "ADDED",
                    "insertions": 31,
                    "deletions": 0
                },
                {
                    "file": "configurations/yosemite4_wailuafalls.json",
                    "type": "MODIFIED",
                    "insertions": 6,
                    "deletions": -6
                },
                {
                    "file": "configurations/yosemite4_sentineldome.json",
                    "type": "MODIFIED",
                    "insertions": 2,
                    "deletions": -2
                }
            ],
            "sizeInsertions": 69,
            "sizeDeletions": 18
        },
        {
            "number": 6,
            "revision": "61209f156e23e777372c820fd0b269c79de2a914",
            "parents": [
                "32da57bcc5658336cdf7fe924dc3fb4b7c1a2e6a"
            ],
            "ref": "refs/changes/00/69600/6",
            "uploader": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "createdOn": 1712287707,
            "author": {
                "name": "Andrew Jeffery",
                "email": "andrew@codeconstruct.com.au",
                "username": "amboar"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "schemas/mctp.json",
                    "line": 17,
                    "reviewer": {
                        "name": "Andrew Jeffery",
                        "email": "andrew@codeconstruct.com.au",
                        "username": "amboar"
                    },
                    "message": "Possibly these should all be `$ref` to bits in `legacy.json`?"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 23,
                    "deletions": 0
                },
                {
                    "file": "schemas/global.json",
                    "type": "MODIFIED",
                    "insertions": 3,
                    "deletions": 0
                },
                {
                    "file": "schemas/mctp.json",
                    "type": "ADDED",
                    "insertions": 27,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 53,
            "sizeDeletions": 0
        }
    ]
}