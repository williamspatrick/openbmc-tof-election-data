{
    "project": "openbmc/dbus-sensors",
    "branch": "master",
    "id": "Icebabc616ba234ba7d4c5a84869b0948773aa0fd",
    "number": 71495,
    "subject": "Added the PwmDev field to FanSensor",
    "owner": {
        "name": "Glukhov Mikhail",
        "email": "mikl@greenfil.ru",
        "username": "gluhow"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/dbus-sensors/+/71495",
    "hashtags": [],
    "createdOn": 1715929794,
    "lastUpdated": 1717187591,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1715929794,
            "reviewer": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1715929816,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1715929816,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1715929831,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/84531/ : FAILURE"
        },
        {
            "timestamp": 1715930355,
            "reviewer": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "message": "Uploaded patch set 2.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1715930391,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1715930391,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1715930713,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/84533/ : FAILURE"
        },
        {
            "timestamp": 1715938871,
            "reviewer": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE\")\n"
        },
        {
            "timestamp": 1715938917,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1715938917,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1715939300,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/84539/ : SUCCESS"
        },
        {
            "timestamp": 1715962914,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 3:\n\n(3 comments)"
        },
        {
            "timestamp": 1716191634,
            "reviewer": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "message": "Patch Set 3:\n\n(1 comment)"
        },
        {
            "timestamp": 1716970339,
            "reviewer": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        },
        {
            "timestamp": 1717187591,
            "reviewer": {
                "name": "Zhikui Ren",
                "email": "zhikui.ren@intel.com",
                "username": "ZhikuiRen"
            },
            "message": "Patch Set 3:\n\n(2 comments)"
        }
    ],
    "patchSets": [
        {
            "number": 1,
            "revision": "c493c9cdcf0d9b439c4fae729e5bddc136546d36",
            "parents": [
                "394f0c525355fead2f997c6d9a2096d1fb88b1f0"
            ],
            "ref": "refs/changes/95/71495/1",
            "uploader": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "createdOn": 1715929794,
            "author": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "src/FanMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 47,
                    "deletions": -45
                }
            ],
            "sizeInsertions": 73,
            "sizeDeletions": 45
        },
        {
            "number": 2,
            "revision": "34dcc7ce0ed0fb335f2b3ae0e7ba8f0a79b49314",
            "parents": [
                "394f0c525355fead2f997c6d9a2096d1fb88b1f0"
            ],
            "ref": "refs/changes/95/71495/2",
            "uploader": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "createdOn": 1715930355,
            "author": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "src/FanMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": -46
                }
            ],
            "sizeInsertions": 75,
            "sizeDeletions": 46
        },
        {
            "number": 3,
            "revision": "af91f1fabe1430f8061cb5ecc47540eb4ec1f660",
            "parents": [
                "394f0c525355fead2f997c6d9a2096d1fb88b1f0"
            ],
            "ref": "refs/changes/95/71495/3",
            "uploader": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "createdOn": 1715938871,
            "author": {
                "name": "Glukhov Mikhail",
                "email": "mikl@greenfil.ru",
                "username": "gluhow"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "What fan controller device is used? Which driver creates pwm-cpu dev node? \nIs \"PwmDev\" already defined in entity-manager's schema? If not, it needs to be added there."
                },
                {
                    "file": "/COMMIT_MSG",
                    "line": 15,
                    "reviewer": {
                        "name": "Glukhov Mikhail",
                        "email": "mikl@greenfil.ru",
                        "username": "gluhow"
                    },
                    "message": "I'm using the \"pwm-fan\" driver.\nhttps://github.com/openbmc/linux/blob/dev-6.6/drivers/hwmon/pwm-fan.c\n\"PwmDev\" is not present in EM. Yes, I will add it."
                },
                {
                    "file": "src/FanMain.cpp",
                    "line": 493,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Current code requires \"Pwm\" to be found. The new code continues here if it is not found and both pwm and pwmname are not set. \nIt does not seem right."
                },
                {
                    "file": "src/FanMain.cpp",
                    "line": 493,
                    "reviewer": {
                        "name": "Glukhov Mikhail",
                        "email": "mikl@greenfil.ru",
                        "username": "gluhow"
                    },
                    "message": "If at least one of \u201cPwm\u201d and \u201cPwmDev\u201d is not found, then pwmPatchExists is False and the error \u201cConnector for <FanName> no pwm channel found!\u201d is displayed."
                },
                {
                    "file": "src/FanMain.cpp",
                    "line": 493,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "But \"Pwm\" is not just use to find path, it serves as an index and used in line 510.\nIf only \"PwmDev\" is defined and \"Pwm\" is not define, it should quit/continue to next config."
                },
                {
                    "file": "src/FanMain.cpp",
                    "line": 501,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "Can you explain what is the expected logic here?\nCurrent code first looks in directory for pwmX, if not found, it then search for \"pwm-fanX\". \nWhen \"PwmDev\" is defined, should it directly search for the customized name?"
                },
                {
                    "file": "src/FanMain.cpp",
                    "line": 501,
                    "reviewer": {
                        "name": "Glukhov Mikhail",
                        "email": "mikl@greenfil.ru",
                        "username": "gluhow"
                    },
                    "message": "My idea is that if both PwmDev and Pwm are specified, then the program will find the right PwmDev folder and look for the right pwn[] file in it"
                },
                {
                    "file": "src/FanMain.cpp",
                    "line": 501,
                    "reviewer": {
                        "name": "Zhikui Ren",
                        "email": "zhikui.ren@intel.com",
                        "username": "ZhikuiRen"
                    },
                    "message": "I would expect when PwmDev is defined, you know your driver and want to override the default behavior. \"PwmDev\" takes priority over the default pwm-fanX."
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 26,
                    "deletions": 0
                },
                {
                    "file": "src/FanMain.cpp",
                    "type": "MODIFIED",
                    "insertions": 49,
                    "deletions": -46
                }
            ],
            "sizeInsertions": 75,
            "sizeDeletions": 46
        }
    ]
}