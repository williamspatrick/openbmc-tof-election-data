{
    "project": "openbmc/phosphor-pid-control",
    "branch": "master",
    "id": "Iaeb679bf0ad1da9c3d94d1123314f408da32f51a",
    "number": 65348,
    "subject": "Add a design for fan configuration versioning",
    "owner": {
        "name": "DelphineCCChiu",
        "email": "Delphine_CC_Chiu@wiwynn.com",
        "username": "DelphineCCChiu"
    },
    "url": "https://gerrit.openbmc.org/c/openbmc/phosphor-pid-control/+/65348",
    "hashtags": [],
    "createdOn": 1690523322,
    "lastUpdated": 1717139628,
    "open": true,
    "status": "NEW",
    "comments": [
        {
            "timestamp": 1690523322,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Uploaded patch set 1."
        },
        {
            "timestamp": 1690523367,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1690523367,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: -Ok-To-Test"
        },
        {
            "timestamp": 1690523385,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 1: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/72096/ : FAILURE"
        },
        {
            "timestamp": 1690523494,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Uploaded patch set 2: Commit message was updated.\n\nCopied Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1690523556,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1690523556,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2: -Ok-To-Test"
        },
        {
            "timestamp": 1690523575,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 2:\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/72097/ : FAILURE"
        },
        {
            "timestamp": 1690524121,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Uploaded patch set 3.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1690524145,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1690524145,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: -Ok-To-Test"
        },
        {
            "timestamp": 1690524173,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 3: Verified-1\n\nBuild Failed \n\nhttps://jenkins.openbmc.org/job/ci-repository/72099/ : FAILURE"
        },
        {
            "timestamp": 1690524240,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Uploaded patch set 4.\n\nOutdated Votes:\n* Verified-1 (copy condition: \"changekind:NO_CHANGE OR changekind:NO_CODE_CHANGE\")\n"
        },
        {
            "timestamp": 1690524272,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Ok-To-Test+1\n\nUser approved, CI ok to start"
        },
        {
            "timestamp": 1690524272,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: -Ok-To-Test"
        },
        {
            "timestamp": 1690524581,
            "reviewer": {
                "name": "OpenBMC CI",
                "email": "openbmcbump-ci@yahoo.com",
                "username": "jenkins-openbmc-ci"
            },
            "message": "Patch Set 4: Verified+1\n\nBuild Successful \n\nhttps://jenkins.openbmc.org/job/ci-repository/72100/ : SUCCESS"
        },
        {
            "timestamp": 1690858500,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Set Ready For Review"
        },
        {
            "timestamp": 1690954359,
            "reviewer": {
                "name": "Josh Lehan",
                "email": "krellan@gmail.com",
                "username": "Krellan"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1691113021,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1691163762,
            "reviewer": {
                "name": "Josh Lehan",
                "email": "krellan@gmail.com",
                "username": "Krellan"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1691458099,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1691537426,
            "reviewer": {
                "name": "Josh Lehan",
                "email": "krellan@gmail.com",
                "username": "Krellan"
            },
            "message": "Patch Set 4: Code-Review+1\n\n(1 comment)"
        },
        {
            "timestamp": 1692093463,
            "reviewer": {
                "name": "Thang Q. Nguyen",
                "email": "thang@os.amperecomputing.com",
                "username": "thangqn-ampere"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1692181423,
            "reviewer": {
                "name": "Lei YU",
                "email": "mine260309@gmail.com",
                "username": "mine260309"
            },
            "message": "Patch Set 4:\n\n(1 comment)"
        },
        {
            "timestamp": 1698355751,
            "reviewer": {
                "name": "Josh Lehan",
                "email": "krellan@gmail.com",
                "username": "Krellan"
            },
            "message": "Patch Set 4:\n\n(2 comments)"
        },
        {
            "timestamp": 1717139628,
            "reviewer": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "message": "Set Work In Progress"
        }
    ],
    "wip": true,
    "patchSets": [
        {
            "number": 1,
            "revision": "d2e5fe4579f90560fc2fd0d250586be63e60e718",
            "parents": [
                "796f06dc6f0e8161ee9ecf085443c1ae0dc45216"
            ],
            "ref": "refs/changes/48/65348/1",
            "uploader": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "createdOn": 1690523322,
            "author": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 14,
                    "deletions": 0
                },
                {
                    "file": "fan-versioning.md",
                    "type": "ADDED",
                    "insertions": 56,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 70,
            "sizeDeletions": 0
        },
        {
            "number": 2,
            "revision": "c0f7f9be880639fcead44e7b2310336d423258ad",
            "parents": [
                "796f06dc6f0e8161ee9ecf085443c1ae0dc45216"
            ],
            "ref": "refs/changes/48/65348/2",
            "uploader": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "createdOn": 1690523494,
            "author": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "kind": "NO_CODE_CHANGE",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "fan-versioning.md",
                    "type": "ADDED",
                    "insertions": 56,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 71,
            "sizeDeletions": 0
        },
        {
            "number": 3,
            "revision": "d4bd69d90367bf9bdc3bf2fe8884b0068a4e6f19",
            "parents": [
                "796f06dc6f0e8161ee9ecf085443c1ae0dc45216"
            ],
            "ref": "refs/changes/48/65348/3",
            "uploader": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "createdOn": 1690524121,
            "author": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "kind": "REWORK",
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "fan-versioning.md",
                    "type": "ADDED",
                    "insertions": 72,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 87,
            "sizeDeletions": 0
        },
        {
            "number": 4,
            "revision": "7e68a9a9ed82ddcbe53d285e23bcdff0dba10d44",
            "parents": [
                "796f06dc6f0e8161ee9ecf085443c1ae0dc45216"
            ],
            "ref": "refs/changes/48/65348/4",
            "uploader": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "createdOn": 1690524240,
            "author": {
                "name": "DelphineCCChiu",
                "email": "Delphine_CC_Chiu@wiwynn.com",
                "username": "DelphineCCChiu"
            },
            "kind": "REWORK",
            "comments": [
                {
                    "file": "/COMMIT_MSG",
                    "line": 12,
                    "reviewer": {
                        "name": "Josh Lehan",
                        "email": "krellan@gmail.com",
                        "username": "Krellan"
                    },
                    "message": "This summary is good. It should also be at the top of the document itself, not just this commit message."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Josh Lehan",
                        "email": "krellan@gmail.com",
                        "username": "Krellan"
                    },
                    "message": "I am not sure of the purpose of this. Is it to load multiple configurations onto D-Bus at the same time, then use a version number or other selector, to distinguish between them?"
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": "No, it loads one configuration onto D-Bus with a version number included. When we doing thermal calibration, we would have multiple versions of configuaration for testing. It is easy to know what version currently testing if we have a version number on D-Bus. It is also helpful to know what version currently running after BMC firmware update."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Josh Lehan",
                        "email": "krellan@gmail.com",
                        "username": "Krellan"
                    },
                    "message": "Hmm. Wouldn't you be able to see what version is running by looking at the current configuration, that is, the D-Bus `Inventory` objects in `entity-manager`? Those would tell you exactly what parameters are in use, more so than simply looking at a version number field. Or, is there a desire to support the old `config.json` file-based configuration as well?\n\nI still don't really understand what the benefit would be of adding a version number here, or what `phosphor-pid-control` is intended to do with the version number. Is it something only used by the external tools you mentioned?\n\nThere are already two different code paths for providing configuration information to `phosphor-pid-control`, and I am really hesitant to add a third."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "DelphineCCChiu",
                        "email": "Delphine_CC_Chiu@wiwynn.com",
                        "username": "DelphineCCChiu"
                    },
                    "message": ">Or, is there a desire to support the old config.json file-based configuration as well?\n\nYes, we want to support the json file as well. \n\nWhen we have a lot of fans and a parameter different between config version 1 and version 2, it is hard to notice the different of them. We won't need to go through every single parameter if we have fan config version."
                },
                {
                    "file": "/PATCHSET_LEVEL",
                    "line": 0,
                    "reviewer": {
                        "name": "Josh Lehan",
                        "email": "krellan@gmail.com",
                        "username": "Krellan"
                    },
                    "message": "OK. Since it's to support the JSON file also, this makes more sense, because we don't have a way to query Entity Manager at runtime for the old config.json format. Therefore, this functionality is not redundant with what's already there."
                },
                {
                    "file": "fan-versioning.md",
                    "line": 3,
                    "reviewer": {
                        "name": "Thang Q. Nguyen",
                        "email": "thang@os.amperecomputing.com",
                        "username": "thangqn-ampere"
                    },
                    "message": "Do you mean we can have multiple FAN control algorithm and can select to run the right one on a specified criteria?\nI am thinking about the case of the same BMC firmware for different hardware variants (the same motherboard and BMC board but with different chassis and hardware device plugged on it, for example). In this case, as different airflow, different FAN control tables are used."
                },
                {
                    "file": "fan-versioning.md",
                    "line": 6,
                    "reviewer": {
                        "name": "Josh Lehan",
                        "email": "krellan@gmail.com",
                        "username": "Krellan"
                    },
                    "message": "Will it be possible to write, not just read, the current fan configuration setting choice?\n\nReason is, I have recently become aware of a demand for this feature. Have multiple PID control settings on the system, and be able to change between these somehow, perhaps externally (via other changes to external-facing services such as `bmcweb`).\n\nFor example, one could have three versions of settings, \"quiet\", \"normal\", and \"turbo\", and expose an interface to let the user choose one of these three choices. Each of these three versions would activate a different set of pre-tuned thermal parameters appropriate for the platform.\n\nFor safety, the user would not be allowed to change any of the underlying PID loop coefficients or parameters. However, the user would be freely allowed to swap between these three versions at will. This would provide the best balance between safety and flexibility."
                },
                {
                    "file": "fan-versioning.md",
                    "line": 59,
                    "reviewer": {
                        "name": "Lei YU",
                        "email": "mine260309@gmail.com",
                        "username": "mine260309"
                    },
                    "message": "Why not implement this dbus object by phosphor-pid-control directly?"
                }
            ],
            "files": [
                {
                    "file": "/COMMIT_MSG",
                    "type": "ADDED",
                    "insertions": 15,
                    "deletions": 0
                },
                {
                    "file": "fan-versioning.md",
                    "type": "ADDED",
                    "insertions": 71,
                    "deletions": 0
                }
            ],
            "sizeInsertions": 86,
            "sizeDeletions": 0
        }
    ]
}